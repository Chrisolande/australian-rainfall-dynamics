{
  "hash": "b4a83145259d034ef482d78c07f5764c",
  "result": {
    "engine": "knitr",
    "markdown": "# Exploratory Data Analysis {#sec-eda}\n## Temporal and Meteorological Drivers of Australian Rainfall\n\n---\n\n> **Chapter Context.** This chapter investigates the distributional and structural properties of the daily rainfall data, using findings from the data preparation chapter (@sec-data) as its starting point rather than repeating the missingness diagnostics performed there. The analyses proceed in a deliberate sequence: target variable distribution, bivariate predictor correlations, temporal dynamics, pressure analysis, seasonal patterns, and feature interactions. Each section produces a specific finding that motivates a corresponding decision in the feature engineering or model specification stages.\n\n---\n\n\n\n---\n\n## Data Quality Summary {#sec-data-quality}\n\nA thorough investigation of missingness is documented in @sec-data and summarised briefly here for continuity. The full diagnostic pipeline co-missingness analysis, temporal structural break detection, ghost sensor identification, and a weather-conditionality test established the following picture.\n\nThe dataset contains 314,146 missing entries in total, distributed highly unevenly across features. The four most affected variables are `sunshine` (47.7% missing), `evaporation` (42.5%), `cloud9am` (approximately 40%), and `cloud3pm` (approximately 37%). Their missingness is not independent: co-missing rates between any pair of these four variables range from 67% to 93%, confirming that they fail together at the station level rather than through separate independent sensor faults. This is Missing Not At Random at the station level, driven by instrumentation deployment profiles.\n\nA weather-conditionality test confirmed that sunshine missingness does not covary with rainfall amounts: the missing rate is 47.8% on dry days and 47.2% on rainy days. Missingness is station-conditional rather than outcome-conditional, meaning imputed values do not introduce directional bias into the training labels.\n\nThe core dynamic variables pressure, wind speed, temperature, and humidity exhibit missingness below 10% and are available across virtually all observations.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntotal_na <- sum(is.na(df_clean))\nprint(paste(\"Total missing values:\", total_na))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> [1] \"Total missing values: 314146\"\n```\n\n\n:::\n\n```{.r .cell-code}\nmissing_val(df_clean)\n```\n\n::: {.cell-output-display}\n\n\nTable: Percentage of Missing Values by Feature\n\n|column          | pct_missing|\n|:---------------|-----------:|\n|sunshine        |  47.6937250|\n|evaporation     |  42.5375706|\n|cloud3pm        |  39.9960619|\n|cloud9am        |  37.5044832|\n|pressure3pm     |   9.8404349|\n|pressure9am     |   9.8031632|\n|wind_dir9am     |   6.8840147|\n|wind_gust_dir   |   6.8390073|\n|wind_gust_speed |   6.7968129|\n|wind_dir3pm     |   2.6716081|\n|humidity3pm     |   2.5527606|\n|temp3pm         |   1.9310966|\n|wind_speed3pm   |   1.8614758|\n|humidity9am     |   1.0928347|\n|rain_tomorrow   |   0.9929746|\n|wind_speed9am   |   0.7672347|\n|temp9am         |   0.4817193|\n|min_temp        |   0.3424778|\n|max_temp        |   0.3305227|\n|date            |   0.0000000|\n|location        |   0.0000000|\n|rainfall        |   0.0000000|\n|rain_today      |   0.0000000|\n|month           |   0.0000000|\n|day             |   0.0000000|\n\n\n:::\n:::\n\n\n**Resolution.** A two-stage hybrid imputation pipeline was applied in @sec-data: linear temporal interpolation bounded by a five-day cap for the eight smoothly-evolving meteorological variables, followed by multivariate Random Forest imputation via `mice` for the four atmosphere variables (`sunshine`, `evaporation`, `cloud9am`, `cloud3pm`) and the three wind direction variables (`wind_gust_dir`, `wind_dir9am`, `wind_dir3pm`). Each variable's predictor set was restricted to physically motivated covariates: cloud cover from humidity and pressure, sunshine from cloud cover and temperature, evaporation from wind speed, temperature and humidity, and wind direction from the corresponding wind speed, pressure, location, and month. Ghost sensor station-variable pairs, those with more than 90% missingness across the full observation window, were identified before the Random Forest stage and carried forward with binary imputation flags (`sunshine_imp_flagged`, `evap_imp_flagged`, `cloud3pm_imp_flagged`, `cloud9am_imp_flagged`) rather than populated with extrapolations that have no empirical anchor. The imputed dataset `df_final` is used throughout the remainder of this chapter. The raw dataset `df_clean` is used only in this opening section, where using pre-imputation data avoids circularity between the imputed features and the response distribution.\n\n**Modelling implication.** The concentration of missingness in `sunshine` and `evaporation`, both of which exhibit meaningful correlation with rainfall, as shown in @sec-correlation, creates a direct trade-off: discarding these variables avoids imputation complexity but sacrifices predictive signal, while listwise deletion would eliminate nearly half the dataset and introduce geographic bias toward well-instrumented stations. The Random Forest imputation strategy in @sec-data resolves this trade-off by preserving both sample and features.\n\n---\n\n## Distributional Properties of the Target Variable\n\nUnderstanding the marginal distribution of the response variable is a prerequisite for selecting an appropriate model family. A Gaussian assumption carries substantive claims about the data-generating process that can be directly tested.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrainfall_stats <- df_clean %>%\n  summarise(\n    n = n(),\n    mean = mean(rainfall),\n    median = median(rainfall),\n    sd = sd(rainfall),\n    min = min(rainfall),\n    max = max(rainfall),\n    q25 = quantile(rainfall, 0.25),\n    q75 = quantile(rainfall, 0.75),\n    iqr = IQR(rainfall),\n    n_zeros = sum(rainfall == 0),\n    pct_zeros = mean(rainfall == 0) * 100,\n    n_large = sum(rainfall > 100),\n    pct_large = mean(rainfall > 100) * 100,\n    skewness = moments::skewness(rainfall),\n    kurtosis = moments::kurtosis(rainfall)\n  )\n\nrainfall_stats %>%\n  pivot_longer(everything(), names_to = \"Statistic\", values_to = \"Value\") %>%\n  mutate(\n    Value = ifelse(\n      Value > 1000,\n      format(Value, scientific = TRUE, digits = 3),\n      round(Value, 3)\n    )\n  ) %>%\n  kable(\n    caption = \"Descriptive Statistics: Daily Rainfall (mm)\",\n    align = \"lr\"\n  ) %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Descriptive Statistics: Daily Rainfall (mm)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Statistic </th>\n   <th style=\"text-align:right;\"> Value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> n </td>\n   <td style=\"text-align:right;\"> 1.42e+05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> mean </td>\n   <td style=\"text-align:right;\"> 2.361 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> median </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sd </td>\n   <td style=\"text-align:right;\"> 8.478 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> min </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> max </td>\n   <td style=\"text-align:right;\"> 371 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> q25 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> q75 </td>\n   <td style=\"text-align:right;\"> 0.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> iqr </td>\n   <td style=\"text-align:right;\"> 0.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> n_zeros </td>\n   <td style=\"text-align:right;\"> 9.11e+04 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pct_zeros </td>\n   <td style=\"text-align:right;\"> 64.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> n_large </td>\n   <td style=\"text-align:right;\"> 151 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pct_large </td>\n   <td style=\"text-align:right;\"> 0.106 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> skewness </td>\n   <td style=\"text-align:right;\"> 9.836 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> kurtosis </td>\n   <td style=\"text-align:right;\"> 181.146 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\nrain_check <- df_clean %>%\n  summarise(\n    total_days = n(),\n    dry_days = sum(rainfall == 0),\n    rainy_days = sum(rainfall > 0),\n    zero_inflation_pct = (dry_days / total_days) * 100\n  )\n\nrain_check %>%\n  kable(\n    caption = \"Prevalence of Zero-Inflation (Dry Days)\",\n    col.names = c(\n      \"Total Days\",\n      \"Dry Days (0mm)\",\n      \"Rainy Days (>0mm)\",\n      \"Zero Inflation (%)\"\n    )\n  ) %>%\n  kable_styling(\n    bootstrap_options = c(\"striped\", \"bordered\"),\n    full_width = FALSE\n  )\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-bordered\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Prevalence of Zero-Inflation (Dry Days)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Total Days </th>\n   <th style=\"text-align:right;\"> Dry Days (0mm) </th>\n   <th style=\"text-align:right;\"> Rainy Days (&gt;0mm) </th>\n   <th style=\"text-align:right;\"> Zero Inflation (%) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 142199 </td>\n   <td style=\"text-align:right;\"> 91080 </td>\n   <td style=\"text-align:right;\"> 51119 </td>\n   <td style=\"text-align:right;\"> 64.05108 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe descriptive statistics reveal a distribution fundamentally incompatible with Gaussian modelling assumptions.\n\n**Zero-inflation.** 64.05% of the 142,199 recorded observations are dry days (rainfall = 0 mm). The median is zero. The data-generating mechanism genuinely produces two qualitatively different outcomes, no rain at all versus some positive amount and any model treating the response as a single continuous variable will be forced to place probability mass on negative values and will systematically misestimate the probability of the zero outcome.\n\n**Heavy tails.** Among non-zero observations, the distribution is severely right-skewed (skewness = 9.84). The standard deviation (8.48 mm) is nearly four times the mean (2.36 mm). Kurtosis of 181.15 compared to 3 for a normal distribution confirms that extreme events occur far more frequently than a Gaussian model would predict. The maximum recorded value is 371 mm, and 151 events exceed 100 mm.\n\n**Modelling implication.** The conjunction of zero-inflation and extreme positive skew means a single-component model is insufficient. The data implicitly poses two separate questions: does rain occur (binary classification) and, given that it does, how much falls (positive continuous regression). This motivates the Zero-Inflated Gamma framework adopted in subsequent analysis.\n\n---\n\n## Bivariate Correlation Structure {#sec-correlation}\n\nBecause rainfall is heavily skewed and the relationships are unlikely to be linear, Spearman rank correlation is used throughout, a non-parametric measure that captures monotonic association without requiring linearity or normality.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nnumeric_cols <- df_clean %>%\n  select(where(is.numeric)) %>%\n  names()\nnumeric_cols <- numeric_cols[numeric_cols != \"rainfall\"]\n\ncors <- df_clean %>%\n  rstatix::cor_test(\n    vars = \"rainfall\",\n    vars2 = numeric_cols,\n    method = \"spearman\"\n  ) %>%\n  filter(!is.na(cor)) %>%\n  arrange(desc(abs(cor))) %>%\n  dplyr::select(var2, cor, p) %>%\n  mutate(\n    interpretation = case_when(\n      abs(cor) < 0.1 ~ \"Negligible\",\n      abs(cor) < 0.3 ~ \"Small\",\n      abs(cor) < 0.5 ~ \"Moderate\",\n      TRUE ~ \"Large\"\n    )\n  )\n\ncors %>%\n  kable(\n    caption = \"Spearman Correlation with Rainfall (Ranked by Strength)\",\n    col.names = c(\"Predictor\", \"Correlation (r)\", \"P-Value\", \"Strength\")\n  ) %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Spearman Correlation with Rainfall (Ranked by Strength)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Predictor </th>\n   <th style=\"text-align:right;\"> Correlation (r) </th>\n   <th style=\"text-align:right;\"> P-Value </th>\n   <th style=\"text-align:left;\"> Strength </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> humidity9am </td>\n   <td style=\"text-align:right;\"> 0.440 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Moderate </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> humidity3pm </td>\n   <td style=\"text-align:right;\"> 0.440 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Moderate </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sunshine </td>\n   <td style=\"text-align:right;\"> -0.400 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Moderate </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> cloud9am </td>\n   <td style=\"text-align:right;\"> 0.370 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Moderate </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> cloud3pm </td>\n   <td style=\"text-align:right;\"> 0.320 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Moderate </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> evaporation </td>\n   <td style=\"text-align:right;\"> -0.310 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Moderate </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> temp3pm </td>\n   <td style=\"text-align:right;\"> -0.310 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Moderate </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> max_temp </td>\n   <td style=\"text-align:right;\"> -0.300 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Moderate </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pressure9am </td>\n   <td style=\"text-align:right;\"> -0.150 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Small </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> temp9am </td>\n   <td style=\"text-align:right;\"> -0.150 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Small </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> wind_gust_speed </td>\n   <td style=\"text-align:right;\"> 0.130 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Small </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> wind_speed9am </td>\n   <td style=\"text-align:right;\"> 0.083 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Negligible </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> wind_speed3pm </td>\n   <td style=\"text-align:right;\"> 0.068 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Negligible </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pressure3pm </td>\n   <td style=\"text-align:right;\"> -0.063 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Negligible </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> min_temp </td>\n   <td style=\"text-align:right;\"> 0.022 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Negligible </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncor_matrix <- df_clean %>%\n  select(where(is.numeric)) %>%\n  cor(use = \"pairwise.complete.obs\", method = \"spearman\")\n\ncor_melt <- cor_matrix %>%\n  as.data.frame() %>%\n  rownames_to_column(var = \"Var1\") %>%\n  pivot_longer(cols = -Var1, names_to = \"Var2\", values_to = \"Correlation\")\n\ncor_melt %>%\n  ggplot(aes(x = Var1, y = Var2, fill = Correlation)) +\n  geom_tile(color = \"white\") +\n  scale_fill_gradient2(\n    low = \"#D73027\",\n    mid = \"white\",\n    high = \"#4575B4\",\n    midpoint = 0,\n    limit = c(-1, 1),\n    name = \"Spearman\\nCorrelation\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, vjust = 1, size = 10, hjust = 1),\n    axis.text.y = element_text(size = 10),\n    axis.title = element_blank(),\n    panel.grid.major = element_blank(),\n    legend.position = \"right\"\n  ) +\n  geom_text(\n    data = filter(cor_melt, abs(Correlation) > 0.3),\n    aes(label = round(Correlation, 2)),\n    color = \"black\",\n    size = 3\n  ) +\n  labs(\n    title = \"Feature Correlation Matrix\",\n    subtitle = \"Strongest predictors: Humidity (positive) and Sunshine (negative)\"\n  )\n```\n\n::: {.cell-output-display}\n![Spearman Correlation Matrix of Meteorological Features. Red indicates negative correlation; blue indicates positive correlation. Coefficients shown for pairs where |r| > 0.3.](03-eda_files/figure-html/fig-correlation-matrix-1.png){#fig-correlation-matrix fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncor_humidity <- cor.test(\n  df_clean$rainfall,\n  df_clean$humidity3pm,\n  method = \"spearman\"\n)\ncor_sunshine <- cor.test(\n  df_clean$rainfall,\n  df_clean$sunshine,\n  method = \"spearman\"\n)\n\ncocor_result <- cocor.dep.groups.overlap(\n  r.jk = cor_humidity$estimate,\n  r.jh = cor_sunshine$estimate,\n  r.kh = cor(\n    df_clean$humidity3pm,\n    df_clean$sunshine,\n    use = \"complete.obs\",\n    method = \"spearman\"\n  ),\n  n = nrow(df_clean),\n  alternative = \"two.sided\",\n  test = \"steiger1980\",\n  return.htest = TRUE\n)\n\nprint(cocor_result)\n#> $pearson1898\n#> \n#> \tPearson and Filon's z (1898)\n#> \n#> data:  \n#> \n#> alternative hypothesis: true difference in correlations is not equal to 0\n#> sample estimates:\n#>   r.jk.rho   r.jh.rho       r.kh \n#>  0.4436352 -0.4013063 -0.6206376 \n#> \n#> \n#> $hotelling1940\n#> \n#> \tHotelling's t (1940)\n#> \n#> data:  \n#> \n#> alternative hypothesis: true difference in correlations is not equal to 0\n#> sample estimates:\n#>   r.jk.rho   r.jh.rho       r.kh \n#>  0.4436352 -0.4013063 -0.6206376 \n#> \n#> \n#> $williams1959\n#> \n#> \tWilliams' t (1959)\n#> \n#> data:  \n#> \n#> alternative hypothesis: true difference in correlations is not equal to 0\n#> sample estimates:\n#>   r.jk.rho   r.jh.rho       r.kh \n#>  0.4436352 -0.4013063 -0.6206376 \n#> \n#> \n#> $hendrickson1970\n#> \n#> \tHendrickson, Stanley, and Hills' (1970) modification of Williams' t\n#> \t(1959)\n#> \n#> data:  \n#> \n#> alternative hypothesis: true difference in correlations is not equal to 0\n#> sample estimates:\n#>   r.jk.rho   r.jh.rho       r.kh \n#>  0.4436352 -0.4013063 -0.6206376 \n#> \n#> \n#> $olkin1967\n#> \n#> \tOlkin's z (1967)\n#> \n#> data:  \n#> \n#> alternative hypothesis: true difference in correlations is not equal to 0\n#> sample estimates:\n#>   r.jk.rho   r.jh.rho       r.kh \n#>  0.4436352 -0.4013063 -0.6206376 \n#> \n#> \n#> $dunn1969\n#> \n#> \tDunn and Clark's z (1969)\n#> \n#> data:  \n#> \n#> alternative hypothesis: true difference in correlations is not equal to 0\n#> sample estimates:\n#>   r.jk.rho   r.jh.rho       r.kh \n#>  0.4436352 -0.4013063 -0.6206376 \n#> \n#> \n#> $steiger1980\n#> \n#> \tSteiger's (1980) modification of Dunn and Clark's z (1969) using\n#> \taverage correlations\n#> \n#> data:  \n#> z = 188.91, p-value < 2.2e-16\n#> alternative hypothesis: true difference in correlations is not equal to 0\n#> sample estimates:\n#>   r.jk.rho   r.jh.rho       r.kh \n#>  0.4436352 -0.4013063 -0.6206376 \n#> \n#> \n#> $meng1992\n#> \n#> \tMeng, Rosenthal, and Rubin's z (1992)\n#> \n#> data:  \n#> \n#> alternative hypothesis: true difference in correlations is not equal to 0\n#> sample estimates:\n#>   r.jk.rho   r.jh.rho       r.kh \n#>  0.4436352 -0.4013063 -0.6206376 \n#> \n#> \n#> $hittner2003\n#> \n#> \tHittner, May, and Silver's (2003) modification of Dunn and Clark's z\n#> \t(1969) using a backtransformed average Fisher's (1921) Z procedure\n#> \n#> data:  \n#> \n#> alternative hypothesis: true difference in correlations is not equal to 0\n#> sample estimates:\n#>   r.jk.rho   r.jh.rho       r.kh \n#>  0.4436352 -0.4013063 -0.6206376 \n#> \n#> \n#> $zou2007\n#> \n#> \tZou's (2007) confidence interval\n#> \n#> data:  \n#> \n#> alternative hypothesis: true difference in correlations is not equal to 0\n#> sample estimates:\n#>   r.jk.rho   r.jh.rho       r.kh \n#>  0.4436352 -0.4013063 -0.6206376\n```\n:::\n\n\n**Moisture indicators (positive association).** `Humidity3pm` ($r = 0.44$) and cloud cover ($r \\approx 0.37$) show the strongest positive associations. High afternoon humidity indicates moisture has accumulated in the lower atmosphere over the course of the day. Cloud cover is both a physical precondition for rain and a consequence of the same atmospheric dynamics.\n\n**Radiation and evaporation indicators (negative association).** `Sunshine` ($r = -0.40$) and `evaporation` ($r = -0.31$) exhibit the strongest negative associations. Long sunshine hours proxy clear-sky, high-pressure conditions. High evaporation signals warm, dry, low-humidity surface conditions.\n\n**Multicollinearity.** The correlation heatmap (@fig-correlation-matrix) reveals substantial redundancy among predictors. `pressure9am` and `pressure3pm` share $r = 0.96$, and the two temperature readings are similarly collinear. This directly motivates VIF-based feature selection in the feature engineering chapter.\n\n**Statistical validation.** Steiger's Z-test comparing the two strongest opposing predictors yields $z \\approx 188.9$, $p < 2.2 \\times 10^{-16}$. With $N > 140,000$, the p-value alone is uninformative; the Z-statistic magnitude confirms the differential predictive strength is not a sampling artefact. Humidity and sunshine represent genuinely distinct physical forces operating in opposing directions.\n\n---\n\n## Temporal Structure of Rainfall\n\n### Weekly and Seasonal Frequency {#sec-frequency}\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_clean %>%\n  filter(rainfall > 0) %>%\n  tabyl(day) %>%\n  adorn_pct_formatting() %>%\n  arrange(desc(n)) %>%\n  kable(\n    caption = \"Frequency of Rainfall Days by Day of the Week\",\n    col.names = c(\"Day\", \"Count (n)\", \"Percentage\")\n  ) %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Frequency of Rainfall Days by Day of the Week</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Day </th>\n   <th style=\"text-align:right;\"> Count (n) </th>\n   <th style=\"text-align:left;\"> Percentage </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Tue </td>\n   <td style=\"text-align:right;\"> 7508 </td>\n   <td style=\"text-align:left;\"> 14.7% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mon </td>\n   <td style=\"text-align:right;\"> 7480 </td>\n   <td style=\"text-align:left;\"> 14.6% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Fri </td>\n   <td style=\"text-align:right;\"> 7378 </td>\n   <td style=\"text-align:left;\"> 14.4% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Wed </td>\n   <td style=\"text-align:right;\"> 7342 </td>\n   <td style=\"text-align:left;\"> 14.4% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Thu </td>\n   <td style=\"text-align:right;\"> 7314 </td>\n   <td style=\"text-align:left;\"> 14.3% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Sat </td>\n   <td style=\"text-align:right;\"> 7057 </td>\n   <td style=\"text-align:left;\"> 13.8% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Sun </td>\n   <td style=\"text-align:right;\"> 7040 </td>\n   <td style=\"text-align:left;\"> 13.8% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\ndf_clean %>%\n  filter(rainfall > 0) %>%\n  tabyl(month) %>%\n  adorn_pct_formatting() %>%\n  arrange(desc(n)) %>%\n  kable(\n    caption = \"Frequency of Rainfall Days by Month\",\n    col.names = c(\"Month\", \"Count (n)\", \"Percentage\")\n  ) %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Frequency of Rainfall Days by Month</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Month </th>\n   <th style=\"text-align:right;\"> Count (n) </th>\n   <th style=\"text-align:left;\"> Percentage </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 6 </td>\n   <td style=\"text-align:right;\"> 5448 </td>\n   <td style=\"text-align:left;\"> 10.7% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 7 </td>\n   <td style=\"text-align:right;\"> 5250 </td>\n   <td style=\"text-align:left;\"> 10.3% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:right;\"> 4937 </td>\n   <td style=\"text-align:left;\"> 9.7% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 8 </td>\n   <td style=\"text-align:right;\"> 4704 </td>\n   <td style=\"text-align:left;\"> 9.2% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:right;\"> 4444 </td>\n   <td style=\"text-align:left;\"> 8.7% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 9 </td>\n   <td style=\"text-align:right;\"> 4234 </td>\n   <td style=\"text-align:left;\"> 8.3% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4001 </td>\n   <td style=\"text-align:left;\"> 7.8% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 10 </td>\n   <td style=\"text-align:right;\"> 3770 </td>\n   <td style=\"text-align:left;\"> 7.4% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 11 </td>\n   <td style=\"text-align:right;\"> 3760 </td>\n   <td style=\"text-align:left;\"> 7.4% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3702 </td>\n   <td style=\"text-align:left;\"> 7.2% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 12 </td>\n   <td style=\"text-align:right;\"> 3562 </td>\n   <td style=\"text-align:left;\"> 7.0% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 3307 </td>\n   <td style=\"text-align:left;\"> 6.5% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\ndf_clean %>%\n  filter(rainfall > 0) %>%\n  tabyl(month, day) %>%\n  adorn_totals(c(\"row\", \"col\")) %>%\n  kable(caption = \"Cross-tabulation of Rainfall Frequency: Month vs. Day\") %>%\n  kable_styling(\n    bootstrap_options = c(\"striped\", \"condensed\"),\n    font_size = 11\n  ) %>%\n  scroll_box(width = \"100%\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; \"><table class=\"table table-striped table-condensed\" style=\"font-size: 11px; margin-left: auto; margin-right: auto;\">\n<caption style=\"font-size: initial !important;\">Cross-tabulation of Rainfall Frequency: Month vs. Day</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> month </th>\n   <th style=\"text-align:right;\"> Sun </th>\n   <th style=\"text-align:right;\"> Mon </th>\n   <th style=\"text-align:right;\"> Tue </th>\n   <th style=\"text-align:right;\"> Wed </th>\n   <th style=\"text-align:right;\"> Thu </th>\n   <th style=\"text-align:right;\"> Fri </th>\n   <th style=\"text-align:right;\"> Sat </th>\n   <th style=\"text-align:right;\"> Total </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 536 </td>\n   <td style=\"text-align:right;\"> 570 </td>\n   <td style=\"text-align:right;\"> 514 </td>\n   <td style=\"text-align:right;\"> 482 </td>\n   <td style=\"text-align:right;\"> 493 </td>\n   <td style=\"text-align:right;\"> 567 </td>\n   <td style=\"text-align:right;\"> 540 </td>\n   <td style=\"text-align:right;\"> 3702 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 480 </td>\n   <td style=\"text-align:right;\"> 530 </td>\n   <td style=\"text-align:right;\"> 469 </td>\n   <td style=\"text-align:right;\"> 466 </td>\n   <td style=\"text-align:right;\"> 443 </td>\n   <td style=\"text-align:right;\"> 471 </td>\n   <td style=\"text-align:right;\"> 448 </td>\n   <td style=\"text-align:right;\"> 3307 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:right;\"> 636 </td>\n   <td style=\"text-align:right;\"> 645 </td>\n   <td style=\"text-align:right;\"> 639 </td>\n   <td style=\"text-align:right;\"> 592 </td>\n   <td style=\"text-align:right;\"> 662 </td>\n   <td style=\"text-align:right;\"> 644 </td>\n   <td style=\"text-align:right;\"> 626 </td>\n   <td style=\"text-align:right;\"> 4444 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 578 </td>\n   <td style=\"text-align:right;\"> 597 </td>\n   <td style=\"text-align:right;\"> 566 </td>\n   <td style=\"text-align:right;\"> 604 </td>\n   <td style=\"text-align:right;\"> 579 </td>\n   <td style=\"text-align:right;\"> 515 </td>\n   <td style=\"text-align:right;\"> 562 </td>\n   <td style=\"text-align:right;\"> 4001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:right;\"> 710 </td>\n   <td style=\"text-align:right;\"> 722 </td>\n   <td style=\"text-align:right;\"> 765 </td>\n   <td style=\"text-align:right;\"> 714 </td>\n   <td style=\"text-align:right;\"> 678 </td>\n   <td style=\"text-align:right;\"> 681 </td>\n   <td style=\"text-align:right;\"> 667 </td>\n   <td style=\"text-align:right;\"> 4937 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 6 </td>\n   <td style=\"text-align:right;\"> 766 </td>\n   <td style=\"text-align:right;\"> 801 </td>\n   <td style=\"text-align:right;\"> 804 </td>\n   <td style=\"text-align:right;\"> 797 </td>\n   <td style=\"text-align:right;\"> 760 </td>\n   <td style=\"text-align:right;\"> 753 </td>\n   <td style=\"text-align:right;\"> 767 </td>\n   <td style=\"text-align:right;\"> 5448 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 7 </td>\n   <td style=\"text-align:right;\"> 694 </td>\n   <td style=\"text-align:right;\"> 717 </td>\n   <td style=\"text-align:right;\"> 728 </td>\n   <td style=\"text-align:right;\"> 796 </td>\n   <td style=\"text-align:right;\"> 773 </td>\n   <td style=\"text-align:right;\"> 818 </td>\n   <td style=\"text-align:right;\"> 724 </td>\n   <td style=\"text-align:right;\"> 5250 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 8 </td>\n   <td style=\"text-align:right;\"> 612 </td>\n   <td style=\"text-align:right;\"> 702 </td>\n   <td style=\"text-align:right;\"> 694 </td>\n   <td style=\"text-align:right;\"> 679 </td>\n   <td style=\"text-align:right;\"> 689 </td>\n   <td style=\"text-align:right;\"> 687 </td>\n   <td style=\"text-align:right;\"> 641 </td>\n   <td style=\"text-align:right;\"> 4704 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 9 </td>\n   <td style=\"text-align:right;\"> 516 </td>\n   <td style=\"text-align:right;\"> 571 </td>\n   <td style=\"text-align:right;\"> 616 </td>\n   <td style=\"text-align:right;\"> 639 </td>\n   <td style=\"text-align:right;\"> 648 </td>\n   <td style=\"text-align:right;\"> 659 </td>\n   <td style=\"text-align:right;\"> 585 </td>\n   <td style=\"text-align:right;\"> 4234 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 10 </td>\n   <td style=\"text-align:right;\"> 507 </td>\n   <td style=\"text-align:right;\"> 606 </td>\n   <td style=\"text-align:right;\"> 579 </td>\n   <td style=\"text-align:right;\"> 550 </td>\n   <td style=\"text-align:right;\"> 517 </td>\n   <td style=\"text-align:right;\"> 456 </td>\n   <td style=\"text-align:right;\"> 555 </td>\n   <td style=\"text-align:right;\"> 3770 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 11 </td>\n   <td style=\"text-align:right;\"> 556 </td>\n   <td style=\"text-align:right;\"> 526 </td>\n   <td style=\"text-align:right;\"> 554 </td>\n   <td style=\"text-align:right;\"> 480 </td>\n   <td style=\"text-align:right;\"> 538 </td>\n   <td style=\"text-align:right;\"> 575 </td>\n   <td style=\"text-align:right;\"> 531 </td>\n   <td style=\"text-align:right;\"> 3760 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 12 </td>\n   <td style=\"text-align:right;\"> 449 </td>\n   <td style=\"text-align:right;\"> 493 </td>\n   <td style=\"text-align:right;\"> 580 </td>\n   <td style=\"text-align:right;\"> 543 </td>\n   <td style=\"text-align:right;\"> 534 </td>\n   <td style=\"text-align:right;\"> 552 </td>\n   <td style=\"text-align:right;\"> 411 </td>\n   <td style=\"text-align:right;\"> 3562 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Total </td>\n   <td style=\"text-align:right;\"> 7040 </td>\n   <td style=\"text-align:right;\"> 7480 </td>\n   <td style=\"text-align:right;\"> 7508 </td>\n   <td style=\"text-align:right;\"> 7342 </td>\n   <td style=\"text-align:right;\"> 7314 </td>\n   <td style=\"text-align:right;\"> 7378 </td>\n   <td style=\"text-align:right;\"> 7057 </td>\n   <td style=\"text-align:right;\"> 51119 </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n:::\n\n\n**Weekly cycle.** The distribution of wet days across the days of the week is approximately uniform, ranging from 13.8% to 14.7%. This near-uniformity is physically expected: atmospheric processes operate independently of the social calendar. The slight variation is consistent with sampling noise, suggesting `Day` carries little predictive information.\n\n**Annual cycle.** June (10.7%) and July (10.3%) record the highest frequency of wet days, consistent with Southern Hemisphere winter frontal systems from the Southern Ocean. February (6.5%) and December (7.0%) record the lowest frequencies. The cross-tabulation confirms this seasonal signal is not an artefact of any particular day of the week. `Month` is therefore a legitimate predictor warranting explicit model inclusion.\n\n### Day-to-Day Persistence: A Markov Chain Analysis {#sec-markov}\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmarkov_table <- df_final %>%\n  group_by(location) %>%\n  arrange(date) %>%\n  mutate(yesterday_rain = lag(rain_today)) %>%\n  ungroup() %>%\n  filter(!is.na(rain_today), !is.na(yesterday_rain)) %>%\n  count(yesterday_rain, rain_today)\n\ncont_table <- markov_table %>%\n  pivot_wider(names_from = rain_today, values_from = n, values_fill = 0) %>%\n  column_to_rownames(\"yesterday_rain\") %>%\n  as.matrix()\n\nprint(cont_table)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>        No   Yes\n#> No  93231 17043\n#> Yes 17047 14829\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nchi_result <- chisq_test(as.table(cont_table))\nprint(chi_result)\n#> # A tibble: 1 Ã— 6\n#>        n statistic     p    df method          p.signif\n#> *  <int>     <dbl> <dbl> <int> <chr>           <chr>   \n#> 1 142150    13718.     0     1 Chi-square test ****\n\ncramers_v <- cramer_v(cont_table)\n\ncat(\"\\nEffect Size Interpretation\\n\")\n#> \n#> Effect Size Interpretation\ncat(sprintf(\"V = %.4f: \", cramers_v))\n#> V = 0.3107:\n\nif (cramers_v < 0.1) {\n  cat(\"Negligible Association\\n\")\n} else if (cramers_v < 0.3) {\n  cat(\"Weak Association\\n\")\n} else if (cramers_v < 0.5) {\n  cat(\"Moderate Association\\n\")\n} else {\n  cat(\"Strong Association\\n\")\n}\n#> Moderate Association\n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmarkov_data <- df_final %>%\n  group_by(location) %>%\n  arrange(date) %>%\n  mutate(yesterday_rain = lag(rain_today)) %>%\n  ungroup() %>%\n  filter(!is.na(rain_today), !is.na(yesterday_rain))\n\nmarkov_data %>%\n  count(yesterday_rain, rain_today) %>%\n  group_by(yesterday_rain) %>%\n  mutate(prob = n / sum(n)) %>%\n  ggplot(aes(x = yesterday_rain, y = rain_today, fill = prob)) +\n  geom_tile() +\n  geom_text(\n    aes(label = scales::percent(prob, accuracy = 1)),\n    color = \"white\",\n    size = 8,\n    fontface = \"bold\"\n  ) +\n  scale_fill_viridis_c(option = \"viridis\", begin = 0.2, end = 0.8) +\n  labs(\n    title = \"Markov Chain: Rain Persistence Effect\",\n    subtitle = sprintf(\n      \"X^2 = %.2f, p < 0.001, Cramer's V = %.3f (Moderate Association)\\nYesterday's rain state is a significant, moderate predictor of today's rain state.\",\n      chi_result$statistic,\n      cramers_v\n    ),\n    x = \"Did it Rain Yesterday?\",\n    y = \"Did it Rain Today?\",\n    fill = \"Probability\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text = element_text(size = 12),\n    axis.title = element_text(size = 14, face = \"bold\"),\n    plot.title = element_text(size = 16, face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![Markov Chain Transition Matrix. The asymmetry between dry-to-dry (85%) and wet-to-wet (47%) probabilities is the central finding: dry states are self-reinforcing, wet states are transient.](03-eda_files/figure-html/fig-markov-chain-1.png){#fig-markov-chain fig-align='center' width=100%}\n:::\n:::\n\n\nThe Chi-squared test yields $\\chi^2 \\approx 13,718$, $p < 0.001$, rejecting daily independence by a large margin. Cramer's V ($V \\approx 0.31$) confirms a moderate practical effect size.\n\nThe transition matrix (@fig-markov-chain) reveals an important asymmetry. When the previous day was dry, there is an 85% probability of remaining dry, high-pressure systems are persistent and self-reinforcing. When the previous day was wet, there is only a 47% probability of continued rain, meaning wet events are more transient. This asymmetry has a direct atmospheric interpretation: anticyclonic systems can persist for days to weeks, while frontal systems pass through more quickly.\n\n`rain_today` (lagged one day) carries meaningful predictive signal. Its modest effect size also demonstrates that autocorrelation alone is insufficient: the wet state is too transient for a persistence-only rule, and other meteorological covariates are necessary.\n\n### Dry Spell Dynamics and Temporal Decay {#sec-dry-spell}\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndry_spell_data <- df_final %>%\n  group_by(location) %>%\n  arrange(date) %>%\n  mutate(\n    did_rain_yesterday = lag(rainfall > 0, default = FALSE),\n    dry_spell_id = cumsum(did_rain_yesterday)\n  ) %>%\n  group_by(location, dry_spell_id) %>%\n  mutate(days_since_rain = row_number()) %>%\n  ungroup() %>%\n  filter(days_since_rain <= 30) %>%\n  mutate(rain_binary = as.numeric(rainfall > 0))\n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlogit_model <- glm(\n  rain_binary ~ days_since_rain,\n  data = dry_spell_data,\n  family = binomial(link = \"logit\")\n)\n\nwald_test <- aod::wald.test(\n  b = coef(logit_model),\n  Sigma = vcov(logit_model),\n  Terms = 2\n)\nor_results <- tidy(logit_model, conf.int = TRUE, exponentiate = TRUE) %>%\n  filter(term == \"days_since_rain\")\n\nprint(wald_test)\n#> Wald test:\n#> ----------\n#> \n#> Chi-squared test:\n#> X2 = 8099.7, df = 1, P(> X2) = 0.0\ncat(sprintf(\n  \"\\nFor each additional day without rain, odds of rainfall decrease by %.1f%%\\n\",\n  (1 - or_results$estimate) * 100\n))\n#> \n#> For each additional day without rain, odds of rainfall decrease by 16.5%\ncat(sprintf(\n  \"95%% CI: [%.3f, %.3f]\\n\",\n  or_results$conf.low,\n  or_results$conf.high\n))\n#> 95% CI: [0.831, 0.838]\n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlogit_spline <- glm(\n  rain_binary ~ splines::ns(days_since_rain, df = 4),\n  data = dry_spell_data,\n  family = binomial\n)\n\nlrt_result <- anova(logit_model, logit_spline, test = \"LRT\")\nprint(lrt_result)\n#> Analysis of Deviance Table\n#> \n#> Model 1: rain_binary ~ days_since_rain\n#> Model 2: rain_binary ~ splines::ns(days_since_rain, df = 4)\n#>   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)    \n#> 1    138444     169706                          \n#> 2    138441     162027  3   7678.7 < 2.2e-16 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npred_data <- data.frame(days_since_rain = 1:30)\npred_data$pred_prob <- predict(\n  logit_model,\n  newdata = pred_data,\n  type = \"response\"\n)\npred_data$pred_se <- predict(\n  logit_model,\n  newdata = pred_data,\n  type = \"response\",\n  se.fit = TRUE\n)$se.fit\n\nempirical_probs <- dry_spell_data %>%\n  group_by(days_since_rain) %>%\n  summarise(\n    prob_rain = mean(rain_binary, na.rm = TRUE),\n    n = n(),\n    se = sqrt(prob_rain * (1 - prob_rain) / n)\n  )\n\nggplot() +\n  geom_ribbon(\n    data = pred_data,\n    aes(\n      x = days_since_rain,\n      ymin = pred_prob - 1.96 * pred_se,\n      ymax = pred_prob + 1.96 * pred_se\n    ),\n    alpha = 0.2,\n    fill = \"firebrick\"\n  ) +\n  geom_line(\n    data = pred_data,\n    aes(x = days_since_rain, y = pred_prob),\n    color = \"firebrick\",\n    size = 1.2,\n    linetype = \"dashed\"\n  ) +\n  geom_pointrange(\n    data = empirical_probs,\n    aes(\n      x = days_since_rain,\n      y = prob_rain,\n      ymin = prob_rain - 1.96 * se,\n      ymax = prob_rain + 1.96 * se\n    ),\n    size = 0.5,\n    color = \"black\"\n  ) +\n  scale_y_continuous(\n    labels = scales::percent_format(1),\n    breaks = pretty_breaks(n = 6)\n  ) +\n  scale_x_continuous(breaks = scales::pretty_breaks()) +\n  labs(\n    x = \"Days Since Last Rain\",\n    y = \"Probability of Rainfall\",\n    title = \"Dry Spell Effect on Rain Probability\",\n    subtitle = sprintf(\n      \"Logistic Regression: B = %.4f, Wald chi2 = %.2f, p < 0.001\\nEach additional dry day reduces odds of rain by %.1f%%\",\n      coef(logit_model)[2],\n      wald_test$result$chi2[1],\n      (1 - or_results$estimate) * 100\n    ),\n    caption = \"Points: Empirical probabilities +/- 95% CI | Line: Logistic model fit\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![The drying effect: empirical vs. modelled probability of rainfall by days since last rain. The rapid initial decline followed by a plateau motivates a spline parameterisation rather than a linear logistic term.](03-eda_files/figure-html/fig-dry-spell-1.png){#fig-dry-spell fig-align='center' width=100%}\n:::\n:::\n\n\nA logistic regression of daily rain occurrence on `days_since_rain` yields $OR = 0.835$ (Wald $\\chi^2 \\approx 8099$, $p < 0.001$): each additional dry day reduces the odds of rainfall by approximately 16.5%. This is consistent with the progressive establishment of stable high-pressure ridges documented in the Markov analysis.\n\nThe linear model is however an approximation. The LRT against a four-knot natural spline is highly significant ($\\chi^2 \\approx 7678$, $p < 0.001$). The empirical pattern (@fig-dry-spell) shows rain probability falling sharply from approximately 48% on Day 1 to around 18% by Day 10, then plateauing in the 12-16% range through Days 15 to 30. The linear model underestimates the initial steepness and overestimates long-drought decline rates. This \"rapid-then-gradual\" decay motivates a spline parameterisation of `days_since_rain` rather than a simple linear term.\n\n---\n\n## Atmospheric Pressure Dynamics\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npressure_data <- df_final %>%\n  mutate(pressure_change = pressure3pm - pressure9am) %>%\n  select(rain_today, pressure9am, pressure3pm, pressure_change) %>%\n  filter(!is.na(pressure9am), !is.na(rain_today))\n\npressure_data %>%\n  sample_n(5000) %>%\n  pivot_longer(\n    cols = c(pressure9am, pressure3pm, pressure_change),\n    names_to = \"metric\",\n    values_to = \"value\"\n  ) %>%\n  ggplot(aes(sample = value)) +\n  stat_qq(alpha = 0.5) +\n  stat_qq_line(color = \"red\") +\n  facet_wrap(~metric, scales = \"free\") +\n  labs(\n    title = \"Q-Q Plots: Normality Check for Pressure Variables\",\n    subtitle = \"Modest tail deviations acceptable at N > 140,000 (CLT applies).\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03-eda_files/figure-html/pressure-prep-normality-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntest_data <- pressure_data %>%\n  pivot_longer(\n    cols = c(pressure9am, pressure3pm, pressure_change),\n    names_to = \"metric\",\n    values_to = \"value\"\n  )\n\nstats_results <- test_data %>%\n  group_by(metric) %>%\n  t_test(value ~ rain_today, var.equal = FALSE) %>%\n  adjust_pvalue(method = \"holm\") %>%\n  add_significance()\n\nstats_results %>%\n  select(metric, group1, group2, statistic, df, p.adj, p.adj.signif) %>%\n  kable(\n    caption = \"Welch Two-Sample t-test Results (Bonferroni-Holm Corrected)\",\n    digits = 3,\n    col.names = c(\n      \"Metric\",\n      \"Group 1\",\n      \"Group 2\",\n      \"t-statistic\",\n      \"df\",\n      \"Adj. P-Value\",\n      \"Significance\"\n    )\n  ) %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Welch Two-Sample t-test Results (Bonferroni-Holm Corrected)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Metric </th>\n   <th style=\"text-align:left;\"> Group 1 </th>\n   <th style=\"text-align:left;\"> Group 2 </th>\n   <th style=\"text-align:right;\"> t-statistic </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> Adj. P-Value </th>\n   <th style=\"text-align:left;\"> Significance </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> pressure3pm </td>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:right;\"> 34.844 </td>\n   <td style=\"text-align:right;\"> 47909.59 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> **** </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pressure9am </td>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:right;\"> 58.520 </td>\n   <td style=\"text-align:right;\"> 49181.95 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> **** </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pressure_change </td>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:right;\"> -54.085 </td>\n   <td style=\"text-align:right;\"> 50668.58 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> **** </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\neffect_sizes <- test_data %>%\n  group_by(metric) %>%\n  cohens_d(value ~ rain_today, var.equal = FALSE) %>%\n  mutate(\n    magnitude = case_when(\n      abs(effsize) < 0.2 ~ \"Negligible\",\n      abs(effsize) < 0.5 ~ \"Small\",\n      abs(effsize) < 0.8 ~ \"Medium\",\n      TRUE ~ \"Large\"\n    )\n  )\n\neffect_sizes %>%\n  select(metric, effsize, magnitude) %>%\n  kable(\n    caption = \"Cohen's d Effect Size Analysis\",\n    digits = 3,\n    col.names = c(\"Metric\", \"Effect Size (d)\", \"Interpretation\")\n  ) %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Cohen's d Effect Size Analysis</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Metric </th>\n   <th style=\"text-align:right;\"> Effect Size (d) </th>\n   <th style=\"text-align:left;\"> Interpretation </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> pressure3pm </td>\n   <td style=\"text-align:right;\"> 0.228 </td>\n   <td style=\"text-align:left;\"> Small </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pressure9am </td>\n   <td style=\"text-align:right;\"> 0.379 </td>\n   <td style=\"text-align:left;\"> Small </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pressure_change </td>\n   <td style=\"text-align:right;\"> -0.346 </td>\n   <td style=\"text-align:left;\"> Small </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_annotations <- stats_results %>%\n  left_join(effect_sizes, by = \"metric\") %>%\n  mutate(\n    label_text = sprintf(\n      \"p %s\\nCohen's d = %.2f (%s)\",\n      p.adj.signif,\n      effsize,\n      magnitude\n    ),\n    y_pos = case_when(\n      metric == \"pressure9am\" ~ 1045,\n      metric == \"pressure3pm\" ~ 1040,\n      metric == \"pressure_change\" ~ 15\n    )\n  )\n\nggplot(test_data, aes(rain_today, value, fill = rain_today)) +\n  geom_violin(alpha = 0.6, trim = TRUE) +\n  geom_boxplot(width = 0.2, outlier.shape = NA, alpha = 0.8, color = \"black\") +\n  facet_wrap(~metric, scales = \"free_y\") +\n  geom_text(\n    data = plot_annotations,\n    aes(x = 1.5, y = y_pos, label = label_text),\n    inherit.aes = FALSE,\n    vjust = 0,\n    fontface = \"italic\",\n    size = 3.5\n  ) +\n  scale_fill_manual(values = c(\"No\" = \"#B0B0B0\", \"Yes\" = \"#0072B2\")) +\n  labs(\n    title = \"Atmospheric Pressure vs. Rainfall\",\n    subtitle = \"Welch's t-test with Cohen's d effect sizes\",\n    y = \"Pressure (hPa)\",\n    x = \"Did it rain?\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    strip.text = element_text(size = 12, face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![Violin plots of atmospheric pressure variables by rainfall state. The pressure_change panel shows the most pronounced separation.](03-eda_files/figure-html/fig-pressure-violin-1.png){#fig-pressure-violin fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata_wide <- df_final %>%\n  group_by(rain_today) %>%\n  summarise(\n    `9:00 AM` = mean(pressure9am, na.rm = TRUE),\n    `3:00 PM` = mean(pressure3pm, na.rm = TRUE),\n    `Pressure Drop` = mean(pressure9am, na.rm = TRUE) -\n      mean(pressure3pm, na.rm = TRUE)\n  ) %>%\n  pivot_longer(cols = -rain_today, names_to = \"metric\", values_to = \"value\") %>%\n  mutate(\n    metric = factor(metric, levels = c(\"9:00 AM\", \"3:00 PM\", \"Pressure Drop\")),\n    label_txt = round(value, 1)\n  )\n\nggplot(data_wide, aes(x = rain_today, y = value, fill = rain_today)) +\n  geom_col(width = 0.6, alpha = 0.9) +\n  geom_text(aes(label = label_txt), vjust = -0.5, fontface = \"bold\", size = 4) +\n  facet_wrap(~metric, scales = \"free_y\", nrow = 1) +\n  scale_fill_manual(values = c(\"No\" = \"#B0B0B0\", \"Yes\" = \"#0072B2\")) +\n  scale_x_discrete(labels = c(\"No\" = \"Dry Days\", \"Yes\" = \"Rainy Days\")) +\n  labs(\n    title = \"Rainy Days Show Lower Baseline Pressure and Suppressed Diurnal Variation\",\n    subtitle = \"The diurnal pressure drop is the stronger discriminating signal\",\n    y = \"Pressure (hPa) / Drop (hPa)\",\n    x = NULL\n  ) +\n  theme_minimal(base_size = 14) +\n  theme(\n    legend.position = \"none\",\n    plot.title = element_text(face = \"bold\", size = 12),\n    axis.text.x = element_text(face = \"bold\", size = 11),\n    strip.text = element_text(face = \"bold\", size = 12),\n    panel.grid.major.x = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![Mean pressure levels and diurnal drop by rainfall state. The suppressed pressure drop on rainy days (1.3 vs. 2.7 hPa) is a stronger discriminating signal than the absolute pressure baseline.](03-eda_files/figure-html/fig-pressure-means-1.png){#fig-pressure-means fig-align='center' width=100%}\n:::\n:::\n\n\n**Normality.** Q-Q plots show modest tail deviations, but with $N > 140,000$ the CLT ensures normally distributed sample means. Welch's t-test is therefore valid without equal-variance assumptions, and Bonferroni-Holm correction is applied for multiple comparisons.\n\n**Baseline pressure.** Rainy days show mean pressure of 1015 hPa at 9:00 AM versus 1018.5 hPa on dry days. Cohen's $d \\approx 0.28$-$0.48$ represents a small-to-medium effect, consistent with absolute pressure being necessary but not sufficient for rain.\n\n**Diurnal pressure change.** On dry days, pressure drops 2.7 hPa from morning to afternoon, the standard thermal low from daytime surface heating. On rainy days, this drop is suppressed to 1.3 hPa, because cloud cover reduces insolation. Cohen's $d = -0.72$ for `pressure_change` is a medium effect, stronger than either absolute pressure reading individually. The rate of pressure change during the day is the more discriminating feature.\n\n---\n\n## Seasonal Rainfall Intensity\n\n### Cyclical Patterns\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmonthly_stats <- df_final %>%\n  filter(rainfall > 0) %>%\n  group_by(month) %>%\n  summarise(\n    median_rain = median(rainfall),\n    mean_rain = mean(rainfall),\n    rain_days = n(),\n    .groups = \"drop\"\n  ) %>%\n  mutate(month_label = factor(month.abb[month], levels = rev(month.abb)))\n\nplot_data <- df_final %>%\n  filter(rainfall > 0) %>%\n  mutate(\n    month_label = factor(month.abb[month], levels = rev(month.abb)),\n    log_rain = log(rainfall)\n  ) %>%\n  left_join(monthly_stats, by = c(\"month\", \"month_label\"))\n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(plot_data, aes(log_rain, month_label, fill = after_stat(x))) +\n  geom_density_ridges_gradient(\n    scale = 2.5,\n    rel_min_height = 0.01,\n    quantile_lines = TRUE,\n    quantiles = 2,\n    alpha = 0.8\n  ) +\n  geom_vline(\n    xintercept = median(log(df_final$rainfall[df_final$rainfall > 0])),\n    linetype = \"dashed\",\n    color = \"grey30\",\n    linewidth = 0.5\n  ) +\n  scale_fill_viridis_c(\n    option = \"mako\",\n    name = \"Log\\nRainfall\",\n    direction = -1\n  ) +\n  scale_x_continuous(breaks = pretty_breaks()) +\n  labs(\n    title = \"Monthly Rainfall Distribution Patterns\",\n    subtitle = \"Solid lines mark monthly medians vs. the global median (dashed).\",\n    x = \"Rainfall Amount (mm, log scale)\",\n    y = NULL\n  ) +\n  theme_minimal(base_size = 13)\n```\n\n::: {.cell-output-display}\n![Ridgeline plot of monthly log-rainfall distributions. Shifting peaks illustrate how rainfall intensity varies cyclically relative to the global median (dashed line).](03-eda_files/figure-html/fig-monthly-dist-1.png){#fig-monthly-dist fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nseasonal_data <- df_final %>%\n  filter(rainfall > 0) %>%\n  mutate(\n    season = case_when(\n      month %in% c(12, 1, 2) ~ \"Summer\",\n      month %in% c(3, 4, 5) ~ \"Autumn\",\n      month %in% c(6, 7, 8) ~ \"Winter\",\n      month %in% c(9, 10, 11) ~ \"Spring\"\n    ),\n    season = factor(season, levels = c(\"Summer\", \"Autumn\", \"Winter\", \"Spring\"))\n  )\n\nseasonal_data %>%\n  mutate(month_label = factor(month.abb[month], levels = month.abb)) %>%\n  ggplot(aes(rainfall, month_label, fill = season)) +\n  geom_density_ridges(\n    scale = 1.5,\n    alpha = 0.7,\n    quantile_lines = TRUE,\n    quantiles = c(0.25, 0.5, 0.75)\n  ) +\n  scale_x_log10(\n    breaks = c(1, 10, 50, 100, 300),\n    labels = label_number(accuracy = 1)\n  ) +\n  scale_fill_manual(\n    values = c(\n      \"Summer\" = \"#E69F00\",\n      \"Autumn\" = \"#D55E00\",\n      \"Winter\" = \"#0072B2\",\n      \"Spring\" = \"#009E73\"\n    )\n  ) +\n  facet_wrap(~season, scales = \"free_y\", ncol = 2) +\n  labs(\n    title = \"Seasonal Rainfall Patterns\",\n    subtitle = \"Quartile lines show 25th, 50th, and 75th percentiles\",\n    x = \"Rainfall Amount (mm, log scale)\",\n    y = NULL\n  ) +\n  theme_minimal(base_size = 12)\n```\n\n::: {.cell-output-display}\n![Seasonal rainfall patterns by meteorological season. Summer exhibits high variance and a pronounced right tail; winter shows narrower, more predictable distributions.](03-eda_files/figure-html/fig-seasonal-facet-1.png){#fig-seasonal-facet fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmonthly_stats %>%\n  mutate(month_label = factor(month.abb[month], levels = month.abb)) %>%\n  ggplot(aes(month_label, mean_rain)) +\n  geom_col(aes(fill = mean_rain, alpha = 0.8), width = 0.7) +\n  geom_text(\n    aes(label = round(mean_rain, 1)),\n    vjust = -0.5,\n    size = 3.5,\n    fontface = \"bold\"\n  ) +\n  scale_fill_viridis_c(option = \"mako\", direction = -1) +\n  labs(\n    title = \"Mean Rainfall by Month (Non-Zero Days)\",\n    subtitle = \"Seasonal variation in intensity is distinct from seasonal variation in frequency\",\n    y = \"Mean Rainfall (mm)\",\n    x = NULL\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14),\n    legend.position = \"none\",\n    panel.grid.major.x = element_blank(),\n    axis.text.x = element_text(angle = 45, hjust = 1, face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![Average rainfall intensity on non-zero days by month. February records the highest mean intensity at 10.1 mm, nearly double July's 4.9 mm.](03-eda_files/figure-html/fig-mean-rain-bar-1.png){#fig-mean-rain-bar fig-align='center' width=100%}\n:::\n:::\n\n\nThe earlier frequency analysis (@sec-frequency) established *when* rain tends to occur. This section investigates *how much* falls when it does.\n\nJanuary and February distributions are shifted systematically right of the global median: summer storms are considerably more intense when they arrive, even though they occur less frequently. June through August cluster left, representing lower but more consistent rainfall. February records the highest mean intensity per wet day at 10.1 mm, nearly double July's 4.9 mm.\n\nSummer rainfall has a wide interquartile range and a pronounced right tail beyond 100 mm per day, reflecting episodic convective storms. Winter shows a narrower, more peaked distribution. Both the frequency variation (more rain in winter) and the intensity variation (heavier rain in summer) carry independent information; a complete model must account for both dimensions.\n\n**Encoding implication.** Because the seasonal cycle is continuous the transition from December to January is climatologically smooth treating `Month` as unordered discards proximity information. Cyclical encoding via sine and cosine transformations of the month number preserves the circular geometry of the annual cycle.\n\n### Statistical Validation\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nseasonal_data %>%\n  select(season, rainfall) %>%\n  group_by(season) %>%\n  get_summary_stats(rainfall, type = \"mean_sd\") %>%\n  kable(\n    caption = \"Descriptive Statistics of Rainfall Intensity by Season\",\n    col.names = c(\"Season\", \"Variable\", \"N (Events)\", \"Mean (mm)\", \"SD (mm)\")\n  ) %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Descriptive Statistics of Rainfall Intensity by Season</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Season </th>\n   <th style=\"text-align:left;\"> Variable </th>\n   <th style=\"text-align:right;\"> N (Events) </th>\n   <th style=\"text-align:right;\"> Mean (mm) </th>\n   <th style=\"text-align:right;\"> SD (mm) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Summer </td>\n   <td style=\"text-align:left;\"> rainfall </td>\n   <td style=\"text-align:right;\"> 10571 </td>\n   <td style=\"text-align:right;\"> 9.070 </td>\n   <td style=\"text-align:right;\"> 18.195 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Autumn </td>\n   <td style=\"text-align:left;\"> rainfall </td>\n   <td style=\"text-align:right;\"> 13382 </td>\n   <td style=\"text-align:right;\"> 6.667 </td>\n   <td style=\"text-align:right;\"> 13.495 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Winter </td>\n   <td style=\"text-align:left;\"> rainfall </td>\n   <td style=\"text-align:right;\"> 15402 </td>\n   <td style=\"text-align:right;\"> 5.463 </td>\n   <td style=\"text-align:right;\"> 9.809 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Spring </td>\n   <td style=\"text-align:left;\"> rainfall </td>\n   <td style=\"text-align:right;\"> 11764 </td>\n   <td style=\"text-align:right;\"> 5.651 </td>\n   <td style=\"text-align:right;\"> 10.495 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nkw_result <- kruskal_test(rainfall ~ season, data = seasonal_data)\nepsilon_sq <- kruskal_effsize(rainfall ~ season, data = seasonal_data)\n\ntibble(\n  Test = \"Kruskal-Wallis Rank Sum Test\",\n  `Chi-squared` = round(kw_result$statistic, 2),\n  df = kw_result$df,\n  `P-value` = scales::pvalue(kw_result$p, accuracy = 0.001),\n  `Effect Size` = round(epsilon_sq$effsize, 4),\n  Magnitude = as.character(epsilon_sq$magnitude)\n) %>%\n  kable(\n    caption = \"Statistical Significance of Seasonal Differences (Non-Parametric)\",\n    align = \"lccccr\"\n  ) %>%\n  kable_styling(\n    bootstrap_options = c(\"striped\", \"hover\", \"condensed\"),\n    full_width = FALSE,\n    position = \"left\"\n  ) %>%\n  add_footnote(\n    c(\"Effect size: Epsilon-squared.\", \"Alpha = 0.05\"),\n    notation = \"symbol\"\n  )\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed\" style=\"width: auto !important; \">\n<caption>Statistical Significance of Seasonal Differences (Non-Parametric)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Test </th>\n   <th style=\"text-align:center;\"> Chi-squared </th>\n   <th style=\"text-align:center;\"> df </th>\n   <th style=\"text-align:center;\"> P-value </th>\n   <th style=\"text-align:center;\"> Effect Size </th>\n   <th style=\"text-align:right;\"> Magnitude </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Kruskal-Wallis Rank Sum Test </td>\n   <td style=\"text-align:center;\"> 230.44 </td>\n   <td style=\"text-align:center;\"> 3 </td>\n   <td style=\"text-align:center;\"> &lt;0.001 </td>\n   <td style=\"text-align:center;\"> 0.0044 </td>\n   <td style=\"text-align:right;\"> small </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr>\n<td style = 'padding: 0; border:0;' colspan='100%'><sup>*</sup> Effect size: Epsilon-squared.</td>\n</tr>\n<tr>\n<td style = 'padding: 0; border:0;' colspan='100%'><sup>&dagger;</sup> Alpha = 0.05</td>\n</tr>\n</tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndunn_result <- dunn_test(\n  rainfall ~ season,\n  data = seasonal_data,\n  p.adjust.method = \"bonferroni\"\n)\n\ndunn_result %>%\n  select(group1, group2, statistic, p.adj, p.adj.signif) %>%\n  kable(\n    caption = \"Dunn's Pairwise Comparison Test (Bonferroni Corrected)\",\n    col.names = c(\n      \"Group 1\",\n      \"Group 2\",\n      \"Z-Statistic\",\n      \"Adj. P-Value\",\n      \"Significance\"\n    )\n  ) %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Dunn's Pairwise Comparison Test (Bonferroni Corrected)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Group 1 </th>\n   <th style=\"text-align:left;\"> Group 2 </th>\n   <th style=\"text-align:right;\"> Z-Statistic </th>\n   <th style=\"text-align:right;\"> Adj. P-Value </th>\n   <th style=\"text-align:left;\"> Significance </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Summer </td>\n   <td style=\"text-align:left;\"> Autumn </td>\n   <td style=\"text-align:right;\"> -11.4684561 </td>\n   <td style=\"text-align:right;\"> 0.0000000 </td>\n   <td style=\"text-align:left;\"> **** </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Summer </td>\n   <td style=\"text-align:left;\"> Winter </td>\n   <td style=\"text-align:right;\"> -14.4832877 </td>\n   <td style=\"text-align:right;\"> 0.0000000 </td>\n   <td style=\"text-align:left;\"> **** </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Summer </td>\n   <td style=\"text-align:left;\"> Spring </td>\n   <td style=\"text-align:right;\"> -11.0494713 </td>\n   <td style=\"text-align:right;\"> 0.0000000 </td>\n   <td style=\"text-align:left;\"> **** </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Autumn </td>\n   <td style=\"text-align:left;\"> Winter </td>\n   <td style=\"text-align:right;\"> -2.8512817 </td>\n   <td style=\"text-align:right;\"> 0.0261260 </td>\n   <td style=\"text-align:left;\"> * </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Autumn </td>\n   <td style=\"text-align:left;\"> Spring </td>\n   <td style=\"text-align:right;\"> 0.0912015 </td>\n   <td style=\"text-align:right;\"> 1.0000000 </td>\n   <td style=\"text-align:left;\"> ns </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Winter </td>\n   <td style=\"text-align:left;\"> Spring </td>\n   <td style=\"text-align:right;\"> 2.8459539 </td>\n   <td style=\"text-align:right;\"> 0.0265672 </td>\n   <td style=\"text-align:left;\"> * </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np_vals <- dunn_result$p.adj\nnames(p_vals) <- paste(dunn_result$group1, dunn_result$group2, sep = \"-\")\nletters_vec <- multcompLetters(p_vals)$Letters\nletters_df <- data.frame(season = names(letters_vec), Letter = letters_vec)\n\nseasonal_data %>%\n  group_by(season) %>%\n  summarise(mean_rain = mean(rainfall, na.rm = TRUE), n = n()) %>%\n  left_join(letters_df, by = \"season\") %>%\n  ggplot(aes(x = season, y = mean_rain, fill = season)) +\n  geom_col(alpha = 0.8, width = 0.7) +\n  geom_text(aes(label = Letter), vjust = -0.5, size = 8, fontface = \"bold\") +\n  geom_text(\n    aes(label = round(mean_rain, 1)),\n    vjust = 1.5,\n    color = \"white\",\n    fontface = \"bold\",\n    size = 5\n  ) +\n  scale_fill_manual(\n    values = c(\n      \"Summer\" = \"#E69F00\",\n      \"Autumn\" = \"#D55E00\",\n      \"Winter\" = \"#0072B2\",\n      \"Spring\" = \"#009E73\"\n    )\n  ) +\n  labs(\n    title = \"Seasonal Rainfall with Statistical Groupings\",\n    subtitle = sprintf(\n      \"Kruskal-Wallis: p < 0.001, Effect Size: %s\\nSeasons sharing a letter are not significantly different.\",\n      as.character(epsilon_sq$magnitude)\n    ),\n    y = \"Mean Rainfall (mm)\",\n    x = NULL\n  ) +\n  theme_minimal(base_size = 14) +\n  theme(\n    legend.position = \"none\",\n    plot.title = element_text(face = \"bold\", size = 16),\n    axis.text.x = element_text(size = 12, face = \"bold\"),\n    panel.grid.major.x = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![Mean seasonal rainfall with statistical groupings. Shared letters indicate seasons not significantly different from one another (Dunn's test, p < 0.05).](03-eda_files/figure-html/fig-seasonal-stat-groups-1.png){#fig-seasonal-stat-groups fig-align='center' width=100%}\n:::\n:::\n\n\nThe Kruskal-Wallis test yields $\\chi^2 = 230$, $p < 0.001$, strongly rejecting the null. The epsilon-squared effect size ($\\eta^2 \\approx 0.004$) is small the seasonal signal is real but accounts for only a minor fraction of total variance in rainfall intensity, reinforcing the necessity of a multivariate approach.\n\nPost-hoc Dunn's tests identify three distinct statistical groups (@fig-seasonal-stat-groups). Summer stands alone as the most intense season ($\\bar{x} = 9.1$ mm, $p < 0.001$ vs. all others). Autumn and Spring are statistically indistinguishable ($p = 1.0$). Winter registers the lowest mean intensity ($\\bar{x} = 5.5$ mm) and is statistically distinct from Spring ($p_\\text{adj} = 0.026$).\n\n---\n\n## Feature Interactions: The \"Rain Corner\" {#sec-bivariate-density}\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_final %>%\n  group_by(location) %>%\n  arrange(date) %>%\n  mutate(rain_index_ref = ifelse(rainfall > 0, row_number(), NA_integer_)) %>%\n  fill(rain_index_ref, .direction = \"down\") %>%\n  mutate(days_since_rain = row_number() - lag(rain_index_ref)) %>%\n  select(-rain_index_ref) %>%\n  ggplot(aes(sunshine, humidity3pm)) +\n  geom_density2d_filled(continuous_var = \"ndensity\", bins = 7) +\n  facet_wrap(~rain_today, labeller = label_both) +\n  scale_fill_brewer(palette = \"Blues\") +\n  labs(\n    title = \"Justifying Interaction: The 'Rain Corner'\",\n    subtitle = \"Rain (right panel) concentrates in high humidity / low sunshine.\\nDry days (left panel) are dispersed across feature space.\\nThis structural asymmetry justifies a sunshine * humidity interaction term.\",\n    x = \"Sunshine (hours)\",\n    y = \"Humidity 3pm (%)\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    strip.text = element_text(size = 12, face = \"bold\"),\n    plot.title = element_text(size = 14, face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![Bivariate density of Humidity3pm vs. Sunshine, faceted by rainfall occurrence. Rain events concentrate tightly in the upper-left 'Rain Corner' (high humidity, low sunshine), while dry days are dispersed broadly. This structural asymmetry justifies a multiplicative interaction term.](03-eda_files/figure-html/fig-interaction-rain-corner-1.png){#fig-interaction-rain-corner fig-align='center' width=100%}\n:::\n:::\n\n\nThe correlation analysis in @sec-correlation established that humidity and sunshine are individually among the strongest predictors. A standard additive model treats their effects as independent. This section tests whether that assumption holds.\n\nThe bivariate density plots (@fig-interaction-rain-corner) reveal a striking structural difference. On dry days, the density is dispersed broadly across the humidity-sunshine space: high humidity can occur without rain under high-pressure suppression, and low sunshine can occur without rain under thin overcast. No single region clearly separates the two states.\n\nOn rainy days, the density collapses into a tight cluster in the upper-left quadrant: high afternoon humidity (above approximately 50%) combined with low sunshine (below approximately 5 hours). This is the \"Rain Corner\". Neither condition alone is sufficient; both must coincide simultaneously. This is statistical interaction: the effect of one variable on the outcome is conditional on the level of the other.\n\n**Modelling implication.** An additive model that includes `Humidity3pm` and `Sunshine` as separate terms cannot express the idea that their joint occurrence not their individual magnitudes is what matters. Capturing the Rain Corner requires a multiplicative interaction term ($\\text{Humidity} \\times \\text{Sunshine}$) in the model specification.\n\n---\n\n## Summary and Modelling Implications\n\nThe preceding analyses characterise the dataset along six interconnected dimensions, each producing a specific modelling requirement.\n\nThe **distributional structure** of the target variable 64% zeros, extreme positive skew, kurtosis of 181 rules out any single-component Gaussian model. A two-part framework separating occurrence from intensity is the appropriate response.\n\nThe **missingness analysis** (documented in @sec-data, summarised in Section 1 above) establishes that imputation is necessary to preserve both sample size and the predictive signal in `sunshine` and `evaporation`, and that the imputed values do not introduce outcome-related bias.\n\nThe **correlation structure** identifies humidity, cloud cover, sunshine, and evaporation as the strongest individual predictors, and flags severe multicollinearity among morning-afternoon pairs. VIF-based feature selection is required.\n\nThe **temporal analyses** establish that both the day-to-day Markov state and the cumulative dry spell duration carry predictive signal. Month should be cyclically encoded. The dry spell decay is non-linear and warrants a natural spline parameterisation of `days_since_rain`.\n\nThe **pressure analysis** identifies the diurnal pressure change as the more discriminating pressure-derived feature, with Cohen's $d = 0.72$ separating rainy from dry days more effectively than absolute pressure level.\n\nThe **interaction analysis** provides empirical justification for a $\\text{Humidity} \\times \\text{Sunshine}$ interaction term, reflecting the physical reality that precipitation concentrates where high moisture and low solar radiation coincide in the \"Rain Corner\" of the feature space.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}