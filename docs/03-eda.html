<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="A comprehensive statistical analysis of rainfall patterns across 49 Australian cities using Zero-Inflated Gamma GLMMs.">

<title>3&nbsp; Exploratory Data Analysis – Australian Rainfall Dynamics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-features.html" rel="next">
<link href="./02-data-prep.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2b343a76e97438dab7fb4d41b62743f8.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-5f9457399cb503d1c34ffd8fbac5e1f9.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2b343a76e97438dab7fb4d41b62743f8.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c2f9db4fb4608acd7c842482413a1489.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d3b9742b9ff5b22559c24e86974f6d61.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-c2f9db4fb4608acd7c842482413a1489.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-data-prep.html">Data</a></li><li class="breadcrumb-item"><a href="./03-eda.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Australian Rainfall Dynamics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predicting Australian Rainfall</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-data-prep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Preparation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-eda.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Feature Engineering</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-features.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Feature Engineering</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Modelling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model Evaluation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-model-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Model Selection</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#temporal-and-meteorological-drivers-of-australian-rainfall" id="toc-temporal-and-meteorological-drivers-of-australian-rainfall" class="nav-link active" data-scroll-target="#temporal-and-meteorological-drivers-of-australian-rainfall"><span class="header-section-number">3.1</span> Temporal and Meteorological Drivers of Australian Rainfall</a></li>
  <li><a href="#sec-data-quality" id="toc-sec-data-quality" class="nav-link" data-scroll-target="#sec-data-quality"><span class="header-section-number">3.2</span> Data Quality Summary</a></li>
  <li><a href="#distributional-properties-of-the-target-variable" id="toc-distributional-properties-of-the-target-variable" class="nav-link" data-scroll-target="#distributional-properties-of-the-target-variable"><span class="header-section-number">3.3</span> Distributional Properties of the Target Variable</a></li>
  <li><a href="#sec-correlation" id="toc-sec-correlation" class="nav-link" data-scroll-target="#sec-correlation"><span class="header-section-number">3.4</span> Bivariate Correlation Structure</a></li>
  <li><a href="#temporal-structure-of-rainfall" id="toc-temporal-structure-of-rainfall" class="nav-link" data-scroll-target="#temporal-structure-of-rainfall"><span class="header-section-number">3.5</span> Temporal Structure of Rainfall</a>
  <ul class="collapse">
  <li><a href="#sec-frequency" id="toc-sec-frequency" class="nav-link" data-scroll-target="#sec-frequency"><span class="header-section-number">3.5.1</span> Weekly and Seasonal Frequency</a></li>
  <li><a href="#sec-markov" id="toc-sec-markov" class="nav-link" data-scroll-target="#sec-markov"><span class="header-section-number">3.5.2</span> Day-to-Day Persistence: A Markov Chain Analysis</a></li>
  <li><a href="#sec-dry-spell" id="toc-sec-dry-spell" class="nav-link" data-scroll-target="#sec-dry-spell"><span class="header-section-number">3.5.3</span> Dry Spell Dynamics and Temporal Decay</a></li>
  </ul></li>
  <li><a href="#atmospheric-pressure-dynamics" id="toc-atmospheric-pressure-dynamics" class="nav-link" data-scroll-target="#atmospheric-pressure-dynamics"><span class="header-section-number">3.6</span> Atmospheric Pressure Dynamics</a></li>
  <li><a href="#seasonal-rainfall-intensity" id="toc-seasonal-rainfall-intensity" class="nav-link" data-scroll-target="#seasonal-rainfall-intensity"><span class="header-section-number">3.7</span> Seasonal Rainfall Intensity</a>
  <ul class="collapse">
  <li><a href="#cyclical-patterns" id="toc-cyclical-patterns" class="nav-link" data-scroll-target="#cyclical-patterns"><span class="header-section-number">3.7.1</span> Cyclical Patterns</a></li>
  <li><a href="#statistical-validation" id="toc-statistical-validation" class="nav-link" data-scroll-target="#statistical-validation"><span class="header-section-number">3.7.2</span> Statistical Validation</a></li>
  </ul></li>
  <li><a href="#sec-bivariate-density" id="toc-sec-bivariate-density" class="nav-link" data-scroll-target="#sec-bivariate-density"><span class="header-section-number">3.8</span> Feature Interactions: The “Rain Corner”</a></li>
  <li><a href="#summary-and-modelling-implications" id="toc-summary-and-modelling-implications" class="nav-link" data-scroll-target="#summary-and-modelling-implications"><span class="header-section-number">3.9</span> Summary and Modelling Implications</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/blob/main/03-eda.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-data-prep.html">Data</a></li><li class="breadcrumb-item"><a href="./03-eda.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-eda" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="temporal-and-meteorological-drivers-of-australian-rainfall" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="temporal-and-meteorological-drivers-of-australian-rainfall"><span class="header-section-number">3.1</span> Temporal and Meteorological Drivers of Australian Rainfall</h2>
<hr>
<blockquote class="blockquote">
<p><strong>Chapter Context.</strong> This chapter investigates the distributional and structural properties of the daily rainfall data, using findings from the data preparation chapter (<a href="02-data-prep.html" class="quarto-xref"><span>Chapter 2</span></a>) as its starting point rather than repeating the missingness diagnostics performed there. The analyses proceed in a deliberate sequence: target variable distribution, bivariate predictor correlations, temporal dynamics, pressure analysis, seasonal patterns, and feature interactions. Each section produces a specific finding that motivates a corresponding decision in the feature engineering or model specification stages.</p>
</blockquote>
<hr>
<hr>
</section>
<section id="sec-data-quality" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="sec-data-quality"><span class="header-section-number">3.2</span> Data Quality Summary</h2>
<p>A thorough investigation of missingness is documented in <a href="02-data-prep.html" class="quarto-xref"><span>Chapter 2</span></a> and summarised briefly here for continuity. The full diagnostic pipeline co-missingness analysis, temporal structural break detection, ghost sensor identification, and a weather-conditionality test established the following picture.</p>
<p>The dataset contains 314,146 missing entries in total, distributed highly unevenly across features. The four most affected variables are <code>sunshine</code> (47.7% missing), <code>evaporation</code> (42.5%), <code>cloud9am</code> (approximately 40%), and <code>cloud3pm</code> (approximately 37%). Their missingness is not independent: co-missing rates between any pair of these four variables range from 67% to 93%, confirming that they fail together at the station level rather than through separate independent sensor faults. This is Missing Not At Random at the station level, driven by instrumentation deployment profiles.</p>
<p>A weather-conditionality test confirmed that sunshine missingness does not covary with rainfall amounts: the missing rate is 47.8% on dry days and 47.2% on rainy days. Missingness is station-conditional rather than outcome-conditional, meaning imputed values do not introduce directional bias into the training labels.</p>
<p>The core dynamic variables pressure, wind speed, temperature, and humidity exhibit missingness below 10% and are available across virtually all observations.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>total_na <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(df_clean))</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Total missing values:"</span>, total_na))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] "Total missing values: 314146"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">missing_val</span>(df_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Percentage of Missing Values by Feature</caption>
<thead>
<tr class="header">
<th style="text-align: left;">column</th>
<th style="text-align: right;">pct_missing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sunshine</td>
<td style="text-align: right;">47.6937250</td>
</tr>
<tr class="even">
<td style="text-align: left;">evaporation</td>
<td style="text-align: right;">42.5375706</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cloud3pm</td>
<td style="text-align: right;">39.9960619</td>
</tr>
<tr class="even">
<td style="text-align: left;">cloud9am</td>
<td style="text-align: right;">37.5044832</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pressure3pm</td>
<td style="text-align: right;">9.8404349</td>
</tr>
<tr class="even">
<td style="text-align: left;">pressure9am</td>
<td style="text-align: right;">9.8031632</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wind_dir9am</td>
<td style="text-align: right;">6.8840147</td>
</tr>
<tr class="even">
<td style="text-align: left;">wind_gust_dir</td>
<td style="text-align: right;">6.8390073</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wind_gust_speed</td>
<td style="text-align: right;">6.7968129</td>
</tr>
<tr class="even">
<td style="text-align: left;">wind_dir3pm</td>
<td style="text-align: right;">2.6716081</td>
</tr>
<tr class="odd">
<td style="text-align: left;">humidity3pm</td>
<td style="text-align: right;">2.5527606</td>
</tr>
<tr class="even">
<td style="text-align: left;">temp3pm</td>
<td style="text-align: right;">1.9310966</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wind_speed3pm</td>
<td style="text-align: right;">1.8614758</td>
</tr>
<tr class="even">
<td style="text-align: left;">humidity9am</td>
<td style="text-align: right;">1.0928347</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rain_tomorrow</td>
<td style="text-align: right;">0.9929746</td>
</tr>
<tr class="even">
<td style="text-align: left;">wind_speed9am</td>
<td style="text-align: right;">0.7672347</td>
</tr>
<tr class="odd">
<td style="text-align: left;">temp9am</td>
<td style="text-align: right;">0.4817193</td>
</tr>
<tr class="even">
<td style="text-align: left;">min_temp</td>
<td style="text-align: right;">0.3424778</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max_temp</td>
<td style="text-align: right;">0.3305227</td>
</tr>
<tr class="even">
<td style="text-align: left;">date</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">location</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">rainfall</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rain_today</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">month</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">day</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Resolution.</strong> A three-stage hybrid imputation pipeline was applied in <a href="02-data-prep.html" class="quarto-xref"><span>Chapter 2</span></a>: binary missingness flags, linear temporal interpolation bounded by a five-day cap, and two-pass Random Forest imputation via <code>missRanger</code> and targeted <code>mice</code>. Ghost sensor observations, station-variable pairs with more than 90% missingness across the full window, were reverted to missing after the pipeline rather than filled with unsupported synthetic values. The imputed dataset <code>df_final</code> is used throughout the remainder of this chapter. The raw dataset <code>df_clean</code> is used only in this opening section, where using pre-imputation data avoids circularity between the imputed features and the response distribution.</p>
<p><strong>Modelling implication.</strong> The concentration of missingness in <code>sunshine</code> and <code>evaporation</code>, both of which exhibit meaningful correlation with rainfall, as shown in <a href="#sec-correlation" class="quarto-xref"><span>Section 3.4</span></a>, creates a direct trade-off: discarding these variables avoids imputation complexity but sacrifices predictive signal, while listwise deletion would eliminate nearly half the dataset and introduce geographic bias toward well-instrumented stations. The Random Forest imputation strategy in <a href="02-data-prep.html" class="quarto-xref"><span>Chapter 2</span></a> resolves this trade-off by preserving both sample and features.</p>
<hr>
</section>
<section id="distributional-properties-of-the-target-variable" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="distributional-properties-of-the-target-variable"><span class="header-section-number">3.3</span> Distributional Properties of the Target Variable</h2>
<p>Understanding the marginal distribution of the response variable is a prerequisite for selecting an appropriate model family. A Gaussian assumption carries substantive claims about the data-generating process that can be directly tested.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>rainfall_stats <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="fu">summarise</span>(</span>
<span id="cb4-3"><a href="#cb4-3"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb4-4"><a href="#cb4-4"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(rainfall),</span>
<span id="cb4-5"><a href="#cb4-5"></a>    <span class="at">median =</span> <span class="fu">median</span>(rainfall),</span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(rainfall),</span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="at">min =</span> <span class="fu">min</span>(rainfall),</span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="at">max =</span> <span class="fu">max</span>(rainfall),</span>
<span id="cb4-9"><a href="#cb4-9"></a>    <span class="at">q25 =</span> <span class="fu">quantile</span>(rainfall, <span class="fl">0.25</span>),</span>
<span id="cb4-10"><a href="#cb4-10"></a>    <span class="at">q75 =</span> <span class="fu">quantile</span>(rainfall, <span class="fl">0.75</span>),</span>
<span id="cb4-11"><a href="#cb4-11"></a>    <span class="at">iqr =</span> <span class="fu">IQR</span>(rainfall),</span>
<span id="cb4-12"><a href="#cb4-12"></a>    <span class="at">n_zeros =</span> <span class="fu">sum</span>(rainfall <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb4-13"><a href="#cb4-13"></a>    <span class="at">pct_zeros =</span> <span class="fu">mean</span>(rainfall <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb4-14"><a href="#cb4-14"></a>    <span class="at">n_large =</span> <span class="fu">sum</span>(rainfall <span class="sc">&gt;</span> <span class="dv">100</span>),</span>
<span id="cb4-15"><a href="#cb4-15"></a>    <span class="at">pct_large =</span> <span class="fu">mean</span>(rainfall <span class="sc">&gt;</span> <span class="dv">100</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb4-16"><a href="#cb4-16"></a>    <span class="at">skewness =</span> moments<span class="sc">::</span><span class="fu">skewness</span>(rainfall),</span>
<span id="cb4-17"><a href="#cb4-17"></a>    <span class="at">kurtosis =</span> moments<span class="sc">::</span><span class="fu">kurtosis</span>(rainfall)</span>
<span id="cb4-18"><a href="#cb4-18"></a>  )</span>
<span id="cb4-19"><a href="#cb4-19"></a></span>
<span id="cb4-20"><a href="#cb4-20"></a>rainfall_stats <span class="sc">%&gt;%</span></span>
<span id="cb4-21"><a href="#cb4-21"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Statistic"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-22"><a href="#cb4-22"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-23"><a href="#cb4-23"></a>    <span class="at">Value =</span> <span class="fu">ifelse</span>(</span>
<span id="cb4-24"><a href="#cb4-24"></a>      Value <span class="sc">&gt;</span> <span class="dv">1000</span>,</span>
<span id="cb4-25"><a href="#cb4-25"></a>      <span class="fu">format</span>(Value, <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb4-26"><a href="#cb4-26"></a>      <span class="fu">round</span>(Value, <span class="dv">3</span>)</span>
<span id="cb4-27"><a href="#cb4-27"></a>    )</span>
<span id="cb4-28"><a href="#cb4-28"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-29"><a href="#cb4-29"></a>  <span class="fu">kable</span>(</span>
<span id="cb4-30"><a href="#cb4-30"></a>    <span class="at">caption =</span> <span class="st">"Descriptive Statistics: Daily Rainfall (mm)"</span>,</span>
<span id="cb4-31"><a href="#cb4-31"></a>    <span class="at">align =</span> <span class="st">"lr"</span></span>
<span id="cb4-32"><a href="#cb4-32"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-33"><a href="#cb4-33"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Descriptive Statistics: Daily Rainfall (mm)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">n</td>
<td style="text-align: right;">1.42e+05</td>
</tr>
<tr class="even">
<td style="text-align: left;">mean</td>
<td style="text-align: right;">2.361</td>
</tr>
<tr class="odd">
<td style="text-align: left;">median</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">sd</td>
<td style="text-align: right;">8.478</td>
</tr>
<tr class="odd">
<td style="text-align: left;">min</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">max</td>
<td style="text-align: right;">371</td>
</tr>
<tr class="odd">
<td style="text-align: left;">q25</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">q75</td>
<td style="text-align: right;">0.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">iqr</td>
<td style="text-align: right;">0.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">n_zeros</td>
<td style="text-align: right;">9.11e+04</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pct_zeros</td>
<td style="text-align: right;">64.051</td>
</tr>
<tr class="even">
<td style="text-align: left;">n_large</td>
<td style="text-align: right;">151</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pct_large</td>
<td style="text-align: right;">0.106</td>
</tr>
<tr class="even">
<td style="text-align: left;">skewness</td>
<td style="text-align: right;">9.836</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kurtosis</td>
<td style="text-align: right;">181.146</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>rain_check <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">summarise</span>(</span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="at">total_days =</span> <span class="fu">n</span>(),</span>
<span id="cb5-4"><a href="#cb5-4"></a>    <span class="at">dry_days =</span> <span class="fu">sum</span>(rainfall <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb5-5"><a href="#cb5-5"></a>    <span class="at">rainy_days =</span> <span class="fu">sum</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb5-6"><a href="#cb5-6"></a>    <span class="at">zero_inflation_pct =</span> (dry_days <span class="sc">/</span> total_days) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>  )</span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a>rain_check <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>  <span class="fu">kable</span>(</span>
<span id="cb5-11"><a href="#cb5-11"></a>    <span class="at">caption =</span> <span class="st">"Prevalence of Zero-Inflation (Dry Days)"</span>,</span>
<span id="cb5-12"><a href="#cb5-12"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb5-13"><a href="#cb5-13"></a>      <span class="st">"Total Days"</span>,</span>
<span id="cb5-14"><a href="#cb5-14"></a>      <span class="st">"Dry Days (0mm)"</span>,</span>
<span id="cb5-15"><a href="#cb5-15"></a>      <span class="st">"Rainy Days (&gt;0mm)"</span>,</span>
<span id="cb5-16"><a href="#cb5-16"></a>      <span class="st">"Zero Inflation (%)"</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>    )</span>
<span id="cb5-18"><a href="#cb5-18"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-19"><a href="#cb5-19"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb5-20"><a href="#cb5-20"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"bordered"</span>),</span>
<span id="cb5-21"><a href="#cb5-21"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span></span>
<span id="cb5-22"><a href="#cb5-22"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-bordered caption-top table-sm small" data-quarto-postprocess="true">
<caption>Prevalence of Zero-Inflation (Dry Days)</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Total Days</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dry Days (0mm)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Rainy Days (&gt;0mm)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Zero Inflation (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">142199</td>
<td style="text-align: right;">91080</td>
<td style="text-align: right;">51119</td>
<td style="text-align: right;">64.05108</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The descriptive statistics reveal a distribution fundamentally incompatible with Gaussian modelling assumptions.</p>
<p><strong>Zero-inflation.</strong> 64.05% of the 142,199 recorded observations are dry days (rainfall = 0 mm). The median is zero. The data-generating mechanism genuinely produces two qualitatively different outcomes, no rain at all versus some positive amount and any model treating the response as a single continuous variable will be forced to place probability mass on negative values and will systematically misestimate the probability of the zero outcome.</p>
<p><strong>Heavy tails.</strong> Among non-zero observations, the distribution is severely right-skewed (skewness = 9.84). The standard deviation (8.48 mm) is nearly four times the mean (2.36 mm). Kurtosis of 181.15 compared to 3 for a normal distribution confirms that extreme events occur far more frequently than a Gaussian model would predict. The maximum recorded value is 371 mm, and 151 events exceed 100 mm.</p>
<p><strong>Modelling implication.</strong> The conjunction of zero-inflation and extreme positive skew means a single-component model is insufficient. The data implicitly poses two separate questions: does rain occur (binary classification) and, given that it does, how much falls (positive continuous regression). This motivates the Zero-Inflated Gamma framework adopted in subsequent analysis.</p>
<hr>
</section>
<section id="sec-correlation" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="sec-correlation"><span class="header-section-number">3.4</span> Bivariate Correlation Structure</h2>
<p>Because rainfall is heavily skewed and the relationships are unlikely to be linear, Spearman rank correlation is used throughout, a non-parametric measure that captures monotonic association without requiring linearity or normality.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>numeric_cols <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">names</span>()</span>
<span id="cb6-4"><a href="#cb6-4"></a>numeric_cols <span class="ot">&lt;-</span> numeric_cols[numeric_cols <span class="sc">!=</span> <span class="st">"rainfall"</span>]</span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a>cors <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>  rstatix<span class="sc">::</span><span class="fu">cor_test</span>(</span>
<span id="cb6-8"><a href="#cb6-8"></a>    <span class="at">vars =</span> <span class="st">"rainfall"</span>,</span>
<span id="cb6-9"><a href="#cb6-9"></a>    <span class="at">vars2 =</span> numeric_cols,</span>
<span id="cb6-10"><a href="#cb6-10"></a>    <span class="at">method =</span> <span class="st">"spearman"</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(cor)) <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(cor))) <span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(var2, cor, p) <span class="sc">%&gt;%</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-16"><a href="#cb6-16"></a>    <span class="at">interpretation =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-17"><a href="#cb6-17"></a>      <span class="fu">abs</span>(cor) <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"Negligible"</span>,</span>
<span id="cb6-18"><a href="#cb6-18"></a>      <span class="fu">abs</span>(cor) <span class="sc">&lt;</span> <span class="fl">0.3</span> <span class="sc">~</span> <span class="st">"Small"</span>,</span>
<span id="cb6-19"><a href="#cb6-19"></a>      <span class="fu">abs</span>(cor) <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Moderate"</span>,</span>
<span id="cb6-20"><a href="#cb6-20"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Large"</span></span>
<span id="cb6-21"><a href="#cb6-21"></a>    )</span>
<span id="cb6-22"><a href="#cb6-22"></a>  )</span>
<span id="cb6-23"><a href="#cb6-23"></a></span>
<span id="cb6-24"><a href="#cb6-24"></a>cors <span class="sc">%&gt;%</span></span>
<span id="cb6-25"><a href="#cb6-25"></a>  <span class="fu">kable</span>(</span>
<span id="cb6-26"><a href="#cb6-26"></a>    <span class="at">caption =</span> <span class="st">"Spearman Correlation with Rainfall (Ranked by Strength)"</span>,</span>
<span id="cb6-27"><a href="#cb6-27"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Predictor"</span>, <span class="st">"Correlation (r)"</span>, <span class="st">"P-Value"</span>, <span class="st">"Strength"</span>)</span>
<span id="cb6-28"><a href="#cb6-28"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-29"><a href="#cb6-29"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Spearman Correlation with Rainfall (Ranked by Strength)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Predictor</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Correlation (r)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">P-Value</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Strength</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">humidity9am</td>
<td style="text-align: right;">0.440</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr class="even">
<td style="text-align: left;">humidity3pm</td>
<td style="text-align: right;">0.440</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sunshine</td>
<td style="text-align: right;">-0.400</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr class="even">
<td style="text-align: left;">cloud9am</td>
<td style="text-align: right;">0.370</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cloud3pm</td>
<td style="text-align: right;">0.320</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr class="even">
<td style="text-align: left;">evaporation</td>
<td style="text-align: right;">-0.310</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr class="odd">
<td style="text-align: left;">temp3pm</td>
<td style="text-align: right;">-0.310</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr class="even">
<td style="text-align: left;">max_temp</td>
<td style="text-align: right;">-0.300</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pressure9am</td>
<td style="text-align: right;">-0.150</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Small</td>
</tr>
<tr class="even">
<td style="text-align: left;">temp9am</td>
<td style="text-align: right;">-0.150</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Small</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wind_gust_speed</td>
<td style="text-align: right;">0.130</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Small</td>
</tr>
<tr class="even">
<td style="text-align: left;">wind_speed9am</td>
<td style="text-align: right;">0.083</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Negligible</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wind_speed3pm</td>
<td style="text-align: right;">0.068</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Negligible</td>
</tr>
<tr class="even">
<td style="text-align: left;">pressure3pm</td>
<td style="text-align: right;">-0.063</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Negligible</td>
</tr>
<tr class="odd">
<td style="text-align: left;">min_temp</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Negligible</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>cor_matrix <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a>cor_melt <span class="ot">&lt;-</span> cor_matrix <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Var1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Var1, <span class="at">names_to =</span> <span class="st">"Var2"</span>, <span class="at">values_to =</span> <span class="st">"Correlation"</span>)</span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a>cor_melt <span class="sc">%&gt;%</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb7-14"><a href="#cb7-14"></a>    <span class="at">low =</span> <span class="st">"#D73027"</span>,</span>
<span id="cb7-15"><a href="#cb7-15"></a>    <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb7-16"><a href="#cb7-16"></a>    <span class="at">high =</span> <span class="st">"#4575B4"</span>,</span>
<span id="cb7-17"><a href="#cb7-17"></a>    <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb7-18"><a href="#cb7-18"></a>    <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb7-19"><a href="#cb7-19"></a>    <span class="at">name =</span> <span class="st">"Spearman</span><span class="sc">\n</span><span class="st">Correlation"</span></span>
<span id="cb7-20"><a href="#cb7-20"></a>  ) <span class="sc">+</span></span>
<span id="cb7-21"><a href="#cb7-21"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-22"><a href="#cb7-22"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-23"><a href="#cb7-23"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb7-24"><a href="#cb7-24"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb7-25"><a href="#cb7-25"></a>    <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-26"><a href="#cb7-26"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-27"><a href="#cb7-27"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb7-28"><a href="#cb7-28"></a>  ) <span class="sc">+</span></span>
<span id="cb7-29"><a href="#cb7-29"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb7-30"><a href="#cb7-30"></a>    <span class="at">data =</span> <span class="fu">filter</span>(cor_melt, <span class="fu">abs</span>(Correlation) <span class="sc">&gt;</span> <span class="fl">0.3</span>),</span>
<span id="cb7-31"><a href="#cb7-31"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Correlation, <span class="dv">2</span>)),</span>
<span id="cb7-32"><a href="#cb7-32"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb7-33"><a href="#cb7-33"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb7-34"><a href="#cb7-34"></a>  ) <span class="sc">+</span></span>
<span id="cb7-35"><a href="#cb7-35"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-36"><a href="#cb7-36"></a>    <span class="at">title =</span> <span class="st">"Feature Correlation Matrix"</span>,</span>
<span id="cb7-37"><a href="#cb7-37"></a>    <span class="at">subtitle =</span> <span class="st">"Strongest predictors: Humidity (positive) and Sunshine (negative)"</span></span>
<span id="cb7-38"><a href="#cb7-38"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-correlation-matrix" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-correlation-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-correlation-matrix-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-correlation-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Spearman Correlation Matrix of Meteorological Features. Red indicates negative correlation; blue indicates positive correlation. Coefficients shown for pairs where |r| &gt; 0.3.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>cor_humidity <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(</span>
<span id="cb8-2"><a href="#cb8-2"></a>  df_clean<span class="sc">$</span>rainfall,</span>
<span id="cb8-3"><a href="#cb8-3"></a>  df_clean<span class="sc">$</span>humidity3pm,</span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="at">method =</span> <span class="st">"spearman"</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>)</span>
<span id="cb8-6"><a href="#cb8-6"></a>cor_sunshine <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(</span>
<span id="cb8-7"><a href="#cb8-7"></a>  df_clean<span class="sc">$</span>rainfall,</span>
<span id="cb8-8"><a href="#cb8-8"></a>  df_clean<span class="sc">$</span>sunshine,</span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="at">method =</span> <span class="st">"spearman"</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>)</span>
<span id="cb8-11"><a href="#cb8-11"></a></span>
<span id="cb8-12"><a href="#cb8-12"></a>cocor_result <span class="ot">&lt;-</span> <span class="fu">cocor.dep.groups.overlap</span>(</span>
<span id="cb8-13"><a href="#cb8-13"></a>  <span class="at">r.jk =</span> cor_humidity<span class="sc">$</span>estimate,</span>
<span id="cb8-14"><a href="#cb8-14"></a>  <span class="at">r.jh =</span> cor_sunshine<span class="sc">$</span>estimate,</span>
<span id="cb8-15"><a href="#cb8-15"></a>  <span class="at">r.kh =</span> <span class="fu">cor</span>(</span>
<span id="cb8-16"><a href="#cb8-16"></a>    df_clean<span class="sc">$</span>humidity3pm,</span>
<span id="cb8-17"><a href="#cb8-17"></a>    df_clean<span class="sc">$</span>sunshine,</span>
<span id="cb8-18"><a href="#cb8-18"></a>    <span class="at">use =</span> <span class="st">"complete.obs"</span>,</span>
<span id="cb8-19"><a href="#cb8-19"></a>    <span class="at">method =</span> <span class="st">"spearman"</span></span>
<span id="cb8-20"><a href="#cb8-20"></a>  ),</span>
<span id="cb8-21"><a href="#cb8-21"></a>  <span class="at">n =</span> <span class="fu">nrow</span>(df_clean),</span>
<span id="cb8-22"><a href="#cb8-22"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span>,</span>
<span id="cb8-23"><a href="#cb8-23"></a>  <span class="at">test =</span> <span class="st">"steiger1980"</span>,</span>
<span id="cb8-24"><a href="#cb8-24"></a>  <span class="at">return.htest =</span> <span class="cn">TRUE</span></span>
<span id="cb8-25"><a href="#cb8-25"></a>)</span>
<span id="cb8-26"><a href="#cb8-26"></a></span>
<span id="cb8-27"><a href="#cb8-27"></a><span class="fu">print</span>(cocor_result)</span>
<span id="cb8-28"><a href="#cb8-28"></a><span class="co">#&gt; $pearson1898</span></span>
<span id="cb8-29"><a href="#cb8-29"></a><span class="co">#&gt; </span></span>
<span id="cb8-30"><a href="#cb8-30"></a><span class="co">#&gt;  Pearson and Filon's z (1898)</span></span>
<span id="cb8-31"><a href="#cb8-31"></a><span class="co">#&gt; </span></span>
<span id="cb8-32"><a href="#cb8-32"></a><span class="co">#&gt; data:  </span></span>
<span id="cb8-33"><a href="#cb8-33"></a><span class="co">#&gt; </span></span>
<span id="cb8-34"><a href="#cb8-34"></a><span class="co">#&gt; alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb8-35"><a href="#cb8-35"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb8-36"><a href="#cb8-36"></a><span class="co">#&gt;   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb8-37"><a href="#cb8-37"></a><span class="co">#&gt;  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="co">#&gt; </span></span>
<span id="cb8-39"><a href="#cb8-39"></a><span class="co">#&gt; </span></span>
<span id="cb8-40"><a href="#cb8-40"></a><span class="co">#&gt; $hotelling1940</span></span>
<span id="cb8-41"><a href="#cb8-41"></a><span class="co">#&gt; </span></span>
<span id="cb8-42"><a href="#cb8-42"></a><span class="co">#&gt;  Hotelling's t (1940)</span></span>
<span id="cb8-43"><a href="#cb8-43"></a><span class="co">#&gt; </span></span>
<span id="cb8-44"><a href="#cb8-44"></a><span class="co">#&gt; data:  </span></span>
<span id="cb8-45"><a href="#cb8-45"></a><span class="co">#&gt; </span></span>
<span id="cb8-46"><a href="#cb8-46"></a><span class="co">#&gt; alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb8-47"><a href="#cb8-47"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb8-48"><a href="#cb8-48"></a><span class="co">#&gt;   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb8-49"><a href="#cb8-49"></a><span class="co">#&gt;  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb8-50"><a href="#cb8-50"></a><span class="co">#&gt; </span></span>
<span id="cb8-51"><a href="#cb8-51"></a><span class="co">#&gt; </span></span>
<span id="cb8-52"><a href="#cb8-52"></a><span class="co">#&gt; $williams1959</span></span>
<span id="cb8-53"><a href="#cb8-53"></a><span class="co">#&gt; </span></span>
<span id="cb8-54"><a href="#cb8-54"></a><span class="co">#&gt;  Williams' t (1959)</span></span>
<span id="cb8-55"><a href="#cb8-55"></a><span class="co">#&gt; </span></span>
<span id="cb8-56"><a href="#cb8-56"></a><span class="co">#&gt; data:  </span></span>
<span id="cb8-57"><a href="#cb8-57"></a><span class="co">#&gt; </span></span>
<span id="cb8-58"><a href="#cb8-58"></a><span class="co">#&gt; alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb8-59"><a href="#cb8-59"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb8-60"><a href="#cb8-60"></a><span class="co">#&gt;   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb8-61"><a href="#cb8-61"></a><span class="co">#&gt;  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb8-62"><a href="#cb8-62"></a><span class="co">#&gt; </span></span>
<span id="cb8-63"><a href="#cb8-63"></a><span class="co">#&gt; </span></span>
<span id="cb8-64"><a href="#cb8-64"></a><span class="co">#&gt; $hendrickson1970</span></span>
<span id="cb8-65"><a href="#cb8-65"></a><span class="co">#&gt; </span></span>
<span id="cb8-66"><a href="#cb8-66"></a><span class="co">#&gt;  Hendrickson, Stanley, and Hills' (1970) modification of Williams' t</span></span>
<span id="cb8-67"><a href="#cb8-67"></a><span class="co">#&gt;  (1959)</span></span>
<span id="cb8-68"><a href="#cb8-68"></a><span class="co">#&gt; </span></span>
<span id="cb8-69"><a href="#cb8-69"></a><span class="co">#&gt; data:  </span></span>
<span id="cb8-70"><a href="#cb8-70"></a><span class="co">#&gt; </span></span>
<span id="cb8-71"><a href="#cb8-71"></a><span class="co">#&gt; alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb8-72"><a href="#cb8-72"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb8-73"><a href="#cb8-73"></a><span class="co">#&gt;   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb8-74"><a href="#cb8-74"></a><span class="co">#&gt;  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb8-75"><a href="#cb8-75"></a><span class="co">#&gt; </span></span>
<span id="cb8-76"><a href="#cb8-76"></a><span class="co">#&gt; </span></span>
<span id="cb8-77"><a href="#cb8-77"></a><span class="co">#&gt; $olkin1967</span></span>
<span id="cb8-78"><a href="#cb8-78"></a><span class="co">#&gt; </span></span>
<span id="cb8-79"><a href="#cb8-79"></a><span class="co">#&gt;  Olkin's z (1967)</span></span>
<span id="cb8-80"><a href="#cb8-80"></a><span class="co">#&gt; </span></span>
<span id="cb8-81"><a href="#cb8-81"></a><span class="co">#&gt; data:  </span></span>
<span id="cb8-82"><a href="#cb8-82"></a><span class="co">#&gt; </span></span>
<span id="cb8-83"><a href="#cb8-83"></a><span class="co">#&gt; alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb8-84"><a href="#cb8-84"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb8-85"><a href="#cb8-85"></a><span class="co">#&gt;   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb8-86"><a href="#cb8-86"></a><span class="co">#&gt;  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb8-87"><a href="#cb8-87"></a><span class="co">#&gt; </span></span>
<span id="cb8-88"><a href="#cb8-88"></a><span class="co">#&gt; </span></span>
<span id="cb8-89"><a href="#cb8-89"></a><span class="co">#&gt; $dunn1969</span></span>
<span id="cb8-90"><a href="#cb8-90"></a><span class="co">#&gt; </span></span>
<span id="cb8-91"><a href="#cb8-91"></a><span class="co">#&gt;  Dunn and Clark's z (1969)</span></span>
<span id="cb8-92"><a href="#cb8-92"></a><span class="co">#&gt; </span></span>
<span id="cb8-93"><a href="#cb8-93"></a><span class="co">#&gt; data:  </span></span>
<span id="cb8-94"><a href="#cb8-94"></a><span class="co">#&gt; </span></span>
<span id="cb8-95"><a href="#cb8-95"></a><span class="co">#&gt; alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb8-96"><a href="#cb8-96"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb8-97"><a href="#cb8-97"></a><span class="co">#&gt;   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb8-98"><a href="#cb8-98"></a><span class="co">#&gt;  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb8-99"><a href="#cb8-99"></a><span class="co">#&gt; </span></span>
<span id="cb8-100"><a href="#cb8-100"></a><span class="co">#&gt; </span></span>
<span id="cb8-101"><a href="#cb8-101"></a><span class="co">#&gt; $steiger1980</span></span>
<span id="cb8-102"><a href="#cb8-102"></a><span class="co">#&gt; </span></span>
<span id="cb8-103"><a href="#cb8-103"></a><span class="co">#&gt;  Steiger's (1980) modification of Dunn and Clark's z (1969) using</span></span>
<span id="cb8-104"><a href="#cb8-104"></a><span class="co">#&gt;  average correlations</span></span>
<span id="cb8-105"><a href="#cb8-105"></a><span class="co">#&gt; </span></span>
<span id="cb8-106"><a href="#cb8-106"></a><span class="co">#&gt; data:  </span></span>
<span id="cb8-107"><a href="#cb8-107"></a><span class="co">#&gt; z = 188.91, p-value &lt; 2.2e-16</span></span>
<span id="cb8-108"><a href="#cb8-108"></a><span class="co">#&gt; alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb8-109"><a href="#cb8-109"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb8-110"><a href="#cb8-110"></a><span class="co">#&gt;   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb8-111"><a href="#cb8-111"></a><span class="co">#&gt;  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb8-112"><a href="#cb8-112"></a><span class="co">#&gt; </span></span>
<span id="cb8-113"><a href="#cb8-113"></a><span class="co">#&gt; </span></span>
<span id="cb8-114"><a href="#cb8-114"></a><span class="co">#&gt; $meng1992</span></span>
<span id="cb8-115"><a href="#cb8-115"></a><span class="co">#&gt; </span></span>
<span id="cb8-116"><a href="#cb8-116"></a><span class="co">#&gt;  Meng, Rosenthal, and Rubin's z (1992)</span></span>
<span id="cb8-117"><a href="#cb8-117"></a><span class="co">#&gt; </span></span>
<span id="cb8-118"><a href="#cb8-118"></a><span class="co">#&gt; data:  </span></span>
<span id="cb8-119"><a href="#cb8-119"></a><span class="co">#&gt; </span></span>
<span id="cb8-120"><a href="#cb8-120"></a><span class="co">#&gt; alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb8-121"><a href="#cb8-121"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb8-122"><a href="#cb8-122"></a><span class="co">#&gt;   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb8-123"><a href="#cb8-123"></a><span class="co">#&gt;  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb8-124"><a href="#cb8-124"></a><span class="co">#&gt; </span></span>
<span id="cb8-125"><a href="#cb8-125"></a><span class="co">#&gt; </span></span>
<span id="cb8-126"><a href="#cb8-126"></a><span class="co">#&gt; $hittner2003</span></span>
<span id="cb8-127"><a href="#cb8-127"></a><span class="co">#&gt; </span></span>
<span id="cb8-128"><a href="#cb8-128"></a><span class="co">#&gt;  Hittner, May, and Silver's (2003) modification of Dunn and Clark's z</span></span>
<span id="cb8-129"><a href="#cb8-129"></a><span class="co">#&gt;  (1969) using a backtransformed average Fisher's (1921) Z procedure</span></span>
<span id="cb8-130"><a href="#cb8-130"></a><span class="co">#&gt; </span></span>
<span id="cb8-131"><a href="#cb8-131"></a><span class="co">#&gt; data:  </span></span>
<span id="cb8-132"><a href="#cb8-132"></a><span class="co">#&gt; </span></span>
<span id="cb8-133"><a href="#cb8-133"></a><span class="co">#&gt; alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb8-134"><a href="#cb8-134"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb8-135"><a href="#cb8-135"></a><span class="co">#&gt;   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb8-136"><a href="#cb8-136"></a><span class="co">#&gt;  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb8-137"><a href="#cb8-137"></a><span class="co">#&gt; </span></span>
<span id="cb8-138"><a href="#cb8-138"></a><span class="co">#&gt; </span></span>
<span id="cb8-139"><a href="#cb8-139"></a><span class="co">#&gt; $zou2007</span></span>
<span id="cb8-140"><a href="#cb8-140"></a><span class="co">#&gt; </span></span>
<span id="cb8-141"><a href="#cb8-141"></a><span class="co">#&gt;  Zou's (2007) confidence interval</span></span>
<span id="cb8-142"><a href="#cb8-142"></a><span class="co">#&gt; </span></span>
<span id="cb8-143"><a href="#cb8-143"></a><span class="co">#&gt; data:  </span></span>
<span id="cb8-144"><a href="#cb8-144"></a><span class="co">#&gt; </span></span>
<span id="cb8-145"><a href="#cb8-145"></a><span class="co">#&gt; alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb8-146"><a href="#cb8-146"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb8-147"><a href="#cb8-147"></a><span class="co">#&gt;   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb8-148"><a href="#cb8-148"></a><span class="co">#&gt;  0.4436352 -0.4013063 -0.6206376</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Moisture indicators (positive association).</strong> <code>Humidity3pm</code> (<span class="math inline">\(r = 0.44\)</span>) and cloud cover (<span class="math inline">\(r \approx 0.37\)</span>) show the strongest positive associations. High afternoon humidity indicates moisture has accumulated in the lower atmosphere over the course of the day. Cloud cover is both a physical precondition for rain and a consequence of the same atmospheric dynamics.</p>
<p><strong>Radiation and evaporation indicators (negative association).</strong> <code>Sunshine</code> (<span class="math inline">\(r = -0.40\)</span>) and <code>evaporation</code> (<span class="math inline">\(r = -0.31\)</span>) exhibit the strongest negative associations. Long sunshine hours proxy clear-sky, high-pressure conditions. High evaporation signals warm, dry, low-humidity surface conditions.</p>
<p><strong>Multicollinearity.</strong> The correlation heatmap (<a href="#fig-correlation-matrix" class="quarto-xref">Figure&nbsp;<span>3.1</span></a>) reveals substantial redundancy among predictors. <code>pressure9am</code> and <code>pressure3pm</code> share <span class="math inline">\(r = 0.96\)</span>, and the two temperature readings are similarly collinear. This directly motivates VIF-based feature selection in the feature engineering chapter.</p>
<p><strong>Statistical validation.</strong> Steiger’s Z-test comparing the two strongest opposing predictors yields <span class="math inline">\(z \approx 188.9\)</span>, <span class="math inline">\(p &lt; 2.2 \times 10^{-16}\)</span>. With <span class="math inline">\(N &gt; 140,000\)</span>, the p-value alone is uninformative; the Z-statistic magnitude confirms the differential predictive strength is not a sampling artefact. Humidity and sunshine represent genuinely distinct physical forces operating in opposing directions.</p>
<hr>
</section>
<section id="temporal-structure-of-rainfall" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="temporal-structure-of-rainfall"><span class="header-section-number">3.5</span> Temporal Structure of Rainfall</h2>
<section id="sec-frequency" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="sec-frequency"><span class="header-section-number">3.5.1</span> Weekly and Seasonal Frequency</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>df_clean <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">tabyl</span>(day) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="fu">kable</span>(</span>
<span id="cb9-7"><a href="#cb9-7"></a>    <span class="at">caption =</span> <span class="st">"Frequency of Rainfall Days by Day of the Week"</span>,</span>
<span id="cb9-8"><a href="#cb9-8"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Day"</span>, <span class="st">"Count (n)"</span>, <span class="st">"Percentage"</span>)</span>
<span id="cb9-9"><a href="#cb9-9"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Frequency of Rainfall Days by Day of the Week</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Day</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Count (n)</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Tue</td>
<td style="text-align: right;">7508</td>
<td style="text-align: left;">14.7%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mon</td>
<td style="text-align: right;">7480</td>
<td style="text-align: left;">14.6%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fri</td>
<td style="text-align: right;">7378</td>
<td style="text-align: left;">14.4%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wed</td>
<td style="text-align: right;">7342</td>
<td style="text-align: left;">14.4%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Thu</td>
<td style="text-align: right;">7314</td>
<td style="text-align: left;">14.3%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sat</td>
<td style="text-align: right;">7057</td>
<td style="text-align: left;">13.8%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sun</td>
<td style="text-align: right;">7040</td>
<td style="text-align: left;">13.8%</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>df_clean <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">tabyl</span>(month) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="fu">kable</span>(</span>
<span id="cb10-7"><a href="#cb10-7"></a>    <span class="at">caption =</span> <span class="st">"Frequency of Rainfall Days by Month"</span>,</span>
<span id="cb10-8"><a href="#cb10-8"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Month"</span>, <span class="st">"Count (n)"</span>, <span class="st">"Percentage"</span>)</span>
<span id="cb10-9"><a href="#cb10-9"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Frequency of Rainfall Days by Month</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Month</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Count (n)</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">5448</td>
<td style="text-align: left;">10.7%</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">5250</td>
<td style="text-align: left;">10.3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">4937</td>
<td style="text-align: left;">9.7%</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: right;">4704</td>
<td style="text-align: left;">9.2%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">4444</td>
<td style="text-align: left;">8.7%</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">4234</td>
<td style="text-align: left;">8.3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">4001</td>
<td style="text-align: left;">7.8%</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">3770</td>
<td style="text-align: left;">7.4%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">3760</td>
<td style="text-align: left;">7.4%</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">3702</td>
<td style="text-align: left;">7.2%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: right;">3562</td>
<td style="text-align: left;">7.0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">3307</td>
<td style="text-align: left;">6.5%</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>df_clean <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">tabyl</span>(month, day) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">adorn_totals</span>(<span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Cross-tabulation of Rainfall Frequency: Month vs. Day"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb11-7"><a href="#cb11-7"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb11-8"><a href="#cb11-8"></a>    <span class="at">font_size =</span> <span class="dv">11</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Cross-tabulation of Rainfall Frequency: Month vs. Day</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">month</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sun</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mon</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Tue</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Wed</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Thu</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Fri</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sat</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">536</td>
<td style="text-align: right;">570</td>
<td style="text-align: right;">514</td>
<td style="text-align: right;">482</td>
<td style="text-align: right;">493</td>
<td style="text-align: right;">567</td>
<td style="text-align: right;">540</td>
<td style="text-align: right;">3702</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">480</td>
<td style="text-align: right;">530</td>
<td style="text-align: right;">469</td>
<td style="text-align: right;">466</td>
<td style="text-align: right;">443</td>
<td style="text-align: right;">471</td>
<td style="text-align: right;">448</td>
<td style="text-align: right;">3307</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">636</td>
<td style="text-align: right;">645</td>
<td style="text-align: right;">639</td>
<td style="text-align: right;">592</td>
<td style="text-align: right;">662</td>
<td style="text-align: right;">644</td>
<td style="text-align: right;">626</td>
<td style="text-align: right;">4444</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">578</td>
<td style="text-align: right;">597</td>
<td style="text-align: right;">566</td>
<td style="text-align: right;">604</td>
<td style="text-align: right;">579</td>
<td style="text-align: right;">515</td>
<td style="text-align: right;">562</td>
<td style="text-align: right;">4001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">710</td>
<td style="text-align: right;">722</td>
<td style="text-align: right;">765</td>
<td style="text-align: right;">714</td>
<td style="text-align: right;">678</td>
<td style="text-align: right;">681</td>
<td style="text-align: right;">667</td>
<td style="text-align: right;">4937</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">766</td>
<td style="text-align: right;">801</td>
<td style="text-align: right;">804</td>
<td style="text-align: right;">797</td>
<td style="text-align: right;">760</td>
<td style="text-align: right;">753</td>
<td style="text-align: right;">767</td>
<td style="text-align: right;">5448</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">694</td>
<td style="text-align: right;">717</td>
<td style="text-align: right;">728</td>
<td style="text-align: right;">796</td>
<td style="text-align: right;">773</td>
<td style="text-align: right;">818</td>
<td style="text-align: right;">724</td>
<td style="text-align: right;">5250</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: right;">612</td>
<td style="text-align: right;">702</td>
<td style="text-align: right;">694</td>
<td style="text-align: right;">679</td>
<td style="text-align: right;">689</td>
<td style="text-align: right;">687</td>
<td style="text-align: right;">641</td>
<td style="text-align: right;">4704</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">516</td>
<td style="text-align: right;">571</td>
<td style="text-align: right;">616</td>
<td style="text-align: right;">639</td>
<td style="text-align: right;">648</td>
<td style="text-align: right;">659</td>
<td style="text-align: right;">585</td>
<td style="text-align: right;">4234</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">507</td>
<td style="text-align: right;">606</td>
<td style="text-align: right;">579</td>
<td style="text-align: right;">550</td>
<td style="text-align: right;">517</td>
<td style="text-align: right;">456</td>
<td style="text-align: right;">555</td>
<td style="text-align: right;">3770</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">556</td>
<td style="text-align: right;">526</td>
<td style="text-align: right;">554</td>
<td style="text-align: right;">480</td>
<td style="text-align: right;">538</td>
<td style="text-align: right;">575</td>
<td style="text-align: right;">531</td>
<td style="text-align: right;">3760</td>
</tr>
<tr class="even">
<td style="text-align: left;">12</td>
<td style="text-align: right;">449</td>
<td style="text-align: right;">493</td>
<td style="text-align: right;">580</td>
<td style="text-align: right;">543</td>
<td style="text-align: right;">534</td>
<td style="text-align: right;">552</td>
<td style="text-align: right;">411</td>
<td style="text-align: right;">3562</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">7040</td>
<td style="text-align: right;">7480</td>
<td style="text-align: right;">7508</td>
<td style="text-align: right;">7342</td>
<td style="text-align: right;">7314</td>
<td style="text-align: right;">7378</td>
<td style="text-align: right;">7057</td>
<td style="text-align: right;">51119</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><strong>Weekly cycle.</strong> The distribution of wet days across the days of the week is approximately uniform, ranging from 13.8% to 14.7%. This near-uniformity is physically expected: atmospheric processes operate independently of the social calendar. The slight variation is consistent with sampling noise, suggesting <code>Day</code> carries little predictive information.</p>
<p><strong>Annual cycle.</strong> June (10.7%) and July (10.3%) record the highest frequency of wet days, consistent with Southern Hemisphere winter frontal systems from the Southern Ocean. February (6.5%) and December (7.0%) record the lowest frequencies. The cross-tabulation confirms this seasonal signal is not an artefact of any particular day of the week. <code>Month</code> is therefore a legitimate predictor warranting explicit model inclusion.</p>
</section>
<section id="sec-markov" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="sec-markov"><span class="header-section-number">3.5.2</span> Day-to-Day Persistence: A Markov Chain Analysis</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>markov_table <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">mutate</span>(<span class="at">yesterday_rain =</span> <span class="fu">lag</span>(rain_today)) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(rain_today), <span class="sc">!</span><span class="fu">is.na</span>(yesterday_rain)) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="fu">count</span>(yesterday_rain, rain_today)</span>
<span id="cb12-8"><a href="#cb12-8"></a></span>
<span id="cb12-9"><a href="#cb12-9"></a>cont_table <span class="ot">&lt;-</span> markov_table <span class="sc">%&gt;%</span></span>
<span id="cb12-10"><a href="#cb12-10"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> rain_today, <span class="at">values_from =</span> n, <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"yesterday_rain"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-12"><a href="#cb12-12"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb12-13"><a href="#cb12-13"></a></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="fu">print</span>(cont_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;        No   Yes
#&gt; No  93231 17043
#&gt; Yes 17047 14829</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>chi_result <span class="ot">&lt;-</span> <span class="fu">chisq_test</span>(<span class="fu">as.table</span>(cont_table))</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="fu">print</span>(chi_result)</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">#&gt; # A tibble: 1 × 6</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">#&gt;        n statistic     p    df method          p.signif</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">#&gt; *  &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;   </span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">#&gt; 1 142150    13718.     0     1 Chi-square test ****</span></span>
<span id="cb14-7"><a href="#cb14-7"></a></span>
<span id="cb14-8"><a href="#cb14-8"></a>cramers_v <span class="ot">&lt;-</span> <span class="fu">cramer_v</span>(cont_table)</span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effect Size Interpretation</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">#&gt; </span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">#&gt; Effect Size Interpretation</span></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"V = %.4f: "</span>, cramers_v))</span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co">#&gt; V = 0.3107:</span></span>
<span id="cb14-15"><a href="#cb14-15"></a></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="cf">if</span> (cramers_v <span class="sc">&lt;</span> <span class="fl">0.1</span>) {</span>
<span id="cb14-17"><a href="#cb14-17"></a>  <span class="fu">cat</span>(<span class="st">"Negligible Association</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-18"><a href="#cb14-18"></a>} <span class="cf">else</span> <span class="cf">if</span> (cramers_v <span class="sc">&lt;</span> <span class="fl">0.3</span>) {</span>
<span id="cb14-19"><a href="#cb14-19"></a>  <span class="fu">cat</span>(<span class="st">"Weak Association</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-20"><a href="#cb14-20"></a>} <span class="cf">else</span> <span class="cf">if</span> (cramers_v <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb14-21"><a href="#cb14-21"></a>  <span class="fu">cat</span>(<span class="st">"Moderate Association</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-22"><a href="#cb14-22"></a>} <span class="cf">else</span> {</span>
<span id="cb14-23"><a href="#cb14-23"></a>  <span class="fu">cat</span>(<span class="st">"Strong Association</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-24"><a href="#cb14-24"></a>}</span>
<span id="cb14-25"><a href="#cb14-25"></a><span class="co">#&gt; Moderate Association</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>markov_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">mutate</span>(<span class="at">yesterday_rain =</span> <span class="fu">lag</span>(rain_today)) <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(rain_today), <span class="sc">!</span><span class="fu">is.na</span>(yesterday_rain))</span>
<span id="cb15-7"><a href="#cb15-7"></a></span>
<span id="cb15-8"><a href="#cb15-8"></a>markov_data <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>  <span class="fu">count</span>(yesterday_rain, rain_today) <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>  <span class="fu">group_by</span>(yesterday_rain) <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> yesterday_rain, <span class="at">y =</span> rain_today, <span class="at">fill =</span> prob)) <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb15-14"><a href="#cb15-14"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb15-15"><a href="#cb15-15"></a>    <span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(prob, <span class="at">accuracy =</span> <span class="dv">1</span>)),</span>
<span id="cb15-16"><a href="#cb15-16"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb15-17"><a href="#cb15-17"></a>    <span class="at">size =</span> <span class="dv">8</span>,</span>
<span id="cb15-18"><a href="#cb15-18"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span></span>
<span id="cb15-19"><a href="#cb15-19"></a>  ) <span class="sc">+</span></span>
<span id="cb15-20"><a href="#cb15-20"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"viridis"</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb15-21"><a href="#cb15-21"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-22"><a href="#cb15-22"></a>    <span class="at">title =</span> <span class="st">"Markov Chain: Rain Persistence Effect"</span>,</span>
<span id="cb15-23"><a href="#cb15-23"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(</span>
<span id="cb15-24"><a href="#cb15-24"></a>      <span class="st">"X^2 = %.2f, p &lt; 0.001, Cramer's V = %.3f (Moderate Association)</span><span class="sc">\n</span><span class="st">Yesterday's rain state strongly predicts today's rain state."</span>,</span>
<span id="cb15-25"><a href="#cb15-25"></a>      chi_result<span class="sc">$</span>statistic,</span>
<span id="cb15-26"><a href="#cb15-26"></a>      cramers_v</span>
<span id="cb15-27"><a href="#cb15-27"></a>    ),</span>
<span id="cb15-28"><a href="#cb15-28"></a>    <span class="at">x =</span> <span class="st">"Did it Rain Yesterday?"</span>,</span>
<span id="cb15-29"><a href="#cb15-29"></a>    <span class="at">y =</span> <span class="st">"Did it Rain Today?"</span>,</span>
<span id="cb15-30"><a href="#cb15-30"></a>    <span class="at">fill =</span> <span class="st">"Probability"</span></span>
<span id="cb15-31"><a href="#cb15-31"></a>  ) <span class="sc">+</span></span>
<span id="cb15-32"><a href="#cb15-32"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-33"><a href="#cb15-33"></a>  <span class="fu">theme</span>(</span>
<span id="cb15-34"><a href="#cb15-34"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb15-35"><a href="#cb15-35"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb15-36"><a href="#cb15-36"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb15-37"><a href="#cb15-37"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-markov-chain" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-markov-chain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-markov-chain-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-markov-chain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Markov Chain Transition Matrix. The asymmetry between dry-to-dry (85%) and wet-to-wet (47%) probabilities is the central finding: dry states are self-reinforcing, wet states are transient.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The Chi-squared test yields <span class="math inline">\(\chi^2 \approx 13,718\)</span>, <span class="math inline">\(p &lt; 0.001\)</span>, rejecting daily independence by a large margin. Cramer’s V (<span class="math inline">\(V \approx 0.31\)</span>) confirms a moderate practical effect size.</p>
<p>The transition matrix (<a href="#fig-markov-chain" class="quarto-xref">Figure&nbsp;<span>3.2</span></a>) reveals an important asymmetry. When the previous day was dry, there is an 85% probability of remaining dry, high-pressure systems are persistent and self-reinforcing. When the previous day was wet, there is only a 47% probability of continued rain, meaning wet events are more transient. This asymmetry has a direct atmospheric interpretation: anticyclonic systems can persist for days to weeks, while frontal systems pass through more quickly.</p>
<p><code>rain_today</code> (lagged one day) carries meaningful predictive signal. Its modest effect size also demonstrates that autocorrelation alone is insufficient: the wet state is too transient for a persistence-only rule, and other meteorological covariates are necessary.</p>
</section>
<section id="sec-dry-spell" class="level3" data-number="3.5.3">
<h3 data-number="3.5.3" class="anchored" data-anchor-id="sec-dry-spell"><span class="header-section-number">3.5.3</span> Dry Spell Dynamics and Temporal Decay</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>dry_spell_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-5"><a href="#cb16-5"></a>    <span class="at">did_rain_yesterday =</span> <span class="fu">lag</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">default =</span> <span class="cn">FALSE</span>),</span>
<span id="cb16-6"><a href="#cb16-6"></a>    <span class="at">dry_spell_id =</span> <span class="fu">cumsum</span>(did_rain_yesterday)</span>
<span id="cb16-7"><a href="#cb16-7"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8"></a>  <span class="fu">group_by</span>(location, dry_spell_id) <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9"></a>  <span class="fu">mutate</span>(<span class="at">days_since_rain =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11"></a>  <span class="fu">filter</span>(days_since_rain <span class="sc">&lt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12"></a>  <span class="fu">mutate</span>(<span class="at">rain_binary =</span> <span class="fu">as.numeric</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb17-2"><a href="#cb17-2"></a>  rain_binary <span class="sc">~</span> days_since_rain,</span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="at">data =</span> dry_spell_data,</span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb17-5"><a href="#cb17-5"></a>)</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a>wald_test <span class="ot">&lt;-</span> aod<span class="sc">::</span><span class="fu">wald.test</span>(</span>
<span id="cb17-8"><a href="#cb17-8"></a>  <span class="at">b =</span> <span class="fu">coef</span>(logit_model),</span>
<span id="cb17-9"><a href="#cb17-9"></a>  <span class="at">Sigma =</span> <span class="fu">vcov</span>(logit_model),</span>
<span id="cb17-10"><a href="#cb17-10"></a>  <span class="at">Terms =</span> <span class="dv">2</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>)</span>
<span id="cb17-12"><a href="#cb17-12"></a>or_results <span class="ot">&lt;-</span> <span class="fu">tidy</span>(logit_model, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"days_since_rain"</span>)</span>
<span id="cb17-14"><a href="#cb17-14"></a></span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="fu">print</span>(wald_test)</span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="co">#&gt; Wald test:</span></span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="co">#&gt; ----------</span></span>
<span id="cb17-18"><a href="#cb17-18"></a><span class="co">#&gt; </span></span>
<span id="cb17-19"><a href="#cb17-19"></a><span class="co">#&gt; Chi-squared test:</span></span>
<span id="cb17-20"><a href="#cb17-20"></a><span class="co">#&gt; X2 = 8099.7, df = 1, P(&gt; X2) = 0.0</span></span>
<span id="cb17-21"><a href="#cb17-21"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(</span>
<span id="cb17-22"><a href="#cb17-22"></a>  <span class="st">"</span><span class="sc">\n</span><span class="st">For each additional day without rain, odds of rainfall decrease by %.1f%%</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb17-23"><a href="#cb17-23"></a>  (<span class="dv">1</span> <span class="sc">-</span> or_results<span class="sc">$</span>estimate) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb17-24"><a href="#cb17-24"></a>))</span>
<span id="cb17-25"><a href="#cb17-25"></a><span class="co">#&gt; </span></span>
<span id="cb17-26"><a href="#cb17-26"></a><span class="co">#&gt; For each additional day without rain, odds of rainfall decrease by 16.5%</span></span>
<span id="cb17-27"><a href="#cb17-27"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(</span>
<span id="cb17-28"><a href="#cb17-28"></a>  <span class="st">"95%% CI: [%.3f, %.3f]</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb17-29"><a href="#cb17-29"></a>  or_results<span class="sc">$</span>conf.low,</span>
<span id="cb17-30"><a href="#cb17-30"></a>  or_results<span class="sc">$</span>conf.high</span>
<span id="cb17-31"><a href="#cb17-31"></a>))</span>
<span id="cb17-32"><a href="#cb17-32"></a><span class="co">#&gt; 95% CI: [0.831, 0.838]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>logit_spline <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb18-2"><a href="#cb18-2"></a>  rain_binary <span class="sc">~</span> splines<span class="sc">::</span><span class="fu">ns</span>(days_since_rain, <span class="at">df =</span> <span class="dv">4</span>),</span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="at">data =</span> dry_spell_data,</span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="at">family =</span> binomial</span>
<span id="cb18-5"><a href="#cb18-5"></a>)</span>
<span id="cb18-6"><a href="#cb18-6"></a></span>
<span id="cb18-7"><a href="#cb18-7"></a>lrt_result <span class="ot">&lt;-</span> <span class="fu">anova</span>(logit_model, logit_spline, <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="fu">print</span>(lrt_result)</span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co">#&gt; </span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co">#&gt; Model 1: rain_binary ~ days_since_rain</span></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="co">#&gt; Model 2: rain_binary ~ splines::ns(days_since_rain, df = 4)</span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="co">#&gt; 1    138444     169706                          </span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="co">#&gt; 2    138441     162027  3   7678.7 &lt; 2.2e-16 ***</span></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="co">#&gt; ---</span></span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">days_since_rain =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>pred_data<span class="sc">$</span>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb19-3"><a href="#cb19-3"></a>  logit_model,</span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="at">newdata =</span> pred_data,</span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="at">type =</span> <span class="st">"response"</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>)</span>
<span id="cb19-7"><a href="#cb19-7"></a>pred_data<span class="sc">$</span>pred_se <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb19-8"><a href="#cb19-8"></a>  logit_model,</span>
<span id="cb19-9"><a href="#cb19-9"></a>  <span class="at">newdata =</span> pred_data,</span>
<span id="cb19-10"><a href="#cb19-10"></a>  <span class="at">type =</span> <span class="st">"response"</span>,</span>
<span id="cb19-11"><a href="#cb19-11"></a>  <span class="at">se.fit =</span> <span class="cn">TRUE</span></span>
<span id="cb19-12"><a href="#cb19-12"></a>)<span class="sc">$</span>se.fit</span>
<span id="cb19-13"><a href="#cb19-13"></a></span>
<span id="cb19-14"><a href="#cb19-14"></a>empirical_probs <span class="ot">&lt;-</span> dry_spell_data <span class="sc">%&gt;%</span></span>
<span id="cb19-15"><a href="#cb19-15"></a>  <span class="fu">group_by</span>(days_since_rain) <span class="sc">%&gt;%</span></span>
<span id="cb19-16"><a href="#cb19-16"></a>  <span class="fu">summarise</span>(</span>
<span id="cb19-17"><a href="#cb19-17"></a>    <span class="at">prob_rain =</span> <span class="fu">mean</span>(rain_binary, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-18"><a href="#cb19-18"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb19-19"><a href="#cb19-19"></a>    <span class="at">se =</span> <span class="fu">sqrt</span>(prob_rain <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prob_rain) <span class="sc">/</span> n)</span>
<span id="cb19-20"><a href="#cb19-20"></a>  )</span>
<span id="cb19-21"><a href="#cb19-21"></a></span>
<span id="cb19-22"><a href="#cb19-22"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb19-23"><a href="#cb19-23"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb19-24"><a href="#cb19-24"></a>    <span class="at">data =</span> pred_data,</span>
<span id="cb19-25"><a href="#cb19-25"></a>    <span class="fu">aes</span>(</span>
<span id="cb19-26"><a href="#cb19-26"></a>      <span class="at">x =</span> days_since_rain,</span>
<span id="cb19-27"><a href="#cb19-27"></a>      <span class="at">ymin =</span> pred_prob <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_se,</span>
<span id="cb19-28"><a href="#cb19-28"></a>      <span class="at">ymax =</span> pred_prob <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_se</span>
<span id="cb19-29"><a href="#cb19-29"></a>    ),</span>
<span id="cb19-30"><a href="#cb19-30"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb19-31"><a href="#cb19-31"></a>    <span class="at">fill =</span> <span class="st">"firebrick"</span></span>
<span id="cb19-32"><a href="#cb19-32"></a>  ) <span class="sc">+</span></span>
<span id="cb19-33"><a href="#cb19-33"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb19-34"><a href="#cb19-34"></a>    <span class="at">data =</span> pred_data,</span>
<span id="cb19-35"><a href="#cb19-35"></a>    <span class="fu">aes</span>(<span class="at">x =</span> days_since_rain, <span class="at">y =</span> pred_prob),</span>
<span id="cb19-36"><a href="#cb19-36"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span>,</span>
<span id="cb19-37"><a href="#cb19-37"></a>    <span class="at">size =</span> <span class="fl">1.2</span>,</span>
<span id="cb19-38"><a href="#cb19-38"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb19-39"><a href="#cb19-39"></a>  ) <span class="sc">+</span></span>
<span id="cb19-40"><a href="#cb19-40"></a>  <span class="fu">geom_pointrange</span>(</span>
<span id="cb19-41"><a href="#cb19-41"></a>    <span class="at">data =</span> empirical_probs,</span>
<span id="cb19-42"><a href="#cb19-42"></a>    <span class="fu">aes</span>(</span>
<span id="cb19-43"><a href="#cb19-43"></a>      <span class="at">x =</span> days_since_rain,</span>
<span id="cb19-44"><a href="#cb19-44"></a>      <span class="at">y =</span> prob_rain,</span>
<span id="cb19-45"><a href="#cb19-45"></a>      <span class="at">ymin =</span> prob_rain <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb19-46"><a href="#cb19-46"></a>      <span class="at">ymax =</span> prob_rain <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se</span>
<span id="cb19-47"><a href="#cb19-47"></a>    ),</span>
<span id="cb19-48"><a href="#cb19-48"></a>    <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb19-49"><a href="#cb19-49"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb19-50"><a href="#cb19-50"></a>  ) <span class="sc">+</span></span>
<span id="cb19-51"><a href="#cb19-51"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb19-52"><a href="#cb19-52"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="dv">1</span>),</span>
<span id="cb19-53"><a href="#cb19-53"></a>    <span class="at">breaks =</span> <span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">6</span>)</span>
<span id="cb19-54"><a href="#cb19-54"></a>  ) <span class="sc">+</span></span>
<span id="cb19-55"><a href="#cb19-55"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>()) <span class="sc">+</span></span>
<span id="cb19-56"><a href="#cb19-56"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-57"><a href="#cb19-57"></a>    <span class="at">x =</span> <span class="st">"Days Since Last Rain"</span>,</span>
<span id="cb19-58"><a href="#cb19-58"></a>    <span class="at">y =</span> <span class="st">"Probability of Rainfall"</span>,</span>
<span id="cb19-59"><a href="#cb19-59"></a>    <span class="at">title =</span> <span class="st">"Dry Spell Effect on Rain Probability"</span>,</span>
<span id="cb19-60"><a href="#cb19-60"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(</span>
<span id="cb19-61"><a href="#cb19-61"></a>      <span class="st">"Logistic Regression: B = %.4f, Wald chi2 = %.2f, p &lt; 0.001</span><span class="sc">\n</span><span class="st">Each additional dry day reduces odds of rain by %.1f%%"</span>,</span>
<span id="cb19-62"><a href="#cb19-62"></a>      <span class="fu">coef</span>(logit_model)[<span class="dv">2</span>],</span>
<span id="cb19-63"><a href="#cb19-63"></a>      wald_test<span class="sc">$</span>result<span class="sc">$</span>chi2[<span class="dv">1</span>],</span>
<span id="cb19-64"><a href="#cb19-64"></a>      (<span class="dv">1</span> <span class="sc">-</span> or_results<span class="sc">$</span>estimate) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb19-65"><a href="#cb19-65"></a>    ),</span>
<span id="cb19-66"><a href="#cb19-66"></a>    <span class="at">caption =</span> <span class="st">"Points: Empirical probabilities +/- 95% CI | Line: Logistic model fit"</span></span>
<span id="cb19-67"><a href="#cb19-67"></a>  ) <span class="sc">+</span></span>
<span id="cb19-68"><a href="#cb19-68"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-dry-spell" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dry-spell-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-dry-spell-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dry-spell-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: The drying effect: empirical vs.&nbsp;modelled probability of rainfall by days since last rain. The rapid initial decline followed by a plateau motivates a spline parameterisation rather than a linear logistic term.
</figcaption>
</figure>
</div>
</div>
</div>
<p>A logistic regression of daily rain occurrence on <code>days_since_rain</code> yields <span class="math inline">\(OR = 0.835\)</span> (Wald <span class="math inline">\(\chi^2 \approx 8099\)</span>, <span class="math inline">\(p &lt; 0.001\)</span>): each additional dry day reduces the odds of rainfall by approximately 16.5%. This is consistent with the progressive establishment of stable high-pressure ridges documented in the Markov analysis.</p>
<p>The linear model is however an approximation. The LRT against a four-knot natural spline is highly significant (<span class="math inline">\(\chi^2 \approx 7678\)</span>, <span class="math inline">\(p &lt; 0.001\)</span>). The empirical pattern (<a href="#fig-dry-spell" class="quarto-xref">Figure&nbsp;<span>3.3</span></a>) shows rain probability falling sharply from approximately 48% on Day 1 to around 18% by Day 10, then plateauing in the 12–16% range through Days 15 to 30. The linear model underestimates the initial steepness and overestimates long-drought decline rates. This “rapid-then-gradual” decay motivates a spline parameterisation of <code>days_since_rain</code> rather than a simple linear term.</p>
<hr>
</section>
</section>
<section id="atmospheric-pressure-dynamics" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="atmospheric-pressure-dynamics"><span class="header-section-number">3.6</span> Atmospheric Pressure Dynamics</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>pressure_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">mutate</span>(<span class="at">pressure_change =</span> pressure3pm <span class="sc">-</span> pressure9am) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">select</span>(rain_today, pressure9am, pressure3pm, pressure_change) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pressure9am), <span class="sc">!</span><span class="fu">is.na</span>(rain_today))</span>
<span id="cb20-5"><a href="#cb20-5"></a></span>
<span id="cb20-6"><a href="#cb20-6"></a>pressure_data <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7"></a>  <span class="fu">sample_n</span>(<span class="dv">5000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb20-9"><a href="#cb20-9"></a>    <span class="at">cols =</span> <span class="fu">c</span>(pressure9am, pressure3pm, pressure_change),</span>
<span id="cb20-10"><a href="#cb20-10"></a>    <span class="at">names_to =</span> <span class="st">"metric"</span>,</span>
<span id="cb20-11"><a href="#cb20-11"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb20-12"><a href="#cb20-12"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="#cb20-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> value)) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14"></a>  <span class="fu">stat_qq</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-18"><a href="#cb20-18"></a>    <span class="at">title =</span> <span class="st">"Q-Q Plots: Normality Check for Pressure Variables"</span>,</span>
<span id="cb20-19"><a href="#cb20-19"></a>    <span class="at">subtitle =</span> <span class="st">"Modest tail deviations acceptable at N &gt; 140,000 (CLT applies)."</span></span>
<span id="cb20-20"><a href="#cb20-20"></a>  ) <span class="sc">+</span></span>
<span id="cb20-21"><a href="#cb20-21"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-eda_files/figure-html/pressure-prep-normality-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>test_data <span class="ot">&lt;-</span> pressure_data <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb21-3"><a href="#cb21-3"></a>    <span class="at">cols =</span> <span class="fu">c</span>(pressure9am, pressure3pm, pressure_change),</span>
<span id="cb21-4"><a href="#cb21-4"></a>    <span class="at">names_to =</span> <span class="st">"metric"</span>,</span>
<span id="cb21-5"><a href="#cb21-5"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>  )</span>
<span id="cb21-7"><a href="#cb21-7"></a></span>
<span id="cb21-8"><a href="#cb21-8"></a>stats_results <span class="ot">&lt;-</span> test_data <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="#cb21-9"></a>  <span class="fu">group_by</span>(metric) <span class="sc">%&gt;%</span></span>
<span id="cb21-10"><a href="#cb21-10"></a>  <span class="fu">t_test</span>(value <span class="sc">~</span> rain_today, <span class="at">var.equal =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-11"><a href="#cb21-11"></a>  <span class="fu">adjust_pvalue</span>(<span class="at">method =</span> <span class="st">"holm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-12"><a href="#cb21-12"></a>  <span class="fu">add_significance</span>()</span>
<span id="cb21-13"><a href="#cb21-13"></a></span>
<span id="cb21-14"><a href="#cb21-14"></a>stats_results <span class="sc">%&gt;%</span></span>
<span id="cb21-15"><a href="#cb21-15"></a>  <span class="fu">select</span>(metric, group1, group2, statistic, df, p.adj, p.adj.signif) <span class="sc">%&gt;%</span></span>
<span id="cb21-16"><a href="#cb21-16"></a>  <span class="fu">kable</span>(</span>
<span id="cb21-17"><a href="#cb21-17"></a>    <span class="at">caption =</span> <span class="st">"Welch Two-Sample t-test Results (Bonferroni-Holm Corrected)"</span>,</span>
<span id="cb21-18"><a href="#cb21-18"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb21-19"><a href="#cb21-19"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb21-20"><a href="#cb21-20"></a>      <span class="st">"Metric"</span>,</span>
<span id="cb21-21"><a href="#cb21-21"></a>      <span class="st">"Group 1"</span>,</span>
<span id="cb21-22"><a href="#cb21-22"></a>      <span class="st">"Group 2"</span>,</span>
<span id="cb21-23"><a href="#cb21-23"></a>      <span class="st">"t-statistic"</span>,</span>
<span id="cb21-24"><a href="#cb21-24"></a>      <span class="st">"df"</span>,</span>
<span id="cb21-25"><a href="#cb21-25"></a>      <span class="st">"Adj. P-Value"</span>,</span>
<span id="cb21-26"><a href="#cb21-26"></a>      <span class="st">"Significance"</span></span>
<span id="cb21-27"><a href="#cb21-27"></a>    )</span>
<span id="cb21-28"><a href="#cb21-28"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-29"><a href="#cb21-29"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Welch Two-Sample t-test Results (Bonferroni-Holm Corrected)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Group 1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Group 2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t-statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Adj. P-Value</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Significance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">pressure3pm</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">42.016</td>
<td style="text-align: right;">47512.35</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="even">
<td style="text-align: left;">pressure9am</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">72.192</td>
<td style="text-align: right;">47290.28</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pressure_change</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">-105.393</td>
<td style="text-align: right;">44171.84</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">****</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>effect_sizes <span class="ot">&lt;-</span> test_data <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">group_by</span>(metric) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">cohens_d</span>(value <span class="sc">~</span> rain_today, <span class="at">var.equal =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-5"><a href="#cb22-5"></a>    <span class="at">magnitude =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-6"><a href="#cb22-6"></a>      <span class="fu">abs</span>(effsize) <span class="sc">&lt;</span> <span class="fl">0.2</span> <span class="sc">~</span> <span class="st">"Negligible"</span>,</span>
<span id="cb22-7"><a href="#cb22-7"></a>      <span class="fu">abs</span>(effsize) <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Small"</span>,</span>
<span id="cb22-8"><a href="#cb22-8"></a>      <span class="fu">abs</span>(effsize) <span class="sc">&lt;</span> <span class="fl">0.8</span> <span class="sc">~</span> <span class="st">"Medium"</span>,</span>
<span id="cb22-9"><a href="#cb22-9"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Large"</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>    )</span>
<span id="cb22-11"><a href="#cb22-11"></a>  )</span>
<span id="cb22-12"><a href="#cb22-12"></a></span>
<span id="cb22-13"><a href="#cb22-13"></a>effect_sizes <span class="sc">%&gt;%</span></span>
<span id="cb22-14"><a href="#cb22-14"></a>  <span class="fu">select</span>(metric, effsize, magnitude) <span class="sc">%&gt;%</span></span>
<span id="cb22-15"><a href="#cb22-15"></a>  <span class="fu">kable</span>(</span>
<span id="cb22-16"><a href="#cb22-16"></a>    <span class="at">caption =</span> <span class="st">"Cohen's d Effect Size Analysis"</span>,</span>
<span id="cb22-17"><a href="#cb22-17"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb22-18"><a href="#cb22-18"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Effect Size (d)"</span>, <span class="st">"Interpretation"</span>)</span>
<span id="cb22-19"><a href="#cb22-19"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-20"><a href="#cb22-20"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Cohen's d Effect Size Analysis</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Metric</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Effect Size (d)</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">pressure3pm</td>
<td style="text-align: right;">0.275</td>
<td style="text-align: left;">Small</td>
</tr>
<tr class="even">
<td style="text-align: left;">pressure9am</td>
<td style="text-align: right;">0.474</td>
<td style="text-align: left;">Small</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pressure_change</td>
<td style="text-align: right;">-0.711</td>
<td style="text-align: left;">Medium</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>plot_annotations <span class="ot">&lt;-</span> stats_results <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">left_join</span>(effect_sizes, <span class="at">by =</span> <span class="st">"metric"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-4"><a href="#cb23-4"></a>    <span class="at">label_text =</span> <span class="fu">sprintf</span>(</span>
<span id="cb23-5"><a href="#cb23-5"></a>      <span class="st">"p %s</span><span class="sc">\n</span><span class="st">Cohen's d = %.2f (%s)"</span>,</span>
<span id="cb23-6"><a href="#cb23-6"></a>      p.adj.signif,</span>
<span id="cb23-7"><a href="#cb23-7"></a>      effsize,</span>
<span id="cb23-8"><a href="#cb23-8"></a>      magnitude</span>
<span id="cb23-9"><a href="#cb23-9"></a>    ),</span>
<span id="cb23-10"><a href="#cb23-10"></a>    <span class="at">y_pos =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-11"><a href="#cb23-11"></a>      metric <span class="sc">==</span> <span class="st">"pressure9am"</span> <span class="sc">~</span> <span class="dv">1045</span>,</span>
<span id="cb23-12"><a href="#cb23-12"></a>      metric <span class="sc">==</span> <span class="st">"pressure3pm"</span> <span class="sc">~</span> <span class="dv">1040</span>,</span>
<span id="cb23-13"><a href="#cb23-13"></a>      metric <span class="sc">==</span> <span class="st">"pressure_change"</span> <span class="sc">~</span> <span class="dv">15</span></span>
<span id="cb23-14"><a href="#cb23-14"></a>    )</span>
<span id="cb23-15"><a href="#cb23-15"></a>  )</span>
<span id="cb23-16"><a href="#cb23-16"></a></span>
<span id="cb23-17"><a href="#cb23-17"></a><span class="fu">ggplot</span>(test_data, <span class="fu">aes</span>(rain_today, value, <span class="at">fill =</span> rain_today)) <span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb23-19"><a href="#cb23-19"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb23-20"><a href="#cb23-20"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb23-21"><a href="#cb23-21"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb23-22"><a href="#cb23-22"></a>    <span class="at">data =</span> plot_annotations,</span>
<span id="cb23-23"><a href="#cb23-23"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> y_pos, <span class="at">label =</span> label_text),</span>
<span id="cb23-24"><a href="#cb23-24"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-25"><a href="#cb23-25"></a>    <span class="at">vjust =</span> <span class="dv">0</span>,</span>
<span id="cb23-26"><a href="#cb23-26"></a>    <span class="at">fontface =</span> <span class="st">"italic"</span>,</span>
<span id="cb23-27"><a href="#cb23-27"></a>    <span class="at">size =</span> <span class="fl">3.5</span></span>
<span id="cb23-28"><a href="#cb23-28"></a>  ) <span class="sc">+</span></span>
<span id="cb23-29"><a href="#cb23-29"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#B0B0B0"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>)) <span class="sc">+</span></span>
<span id="cb23-30"><a href="#cb23-30"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-31"><a href="#cb23-31"></a>    <span class="at">title =</span> <span class="st">"Atmospheric Pressure vs. Rainfall"</span>,</span>
<span id="cb23-32"><a href="#cb23-32"></a>    <span class="at">subtitle =</span> <span class="st">"Welch's t-test with Cohen's d effect sizes"</span>,</span>
<span id="cb23-33"><a href="#cb23-33"></a>    <span class="at">y =</span> <span class="st">"Pressure (hPa)"</span>,</span>
<span id="cb23-34"><a href="#cb23-34"></a>    <span class="at">x =</span> <span class="st">"Did it rain?"</span></span>
<span id="cb23-35"><a href="#cb23-35"></a>  ) <span class="sc">+</span></span>
<span id="cb23-36"><a href="#cb23-36"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-37"><a href="#cb23-37"></a>  <span class="fu">theme</span>(</span>
<span id="cb23-38"><a href="#cb23-38"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb23-39"><a href="#cb23-39"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb23-40"><a href="#cb23-40"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-pressure-violin" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pressure-violin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-pressure-violin-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pressure-violin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: Violin plots of atmospheric pressure variables by rainfall state. The pressure_change panel shows the most pronounced separation.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>data_wide <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">group_by</span>(rain_today) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">summarise</span>(</span>
<span id="cb24-4"><a href="#cb24-4"></a>    <span class="st">`</span><span class="at">9:00 AM</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(pressure9am, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-5"><a href="#cb24-5"></a>    <span class="st">`</span><span class="at">3:00 PM</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(pressure3pm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-6"><a href="#cb24-6"></a>    <span class="st">`</span><span class="at">Pressure Drop</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(pressure9am, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>      <span class="fu">mean</span>(pressure3pm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-8"><a href="#cb24-8"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="#cb24-9"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>rain_today, <span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-11"><a href="#cb24-11"></a>    <span class="at">metric =</span> <span class="fu">factor</span>(metric, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"9:00 AM"</span>, <span class="st">"3:00 PM"</span>, <span class="st">"Pressure Drop"</span>)),</span>
<span id="cb24-12"><a href="#cb24-12"></a>    <span class="at">label_txt =</span> <span class="fu">round</span>(value, <span class="dv">1</span>)</span>
<span id="cb24-13"><a href="#cb24-13"></a>  )</span>
<span id="cb24-14"><a href="#cb24-14"></a></span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="fu">ggplot</span>(data_wide, <span class="fu">aes</span>(<span class="at">x =</span> rain_today, <span class="at">y =</span> value, <span class="at">fill =</span> rain_today)) <span class="sc">+</span></span>
<span id="cb24-16"><a href="#cb24-16"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb24-17"><a href="#cb24-17"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label_txt), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb24-18"><a href="#cb24-18"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb24-19"><a href="#cb24-19"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#B0B0B0"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>)) <span class="sc">+</span></span>
<span id="cb24-20"><a href="#cb24-20"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"Dry Days"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"Rainy Days"</span>)) <span class="sc">+</span></span>
<span id="cb24-21"><a href="#cb24-21"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-22"><a href="#cb24-22"></a>    <span class="at">title =</span> <span class="st">"Rainy Days Show Lower Baseline Pressure and Suppressed Diurnal Variation"</span>,</span>
<span id="cb24-23"><a href="#cb24-23"></a>    <span class="at">subtitle =</span> <span class="st">"The diurnal pressure drop is the stronger discriminating signal"</span>,</span>
<span id="cb24-24"><a href="#cb24-24"></a>    <span class="at">y =</span> <span class="st">"Pressure (hPa) / Drop (hPa)"</span>,</span>
<span id="cb24-25"><a href="#cb24-25"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb24-26"><a href="#cb24-26"></a>  ) <span class="sc">+</span></span>
<span id="cb24-27"><a href="#cb24-27"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb24-28"><a href="#cb24-28"></a>  <span class="fu">theme</span>(</span>
<span id="cb24-29"><a href="#cb24-29"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb24-30"><a href="#cb24-30"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb24-31"><a href="#cb24-31"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb24-32"><a href="#cb24-32"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb24-33"><a href="#cb24-33"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb24-34"><a href="#cb24-34"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-pressure-means" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pressure-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-pressure-means-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pressure-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.5: Mean pressure levels and diurnal drop by rainfall state. The suppressed pressure drop on rainy days (1.3 vs.&nbsp;2.7 hPa) is a stronger discriminating signal than the absolute pressure baseline.
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Normality.</strong> Q-Q plots show modest tail deviations, but with <span class="math inline">\(N &gt; 140,000\)</span> the CLT ensures normally distributed sample means. Welch’s t-test is therefore valid without equal-variance assumptions, and Bonferroni-Holm correction is applied for multiple comparisons.</p>
<p><strong>Baseline pressure.</strong> Rainy days show mean pressure of 1015 hPa at 9:00 AM versus 1018.5 hPa on dry days. Cohen’s <span class="math inline">\(d \approx 0.28\)</span>–<span class="math inline">\(0.48\)</span> represents a small-to-medium effect, consistent with absolute pressure being necessary but not sufficient for rain.</p>
<p><strong>Diurnal pressure change.</strong> On dry days, pressure drops 2.7 hPa from morning to afternoon, the standard thermal low from daytime surface heating. On rainy days, this drop is suppressed to 1.3 hPa, because cloud cover reduces insolation. Cohen’s <span class="math inline">\(d = -0.72\)</span> for <code>pressure_change</code> is a medium effect, stronger than either absolute pressure reading individually. The rate of pressure change during the day is the more discriminating feature.</p>
<hr>
</section>
<section id="seasonal-rainfall-intensity" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="seasonal-rainfall-intensity"><span class="header-section-number">3.7</span> Seasonal Rainfall Intensity</h2>
<section id="cyclical-patterns" class="level3" data-number="3.7.1">
<h3 data-number="3.7.1" class="anchored" data-anchor-id="cyclical-patterns"><span class="header-section-number">3.7.1</span> Cyclical Patterns</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>monthly_stats <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="fu">group_by</span>(month) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4"></a>  <span class="fu">summarise</span>(</span>
<span id="cb25-5"><a href="#cb25-5"></a>    <span class="at">median_rain =</span> <span class="fu">median</span>(rainfall),</span>
<span id="cb25-6"><a href="#cb25-6"></a>    <span class="at">mean_rain =</span> <span class="fu">mean</span>(rainfall),</span>
<span id="cb25-7"><a href="#cb25-7"></a>    <span class="at">rain_days =</span> <span class="fu">n</span>(),</span>
<span id="cb25-8"><a href="#cb25-8"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb25-9"><a href="#cb25-9"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>  <span class="fu">mutate</span>(<span class="at">month_label =</span> <span class="fu">factor</span>(month.abb[month], <span class="at">levels =</span> <span class="fu">rev</span>(month.abb)))</span>
<span id="cb25-11"><a href="#cb25-11"></a></span>
<span id="cb25-12"><a href="#cb25-12"></a>plot_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb25-13"><a href="#cb25-13"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-14"><a href="#cb25-14"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-15"><a href="#cb25-15"></a>    <span class="at">month_label =</span> <span class="fu">factor</span>(month.abb[month], <span class="at">levels =</span> <span class="fu">rev</span>(month.abb)),</span>
<span id="cb25-16"><a href="#cb25-16"></a>    <span class="at">log_rain =</span> <span class="fu">log</span>(rainfall)</span>
<span id="cb25-17"><a href="#cb25-17"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-18"><a href="#cb25-18"></a>  <span class="fu">left_join</span>(monthly_stats, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"month"</span>, <span class="st">"month_label"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(log_rain, month_label, <span class="at">fill =</span> <span class="fu">after_stat</span>(x))) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">geom_density_ridges_gradient</span>(</span>
<span id="cb26-3"><a href="#cb26-3"></a>    <span class="at">scale =</span> <span class="fl">2.5</span>,</span>
<span id="cb26-4"><a href="#cb26-4"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.01</span>,</span>
<span id="cb26-5"><a href="#cb26-5"></a>    <span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-6"><a href="#cb26-6"></a>    <span class="at">quantiles =</span> <span class="dv">2</span>,</span>
<span id="cb26-7"><a href="#cb26-7"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>  ) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb26-10"><a href="#cb26-10"></a>    <span class="at">xintercept =</span> <span class="fu">median</span>(<span class="fu">log</span>(df_final<span class="sc">$</span>rainfall[df_final<span class="sc">$</span>rainfall <span class="sc">&gt;</span> <span class="dv">0</span>])),</span>
<span id="cb26-11"><a href="#cb26-11"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb26-12"><a href="#cb26-12"></a>    <span class="at">color =</span> <span class="st">"grey30"</span>,</span>
<span id="cb26-13"><a href="#cb26-13"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span></span>
<span id="cb26-14"><a href="#cb26-14"></a>  ) <span class="sc">+</span></span>
<span id="cb26-15"><a href="#cb26-15"></a>  <span class="fu">scale_fill_viridis_c</span>(</span>
<span id="cb26-16"><a href="#cb26-16"></a>    <span class="at">option =</span> <span class="st">"mako"</span>,</span>
<span id="cb26-17"><a href="#cb26-17"></a>    <span class="at">name =</span> <span class="st">"Log</span><span class="sc">\n</span><span class="st">Rainfall"</span>,</span>
<span id="cb26-18"><a href="#cb26-18"></a>    <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb26-19"><a href="#cb26-19"></a>  ) <span class="sc">+</span></span>
<span id="cb26-20"><a href="#cb26-20"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">pretty_breaks</span>()) <span class="sc">+</span></span>
<span id="cb26-21"><a href="#cb26-21"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-22"><a href="#cb26-22"></a>    <span class="at">title =</span> <span class="st">"Monthly Rainfall Distribution Patterns"</span>,</span>
<span id="cb26-23"><a href="#cb26-23"></a>    <span class="at">subtitle =</span> <span class="st">"Solid lines mark monthly medians vs. the global median (dashed)."</span>,</span>
<span id="cb26-24"><a href="#cb26-24"></a>    <span class="at">x =</span> <span class="st">"Rainfall Amount (mm, log scale)"</span>,</span>
<span id="cb26-25"><a href="#cb26-25"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb26-26"><a href="#cb26-26"></a>  ) <span class="sc">+</span></span>
<span id="cb26-27"><a href="#cb26-27"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-monthly-dist" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-monthly-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-monthly-dist-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-monthly-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.6: Ridgeline plot of monthly log-rainfall distributions. Shifting peaks illustrate how rainfall intensity varies cyclically relative to the global median (dashed line).
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>seasonal_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-4"><a href="#cb27-4"></a>    <span class="at">season =</span> <span class="fu">case_when</span>(</span>
<span id="cb27-5"><a href="#cb27-5"></a>      month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">~</span> <span class="st">"Summer"</span>,</span>
<span id="cb27-6"><a href="#cb27-6"></a>      month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>) <span class="sc">~</span> <span class="st">"Autumn"</span>,</span>
<span id="cb27-7"><a href="#cb27-7"></a>      month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>) <span class="sc">~</span> <span class="st">"Winter"</span>,</span>
<span id="cb27-8"><a href="#cb27-8"></a>      month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>) <span class="sc">~</span> <span class="st">"Spring"</span></span>
<span id="cb27-9"><a href="#cb27-9"></a>    ),</span>
<span id="cb27-10"><a href="#cb27-10"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Summer"</span>, <span class="st">"Autumn"</span>, <span class="st">"Winter"</span>, <span class="st">"Spring"</span>))</span>
<span id="cb27-11"><a href="#cb27-11"></a>  )</span>
<span id="cb27-12"><a href="#cb27-12"></a></span>
<span id="cb27-13"><a href="#cb27-13"></a>seasonal_data <span class="sc">%&gt;%</span></span>
<span id="cb27-14"><a href="#cb27-14"></a>  <span class="fu">mutate</span>(<span class="at">month_label =</span> <span class="fu">factor</span>(month.abb[month], <span class="at">levels =</span> month.abb)) <span class="sc">%&gt;%</span></span>
<span id="cb27-15"><a href="#cb27-15"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(rainfall, month_label, <span class="at">fill =</span> season)) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb27-17"><a href="#cb27-17"></a>    <span class="at">scale =</span> <span class="fl">1.5</span>,</span>
<span id="cb27-18"><a href="#cb27-18"></a>    <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb27-19"><a href="#cb27-19"></a>    <span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-20"><a href="#cb27-20"></a>    <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)</span>
<span id="cb27-21"><a href="#cb27-21"></a>  ) <span class="sc">+</span></span>
<span id="cb27-22"><a href="#cb27-22"></a>  <span class="fu">scale_x_log10</span>(</span>
<span id="cb27-23"><a href="#cb27-23"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">300</span>),</span>
<span id="cb27-24"><a href="#cb27-24"></a>    <span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb27-25"><a href="#cb27-25"></a>  ) <span class="sc">+</span></span>
<span id="cb27-26"><a href="#cb27-26"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb27-27"><a href="#cb27-27"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb27-28"><a href="#cb27-28"></a>      <span class="st">"Summer"</span> <span class="ot">=</span> <span class="st">"#E69F00"</span>,</span>
<span id="cb27-29"><a href="#cb27-29"></a>      <span class="st">"Autumn"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>,</span>
<span id="cb27-30"><a href="#cb27-30"></a>      <span class="st">"Winter"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>,</span>
<span id="cb27-31"><a href="#cb27-31"></a>      <span class="st">"Spring"</span> <span class="ot">=</span> <span class="st">"#009E73"</span></span>
<span id="cb27-32"><a href="#cb27-32"></a>    )</span>
<span id="cb27-33"><a href="#cb27-33"></a>  ) <span class="sc">+</span></span>
<span id="cb27-34"><a href="#cb27-34"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>season, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb27-35"><a href="#cb27-35"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-36"><a href="#cb27-36"></a>    <span class="at">title =</span> <span class="st">"Seasonal Rainfall Patterns"</span>,</span>
<span id="cb27-37"><a href="#cb27-37"></a>    <span class="at">subtitle =</span> <span class="st">"Quartile lines show 25th, 50th, and 75th percentiles"</span>,</span>
<span id="cb27-38"><a href="#cb27-38"></a>    <span class="at">x =</span> <span class="st">"Rainfall Amount (mm, log scale)"</span>,</span>
<span id="cb27-39"><a href="#cb27-39"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb27-40"><a href="#cb27-40"></a>  ) <span class="sc">+</span></span>
<span id="cb27-41"><a href="#cb27-41"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-seasonal-facet" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-seasonal-facet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-seasonal-facet-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-seasonal-facet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.7: Seasonal rainfall patterns by meteorological season. Summer exhibits high variance and a pronounced right tail; winter shows narrower, more predictable distributions.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>monthly_stats <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>  <span class="fu">mutate</span>(<span class="at">month_label =</span> <span class="fu">factor</span>(month.abb[month], <span class="at">levels =</span> month.abb)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(month_label, mean_rain)) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> mean_rain, <span class="at">alpha =</span> <span class="fl">0.8</span>), <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb28-6"><a href="#cb28-6"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(mean_rain, <span class="dv">1</span>)),</span>
<span id="cb28-7"><a href="#cb28-7"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb28-8"><a href="#cb28-8"></a>    <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb28-9"><a href="#cb28-9"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span></span>
<span id="cb28-10"><a href="#cb28-10"></a>  ) <span class="sc">+</span></span>
<span id="cb28-11"><a href="#cb28-11"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"mako"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-12"><a href="#cb28-12"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-13"><a href="#cb28-13"></a>    <span class="at">title =</span> <span class="st">"Mean Rainfall by Month (Non-Zero Days)"</span>,</span>
<span id="cb28-14"><a href="#cb28-14"></a>    <span class="at">subtitle =</span> <span class="st">"Seasonal variation in intensity is distinct from seasonal variation in frequency"</span>,</span>
<span id="cb28-15"><a href="#cb28-15"></a>    <span class="at">y =</span> <span class="st">"Mean Rainfall (mm)"</span>,</span>
<span id="cb28-16"><a href="#cb28-16"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb28-17"><a href="#cb28-17"></a>  ) <span class="sc">+</span></span>
<span id="cb28-18"><a href="#cb28-18"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb28-19"><a href="#cb28-19"></a>  <span class="fu">theme</span>(</span>
<span id="cb28-20"><a href="#cb28-20"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb28-21"><a href="#cb28-21"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb28-22"><a href="#cb28-22"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb28-23"><a href="#cb28-23"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb28-24"><a href="#cb28-24"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mean-rain-bar" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mean-rain-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-mean-rain-bar-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mean-rain-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.8: Average rainfall intensity on non-zero days by month. February records the highest mean intensity at 10.1 mm, nearly double July’s 4.9 mm.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The earlier frequency analysis (<a href="#sec-frequency" class="quarto-xref"><span>Section 3.5.1</span></a>) established <em>when</em> rain tends to occur. This section investigates <em>how much</em> falls when it does.</p>
<p>January and February distributions are shifted systematically right of the global median: summer storms are considerably more intense when they arrive, even though they occur less frequently. June through August cluster left, representing lower but more consistent rainfall. February records the highest mean intensity per wet day at 10.1 mm, nearly double July’s 4.9 mm.</p>
<p>Summer rainfall has a wide interquartile range and a pronounced right tail beyond 100 mm per day, reflecting episodic convective storms. Winter shows a narrower, more peaked distribution. Both the frequency variation (more rain in winter) and the intensity variation (heavier rain in summer) carry independent information; a complete model must account for both dimensions.</p>
<p><strong>Encoding implication.</strong> Because the seasonal cycle is continuous the transition from December to January is climatologically smooth treating <code>Month</code> as unordered discards proximity information. Cyclical encoding via sine and cosine transformations of the month number preserves the circular geometry of the annual cycle.</p>
</section>
<section id="statistical-validation" class="level3" data-number="3.7.2">
<h3 data-number="3.7.2" class="anchored" data-anchor-id="statistical-validation"><span class="header-section-number">3.7.2</span> Statistical Validation</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>seasonal_data <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">select</span>(season, rainfall) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">group_by</span>(season) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>  <span class="fu">get_summary_stats</span>(rainfall, <span class="at">type =</span> <span class="st">"mean_sd"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>  <span class="fu">kable</span>(</span>
<span id="cb29-6"><a href="#cb29-6"></a>    <span class="at">caption =</span> <span class="st">"Descriptive Statistics of Rainfall Intensity by Season"</span>,</span>
<span id="cb29-7"><a href="#cb29-7"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Season"</span>, <span class="st">"Variable"</span>, <span class="st">"N (Events)"</span>, <span class="st">"Mean (mm)"</span>, <span class="st">"SD (mm)"</span>)</span>
<span id="cb29-8"><a href="#cb29-8"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-9"><a href="#cb29-9"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Descriptive Statistics of Rainfall Intensity by Season</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Season</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N (Events)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean (mm)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD (mm)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Summer</td>
<td style="text-align: left;">rainfall</td>
<td style="text-align: right;">10571</td>
<td style="text-align: right;">9.070</td>
<td style="text-align: right;">18.195</td>
</tr>
<tr class="even">
<td style="text-align: left;">Autumn</td>
<td style="text-align: left;">rainfall</td>
<td style="text-align: right;">13382</td>
<td style="text-align: right;">6.667</td>
<td style="text-align: right;">13.495</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Winter</td>
<td style="text-align: left;">rainfall</td>
<td style="text-align: right;">15402</td>
<td style="text-align: right;">5.463</td>
<td style="text-align: right;">9.809</td>
</tr>
<tr class="even">
<td style="text-align: left;">Spring</td>
<td style="text-align: left;">rainfall</td>
<td style="text-align: right;">11764</td>
<td style="text-align: right;">5.651</td>
<td style="text-align: right;">10.495</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>kw_result <span class="ot">&lt;-</span> <span class="fu">kruskal_test</span>(rainfall <span class="sc">~</span> season, <span class="at">data =</span> seasonal_data)</span>
<span id="cb30-2"><a href="#cb30-2"></a>epsilon_sq <span class="ot">&lt;-</span> <span class="fu">kruskal_effsize</span>(rainfall <span class="sc">~</span> season, <span class="at">data =</span> seasonal_data)</span>
<span id="cb30-3"><a href="#cb30-3"></a></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="fu">tibble</span>(</span>
<span id="cb30-5"><a href="#cb30-5"></a>  <span class="at">Test =</span> <span class="st">"Kruskal-Wallis Rank Sum Test"</span>,</span>
<span id="cb30-6"><a href="#cb30-6"></a>  <span class="st">`</span><span class="at">Chi-squared</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(kw_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb30-7"><a href="#cb30-7"></a>  <span class="at">df =</span> kw_result<span class="sc">$</span>df,</span>
<span id="cb30-8"><a href="#cb30-8"></a>  <span class="st">`</span><span class="at">P-value</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(kw_result<span class="sc">$</span>p, <span class="at">accuracy =</span> <span class="fl">0.001</span>),</span>
<span id="cb30-9"><a href="#cb30-9"></a>  <span class="st">`</span><span class="at">Effect Size</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(epsilon_sq<span class="sc">$</span>effsize, <span class="dv">4</span>),</span>
<span id="cb30-10"><a href="#cb30-10"></a>  <span class="at">Magnitude =</span> <span class="fu">as.character</span>(epsilon_sq<span class="sc">$</span>magnitude)</span>
<span id="cb30-11"><a href="#cb30-11"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb30-12"><a href="#cb30-12"></a>  <span class="fu">kable</span>(</span>
<span id="cb30-13"><a href="#cb30-13"></a>    <span class="at">caption =</span> <span class="st">"Statistical Significance of Seasonal Differences (Non-Parametric)"</span>,</span>
<span id="cb30-14"><a href="#cb30-14"></a>    <span class="at">align =</span> <span class="st">"lccccr"</span></span>
<span id="cb30-15"><a href="#cb30-15"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb30-16"><a href="#cb30-16"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb30-17"><a href="#cb30-17"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb30-18"><a href="#cb30-18"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb30-19"><a href="#cb30-19"></a>    <span class="at">position =</span> <span class="st">"left"</span></span>
<span id="cb30-20"><a href="#cb30-20"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb30-21"><a href="#cb30-21"></a>  <span class="fu">add_footnote</span>(</span>
<span id="cb30-22"><a href="#cb30-22"></a>    <span class="fu">c</span>(<span class="st">"Effect size: Epsilon-squared."</span>, <span class="st">"Alpha = 0.05"</span>),</span>
<span id="cb30-23"><a href="#cb30-23"></a>    <span class="at">notation =</span> <span class="st">"symbol"</span></span>
<span id="cb30-24"><a href="#cb30-24"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Statistical Significance of Seasonal Differences (Non-Parametric)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Chi-squared</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">P-value</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Effect Size</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Magnitude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Kruskal-Wallis Rank Sum Test</td>
<td style="text-align: center;">230.44</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">&lt;0.001</td>
<td style="text-align: center;">0.0044</td>
<td style="text-align: right;">small</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0; border: 0;"><sup>*</sup> Effect size: Epsilon-squared.</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0; border: 0;"><sup>†</sup> Alpha = 0.05</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>dunn_result <span class="ot">&lt;-</span> <span class="fu">dunn_test</span>(</span>
<span id="cb31-2"><a href="#cb31-2"></a>  rainfall <span class="sc">~</span> season,</span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="at">data =</span> seasonal_data,</span>
<span id="cb31-4"><a href="#cb31-4"></a>  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>)</span>
<span id="cb31-6"><a href="#cb31-6"></a></span>
<span id="cb31-7"><a href="#cb31-7"></a>dunn_result <span class="sc">%&gt;%</span></span>
<span id="cb31-8"><a href="#cb31-8"></a>  <span class="fu">select</span>(group1, group2, statistic, p.adj, p.adj.signif) <span class="sc">%&gt;%</span></span>
<span id="cb31-9"><a href="#cb31-9"></a>  <span class="fu">kable</span>(</span>
<span id="cb31-10"><a href="#cb31-10"></a>    <span class="at">caption =</span> <span class="st">"Dunn's Pairwise Comparison Test (Bonferroni Corrected)"</span>,</span>
<span id="cb31-11"><a href="#cb31-11"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb31-12"><a href="#cb31-12"></a>      <span class="st">"Group 1"</span>,</span>
<span id="cb31-13"><a href="#cb31-13"></a>      <span class="st">"Group 2"</span>,</span>
<span id="cb31-14"><a href="#cb31-14"></a>      <span class="st">"Z-Statistic"</span>,</span>
<span id="cb31-15"><a href="#cb31-15"></a>      <span class="st">"Adj. P-Value"</span>,</span>
<span id="cb31-16"><a href="#cb31-16"></a>      <span class="st">"Significance"</span></span>
<span id="cb31-17"><a href="#cb31-17"></a>    )</span>
<span id="cb31-18"><a href="#cb31-18"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-19"><a href="#cb31-19"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Dunn's Pairwise Comparison Test (Bonferroni Corrected)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Group 1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Group 2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Z-Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Adj. P-Value</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Significance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Summer</td>
<td style="text-align: left;">Autumn</td>
<td style="text-align: right;">-11.4684561</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="even">
<td style="text-align: left;">Summer</td>
<td style="text-align: left;">Winter</td>
<td style="text-align: right;">-14.4832877</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Summer</td>
<td style="text-align: left;">Spring</td>
<td style="text-align: right;">-11.0494713</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="even">
<td style="text-align: left;">Autumn</td>
<td style="text-align: left;">Winter</td>
<td style="text-align: right;">-2.8512817</td>
<td style="text-align: right;">0.0261260</td>
<td style="text-align: left;">*</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Autumn</td>
<td style="text-align: left;">Spring</td>
<td style="text-align: right;">0.0912015</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: left;">ns</td>
</tr>
<tr class="even">
<td style="text-align: left;">Winter</td>
<td style="text-align: left;">Spring</td>
<td style="text-align: right;">2.8459539</td>
<td style="text-align: right;">0.0265672</td>
<td style="text-align: left;">*</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>p_vals <span class="ot">&lt;-</span> dunn_result<span class="sc">$</span>p.adj</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="fu">names</span>(p_vals) <span class="ot">&lt;-</span> <span class="fu">paste</span>(dunn_result<span class="sc">$</span>group1, dunn_result<span class="sc">$</span>group2, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb32-3"><a href="#cb32-3"></a>letters_vec <span class="ot">&lt;-</span> <span class="fu">multcompLetters</span>(p_vals)<span class="sc">$</span>Letters</span>
<span id="cb32-4"><a href="#cb32-4"></a>letters_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">season =</span> <span class="fu">names</span>(letters_vec), <span class="at">Letter =</span> letters_vec)</span>
<span id="cb32-5"><a href="#cb32-5"></a></span>
<span id="cb32-6"><a href="#cb32-6"></a>seasonal_data <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7"></a>  <span class="fu">group_by</span>(season) <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="#cb32-8"></a>  <span class="fu">summarise</span>(<span class="at">mean_rain =</span> <span class="fu">mean</span>(rainfall, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9"></a>  <span class="fu">left_join</span>(letters_df, <span class="at">by =</span> <span class="st">"season"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="#cb32-10"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> mean_rain, <span class="at">fill =</span> season)) <span class="sc">+</span></span>
<span id="cb32-11"><a href="#cb32-11"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Letter), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb32-13"><a href="#cb32-13"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb32-14"><a href="#cb32-14"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(mean_rain, <span class="dv">1</span>)),</span>
<span id="cb32-15"><a href="#cb32-15"></a>    <span class="at">vjust =</span> <span class="fl">1.5</span>,</span>
<span id="cb32-16"><a href="#cb32-16"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb32-17"><a href="#cb32-17"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb32-18"><a href="#cb32-18"></a>    <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb32-19"><a href="#cb32-19"></a>  ) <span class="sc">+</span></span>
<span id="cb32-20"><a href="#cb32-20"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb32-21"><a href="#cb32-21"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb32-22"><a href="#cb32-22"></a>      <span class="st">"Summer"</span> <span class="ot">=</span> <span class="st">"#E69F00"</span>,</span>
<span id="cb32-23"><a href="#cb32-23"></a>      <span class="st">"Autumn"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>,</span>
<span id="cb32-24"><a href="#cb32-24"></a>      <span class="st">"Winter"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>,</span>
<span id="cb32-25"><a href="#cb32-25"></a>      <span class="st">"Spring"</span> <span class="ot">=</span> <span class="st">"#009E73"</span></span>
<span id="cb32-26"><a href="#cb32-26"></a>    )</span>
<span id="cb32-27"><a href="#cb32-27"></a>  ) <span class="sc">+</span></span>
<span id="cb32-28"><a href="#cb32-28"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-29"><a href="#cb32-29"></a>    <span class="at">title =</span> <span class="st">"Seasonal Rainfall with Statistical Groupings"</span>,</span>
<span id="cb32-30"><a href="#cb32-30"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(</span>
<span id="cb32-31"><a href="#cb32-31"></a>      <span class="st">"Kruskal-Wallis: p &lt; 0.001, Effect Size: %s</span><span class="sc">\n</span><span class="st">Seasons sharing a letter are not significantly different."</span>,</span>
<span id="cb32-32"><a href="#cb32-32"></a>      <span class="fu">as.character</span>(epsilon_sq<span class="sc">$</span>magnitude)</span>
<span id="cb32-33"><a href="#cb32-33"></a>    ),</span>
<span id="cb32-34"><a href="#cb32-34"></a>    <span class="at">y =</span> <span class="st">"Mean Rainfall (mm)"</span>,</span>
<span id="cb32-35"><a href="#cb32-35"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb32-36"><a href="#cb32-36"></a>  ) <span class="sc">+</span></span>
<span id="cb32-37"><a href="#cb32-37"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb32-38"><a href="#cb32-38"></a>  <span class="fu">theme</span>(</span>
<span id="cb32-39"><a href="#cb32-39"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb32-40"><a href="#cb32-40"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb32-41"><a href="#cb32-41"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb32-42"><a href="#cb32-42"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb32-43"><a href="#cb32-43"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-seasonal-stat-groups" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-seasonal-stat-groups-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-seasonal-stat-groups-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-seasonal-stat-groups-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.9: Mean seasonal rainfall with statistical groupings. Shared letters indicate seasons not significantly different from one another (Dunn’s test, p &lt; 0.05).
</figcaption>
</figure>
</div>
</div>
</div>
<p>The Kruskal-Wallis test yields <span class="math inline">\(\chi^2 = 230\)</span>, <span class="math inline">\(p &lt; 0.001\)</span>, strongly rejecting the null. The epsilon-squared effect size (<span class="math inline">\(\eta^2 \approx 0.004\)</span>) is small the seasonal signal is real but accounts for only a minor fraction of total variance in rainfall intensity, reinforcing the necessity of a multivariate approach.</p>
<p>Post-hoc Dunn’s tests identify three distinct statistical groups (<a href="#fig-seasonal-stat-groups" class="quarto-xref">Figure&nbsp;<span>3.9</span></a>). Summer stands alone as the most intense season (<span class="math inline">\(\bar{x} = 9.1\)</span> mm, <span class="math inline">\(p &lt; 0.001\)</span> vs.&nbsp;all others). Autumn and Spring are statistically indistinguishable (<span class="math inline">\(p = 1.0\)</span>). Winter registers the lowest mean intensity (<span class="math inline">\(\bar{x} = 5.5\)</span> mm) and is statistically distinct from Spring (<span class="math inline">\(p_\text{adj} = 0.026\)</span>).</p>
<hr>
</section>
</section>
<section id="sec-bivariate-density" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="sec-bivariate-density"><span class="header-section-number">3.8</span> Feature Interactions: The “Rain Corner”</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>df_final <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">mutate</span>(<span class="at">rain_index_ref =</span> <span class="fu">ifelse</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="fu">row_number</span>(), <span class="cn">NA_integer_</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>  <span class="fu">fill</span>(rain_index_ref, <span class="at">.direction =</span> <span class="st">"down"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6"></a>  <span class="fu">mutate</span>(<span class="at">days_since_rain =</span> <span class="fu">row_number</span>() <span class="sc">-</span> <span class="fu">lag</span>(rain_index_ref)) <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>  <span class="fu">select</span>(<span class="sc">-</span>rain_index_ref) <span class="sc">%&gt;%</span></span>
<span id="cb33-8"><a href="#cb33-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sunshine, humidity3pm)) <span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9"></a>  <span class="fu">geom_density2d_filled</span>(<span class="at">continuous_var =</span> <span class="st">"ndensity"</span>, <span class="at">bins =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>rain_today, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-13"><a href="#cb33-13"></a>    <span class="at">title =</span> <span class="st">"Justifying Interaction: The 'Rain Corner'"</span>,</span>
<span id="cb33-14"><a href="#cb33-14"></a>    <span class="at">subtitle =</span> <span class="st">"Rain (right panel) concentrates in high humidity / low sunshine.</span><span class="sc">\n</span><span class="st">Dry days (left panel) are dispersed across feature space.</span><span class="sc">\n</span><span class="st">This structural asymmetry justifies a sunshine * humidity interaction term."</span>,</span>
<span id="cb33-15"><a href="#cb33-15"></a>    <span class="at">x =</span> <span class="st">"Sunshine (hours)"</span>,</span>
<span id="cb33-16"><a href="#cb33-16"></a>    <span class="at">y =</span> <span class="st">"Humidity 3pm (%)"</span></span>
<span id="cb33-17"><a href="#cb33-17"></a>  ) <span class="sc">+</span></span>
<span id="cb33-18"><a href="#cb33-18"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-19"><a href="#cb33-19"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-20"><a href="#cb33-20"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb33-21"><a href="#cb33-21"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb33-22"><a href="#cb33-22"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb33-23"><a href="#cb33-23"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-interaction-rain-corner" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interaction-rain-corner-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-interaction-rain-corner-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interaction-rain-corner-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.10: Bivariate density of Humidity3pm vs.&nbsp;Sunshine, faceted by rainfall occurrence. Rain events concentrate tightly in the upper-left ‘Rain Corner’ (high humidity, low sunshine), while dry days are dispersed broadly. This structural asymmetry justifies a multiplicative interaction term.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The correlation analysis in <a href="#sec-correlation" class="quarto-xref"><span>Section 3.4</span></a> established that humidity and sunshine are individually among the strongest predictors. A standard additive model treats their effects as independent. This section tests whether that assumption holds.</p>
<p>The bivariate density plots (<a href="#fig-interaction-rain-corner" class="quarto-xref">Figure&nbsp;<span>3.10</span></a>) reveal a striking structural difference. On dry days, the density is dispersed broadly across the humidity-sunshine space: high humidity can occur without rain under high-pressure suppression, and low sunshine can occur without rain under thin overcast. No single region clearly separates the two states.</p>
<p>On rainy days, the density collapses into a tight cluster in the upper-left quadrant: high afternoon humidity (above approximately 50%) combined with low sunshine (below approximately 5 hours). This is the “Rain Corner”. Neither condition alone is sufficient; both must coincide simultaneously. This is statistical interaction: the effect of one variable on the outcome is conditional on the level of the other.</p>
<p><strong>Modelling implication.</strong> An additive model that includes <code>Humidity3pm</code> and <code>Sunshine</code> as separate terms cannot express the idea that their joint occurrence not their individual magnitudes is what matters. Capturing the Rain Corner requires a multiplicative interaction term (<span class="math inline">\(\text{Humidity} \times \text{Sunshine}\)</span>) in the model specification.</p>
<hr>
</section>
<section id="summary-and-modelling-implications" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="summary-and-modelling-implications"><span class="header-section-number">3.9</span> Summary and Modelling Implications</h2>
<p>The preceding analyses characterise the dataset along six interconnected dimensions, each producing a specific modelling requirement.</p>
<p>The <strong>distributional structure</strong> of the target variable 64% zeros, extreme positive skew, kurtosis of 181 rules out any single-component Gaussian model. A two-part framework separating occurrence from intensity is the appropriate response.</p>
<p>The <strong>missingness analysis</strong> (documented in <a href="02-data-prep.html" class="quarto-xref"><span>Chapter 2</span></a>, summarised in Section 1 above) establishes that imputation is necessary to preserve both sample size and the predictive signal in <code>sunshine</code> and <code>evaporation</code>, and that the imputed values do not introduce outcome-related bias.</p>
<p>The <strong>correlation structure</strong> identifies humidity, cloud cover, sunshine, and evaporation as the strongest individual predictors, and flags severe multicollinearity among morning-afternoon pairs. VIF-based feature selection is required.</p>
<p>The <strong>temporal analyses</strong> establish that both the day-to-day Markov state and the cumulative dry spell duration carry predictive signal. Month should be cyclically encoded. The dry spell decay is non-linear and warrants a natural spline parameterisation of <code>days_since_rain</code>.</p>
<p>The <strong>pressure analysis</strong> identifies the diurnal pressure change as the more discriminating pressure-derived feature, with Cohen’s <span class="math inline">\(d = 0.72\)</span> separating rainy from dry days more effectively than absolute pressure level.</p>
<p>The <strong>interaction analysis</strong> provides empirical justification for a <span class="math inline">\(\text{Humidity} \times \text{Sunshine}\)</span> interaction term, reflecting the physical reality that precipitation concentrates where high moisture and low solar radiation coincide in the “Rain Corner” of the feature space.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-data-prep.html" class="pagination-link" aria-label="Data Preparation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Preparation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-features.html" class="pagination-link" aria-label="Feature Engineering">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Feature Engineering</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb34" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu"># Exploratory Data Analysis {#sec-eda}</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="fu">## Temporal and Meteorological Drivers of Australian Rainfall</span></span>
<span id="cb34-3"><a href="#cb34-3"></a></span>
<span id="cb34-4"><a href="#cb34-4"></a>---</span>
<span id="cb34-5"><a href="#cb34-5"></a></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="at">&gt; **Chapter Context.** This chapter investigates the distributional and structural properties of the daily rainfall data, using findings from the data preparation chapter (@sec-data) as its starting point rather than repeating the missingness diagnostics performed there. The analyses proceed in a deliberate sequence: target variable distribution, bivariate predictor correlations, temporal dynamics, pressure analysis, seasonal patterns, and feature interactions. Each section produces a specific finding that motivates a corresponding decision in the feature engineering or model specification stages.</span></span>
<span id="cb34-7"><a href="#cb34-7"></a></span>
<span id="cb34-8"><a href="#cb34-8"></a>---</span>
<span id="cb34-9"><a href="#cb34-9"></a></span>
<span id="cb34-12"><a href="#cb34-12"></a><span class="in">```{r}</span></span>
<span id="cb34-13"><a href="#cb34-13"></a><span class="co">#| label: setup-eda</span></span>
<span id="cb34-14"><a href="#cb34-14"></a><span class="co">#| include: false</span></span>
<span id="cb34-15"><a href="#cb34-15"></a></span>
<span id="cb34-16"><a href="#cb34-16"></a>librarian<span class="sc">::</span><span class="fu">shelf</span>(</span>
<span id="cb34-17"><a href="#cb34-17"></a>  tidyverse,</span>
<span id="cb34-18"><a href="#cb34-18"></a>  janitor,</span>
<span id="cb34-19"><a href="#cb34-19"></a>  kableExtra,</span>
<span id="cb34-20"><a href="#cb34-20"></a>  ggridges,</span>
<span id="cb34-21"><a href="#cb34-21"></a>  here,</span>
<span id="cb34-22"><a href="#cb34-22"></a>  rstatix,</span>
<span id="cb34-23"><a href="#cb34-23"></a>  moments,</span>
<span id="cb34-24"><a href="#cb34-24"></a>  cocor,</span>
<span id="cb34-25"><a href="#cb34-25"></a>  broom,</span>
<span id="cb34-26"><a href="#cb34-26"></a>  aod,</span>
<span id="cb34-27"><a href="#cb34-27"></a>  multcompView,</span>
<span id="cb34-28"><a href="#cb34-28"></a>  scales,</span>
<span id="cb34-29"><a href="#cb34-29"></a>  patchwork</span>
<span id="cb34-30"><a href="#cb34-30"></a>)</span>
<span id="cb34-31"><a href="#cb34-31"></a></span>
<span id="cb34-32"><a href="#cb34-32"></a>df_clean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"df_clean.rds"</span>))</span>
<span id="cb34-33"><a href="#cb34-33"></a>df_final <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"df_final.csv"</span>))</span>
<span id="cb34-34"><a href="#cb34-34"></a></span>
<span id="cb34-35"><a href="#cb34-35"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"utils.R"</span>))</span>
<span id="cb34-36"><a href="#cb34-36"></a><span class="in">```</span></span>
<span id="cb34-37"><a href="#cb34-37"></a></span>
<span id="cb34-38"><a href="#cb34-38"></a>---</span>
<span id="cb34-39"><a href="#cb34-39"></a></span>
<span id="cb34-40"><a href="#cb34-40"></a><span class="fu">## Data Quality Summary {#sec-data-quality}</span></span>
<span id="cb34-41"><a href="#cb34-41"></a></span>
<span id="cb34-42"><a href="#cb34-42"></a>A thorough investigation of missingness is documented in @sec-data and summarised briefly here for continuity. The full diagnostic pipeline co-missingness analysis, temporal structural break detection, ghost sensor identification, and a weather-conditionality test established the following picture.</span>
<span id="cb34-43"><a href="#cb34-43"></a></span>
<span id="cb34-44"><a href="#cb34-44"></a>The dataset contains 314,146 missing entries in total, distributed highly unevenly across features. The four most affected variables are <span class="in">`sunshine`</span> (47.7% missing), <span class="in">`evaporation`</span> (42.5%), <span class="in">`cloud9am`</span> (approximately 40%), and <span class="in">`cloud3pm`</span> (approximately 37%). Their missingness is not independent: co-missing rates between any pair of these four variables range from 67% to 93%, confirming that they fail together at the station level rather than through separate independent sensor faults. This is Missing Not At Random at the station level, driven by instrumentation deployment profiles.</span>
<span id="cb34-45"><a href="#cb34-45"></a></span>
<span id="cb34-46"><a href="#cb34-46"></a>A weather-conditionality test confirmed that sunshine missingness does not covary with rainfall amounts: the missing rate is 47.8% on dry days and 47.2% on rainy days. Missingness is station-conditional rather than outcome-conditional, meaning imputed values do not introduce directional bias into the training labels.</span>
<span id="cb34-47"><a href="#cb34-47"></a></span>
<span id="cb34-48"><a href="#cb34-48"></a>The core dynamic variables pressure, wind speed, temperature, and humidity exhibit missingness below 10% and are available across virtually all observations.</span>
<span id="cb34-49"><a href="#cb34-49"></a></span>
<span id="cb34-52"><a href="#cb34-52"></a><span class="in">```{r}</span></span>
<span id="cb34-53"><a href="#cb34-53"></a><span class="co">#| label: missing-values-summary</span></span>
<span id="cb34-54"><a href="#cb34-54"></a><span class="co">#| echo: true</span></span>
<span id="cb34-55"><a href="#cb34-55"></a><span class="co">#| message: false</span></span>
<span id="cb34-56"><a href="#cb34-56"></a><span class="co">#| warning: false</span></span>
<span id="cb34-57"><a href="#cb34-57"></a></span>
<span id="cb34-58"><a href="#cb34-58"></a>total_na <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(df_clean))</span>
<span id="cb34-59"><a href="#cb34-59"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Total missing values:"</span>, total_na))</span>
<span id="cb34-60"><a href="#cb34-60"></a></span>
<span id="cb34-61"><a href="#cb34-61"></a><span class="fu">missing_val</span>(df_clean)</span>
<span id="cb34-62"><a href="#cb34-62"></a><span class="in">```</span></span>
<span id="cb34-63"><a href="#cb34-63"></a></span>
<span id="cb34-64"><a href="#cb34-64"></a>**Resolution.** A three-stage hybrid imputation pipeline was applied in @sec-data: binary missingness flags, linear temporal interpolation bounded by a five-day cap, and two-pass Random Forest imputation via <span class="in">`missRanger`</span> and targeted <span class="in">`mice`</span>. Ghost sensor observations, station-variable pairs with more than 90% missingness across the full window, were reverted to missing after the pipeline rather than filled with unsupported synthetic values. The imputed dataset <span class="in">`df_final`</span> is used throughout the remainder of this chapter. The raw dataset <span class="in">`df_clean`</span> is used only in this opening section, where using pre-imputation data avoids circularity between the imputed features and the response distribution.</span>
<span id="cb34-65"><a href="#cb34-65"></a></span>
<span id="cb34-66"><a href="#cb34-66"></a>**Modelling implication.** The concentration of missingness in <span class="in">`sunshine`</span> and <span class="in">`evaporation`</span>, both of which exhibit meaningful correlation with rainfall, as shown in @sec-correlation, creates a direct trade-off: discarding these variables avoids imputation complexity but sacrifices predictive signal, while listwise deletion would eliminate nearly half the dataset and introduce geographic bias toward well-instrumented stations. The Random Forest imputation strategy in @sec-data resolves this trade-off by preserving both sample and features.</span>
<span id="cb34-67"><a href="#cb34-67"></a></span>
<span id="cb34-68"><a href="#cb34-68"></a>---</span>
<span id="cb34-69"><a href="#cb34-69"></a></span>
<span id="cb34-70"><a href="#cb34-70"></a><span class="fu">## Distributional Properties of the Target Variable</span></span>
<span id="cb34-71"><a href="#cb34-71"></a></span>
<span id="cb34-72"><a href="#cb34-72"></a>Understanding the marginal distribution of the response variable is a prerequisite for selecting an appropriate model family. A Gaussian assumption carries substantive claims about the data-generating process that can be directly tested.</span>
<span id="cb34-73"><a href="#cb34-73"></a></span>
<span id="cb34-76"><a href="#cb34-76"></a><span class="in">```{r}</span></span>
<span id="cb34-77"><a href="#cb34-77"></a><span class="co">#| label: target-stats</span></span>
<span id="cb34-78"><a href="#cb34-78"></a><span class="co">#| echo: true</span></span>
<span id="cb34-79"><a href="#cb34-79"></a><span class="co">#| message: false</span></span>
<span id="cb34-80"><a href="#cb34-80"></a><span class="co">#| warning: false</span></span>
<span id="cb34-81"><a href="#cb34-81"></a></span>
<span id="cb34-82"><a href="#cb34-82"></a>rainfall_stats <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb34-83"><a href="#cb34-83"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-84"><a href="#cb34-84"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb34-85"><a href="#cb34-85"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(rainfall),</span>
<span id="cb34-86"><a href="#cb34-86"></a>    <span class="at">median =</span> <span class="fu">median</span>(rainfall),</span>
<span id="cb34-87"><a href="#cb34-87"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(rainfall),</span>
<span id="cb34-88"><a href="#cb34-88"></a>    <span class="at">min =</span> <span class="fu">min</span>(rainfall),</span>
<span id="cb34-89"><a href="#cb34-89"></a>    <span class="at">max =</span> <span class="fu">max</span>(rainfall),</span>
<span id="cb34-90"><a href="#cb34-90"></a>    <span class="at">q25 =</span> <span class="fu">quantile</span>(rainfall, <span class="fl">0.25</span>),</span>
<span id="cb34-91"><a href="#cb34-91"></a>    <span class="at">q75 =</span> <span class="fu">quantile</span>(rainfall, <span class="fl">0.75</span>),</span>
<span id="cb34-92"><a href="#cb34-92"></a>    <span class="at">iqr =</span> <span class="fu">IQR</span>(rainfall),</span>
<span id="cb34-93"><a href="#cb34-93"></a>    <span class="at">n_zeros =</span> <span class="fu">sum</span>(rainfall <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb34-94"><a href="#cb34-94"></a>    <span class="at">pct_zeros =</span> <span class="fu">mean</span>(rainfall <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb34-95"><a href="#cb34-95"></a>    <span class="at">n_large =</span> <span class="fu">sum</span>(rainfall <span class="sc">&gt;</span> <span class="dv">100</span>),</span>
<span id="cb34-96"><a href="#cb34-96"></a>    <span class="at">pct_large =</span> <span class="fu">mean</span>(rainfall <span class="sc">&gt;</span> <span class="dv">100</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb34-97"><a href="#cb34-97"></a>    <span class="at">skewness =</span> moments<span class="sc">::</span><span class="fu">skewness</span>(rainfall),</span>
<span id="cb34-98"><a href="#cb34-98"></a>    <span class="at">kurtosis =</span> moments<span class="sc">::</span><span class="fu">kurtosis</span>(rainfall)</span>
<span id="cb34-99"><a href="#cb34-99"></a>  )</span>
<span id="cb34-100"><a href="#cb34-100"></a></span>
<span id="cb34-101"><a href="#cb34-101"></a>rainfall_stats <span class="sc">%&gt;%</span></span>
<span id="cb34-102"><a href="#cb34-102"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Statistic"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-103"><a href="#cb34-103"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-104"><a href="#cb34-104"></a>    <span class="at">Value =</span> <span class="fu">ifelse</span>(</span>
<span id="cb34-105"><a href="#cb34-105"></a>      Value <span class="sc">&gt;</span> <span class="dv">1000</span>,</span>
<span id="cb34-106"><a href="#cb34-106"></a>      <span class="fu">format</span>(Value, <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb34-107"><a href="#cb34-107"></a>      <span class="fu">round</span>(Value, <span class="dv">3</span>)</span>
<span id="cb34-108"><a href="#cb34-108"></a>    )</span>
<span id="cb34-109"><a href="#cb34-109"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-110"><a href="#cb34-110"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-111"><a href="#cb34-111"></a>    <span class="at">caption =</span> <span class="st">"Descriptive Statistics: Daily Rainfall (mm)"</span>,</span>
<span id="cb34-112"><a href="#cb34-112"></a>    <span class="at">align =</span> <span class="st">"lr"</span></span>
<span id="cb34-113"><a href="#cb34-113"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-114"><a href="#cb34-114"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-115"><a href="#cb34-115"></a></span>
<span id="cb34-116"><a href="#cb34-116"></a>rain_check <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb34-117"><a href="#cb34-117"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-118"><a href="#cb34-118"></a>    <span class="at">total_days =</span> <span class="fu">n</span>(),</span>
<span id="cb34-119"><a href="#cb34-119"></a>    <span class="at">dry_days =</span> <span class="fu">sum</span>(rainfall <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb34-120"><a href="#cb34-120"></a>    <span class="at">rainy_days =</span> <span class="fu">sum</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb34-121"><a href="#cb34-121"></a>    <span class="at">zero_inflation_pct =</span> (dry_days <span class="sc">/</span> total_days) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb34-122"><a href="#cb34-122"></a>  )</span>
<span id="cb34-123"><a href="#cb34-123"></a></span>
<span id="cb34-124"><a href="#cb34-124"></a>rain_check <span class="sc">%&gt;%</span></span>
<span id="cb34-125"><a href="#cb34-125"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-126"><a href="#cb34-126"></a>    <span class="at">caption =</span> <span class="st">"Prevalence of Zero-Inflation (Dry Days)"</span>,</span>
<span id="cb34-127"><a href="#cb34-127"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb34-128"><a href="#cb34-128"></a>      <span class="st">"Total Days"</span>,</span>
<span id="cb34-129"><a href="#cb34-129"></a>      <span class="st">"Dry Days (0mm)"</span>,</span>
<span id="cb34-130"><a href="#cb34-130"></a>      <span class="st">"Rainy Days (&gt;0mm)"</span>,</span>
<span id="cb34-131"><a href="#cb34-131"></a>      <span class="st">"Zero Inflation (%)"</span></span>
<span id="cb34-132"><a href="#cb34-132"></a>    )</span>
<span id="cb34-133"><a href="#cb34-133"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-134"><a href="#cb34-134"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb34-135"><a href="#cb34-135"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"bordered"</span>),</span>
<span id="cb34-136"><a href="#cb34-136"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span></span>
<span id="cb34-137"><a href="#cb34-137"></a>  )</span>
<span id="cb34-138"><a href="#cb34-138"></a><span class="in">```</span></span>
<span id="cb34-139"><a href="#cb34-139"></a></span>
<span id="cb34-140"><a href="#cb34-140"></a>The descriptive statistics reveal a distribution fundamentally incompatible with Gaussian modelling assumptions.</span>
<span id="cb34-141"><a href="#cb34-141"></a></span>
<span id="cb34-142"><a href="#cb34-142"></a>**Zero-inflation.** 64.05% of the 142,199 recorded observations are dry days (rainfall = 0 mm). The median is zero. The data-generating mechanism genuinely produces two qualitatively different outcomes, no rain at all versus some positive amount and any model treating the response as a single continuous variable will be forced to place probability mass on negative values and will systematically misestimate the probability of the zero outcome.</span>
<span id="cb34-143"><a href="#cb34-143"></a></span>
<span id="cb34-144"><a href="#cb34-144"></a>**Heavy tails.** Among non-zero observations, the distribution is severely right-skewed (skewness = 9.84). The standard deviation (8.48 mm) is nearly four times the mean (2.36 mm). Kurtosis of 181.15 compared to 3 for a normal distribution confirms that extreme events occur far more frequently than a Gaussian model would predict. The maximum recorded value is 371 mm, and 151 events exceed 100 mm.</span>
<span id="cb34-145"><a href="#cb34-145"></a></span>
<span id="cb34-146"><a href="#cb34-146"></a>**Modelling implication.** The conjunction of zero-inflation and extreme positive skew means a single-component model is insufficient. The data implicitly poses two separate questions: does rain occur (binary classification) and, given that it does, how much falls (positive continuous regression). This motivates the Zero-Inflated Gamma framework adopted in subsequent analysis.</span>
<span id="cb34-147"><a href="#cb34-147"></a></span>
<span id="cb34-148"><a href="#cb34-148"></a>---</span>
<span id="cb34-149"><a href="#cb34-149"></a></span>
<span id="cb34-150"><a href="#cb34-150"></a><span class="fu">## Bivariate Correlation Structure {#sec-correlation}</span></span>
<span id="cb34-151"><a href="#cb34-151"></a></span>
<span id="cb34-152"><a href="#cb34-152"></a>Because rainfall is heavily skewed and the relationships are unlikely to be linear, Spearman rank correlation is used throughout, a non-parametric measure that captures monotonic association without requiring linearity or normality.</span>
<span id="cb34-153"><a href="#cb34-153"></a></span>
<span id="cb34-156"><a href="#cb34-156"></a><span class="in">```{r}</span></span>
<span id="cb34-157"><a href="#cb34-157"></a><span class="co">#| label: correlation-table</span></span>
<span id="cb34-158"><a href="#cb34-158"></a><span class="co">#| echo: true</span></span>
<span id="cb34-159"><a href="#cb34-159"></a><span class="co">#| message: false</span></span>
<span id="cb34-160"><a href="#cb34-160"></a><span class="co">#| warning: false</span></span>
<span id="cb34-161"><a href="#cb34-161"></a></span>
<span id="cb34-162"><a href="#cb34-162"></a>numeric_cols <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb34-163"><a href="#cb34-163"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb34-164"><a href="#cb34-164"></a>  <span class="fu">names</span>()</span>
<span id="cb34-165"><a href="#cb34-165"></a>numeric_cols <span class="ot">&lt;-</span> numeric_cols[numeric_cols <span class="sc">!=</span> <span class="st">"rainfall"</span>]</span>
<span id="cb34-166"><a href="#cb34-166"></a></span>
<span id="cb34-167"><a href="#cb34-167"></a>cors <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb34-168"><a href="#cb34-168"></a>  rstatix<span class="sc">::</span><span class="fu">cor_test</span>(</span>
<span id="cb34-169"><a href="#cb34-169"></a>    <span class="at">vars =</span> <span class="st">"rainfall"</span>,</span>
<span id="cb34-170"><a href="#cb34-170"></a>    <span class="at">vars2 =</span> numeric_cols,</span>
<span id="cb34-171"><a href="#cb34-171"></a>    <span class="at">method =</span> <span class="st">"spearman"</span></span>
<span id="cb34-172"><a href="#cb34-172"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-173"><a href="#cb34-173"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(cor)) <span class="sc">%&gt;%</span></span>
<span id="cb34-174"><a href="#cb34-174"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(cor))) <span class="sc">%&gt;%</span></span>
<span id="cb34-175"><a href="#cb34-175"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(var2, cor, p) <span class="sc">%&gt;%</span></span>
<span id="cb34-176"><a href="#cb34-176"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-177"><a href="#cb34-177"></a>    <span class="at">interpretation =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-178"><a href="#cb34-178"></a>      <span class="fu">abs</span>(cor) <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"Negligible"</span>,</span>
<span id="cb34-179"><a href="#cb34-179"></a>      <span class="fu">abs</span>(cor) <span class="sc">&lt;</span> <span class="fl">0.3</span> <span class="sc">~</span> <span class="st">"Small"</span>,</span>
<span id="cb34-180"><a href="#cb34-180"></a>      <span class="fu">abs</span>(cor) <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Moderate"</span>,</span>
<span id="cb34-181"><a href="#cb34-181"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Large"</span></span>
<span id="cb34-182"><a href="#cb34-182"></a>    )</span>
<span id="cb34-183"><a href="#cb34-183"></a>  )</span>
<span id="cb34-184"><a href="#cb34-184"></a></span>
<span id="cb34-185"><a href="#cb34-185"></a>cors <span class="sc">%&gt;%</span></span>
<span id="cb34-186"><a href="#cb34-186"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-187"><a href="#cb34-187"></a>    <span class="at">caption =</span> <span class="st">"Spearman Correlation with Rainfall (Ranked by Strength)"</span>,</span>
<span id="cb34-188"><a href="#cb34-188"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Predictor"</span>, <span class="st">"Correlation (r)"</span>, <span class="st">"P-Value"</span>, <span class="st">"Strength"</span>)</span>
<span id="cb34-189"><a href="#cb34-189"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-190"><a href="#cb34-190"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-191"><a href="#cb34-191"></a><span class="in">```</span></span>
<span id="cb34-192"><a href="#cb34-192"></a></span>
<span id="cb34-195"><a href="#cb34-195"></a><span class="in">```{r}</span></span>
<span id="cb34-196"><a href="#cb34-196"></a><span class="co">#| label: fig-correlation-matrix</span></span>
<span id="cb34-197"><a href="#cb34-197"></a><span class="co">#| fig-cap: "Spearman Correlation Matrix of Meteorological Features. Red indicates negative correlation; blue indicates positive correlation. Coefficients shown for pairs where |r| &gt; 0.3."</span></span>
<span id="cb34-198"><a href="#cb34-198"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb34-199"><a href="#cb34-199"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb34-200"><a href="#cb34-200"></a><span class="co">#| echo: true</span></span>
<span id="cb34-201"><a href="#cb34-201"></a><span class="co">#| warning: false</span></span>
<span id="cb34-202"><a href="#cb34-202"></a></span>
<span id="cb34-203"><a href="#cb34-203"></a>cor_matrix <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb34-204"><a href="#cb34-204"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb34-205"><a href="#cb34-205"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb34-206"><a href="#cb34-206"></a></span>
<span id="cb34-207"><a href="#cb34-207"></a>cor_melt <span class="ot">&lt;-</span> cor_matrix <span class="sc">%&gt;%</span></span>
<span id="cb34-208"><a href="#cb34-208"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-209"><a href="#cb34-209"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Var1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-210"><a href="#cb34-210"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Var1, <span class="at">names_to =</span> <span class="st">"Var2"</span>, <span class="at">values_to =</span> <span class="st">"Correlation"</span>)</span>
<span id="cb34-211"><a href="#cb34-211"></a></span>
<span id="cb34-212"><a href="#cb34-212"></a>cor_melt <span class="sc">%&gt;%</span></span>
<span id="cb34-213"><a href="#cb34-213"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb34-214"><a href="#cb34-214"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb34-215"><a href="#cb34-215"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb34-216"><a href="#cb34-216"></a>    <span class="at">low =</span> <span class="st">"#D73027"</span>,</span>
<span id="cb34-217"><a href="#cb34-217"></a>    <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb34-218"><a href="#cb34-218"></a>    <span class="at">high =</span> <span class="st">"#4575B4"</span>,</span>
<span id="cb34-219"><a href="#cb34-219"></a>    <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb34-220"><a href="#cb34-220"></a>    <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb34-221"><a href="#cb34-221"></a>    <span class="at">name =</span> <span class="st">"Spearman</span><span class="sc">\n</span><span class="st">Correlation"</span></span>
<span id="cb34-222"><a href="#cb34-222"></a>  ) <span class="sc">+</span></span>
<span id="cb34-223"><a href="#cb34-223"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-224"><a href="#cb34-224"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-225"><a href="#cb34-225"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb34-226"><a href="#cb34-226"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb34-227"><a href="#cb34-227"></a>    <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-228"><a href="#cb34-228"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-229"><a href="#cb34-229"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb34-230"><a href="#cb34-230"></a>  ) <span class="sc">+</span></span>
<span id="cb34-231"><a href="#cb34-231"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb34-232"><a href="#cb34-232"></a>    <span class="at">data =</span> <span class="fu">filter</span>(cor_melt, <span class="fu">abs</span>(Correlation) <span class="sc">&gt;</span> <span class="fl">0.3</span>),</span>
<span id="cb34-233"><a href="#cb34-233"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Correlation, <span class="dv">2</span>)),</span>
<span id="cb34-234"><a href="#cb34-234"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb34-235"><a href="#cb34-235"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb34-236"><a href="#cb34-236"></a>  ) <span class="sc">+</span></span>
<span id="cb34-237"><a href="#cb34-237"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-238"><a href="#cb34-238"></a>    <span class="at">title =</span> <span class="st">"Feature Correlation Matrix"</span>,</span>
<span id="cb34-239"><a href="#cb34-239"></a>    <span class="at">subtitle =</span> <span class="st">"Strongest predictors: Humidity (positive) and Sunshine (negative)"</span></span>
<span id="cb34-240"><a href="#cb34-240"></a>  )</span>
<span id="cb34-241"><a href="#cb34-241"></a><span class="in">```</span></span>
<span id="cb34-242"><a href="#cb34-242"></a></span>
<span id="cb34-245"><a href="#cb34-245"></a><span class="in">```{r}</span></span>
<span id="cb34-246"><a href="#cb34-246"></a><span class="co">#| label: correlation-significance-test</span></span>
<span id="cb34-247"><a href="#cb34-247"></a><span class="co">#| echo: true</span></span>
<span id="cb34-248"><a href="#cb34-248"></a><span class="co">#| collapse: true</span></span>
<span id="cb34-249"><a href="#cb34-249"></a></span>
<span id="cb34-250"><a href="#cb34-250"></a>cor_humidity <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(</span>
<span id="cb34-251"><a href="#cb34-251"></a>  df_clean<span class="sc">$</span>rainfall,</span>
<span id="cb34-252"><a href="#cb34-252"></a>  df_clean<span class="sc">$</span>humidity3pm,</span>
<span id="cb34-253"><a href="#cb34-253"></a>  <span class="at">method =</span> <span class="st">"spearman"</span></span>
<span id="cb34-254"><a href="#cb34-254"></a>)</span>
<span id="cb34-255"><a href="#cb34-255"></a>cor_sunshine <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(</span>
<span id="cb34-256"><a href="#cb34-256"></a>  df_clean<span class="sc">$</span>rainfall,</span>
<span id="cb34-257"><a href="#cb34-257"></a>  df_clean<span class="sc">$</span>sunshine,</span>
<span id="cb34-258"><a href="#cb34-258"></a>  <span class="at">method =</span> <span class="st">"spearman"</span></span>
<span id="cb34-259"><a href="#cb34-259"></a>)</span>
<span id="cb34-260"><a href="#cb34-260"></a></span>
<span id="cb34-261"><a href="#cb34-261"></a>cocor_result <span class="ot">&lt;-</span> <span class="fu">cocor.dep.groups.overlap</span>(</span>
<span id="cb34-262"><a href="#cb34-262"></a>  <span class="at">r.jk =</span> cor_humidity<span class="sc">$</span>estimate,</span>
<span id="cb34-263"><a href="#cb34-263"></a>  <span class="at">r.jh =</span> cor_sunshine<span class="sc">$</span>estimate,</span>
<span id="cb34-264"><a href="#cb34-264"></a>  <span class="at">r.kh =</span> <span class="fu">cor</span>(</span>
<span id="cb34-265"><a href="#cb34-265"></a>    df_clean<span class="sc">$</span>humidity3pm,</span>
<span id="cb34-266"><a href="#cb34-266"></a>    df_clean<span class="sc">$</span>sunshine,</span>
<span id="cb34-267"><a href="#cb34-267"></a>    <span class="at">use =</span> <span class="st">"complete.obs"</span>,</span>
<span id="cb34-268"><a href="#cb34-268"></a>    <span class="at">method =</span> <span class="st">"spearman"</span></span>
<span id="cb34-269"><a href="#cb34-269"></a>  ),</span>
<span id="cb34-270"><a href="#cb34-270"></a>  <span class="at">n =</span> <span class="fu">nrow</span>(df_clean),</span>
<span id="cb34-271"><a href="#cb34-271"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span>,</span>
<span id="cb34-272"><a href="#cb34-272"></a>  <span class="at">test =</span> <span class="st">"steiger1980"</span>,</span>
<span id="cb34-273"><a href="#cb34-273"></a>  <span class="at">return.htest =</span> <span class="cn">TRUE</span></span>
<span id="cb34-274"><a href="#cb34-274"></a>)</span>
<span id="cb34-275"><a href="#cb34-275"></a></span>
<span id="cb34-276"><a href="#cb34-276"></a><span class="fu">print</span>(cocor_result)</span>
<span id="cb34-277"><a href="#cb34-277"></a><span class="in">```</span></span>
<span id="cb34-278"><a href="#cb34-278"></a></span>
<span id="cb34-279"><a href="#cb34-279"></a>**Moisture indicators (positive association).** <span class="in">`Humidity3pm`</span> ($r = 0.44$) and cloud cover ($r \approx 0.37$) show the strongest positive associations. High afternoon humidity indicates moisture has accumulated in the lower atmosphere over the course of the day. Cloud cover is both a physical precondition for rain and a consequence of the same atmospheric dynamics.</span>
<span id="cb34-280"><a href="#cb34-280"></a></span>
<span id="cb34-281"><a href="#cb34-281"></a>**Radiation and evaporation indicators (negative association).** <span class="in">`Sunshine`</span> ($r = -0.40$) and <span class="in">`evaporation`</span> ($r = -0.31$) exhibit the strongest negative associations. Long sunshine hours proxy clear-sky, high-pressure conditions. High evaporation signals warm, dry, low-humidity surface conditions.</span>
<span id="cb34-282"><a href="#cb34-282"></a></span>
<span id="cb34-283"><a href="#cb34-283"></a>**Multicollinearity.** The correlation heatmap (@fig-correlation-matrix) reveals substantial redundancy among predictors. <span class="in">`pressure9am`</span> and <span class="in">`pressure3pm`</span> share $r = 0.96$, and the two temperature readings are similarly collinear. This directly motivates VIF-based feature selection in the feature engineering chapter.</span>
<span id="cb34-284"><a href="#cb34-284"></a></span>
<span id="cb34-285"><a href="#cb34-285"></a>**Statistical validation.** Steiger's Z-test comparing the two strongest opposing predictors yields $z \approx 188.9$, $p &lt; 2.2 \times 10^{-16}$. With $N &gt; 140,000$, the p-value alone is uninformative; the Z-statistic magnitude confirms the differential predictive strength is not a sampling artefact. Humidity and sunshine represent genuinely distinct physical forces operating in opposing directions.</span>
<span id="cb34-286"><a href="#cb34-286"></a></span>
<span id="cb34-287"><a href="#cb34-287"></a>---</span>
<span id="cb34-288"><a href="#cb34-288"></a></span>
<span id="cb34-289"><a href="#cb34-289"></a><span class="fu">## Temporal Structure of Rainfall</span></span>
<span id="cb34-290"><a href="#cb34-290"></a></span>
<span id="cb34-291"><a href="#cb34-291"></a><span class="fu">### Weekly and Seasonal Frequency {#sec-frequency}</span></span>
<span id="cb34-292"><a href="#cb34-292"></a></span>
<span id="cb34-295"><a href="#cb34-295"></a><span class="in">```{r}</span></span>
<span id="cb34-296"><a href="#cb34-296"></a><span class="co">#| label: temporal-dist</span></span>
<span id="cb34-297"><a href="#cb34-297"></a><span class="co">#| echo: true</span></span>
<span id="cb34-298"><a href="#cb34-298"></a><span class="co">#| message: false</span></span>
<span id="cb34-299"><a href="#cb34-299"></a><span class="co">#| warning: false</span></span>
<span id="cb34-300"><a href="#cb34-300"></a></span>
<span id="cb34-301"><a href="#cb34-301"></a>df_clean <span class="sc">%&gt;%</span></span>
<span id="cb34-302"><a href="#cb34-302"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-303"><a href="#cb34-303"></a>  <span class="fu">tabyl</span>(day) <span class="sc">%&gt;%</span></span>
<span id="cb34-304"><a href="#cb34-304"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-305"><a href="#cb34-305"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb34-306"><a href="#cb34-306"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-307"><a href="#cb34-307"></a>    <span class="at">caption =</span> <span class="st">"Frequency of Rainfall Days by Day of the Week"</span>,</span>
<span id="cb34-308"><a href="#cb34-308"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Day"</span>, <span class="st">"Count (n)"</span>, <span class="st">"Percentage"</span>)</span>
<span id="cb34-309"><a href="#cb34-309"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-310"><a href="#cb34-310"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-311"><a href="#cb34-311"></a></span>
<span id="cb34-312"><a href="#cb34-312"></a>df_clean <span class="sc">%&gt;%</span></span>
<span id="cb34-313"><a href="#cb34-313"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-314"><a href="#cb34-314"></a>  <span class="fu">tabyl</span>(month) <span class="sc">%&gt;%</span></span>
<span id="cb34-315"><a href="#cb34-315"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-316"><a href="#cb34-316"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb34-317"><a href="#cb34-317"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-318"><a href="#cb34-318"></a>    <span class="at">caption =</span> <span class="st">"Frequency of Rainfall Days by Month"</span>,</span>
<span id="cb34-319"><a href="#cb34-319"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Month"</span>, <span class="st">"Count (n)"</span>, <span class="st">"Percentage"</span>)</span>
<span id="cb34-320"><a href="#cb34-320"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-321"><a href="#cb34-321"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-322"><a href="#cb34-322"></a></span>
<span id="cb34-323"><a href="#cb34-323"></a>df_clean <span class="sc">%&gt;%</span></span>
<span id="cb34-324"><a href="#cb34-324"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-325"><a href="#cb34-325"></a>  <span class="fu">tabyl</span>(month, day) <span class="sc">%&gt;%</span></span>
<span id="cb34-326"><a href="#cb34-326"></a>  <span class="fu">adorn_totals</span>(<span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-327"><a href="#cb34-327"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Cross-tabulation of Rainfall Frequency: Month vs. Day"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-328"><a href="#cb34-328"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb34-329"><a href="#cb34-329"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb34-330"><a href="#cb34-330"></a>    <span class="at">font_size =</span> <span class="dv">11</span></span>
<span id="cb34-331"><a href="#cb34-331"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-332"><a href="#cb34-332"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>)</span>
<span id="cb34-333"><a href="#cb34-333"></a><span class="in">```</span></span>
<span id="cb34-334"><a href="#cb34-334"></a></span>
<span id="cb34-335"><a href="#cb34-335"></a>**Weekly cycle.** The distribution of wet days across the days of the week is approximately uniform, ranging from 13.8% to 14.7%. This near-uniformity is physically expected: atmospheric processes operate independently of the social calendar. The slight variation is consistent with sampling noise, suggesting <span class="in">`Day`</span> carries little predictive information.</span>
<span id="cb34-336"><a href="#cb34-336"></a></span>
<span id="cb34-337"><a href="#cb34-337"></a>**Annual cycle.** June (10.7%) and July (10.3%) record the highest frequency of wet days, consistent with Southern Hemisphere winter frontal systems from the Southern Ocean. February (6.5%) and December (7.0%) record the lowest frequencies. The cross-tabulation confirms this seasonal signal is not an artefact of any particular day of the week. <span class="in">`Month`</span> is therefore a legitimate predictor warranting explicit model inclusion.</span>
<span id="cb34-338"><a href="#cb34-338"></a></span>
<span id="cb34-339"><a href="#cb34-339"></a><span class="fu">### Day-to-Day Persistence: A Markov Chain Analysis {#sec-markov}</span></span>
<span id="cb34-340"><a href="#cb34-340"></a></span>
<span id="cb34-343"><a href="#cb34-343"></a><span class="in">```{r}</span></span>
<span id="cb34-344"><a href="#cb34-344"></a><span class="co">#| label: markov-prep</span></span>
<span id="cb34-345"><a href="#cb34-345"></a><span class="co">#| echo: true</span></span>
<span id="cb34-346"><a href="#cb34-346"></a><span class="co">#| message: false</span></span>
<span id="cb34-347"><a href="#cb34-347"></a><span class="co">#| warning: false</span></span>
<span id="cb34-348"><a href="#cb34-348"></a></span>
<span id="cb34-349"><a href="#cb34-349"></a>markov_table <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-350"><a href="#cb34-350"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb34-351"><a href="#cb34-351"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb34-352"><a href="#cb34-352"></a>  <span class="fu">mutate</span>(<span class="at">yesterday_rain =</span> <span class="fu">lag</span>(rain_today)) <span class="sc">%&gt;%</span></span>
<span id="cb34-353"><a href="#cb34-353"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-354"><a href="#cb34-354"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(rain_today), <span class="sc">!</span><span class="fu">is.na</span>(yesterday_rain)) <span class="sc">%&gt;%</span></span>
<span id="cb34-355"><a href="#cb34-355"></a>  <span class="fu">count</span>(yesterday_rain, rain_today)</span>
<span id="cb34-356"><a href="#cb34-356"></a></span>
<span id="cb34-357"><a href="#cb34-357"></a>cont_table <span class="ot">&lt;-</span> markov_table <span class="sc">%&gt;%</span></span>
<span id="cb34-358"><a href="#cb34-358"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> rain_today, <span class="at">values_from =</span> n, <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-359"><a href="#cb34-359"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"yesterday_rain"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-360"><a href="#cb34-360"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb34-361"><a href="#cb34-361"></a></span>
<span id="cb34-362"><a href="#cb34-362"></a><span class="fu">print</span>(cont_table)</span>
<span id="cb34-363"><a href="#cb34-363"></a><span class="in">```</span></span>
<span id="cb34-364"><a href="#cb34-364"></a></span>
<span id="cb34-367"><a href="#cb34-367"></a><span class="in">```{r}</span></span>
<span id="cb34-368"><a href="#cb34-368"></a><span class="co">#| label: markov-stats</span></span>
<span id="cb34-369"><a href="#cb34-369"></a><span class="co">#| echo: true</span></span>
<span id="cb34-370"><a href="#cb34-370"></a><span class="co">#| collapse: true</span></span>
<span id="cb34-371"><a href="#cb34-371"></a></span>
<span id="cb34-372"><a href="#cb34-372"></a>chi_result <span class="ot">&lt;-</span> <span class="fu">chisq_test</span>(<span class="fu">as.table</span>(cont_table))</span>
<span id="cb34-373"><a href="#cb34-373"></a><span class="fu">print</span>(chi_result)</span>
<span id="cb34-374"><a href="#cb34-374"></a></span>
<span id="cb34-375"><a href="#cb34-375"></a>cramers_v <span class="ot">&lt;-</span> <span class="fu">cramer_v</span>(cont_table)</span>
<span id="cb34-376"><a href="#cb34-376"></a></span>
<span id="cb34-377"><a href="#cb34-377"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effect Size Interpretation</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-378"><a href="#cb34-378"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"V = %.4f: "</span>, cramers_v))</span>
<span id="cb34-379"><a href="#cb34-379"></a></span>
<span id="cb34-380"><a href="#cb34-380"></a><span class="cf">if</span> (cramers_v <span class="sc">&lt;</span> <span class="fl">0.1</span>) {</span>
<span id="cb34-381"><a href="#cb34-381"></a>  <span class="fu">cat</span>(<span class="st">"Negligible Association</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-382"><a href="#cb34-382"></a>} <span class="cf">else</span> <span class="cf">if</span> (cramers_v <span class="sc">&lt;</span> <span class="fl">0.3</span>) {</span>
<span id="cb34-383"><a href="#cb34-383"></a>  <span class="fu">cat</span>(<span class="st">"Weak Association</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-384"><a href="#cb34-384"></a>} <span class="cf">else</span> <span class="cf">if</span> (cramers_v <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb34-385"><a href="#cb34-385"></a>  <span class="fu">cat</span>(<span class="st">"Moderate Association</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-386"><a href="#cb34-386"></a>} <span class="cf">else</span> {</span>
<span id="cb34-387"><a href="#cb34-387"></a>  <span class="fu">cat</span>(<span class="st">"Strong Association</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-388"><a href="#cb34-388"></a>}</span>
<span id="cb34-389"><a href="#cb34-389"></a><span class="in">```</span></span>
<span id="cb34-390"><a href="#cb34-390"></a></span>
<span id="cb34-393"><a href="#cb34-393"></a><span class="in">```{r}</span></span>
<span id="cb34-394"><a href="#cb34-394"></a><span class="co">#| label: fig-markov-chain</span></span>
<span id="cb34-395"><a href="#cb34-395"></a><span class="co">#| fig-cap: "Markov Chain Transition Matrix. The asymmetry between dry-to-dry (85%) and wet-to-wet (47%) probabilities is the central finding: dry states are self-reinforcing, wet states are transient."</span></span>
<span id="cb34-396"><a href="#cb34-396"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb34-397"><a href="#cb34-397"></a><span class="co">#| fig-height: 7</span></span>
<span id="cb34-398"><a href="#cb34-398"></a><span class="co">#| echo: true</span></span>
<span id="cb34-399"><a href="#cb34-399"></a><span class="co">#| warning: false</span></span>
<span id="cb34-400"><a href="#cb34-400"></a></span>
<span id="cb34-401"><a href="#cb34-401"></a>markov_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-402"><a href="#cb34-402"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb34-403"><a href="#cb34-403"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb34-404"><a href="#cb34-404"></a>  <span class="fu">mutate</span>(<span class="at">yesterday_rain =</span> <span class="fu">lag</span>(rain_today)) <span class="sc">%&gt;%</span></span>
<span id="cb34-405"><a href="#cb34-405"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-406"><a href="#cb34-406"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(rain_today), <span class="sc">!</span><span class="fu">is.na</span>(yesterday_rain))</span>
<span id="cb34-407"><a href="#cb34-407"></a></span>
<span id="cb34-408"><a href="#cb34-408"></a>markov_data <span class="sc">%&gt;%</span></span>
<span id="cb34-409"><a href="#cb34-409"></a>  <span class="fu">count</span>(yesterday_rain, rain_today) <span class="sc">%&gt;%</span></span>
<span id="cb34-410"><a href="#cb34-410"></a>  <span class="fu">group_by</span>(yesterday_rain) <span class="sc">%&gt;%</span></span>
<span id="cb34-411"><a href="#cb34-411"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb34-412"><a href="#cb34-412"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> yesterday_rain, <span class="at">y =</span> rain_today, <span class="at">fill =</span> prob)) <span class="sc">+</span></span>
<span id="cb34-413"><a href="#cb34-413"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb34-414"><a href="#cb34-414"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb34-415"><a href="#cb34-415"></a>    <span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(prob, <span class="at">accuracy =</span> <span class="dv">1</span>)),</span>
<span id="cb34-416"><a href="#cb34-416"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb34-417"><a href="#cb34-417"></a>    <span class="at">size =</span> <span class="dv">8</span>,</span>
<span id="cb34-418"><a href="#cb34-418"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span></span>
<span id="cb34-419"><a href="#cb34-419"></a>  ) <span class="sc">+</span></span>
<span id="cb34-420"><a href="#cb34-420"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"viridis"</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb34-421"><a href="#cb34-421"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-422"><a href="#cb34-422"></a>    <span class="at">title =</span> <span class="st">"Markov Chain: Rain Persistence Effect"</span>,</span>
<span id="cb34-423"><a href="#cb34-423"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(</span>
<span id="cb34-424"><a href="#cb34-424"></a>      <span class="st">"X^2 = %.2f, p &lt; 0.001, Cramer's V = %.3f (Moderate Association)</span><span class="sc">\n</span><span class="st">Yesterday's rain state strongly predicts today's rain state."</span>,</span>
<span id="cb34-425"><a href="#cb34-425"></a>      chi_result<span class="sc">$</span>statistic,</span>
<span id="cb34-426"><a href="#cb34-426"></a>      cramers_v</span>
<span id="cb34-427"><a href="#cb34-427"></a>    ),</span>
<span id="cb34-428"><a href="#cb34-428"></a>    <span class="at">x =</span> <span class="st">"Did it Rain Yesterday?"</span>,</span>
<span id="cb34-429"><a href="#cb34-429"></a>    <span class="at">y =</span> <span class="st">"Did it Rain Today?"</span>,</span>
<span id="cb34-430"><a href="#cb34-430"></a>    <span class="at">fill =</span> <span class="st">"Probability"</span></span>
<span id="cb34-431"><a href="#cb34-431"></a>  ) <span class="sc">+</span></span>
<span id="cb34-432"><a href="#cb34-432"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-433"><a href="#cb34-433"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-434"><a href="#cb34-434"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-435"><a href="#cb34-435"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb34-436"><a href="#cb34-436"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb34-437"><a href="#cb34-437"></a>  )</span>
<span id="cb34-438"><a href="#cb34-438"></a><span class="in">```</span></span>
<span id="cb34-439"><a href="#cb34-439"></a></span>
<span id="cb34-440"><a href="#cb34-440"></a>The Chi-squared test yields $\chi^2 \approx 13,718$, $p &lt; 0.001$, rejecting daily independence by a large margin. Cramer's V ($V \approx 0.31$) confirms a moderate practical effect size.</span>
<span id="cb34-441"><a href="#cb34-441"></a></span>
<span id="cb34-442"><a href="#cb34-442"></a>The transition matrix (@fig-markov-chain) reveals an important asymmetry. When the previous day was dry, there is an 85% probability of remaining dry, high-pressure systems are persistent and self-reinforcing. When the previous day was wet, there is only a 47% probability of continued rain, meaning wet events are more transient. This asymmetry has a direct atmospheric interpretation: anticyclonic systems can persist for days to weeks, while frontal systems pass through more quickly.</span>
<span id="cb34-443"><a href="#cb34-443"></a></span>
<span id="cb34-444"><a href="#cb34-444"></a><span class="in">`rain_today`</span> (lagged one day) carries meaningful predictive signal. Its modest effect size also demonstrates that autocorrelation alone is insufficient: the wet state is too transient for a persistence-only rule, and other meteorological covariates are necessary.</span>
<span id="cb34-445"><a href="#cb34-445"></a></span>
<span id="cb34-446"><a href="#cb34-446"></a><span class="fu">### Dry Spell Dynamics and Temporal Decay {#sec-dry-spell}</span></span>
<span id="cb34-447"><a href="#cb34-447"></a></span>
<span id="cb34-450"><a href="#cb34-450"></a><span class="in">```{r}</span></span>
<span id="cb34-451"><a href="#cb34-451"></a><span class="co">#| label: dry-spell-prep</span></span>
<span id="cb34-452"><a href="#cb34-452"></a><span class="co">#| echo: true</span></span>
<span id="cb34-453"><a href="#cb34-453"></a><span class="co">#| message: false</span></span>
<span id="cb34-454"><a href="#cb34-454"></a><span class="co">#| warning: false</span></span>
<span id="cb34-455"><a href="#cb34-455"></a></span>
<span id="cb34-456"><a href="#cb34-456"></a>dry_spell_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-457"><a href="#cb34-457"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb34-458"><a href="#cb34-458"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb34-459"><a href="#cb34-459"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-460"><a href="#cb34-460"></a>    <span class="at">did_rain_yesterday =</span> <span class="fu">lag</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">default =</span> <span class="cn">FALSE</span>),</span>
<span id="cb34-461"><a href="#cb34-461"></a>    <span class="at">dry_spell_id =</span> <span class="fu">cumsum</span>(did_rain_yesterday)</span>
<span id="cb34-462"><a href="#cb34-462"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-463"><a href="#cb34-463"></a>  <span class="fu">group_by</span>(location, dry_spell_id) <span class="sc">%&gt;%</span></span>
<span id="cb34-464"><a href="#cb34-464"></a>  <span class="fu">mutate</span>(<span class="at">days_since_rain =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb34-465"><a href="#cb34-465"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-466"><a href="#cb34-466"></a>  <span class="fu">filter</span>(days_since_rain <span class="sc">&lt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-467"><a href="#cb34-467"></a>  <span class="fu">mutate</span>(<span class="at">rain_binary =</span> <span class="fu">as.numeric</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>))</span>
<span id="cb34-468"><a href="#cb34-468"></a><span class="in">```</span></span>
<span id="cb34-469"><a href="#cb34-469"></a></span>
<span id="cb34-472"><a href="#cb34-472"></a><span class="in">```{r}</span></span>
<span id="cb34-473"><a href="#cb34-473"></a><span class="co">#| label: dry-spell-model</span></span>
<span id="cb34-474"><a href="#cb34-474"></a><span class="co">#| echo: true</span></span>
<span id="cb34-475"><a href="#cb34-475"></a><span class="co">#| collapse: true</span></span>
<span id="cb34-476"><a href="#cb34-476"></a></span>
<span id="cb34-477"><a href="#cb34-477"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb34-478"><a href="#cb34-478"></a>  rain_binary <span class="sc">~</span> days_since_rain,</span>
<span id="cb34-479"><a href="#cb34-479"></a>  <span class="at">data =</span> dry_spell_data,</span>
<span id="cb34-480"><a href="#cb34-480"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb34-481"><a href="#cb34-481"></a>)</span>
<span id="cb34-482"><a href="#cb34-482"></a></span>
<span id="cb34-483"><a href="#cb34-483"></a>wald_test <span class="ot">&lt;-</span> aod<span class="sc">::</span><span class="fu">wald.test</span>(</span>
<span id="cb34-484"><a href="#cb34-484"></a>  <span class="at">b =</span> <span class="fu">coef</span>(logit_model),</span>
<span id="cb34-485"><a href="#cb34-485"></a>  <span class="at">Sigma =</span> <span class="fu">vcov</span>(logit_model),</span>
<span id="cb34-486"><a href="#cb34-486"></a>  <span class="at">Terms =</span> <span class="dv">2</span></span>
<span id="cb34-487"><a href="#cb34-487"></a>)</span>
<span id="cb34-488"><a href="#cb34-488"></a>or_results <span class="ot">&lt;-</span> <span class="fu">tidy</span>(logit_model, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-489"><a href="#cb34-489"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"days_since_rain"</span>)</span>
<span id="cb34-490"><a href="#cb34-490"></a></span>
<span id="cb34-491"><a href="#cb34-491"></a><span class="fu">print</span>(wald_test)</span>
<span id="cb34-492"><a href="#cb34-492"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(</span>
<span id="cb34-493"><a href="#cb34-493"></a>  <span class="st">"</span><span class="sc">\n</span><span class="st">For each additional day without rain, odds of rainfall decrease by %.1f%%</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb34-494"><a href="#cb34-494"></a>  (<span class="dv">1</span> <span class="sc">-</span> or_results<span class="sc">$</span>estimate) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb34-495"><a href="#cb34-495"></a>))</span>
<span id="cb34-496"><a href="#cb34-496"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(</span>
<span id="cb34-497"><a href="#cb34-497"></a>  <span class="st">"95%% CI: [%.3f, %.3f]</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb34-498"><a href="#cb34-498"></a>  or_results<span class="sc">$</span>conf.low,</span>
<span id="cb34-499"><a href="#cb34-499"></a>  or_results<span class="sc">$</span>conf.high</span>
<span id="cb34-500"><a href="#cb34-500"></a>))</span>
<span id="cb34-501"><a href="#cb34-501"></a><span class="in">```</span></span>
<span id="cb34-502"><a href="#cb34-502"></a></span>
<span id="cb34-505"><a href="#cb34-505"></a><span class="in">```{r}</span></span>
<span id="cb34-506"><a href="#cb34-506"></a><span class="co">#| label: dry-spell-spline</span></span>
<span id="cb34-507"><a href="#cb34-507"></a><span class="co">#| echo: true</span></span>
<span id="cb34-508"><a href="#cb34-508"></a><span class="co">#| collapse: true</span></span>
<span id="cb34-509"><a href="#cb34-509"></a></span>
<span id="cb34-510"><a href="#cb34-510"></a>logit_spline <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb34-511"><a href="#cb34-511"></a>  rain_binary <span class="sc">~</span> splines<span class="sc">::</span><span class="fu">ns</span>(days_since_rain, <span class="at">df =</span> <span class="dv">4</span>),</span>
<span id="cb34-512"><a href="#cb34-512"></a>  <span class="at">data =</span> dry_spell_data,</span>
<span id="cb34-513"><a href="#cb34-513"></a>  <span class="at">family =</span> binomial</span>
<span id="cb34-514"><a href="#cb34-514"></a>)</span>
<span id="cb34-515"><a href="#cb34-515"></a></span>
<span id="cb34-516"><a href="#cb34-516"></a>lrt_result <span class="ot">&lt;-</span> <span class="fu">anova</span>(logit_model, logit_spline, <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb34-517"><a href="#cb34-517"></a><span class="fu">print</span>(lrt_result)</span>
<span id="cb34-518"><a href="#cb34-518"></a><span class="in">```</span></span>
<span id="cb34-519"><a href="#cb34-519"></a></span>
<span id="cb34-522"><a href="#cb34-522"></a><span class="in">```{r}</span></span>
<span id="cb34-523"><a href="#cb34-523"></a><span class="co">#| label: fig-dry-spell</span></span>
<span id="cb34-524"><a href="#cb34-524"></a><span class="co">#| fig-cap: "The drying effect: empirical vs. modelled probability of rainfall by days since last rain. The rapid initial decline followed by a plateau motivates a spline parameterisation rather than a linear logistic term."</span></span>
<span id="cb34-525"><a href="#cb34-525"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb34-526"><a href="#cb34-526"></a><span class="co">#| fig-height: 7</span></span>
<span id="cb34-527"><a href="#cb34-527"></a><span class="co">#| echo: true</span></span>
<span id="cb34-528"><a href="#cb34-528"></a><span class="co">#| warning: false</span></span>
<span id="cb34-529"><a href="#cb34-529"></a></span>
<span id="cb34-530"><a href="#cb34-530"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">days_since_rain =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb34-531"><a href="#cb34-531"></a>pred_data<span class="sc">$</span>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb34-532"><a href="#cb34-532"></a>  logit_model,</span>
<span id="cb34-533"><a href="#cb34-533"></a>  <span class="at">newdata =</span> pred_data,</span>
<span id="cb34-534"><a href="#cb34-534"></a>  <span class="at">type =</span> <span class="st">"response"</span></span>
<span id="cb34-535"><a href="#cb34-535"></a>)</span>
<span id="cb34-536"><a href="#cb34-536"></a>pred_data<span class="sc">$</span>pred_se <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb34-537"><a href="#cb34-537"></a>  logit_model,</span>
<span id="cb34-538"><a href="#cb34-538"></a>  <span class="at">newdata =</span> pred_data,</span>
<span id="cb34-539"><a href="#cb34-539"></a>  <span class="at">type =</span> <span class="st">"response"</span>,</span>
<span id="cb34-540"><a href="#cb34-540"></a>  <span class="at">se.fit =</span> <span class="cn">TRUE</span></span>
<span id="cb34-541"><a href="#cb34-541"></a>)<span class="sc">$</span>se.fit</span>
<span id="cb34-542"><a href="#cb34-542"></a></span>
<span id="cb34-543"><a href="#cb34-543"></a>empirical_probs <span class="ot">&lt;-</span> dry_spell_data <span class="sc">%&gt;%</span></span>
<span id="cb34-544"><a href="#cb34-544"></a>  <span class="fu">group_by</span>(days_since_rain) <span class="sc">%&gt;%</span></span>
<span id="cb34-545"><a href="#cb34-545"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-546"><a href="#cb34-546"></a>    <span class="at">prob_rain =</span> <span class="fu">mean</span>(rain_binary, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-547"><a href="#cb34-547"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb34-548"><a href="#cb34-548"></a>    <span class="at">se =</span> <span class="fu">sqrt</span>(prob_rain <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prob_rain) <span class="sc">/</span> n)</span>
<span id="cb34-549"><a href="#cb34-549"></a>  )</span>
<span id="cb34-550"><a href="#cb34-550"></a></span>
<span id="cb34-551"><a href="#cb34-551"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb34-552"><a href="#cb34-552"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb34-553"><a href="#cb34-553"></a>    <span class="at">data =</span> pred_data,</span>
<span id="cb34-554"><a href="#cb34-554"></a>    <span class="fu">aes</span>(</span>
<span id="cb34-555"><a href="#cb34-555"></a>      <span class="at">x =</span> days_since_rain,</span>
<span id="cb34-556"><a href="#cb34-556"></a>      <span class="at">ymin =</span> pred_prob <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_se,</span>
<span id="cb34-557"><a href="#cb34-557"></a>      <span class="at">ymax =</span> pred_prob <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_se</span>
<span id="cb34-558"><a href="#cb34-558"></a>    ),</span>
<span id="cb34-559"><a href="#cb34-559"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb34-560"><a href="#cb34-560"></a>    <span class="at">fill =</span> <span class="st">"firebrick"</span></span>
<span id="cb34-561"><a href="#cb34-561"></a>  ) <span class="sc">+</span></span>
<span id="cb34-562"><a href="#cb34-562"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb34-563"><a href="#cb34-563"></a>    <span class="at">data =</span> pred_data,</span>
<span id="cb34-564"><a href="#cb34-564"></a>    <span class="fu">aes</span>(<span class="at">x =</span> days_since_rain, <span class="at">y =</span> pred_prob),</span>
<span id="cb34-565"><a href="#cb34-565"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span>,</span>
<span id="cb34-566"><a href="#cb34-566"></a>    <span class="at">size =</span> <span class="fl">1.2</span>,</span>
<span id="cb34-567"><a href="#cb34-567"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb34-568"><a href="#cb34-568"></a>  ) <span class="sc">+</span></span>
<span id="cb34-569"><a href="#cb34-569"></a>  <span class="fu">geom_pointrange</span>(</span>
<span id="cb34-570"><a href="#cb34-570"></a>    <span class="at">data =</span> empirical_probs,</span>
<span id="cb34-571"><a href="#cb34-571"></a>    <span class="fu">aes</span>(</span>
<span id="cb34-572"><a href="#cb34-572"></a>      <span class="at">x =</span> days_since_rain,</span>
<span id="cb34-573"><a href="#cb34-573"></a>      <span class="at">y =</span> prob_rain,</span>
<span id="cb34-574"><a href="#cb34-574"></a>      <span class="at">ymin =</span> prob_rain <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb34-575"><a href="#cb34-575"></a>      <span class="at">ymax =</span> prob_rain <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se</span>
<span id="cb34-576"><a href="#cb34-576"></a>    ),</span>
<span id="cb34-577"><a href="#cb34-577"></a>    <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb34-578"><a href="#cb34-578"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb34-579"><a href="#cb34-579"></a>  ) <span class="sc">+</span></span>
<span id="cb34-580"><a href="#cb34-580"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb34-581"><a href="#cb34-581"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="dv">1</span>),</span>
<span id="cb34-582"><a href="#cb34-582"></a>    <span class="at">breaks =</span> <span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">6</span>)</span>
<span id="cb34-583"><a href="#cb34-583"></a>  ) <span class="sc">+</span></span>
<span id="cb34-584"><a href="#cb34-584"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>()) <span class="sc">+</span></span>
<span id="cb34-585"><a href="#cb34-585"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-586"><a href="#cb34-586"></a>    <span class="at">x =</span> <span class="st">"Days Since Last Rain"</span>,</span>
<span id="cb34-587"><a href="#cb34-587"></a>    <span class="at">y =</span> <span class="st">"Probability of Rainfall"</span>,</span>
<span id="cb34-588"><a href="#cb34-588"></a>    <span class="at">title =</span> <span class="st">"Dry Spell Effect on Rain Probability"</span>,</span>
<span id="cb34-589"><a href="#cb34-589"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(</span>
<span id="cb34-590"><a href="#cb34-590"></a>      <span class="st">"Logistic Regression: B = %.4f, Wald chi2 = %.2f, p &lt; 0.001</span><span class="sc">\n</span><span class="st">Each additional dry day reduces odds of rain by %.1f%%"</span>,</span>
<span id="cb34-591"><a href="#cb34-591"></a>      <span class="fu">coef</span>(logit_model)[<span class="dv">2</span>],</span>
<span id="cb34-592"><a href="#cb34-592"></a>      wald_test<span class="sc">$</span>result<span class="sc">$</span>chi2[<span class="dv">1</span>],</span>
<span id="cb34-593"><a href="#cb34-593"></a>      (<span class="dv">1</span> <span class="sc">-</span> or_results<span class="sc">$</span>estimate) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb34-594"><a href="#cb34-594"></a>    ),</span>
<span id="cb34-595"><a href="#cb34-595"></a>    <span class="at">caption =</span> <span class="st">"Points: Empirical probabilities +/- 95% CI | Line: Logistic model fit"</span></span>
<span id="cb34-596"><a href="#cb34-596"></a>  ) <span class="sc">+</span></span>
<span id="cb34-597"><a href="#cb34-597"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb34-598"><a href="#cb34-598"></a><span class="in">```</span></span>
<span id="cb34-599"><a href="#cb34-599"></a></span>
<span id="cb34-600"><a href="#cb34-600"></a>A logistic regression of daily rain occurrence on <span class="in">`days_since_rain`</span> yields $OR = 0.835$ (Wald $\chi^2 \approx 8099$, $p &lt; 0.001$): each additional dry day reduces the odds of rainfall by approximately 16.5%. This is consistent with the progressive establishment of stable high-pressure ridges documented in the Markov analysis.</span>
<span id="cb34-601"><a href="#cb34-601"></a></span>
<span id="cb34-602"><a href="#cb34-602"></a>The linear model is however an approximation. The LRT against a four-knot natural spline is highly significant ($\chi^2 \approx 7678$, $p &lt; 0.001$). The empirical pattern (@fig-dry-spell) shows rain probability falling sharply from approximately 48% on Day 1 to around 18% by Day 10, then plateauing in the 12–16% range through Days 15 to 30. The linear model underestimates the initial steepness and overestimates long-drought decline rates. This "rapid-then-gradual" decay motivates a spline parameterisation of <span class="in">`days_since_rain`</span> rather than a simple linear term.</span>
<span id="cb34-603"><a href="#cb34-603"></a></span>
<span id="cb34-604"><a href="#cb34-604"></a>---</span>
<span id="cb34-605"><a href="#cb34-605"></a></span>
<span id="cb34-606"><a href="#cb34-606"></a><span class="fu">## Atmospheric Pressure Dynamics</span></span>
<span id="cb34-607"><a href="#cb34-607"></a></span>
<span id="cb34-610"><a href="#cb34-610"></a><span class="in">```{r}</span></span>
<span id="cb34-611"><a href="#cb34-611"></a><span class="co">#| label: pressure-prep-normality</span></span>
<span id="cb34-612"><a href="#cb34-612"></a><span class="co">#| echo: true</span></span>
<span id="cb34-613"><a href="#cb34-613"></a><span class="co">#| message: false</span></span>
<span id="cb34-614"><a href="#cb34-614"></a><span class="co">#| warning: false</span></span>
<span id="cb34-615"><a href="#cb34-615"></a></span>
<span id="cb34-616"><a href="#cb34-616"></a>pressure_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-617"><a href="#cb34-617"></a>  <span class="fu">mutate</span>(<span class="at">pressure_change =</span> pressure3pm <span class="sc">-</span> pressure9am) <span class="sc">%&gt;%</span></span>
<span id="cb34-618"><a href="#cb34-618"></a>  <span class="fu">select</span>(rain_today, pressure9am, pressure3pm, pressure_change) <span class="sc">%&gt;%</span></span>
<span id="cb34-619"><a href="#cb34-619"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pressure9am), <span class="sc">!</span><span class="fu">is.na</span>(rain_today))</span>
<span id="cb34-620"><a href="#cb34-620"></a></span>
<span id="cb34-621"><a href="#cb34-621"></a>pressure_data <span class="sc">%&gt;%</span></span>
<span id="cb34-622"><a href="#cb34-622"></a>  <span class="fu">sample_n</span>(<span class="dv">5000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-623"><a href="#cb34-623"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb34-624"><a href="#cb34-624"></a>    <span class="at">cols =</span> <span class="fu">c</span>(pressure9am, pressure3pm, pressure_change),</span>
<span id="cb34-625"><a href="#cb34-625"></a>    <span class="at">names_to =</span> <span class="st">"metric"</span>,</span>
<span id="cb34-626"><a href="#cb34-626"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb34-627"><a href="#cb34-627"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-628"><a href="#cb34-628"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> value)) <span class="sc">+</span></span>
<span id="cb34-629"><a href="#cb34-629"></a>  <span class="fu">stat_qq</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb34-630"><a href="#cb34-630"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb34-631"><a href="#cb34-631"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb34-632"><a href="#cb34-632"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-633"><a href="#cb34-633"></a>    <span class="at">title =</span> <span class="st">"Q-Q Plots: Normality Check for Pressure Variables"</span>,</span>
<span id="cb34-634"><a href="#cb34-634"></a>    <span class="at">subtitle =</span> <span class="st">"Modest tail deviations acceptable at N &gt; 140,000 (CLT applies)."</span></span>
<span id="cb34-635"><a href="#cb34-635"></a>  ) <span class="sc">+</span></span>
<span id="cb34-636"><a href="#cb34-636"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb34-637"><a href="#cb34-637"></a><span class="in">```</span></span>
<span id="cb34-638"><a href="#cb34-638"></a></span>
<span id="cb34-641"><a href="#cb34-641"></a><span class="in">```{r}</span></span>
<span id="cb34-642"><a href="#cb34-642"></a><span class="co">#| label: pressure-stats</span></span>
<span id="cb34-643"><a href="#cb34-643"></a><span class="co">#| echo: true</span></span>
<span id="cb34-644"><a href="#cb34-644"></a><span class="co">#| message: false</span></span>
<span id="cb34-645"><a href="#cb34-645"></a></span>
<span id="cb34-646"><a href="#cb34-646"></a>test_data <span class="ot">&lt;-</span> pressure_data <span class="sc">%&gt;%</span></span>
<span id="cb34-647"><a href="#cb34-647"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb34-648"><a href="#cb34-648"></a>    <span class="at">cols =</span> <span class="fu">c</span>(pressure9am, pressure3pm, pressure_change),</span>
<span id="cb34-649"><a href="#cb34-649"></a>    <span class="at">names_to =</span> <span class="st">"metric"</span>,</span>
<span id="cb34-650"><a href="#cb34-650"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb34-651"><a href="#cb34-651"></a>  )</span>
<span id="cb34-652"><a href="#cb34-652"></a></span>
<span id="cb34-653"><a href="#cb34-653"></a>stats_results <span class="ot">&lt;-</span> test_data <span class="sc">%&gt;%</span></span>
<span id="cb34-654"><a href="#cb34-654"></a>  <span class="fu">group_by</span>(metric) <span class="sc">%&gt;%</span></span>
<span id="cb34-655"><a href="#cb34-655"></a>  <span class="fu">t_test</span>(value <span class="sc">~</span> rain_today, <span class="at">var.equal =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-656"><a href="#cb34-656"></a>  <span class="fu">adjust_pvalue</span>(<span class="at">method =</span> <span class="st">"holm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-657"><a href="#cb34-657"></a>  <span class="fu">add_significance</span>()</span>
<span id="cb34-658"><a href="#cb34-658"></a></span>
<span id="cb34-659"><a href="#cb34-659"></a>stats_results <span class="sc">%&gt;%</span></span>
<span id="cb34-660"><a href="#cb34-660"></a>  <span class="fu">select</span>(metric, group1, group2, statistic, df, p.adj, p.adj.signif) <span class="sc">%&gt;%</span></span>
<span id="cb34-661"><a href="#cb34-661"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-662"><a href="#cb34-662"></a>    <span class="at">caption =</span> <span class="st">"Welch Two-Sample t-test Results (Bonferroni-Holm Corrected)"</span>,</span>
<span id="cb34-663"><a href="#cb34-663"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb34-664"><a href="#cb34-664"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb34-665"><a href="#cb34-665"></a>      <span class="st">"Metric"</span>,</span>
<span id="cb34-666"><a href="#cb34-666"></a>      <span class="st">"Group 1"</span>,</span>
<span id="cb34-667"><a href="#cb34-667"></a>      <span class="st">"Group 2"</span>,</span>
<span id="cb34-668"><a href="#cb34-668"></a>      <span class="st">"t-statistic"</span>,</span>
<span id="cb34-669"><a href="#cb34-669"></a>      <span class="st">"df"</span>,</span>
<span id="cb34-670"><a href="#cb34-670"></a>      <span class="st">"Adj. P-Value"</span>,</span>
<span id="cb34-671"><a href="#cb34-671"></a>      <span class="st">"Significance"</span></span>
<span id="cb34-672"><a href="#cb34-672"></a>    )</span>
<span id="cb34-673"><a href="#cb34-673"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-674"><a href="#cb34-674"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-675"><a href="#cb34-675"></a><span class="in">```</span></span>
<span id="cb34-676"><a href="#cb34-676"></a></span>
<span id="cb34-679"><a href="#cb34-679"></a><span class="in">```{r}</span></span>
<span id="cb34-680"><a href="#cb34-680"></a><span class="co">#| label: pressure-effect-size</span></span>
<span id="cb34-681"><a href="#cb34-681"></a><span class="co">#| echo: true</span></span>
<span id="cb34-682"><a href="#cb34-682"></a><span class="co">#| message: false</span></span>
<span id="cb34-683"><a href="#cb34-683"></a></span>
<span id="cb34-684"><a href="#cb34-684"></a>effect_sizes <span class="ot">&lt;-</span> test_data <span class="sc">%&gt;%</span></span>
<span id="cb34-685"><a href="#cb34-685"></a>  <span class="fu">group_by</span>(metric) <span class="sc">%&gt;%</span></span>
<span id="cb34-686"><a href="#cb34-686"></a>  <span class="fu">cohens_d</span>(value <span class="sc">~</span> rain_today, <span class="at">var.equal =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-687"><a href="#cb34-687"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-688"><a href="#cb34-688"></a>    <span class="at">magnitude =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-689"><a href="#cb34-689"></a>      <span class="fu">abs</span>(effsize) <span class="sc">&lt;</span> <span class="fl">0.2</span> <span class="sc">~</span> <span class="st">"Negligible"</span>,</span>
<span id="cb34-690"><a href="#cb34-690"></a>      <span class="fu">abs</span>(effsize) <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Small"</span>,</span>
<span id="cb34-691"><a href="#cb34-691"></a>      <span class="fu">abs</span>(effsize) <span class="sc">&lt;</span> <span class="fl">0.8</span> <span class="sc">~</span> <span class="st">"Medium"</span>,</span>
<span id="cb34-692"><a href="#cb34-692"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Large"</span></span>
<span id="cb34-693"><a href="#cb34-693"></a>    )</span>
<span id="cb34-694"><a href="#cb34-694"></a>  )</span>
<span id="cb34-695"><a href="#cb34-695"></a></span>
<span id="cb34-696"><a href="#cb34-696"></a>effect_sizes <span class="sc">%&gt;%</span></span>
<span id="cb34-697"><a href="#cb34-697"></a>  <span class="fu">select</span>(metric, effsize, magnitude) <span class="sc">%&gt;%</span></span>
<span id="cb34-698"><a href="#cb34-698"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-699"><a href="#cb34-699"></a>    <span class="at">caption =</span> <span class="st">"Cohen's d Effect Size Analysis"</span>,</span>
<span id="cb34-700"><a href="#cb34-700"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb34-701"><a href="#cb34-701"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Effect Size (d)"</span>, <span class="st">"Interpretation"</span>)</span>
<span id="cb34-702"><a href="#cb34-702"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-703"><a href="#cb34-703"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-704"><a href="#cb34-704"></a><span class="in">```</span></span>
<span id="cb34-705"><a href="#cb34-705"></a></span>
<span id="cb34-708"><a href="#cb34-708"></a><span class="in">```{r}</span></span>
<span id="cb34-709"><a href="#cb34-709"></a><span class="co">#| label: fig-pressure-violin</span></span>
<span id="cb34-710"><a href="#cb34-710"></a><span class="co">#| fig-cap: "Violin plots of atmospheric pressure variables by rainfall state. The pressure_change panel shows the most pronounced separation."</span></span>
<span id="cb34-711"><a href="#cb34-711"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb34-712"><a href="#cb34-712"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb34-713"><a href="#cb34-713"></a><span class="co">#| echo: true</span></span>
<span id="cb34-714"><a href="#cb34-714"></a><span class="co">#| warning: false</span></span>
<span id="cb34-715"><a href="#cb34-715"></a></span>
<span id="cb34-716"><a href="#cb34-716"></a>plot_annotations <span class="ot">&lt;-</span> stats_results <span class="sc">%&gt;%</span></span>
<span id="cb34-717"><a href="#cb34-717"></a>  <span class="fu">left_join</span>(effect_sizes, <span class="at">by =</span> <span class="st">"metric"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-718"><a href="#cb34-718"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-719"><a href="#cb34-719"></a>    <span class="at">label_text =</span> <span class="fu">sprintf</span>(</span>
<span id="cb34-720"><a href="#cb34-720"></a>      <span class="st">"p %s</span><span class="sc">\n</span><span class="st">Cohen's d = %.2f (%s)"</span>,</span>
<span id="cb34-721"><a href="#cb34-721"></a>      p.adj.signif,</span>
<span id="cb34-722"><a href="#cb34-722"></a>      effsize,</span>
<span id="cb34-723"><a href="#cb34-723"></a>      magnitude</span>
<span id="cb34-724"><a href="#cb34-724"></a>    ),</span>
<span id="cb34-725"><a href="#cb34-725"></a>    <span class="at">y_pos =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-726"><a href="#cb34-726"></a>      metric <span class="sc">==</span> <span class="st">"pressure9am"</span> <span class="sc">~</span> <span class="dv">1045</span>,</span>
<span id="cb34-727"><a href="#cb34-727"></a>      metric <span class="sc">==</span> <span class="st">"pressure3pm"</span> <span class="sc">~</span> <span class="dv">1040</span>,</span>
<span id="cb34-728"><a href="#cb34-728"></a>      metric <span class="sc">==</span> <span class="st">"pressure_change"</span> <span class="sc">~</span> <span class="dv">15</span></span>
<span id="cb34-729"><a href="#cb34-729"></a>    )</span>
<span id="cb34-730"><a href="#cb34-730"></a>  )</span>
<span id="cb34-731"><a href="#cb34-731"></a></span>
<span id="cb34-732"><a href="#cb34-732"></a><span class="fu">ggplot</span>(test_data, <span class="fu">aes</span>(rain_today, value, <span class="at">fill =</span> rain_today)) <span class="sc">+</span></span>
<span id="cb34-733"><a href="#cb34-733"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb34-734"><a href="#cb34-734"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb34-735"><a href="#cb34-735"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb34-736"><a href="#cb34-736"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb34-737"><a href="#cb34-737"></a>    <span class="at">data =</span> plot_annotations,</span>
<span id="cb34-738"><a href="#cb34-738"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> y_pos, <span class="at">label =</span> label_text),</span>
<span id="cb34-739"><a href="#cb34-739"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-740"><a href="#cb34-740"></a>    <span class="at">vjust =</span> <span class="dv">0</span>,</span>
<span id="cb34-741"><a href="#cb34-741"></a>    <span class="at">fontface =</span> <span class="st">"italic"</span>,</span>
<span id="cb34-742"><a href="#cb34-742"></a>    <span class="at">size =</span> <span class="fl">3.5</span></span>
<span id="cb34-743"><a href="#cb34-743"></a>  ) <span class="sc">+</span></span>
<span id="cb34-744"><a href="#cb34-744"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#B0B0B0"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>)) <span class="sc">+</span></span>
<span id="cb34-745"><a href="#cb34-745"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-746"><a href="#cb34-746"></a>    <span class="at">title =</span> <span class="st">"Atmospheric Pressure vs. Rainfall"</span>,</span>
<span id="cb34-747"><a href="#cb34-747"></a>    <span class="at">subtitle =</span> <span class="st">"Welch's t-test with Cohen's d effect sizes"</span>,</span>
<span id="cb34-748"><a href="#cb34-748"></a>    <span class="at">y =</span> <span class="st">"Pressure (hPa)"</span>,</span>
<span id="cb34-749"><a href="#cb34-749"></a>    <span class="at">x =</span> <span class="st">"Did it rain?"</span></span>
<span id="cb34-750"><a href="#cb34-750"></a>  ) <span class="sc">+</span></span>
<span id="cb34-751"><a href="#cb34-751"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-752"><a href="#cb34-752"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-753"><a href="#cb34-753"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb34-754"><a href="#cb34-754"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb34-755"><a href="#cb34-755"></a>  )</span>
<span id="cb34-756"><a href="#cb34-756"></a><span class="in">```</span></span>
<span id="cb34-757"><a href="#cb34-757"></a></span>
<span id="cb34-760"><a href="#cb34-760"></a><span class="in">```{r}</span></span>
<span id="cb34-761"><a href="#cb34-761"></a><span class="co">#| label: fig-pressure-means</span></span>
<span id="cb34-762"><a href="#cb34-762"></a><span class="co">#| fig-cap: "Mean pressure levels and diurnal drop by rainfall state. The suppressed pressure drop on rainy days (1.3 vs. 2.7 hPa) is a stronger discriminating signal than the absolute pressure baseline."</span></span>
<span id="cb34-763"><a href="#cb34-763"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb34-764"><a href="#cb34-764"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb34-765"><a href="#cb34-765"></a><span class="co">#| echo: true</span></span>
<span id="cb34-766"><a href="#cb34-766"></a><span class="co">#| warning: false</span></span>
<span id="cb34-767"><a href="#cb34-767"></a></span>
<span id="cb34-768"><a href="#cb34-768"></a>data_wide <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-769"><a href="#cb34-769"></a>  <span class="fu">group_by</span>(rain_today) <span class="sc">%&gt;%</span></span>
<span id="cb34-770"><a href="#cb34-770"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-771"><a href="#cb34-771"></a>    <span class="st">`</span><span class="at">9:00 AM</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(pressure9am, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-772"><a href="#cb34-772"></a>    <span class="st">`</span><span class="at">3:00 PM</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(pressure3pm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-773"><a href="#cb34-773"></a>    <span class="st">`</span><span class="at">Pressure Drop</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(pressure9am, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span></span>
<span id="cb34-774"><a href="#cb34-774"></a>      <span class="fu">mean</span>(pressure3pm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-775"><a href="#cb34-775"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-776"><a href="#cb34-776"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>rain_today, <span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-777"><a href="#cb34-777"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-778"><a href="#cb34-778"></a>    <span class="at">metric =</span> <span class="fu">factor</span>(metric, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"9:00 AM"</span>, <span class="st">"3:00 PM"</span>, <span class="st">"Pressure Drop"</span>)),</span>
<span id="cb34-779"><a href="#cb34-779"></a>    <span class="at">label_txt =</span> <span class="fu">round</span>(value, <span class="dv">1</span>)</span>
<span id="cb34-780"><a href="#cb34-780"></a>  )</span>
<span id="cb34-781"><a href="#cb34-781"></a></span>
<span id="cb34-782"><a href="#cb34-782"></a><span class="fu">ggplot</span>(data_wide, <span class="fu">aes</span>(<span class="at">x =</span> rain_today, <span class="at">y =</span> value, <span class="at">fill =</span> rain_today)) <span class="sc">+</span></span>
<span id="cb34-783"><a href="#cb34-783"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb34-784"><a href="#cb34-784"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label_txt), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb34-785"><a href="#cb34-785"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-786"><a href="#cb34-786"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#B0B0B0"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>)) <span class="sc">+</span></span>
<span id="cb34-787"><a href="#cb34-787"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"Dry Days"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"Rainy Days"</span>)) <span class="sc">+</span></span>
<span id="cb34-788"><a href="#cb34-788"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-789"><a href="#cb34-789"></a>    <span class="at">title =</span> <span class="st">"Rainy Days Show Lower Baseline Pressure and Suppressed Diurnal Variation"</span>,</span>
<span id="cb34-790"><a href="#cb34-790"></a>    <span class="at">subtitle =</span> <span class="st">"The diurnal pressure drop is the stronger discriminating signal"</span>,</span>
<span id="cb34-791"><a href="#cb34-791"></a>    <span class="at">y =</span> <span class="st">"Pressure (hPa) / Drop (hPa)"</span>,</span>
<span id="cb34-792"><a href="#cb34-792"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb34-793"><a href="#cb34-793"></a>  ) <span class="sc">+</span></span>
<span id="cb34-794"><a href="#cb34-794"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb34-795"><a href="#cb34-795"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-796"><a href="#cb34-796"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb34-797"><a href="#cb34-797"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-798"><a href="#cb34-798"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb34-799"><a href="#cb34-799"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-800"><a href="#cb34-800"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb34-801"><a href="#cb34-801"></a>  )</span>
<span id="cb34-802"><a href="#cb34-802"></a><span class="in">```</span></span>
<span id="cb34-803"><a href="#cb34-803"></a></span>
<span id="cb34-804"><a href="#cb34-804"></a>**Normality.** Q-Q plots show modest tail deviations, but with $N &gt; 140,000$ the CLT ensures normally distributed sample means. Welch's t-test is therefore valid without equal-variance assumptions, and Bonferroni-Holm correction is applied for multiple comparisons.</span>
<span id="cb34-805"><a href="#cb34-805"></a></span>
<span id="cb34-806"><a href="#cb34-806"></a>**Baseline pressure.** Rainy days show mean pressure of 1015 hPa at 9:00 AM versus 1018.5 hPa on dry days. Cohen's $d \approx 0.28$–$0.48$ represents a small-to-medium effect, consistent with absolute pressure being necessary but not sufficient for rain.</span>
<span id="cb34-807"><a href="#cb34-807"></a></span>
<span id="cb34-808"><a href="#cb34-808"></a>**Diurnal pressure change.** On dry days, pressure drops 2.7 hPa from morning to afternoon, the standard thermal low from daytime surface heating. On rainy days, this drop is suppressed to 1.3 hPa, because cloud cover reduces insolation. Cohen's $d = -0.72$ for <span class="in">`pressure_change`</span> is a medium effect, stronger than either absolute pressure reading individually. The rate of pressure change during the day is the more discriminating feature.</span>
<span id="cb34-809"><a href="#cb34-809"></a></span>
<span id="cb34-810"><a href="#cb34-810"></a>---</span>
<span id="cb34-811"><a href="#cb34-811"></a></span>
<span id="cb34-812"><a href="#cb34-812"></a><span class="fu">## Seasonal Rainfall Intensity</span></span>
<span id="cb34-813"><a href="#cb34-813"></a></span>
<span id="cb34-814"><a href="#cb34-814"></a><span class="fu">### Cyclical Patterns</span></span>
<span id="cb34-815"><a href="#cb34-815"></a></span>
<span id="cb34-818"><a href="#cb34-818"></a><span class="in">```{r}</span></span>
<span id="cb34-819"><a href="#cb34-819"></a><span class="co">#| label: seasonality-prep</span></span>
<span id="cb34-820"><a href="#cb34-820"></a><span class="co">#| echo: true</span></span>
<span id="cb34-821"><a href="#cb34-821"></a><span class="co">#| message: false</span></span>
<span id="cb34-822"><a href="#cb34-822"></a><span class="co">#| warning: false</span></span>
<span id="cb34-823"><a href="#cb34-823"></a></span>
<span id="cb34-824"><a href="#cb34-824"></a>monthly_stats <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-825"><a href="#cb34-825"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-826"><a href="#cb34-826"></a>  <span class="fu">group_by</span>(month) <span class="sc">%&gt;%</span></span>
<span id="cb34-827"><a href="#cb34-827"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-828"><a href="#cb34-828"></a>    <span class="at">median_rain =</span> <span class="fu">median</span>(rainfall),</span>
<span id="cb34-829"><a href="#cb34-829"></a>    <span class="at">mean_rain =</span> <span class="fu">mean</span>(rainfall),</span>
<span id="cb34-830"><a href="#cb34-830"></a>    <span class="at">rain_days =</span> <span class="fu">n</span>(),</span>
<span id="cb34-831"><a href="#cb34-831"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb34-832"><a href="#cb34-832"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-833"><a href="#cb34-833"></a>  <span class="fu">mutate</span>(<span class="at">month_label =</span> <span class="fu">factor</span>(month.abb[month], <span class="at">levels =</span> <span class="fu">rev</span>(month.abb)))</span>
<span id="cb34-834"><a href="#cb34-834"></a></span>
<span id="cb34-835"><a href="#cb34-835"></a>plot_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-836"><a href="#cb34-836"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-837"><a href="#cb34-837"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-838"><a href="#cb34-838"></a>    <span class="at">month_label =</span> <span class="fu">factor</span>(month.abb[month], <span class="at">levels =</span> <span class="fu">rev</span>(month.abb)),</span>
<span id="cb34-839"><a href="#cb34-839"></a>    <span class="at">log_rain =</span> <span class="fu">log</span>(rainfall)</span>
<span id="cb34-840"><a href="#cb34-840"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-841"><a href="#cb34-841"></a>  <span class="fu">left_join</span>(monthly_stats, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"month"</span>, <span class="st">"month_label"</span>))</span>
<span id="cb34-842"><a href="#cb34-842"></a><span class="in">```</span></span>
<span id="cb34-843"><a href="#cb34-843"></a></span>
<span id="cb34-846"><a href="#cb34-846"></a><span class="in">```{r}</span></span>
<span id="cb34-847"><a href="#cb34-847"></a><span class="co">#| label: fig-monthly-dist</span></span>
<span id="cb34-848"><a href="#cb34-848"></a><span class="co">#| fig-cap: "Ridgeline plot of monthly log-rainfall distributions. Shifting peaks illustrate how rainfall intensity varies cyclically relative to the global median (dashed line)."</span></span>
<span id="cb34-849"><a href="#cb34-849"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb34-850"><a href="#cb34-850"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb34-851"><a href="#cb34-851"></a><span class="co">#| echo: true</span></span>
<span id="cb34-852"><a href="#cb34-852"></a><span class="co">#| warning: false</span></span>
<span id="cb34-853"><a href="#cb34-853"></a></span>
<span id="cb34-854"><a href="#cb34-854"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(log_rain, month_label, <span class="at">fill =</span> <span class="fu">after_stat</span>(x))) <span class="sc">+</span></span>
<span id="cb34-855"><a href="#cb34-855"></a>  <span class="fu">geom_density_ridges_gradient</span>(</span>
<span id="cb34-856"><a href="#cb34-856"></a>    <span class="at">scale =</span> <span class="fl">2.5</span>,</span>
<span id="cb34-857"><a href="#cb34-857"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.01</span>,</span>
<span id="cb34-858"><a href="#cb34-858"></a>    <span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-859"><a href="#cb34-859"></a>    <span class="at">quantiles =</span> <span class="dv">2</span>,</span>
<span id="cb34-860"><a href="#cb34-860"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb34-861"><a href="#cb34-861"></a>  ) <span class="sc">+</span></span>
<span id="cb34-862"><a href="#cb34-862"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb34-863"><a href="#cb34-863"></a>    <span class="at">xintercept =</span> <span class="fu">median</span>(<span class="fu">log</span>(df_final<span class="sc">$</span>rainfall[df_final<span class="sc">$</span>rainfall <span class="sc">&gt;</span> <span class="dv">0</span>])),</span>
<span id="cb34-864"><a href="#cb34-864"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb34-865"><a href="#cb34-865"></a>    <span class="at">color =</span> <span class="st">"grey30"</span>,</span>
<span id="cb34-866"><a href="#cb34-866"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span></span>
<span id="cb34-867"><a href="#cb34-867"></a>  ) <span class="sc">+</span></span>
<span id="cb34-868"><a href="#cb34-868"></a>  <span class="fu">scale_fill_viridis_c</span>(</span>
<span id="cb34-869"><a href="#cb34-869"></a>    <span class="at">option =</span> <span class="st">"mako"</span>,</span>
<span id="cb34-870"><a href="#cb34-870"></a>    <span class="at">name =</span> <span class="st">"Log</span><span class="sc">\n</span><span class="st">Rainfall"</span>,</span>
<span id="cb34-871"><a href="#cb34-871"></a>    <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb34-872"><a href="#cb34-872"></a>  ) <span class="sc">+</span></span>
<span id="cb34-873"><a href="#cb34-873"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">pretty_breaks</span>()) <span class="sc">+</span></span>
<span id="cb34-874"><a href="#cb34-874"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-875"><a href="#cb34-875"></a>    <span class="at">title =</span> <span class="st">"Monthly Rainfall Distribution Patterns"</span>,</span>
<span id="cb34-876"><a href="#cb34-876"></a>    <span class="at">subtitle =</span> <span class="st">"Solid lines mark monthly medians vs. the global median (dashed)."</span>,</span>
<span id="cb34-877"><a href="#cb34-877"></a>    <span class="at">x =</span> <span class="st">"Rainfall Amount (mm, log scale)"</span>,</span>
<span id="cb34-878"><a href="#cb34-878"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb34-879"><a href="#cb34-879"></a>  ) <span class="sc">+</span></span>
<span id="cb34-880"><a href="#cb34-880"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span>
<span id="cb34-881"><a href="#cb34-881"></a><span class="in">```</span></span>
<span id="cb34-882"><a href="#cb34-882"></a></span>
<span id="cb34-885"><a href="#cb34-885"></a><span class="in">```{r}</span></span>
<span id="cb34-886"><a href="#cb34-886"></a><span class="co">#| label: fig-seasonal-facet</span></span>
<span id="cb34-887"><a href="#cb34-887"></a><span class="co">#| fig-cap: "Seasonal rainfall patterns by meteorological season. Summer exhibits high variance and a pronounced right tail; winter shows narrower, more predictable distributions."</span></span>
<span id="cb34-888"><a href="#cb34-888"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb34-889"><a href="#cb34-889"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb34-890"><a href="#cb34-890"></a><span class="co">#| echo: true</span></span>
<span id="cb34-891"><a href="#cb34-891"></a><span class="co">#| warning: false</span></span>
<span id="cb34-892"><a href="#cb34-892"></a></span>
<span id="cb34-893"><a href="#cb34-893"></a>seasonal_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-894"><a href="#cb34-894"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-895"><a href="#cb34-895"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-896"><a href="#cb34-896"></a>    <span class="at">season =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-897"><a href="#cb34-897"></a>      month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">~</span> <span class="st">"Summer"</span>,</span>
<span id="cb34-898"><a href="#cb34-898"></a>      month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>) <span class="sc">~</span> <span class="st">"Autumn"</span>,</span>
<span id="cb34-899"><a href="#cb34-899"></a>      month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>) <span class="sc">~</span> <span class="st">"Winter"</span>,</span>
<span id="cb34-900"><a href="#cb34-900"></a>      month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>) <span class="sc">~</span> <span class="st">"Spring"</span></span>
<span id="cb34-901"><a href="#cb34-901"></a>    ),</span>
<span id="cb34-902"><a href="#cb34-902"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Summer"</span>, <span class="st">"Autumn"</span>, <span class="st">"Winter"</span>, <span class="st">"Spring"</span>))</span>
<span id="cb34-903"><a href="#cb34-903"></a>  )</span>
<span id="cb34-904"><a href="#cb34-904"></a></span>
<span id="cb34-905"><a href="#cb34-905"></a>seasonal_data <span class="sc">%&gt;%</span></span>
<span id="cb34-906"><a href="#cb34-906"></a>  <span class="fu">mutate</span>(<span class="at">month_label =</span> <span class="fu">factor</span>(month.abb[month], <span class="at">levels =</span> month.abb)) <span class="sc">%&gt;%</span></span>
<span id="cb34-907"><a href="#cb34-907"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(rainfall, month_label, <span class="at">fill =</span> season)) <span class="sc">+</span></span>
<span id="cb34-908"><a href="#cb34-908"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb34-909"><a href="#cb34-909"></a>    <span class="at">scale =</span> <span class="fl">1.5</span>,</span>
<span id="cb34-910"><a href="#cb34-910"></a>    <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb34-911"><a href="#cb34-911"></a>    <span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-912"><a href="#cb34-912"></a>    <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)</span>
<span id="cb34-913"><a href="#cb34-913"></a>  ) <span class="sc">+</span></span>
<span id="cb34-914"><a href="#cb34-914"></a>  <span class="fu">scale_x_log10</span>(</span>
<span id="cb34-915"><a href="#cb34-915"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">300</span>),</span>
<span id="cb34-916"><a href="#cb34-916"></a>    <span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb34-917"><a href="#cb34-917"></a>  ) <span class="sc">+</span></span>
<span id="cb34-918"><a href="#cb34-918"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb34-919"><a href="#cb34-919"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb34-920"><a href="#cb34-920"></a>      <span class="st">"Summer"</span> <span class="ot">=</span> <span class="st">"#E69F00"</span>,</span>
<span id="cb34-921"><a href="#cb34-921"></a>      <span class="st">"Autumn"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>,</span>
<span id="cb34-922"><a href="#cb34-922"></a>      <span class="st">"Winter"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>,</span>
<span id="cb34-923"><a href="#cb34-923"></a>      <span class="st">"Spring"</span> <span class="ot">=</span> <span class="st">"#009E73"</span></span>
<span id="cb34-924"><a href="#cb34-924"></a>    )</span>
<span id="cb34-925"><a href="#cb34-925"></a>  ) <span class="sc">+</span></span>
<span id="cb34-926"><a href="#cb34-926"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>season, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb34-927"><a href="#cb34-927"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-928"><a href="#cb34-928"></a>    <span class="at">title =</span> <span class="st">"Seasonal Rainfall Patterns"</span>,</span>
<span id="cb34-929"><a href="#cb34-929"></a>    <span class="at">subtitle =</span> <span class="st">"Quartile lines show 25th, 50th, and 75th percentiles"</span>,</span>
<span id="cb34-930"><a href="#cb34-930"></a>    <span class="at">x =</span> <span class="st">"Rainfall Amount (mm, log scale)"</span>,</span>
<span id="cb34-931"><a href="#cb34-931"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb34-932"><a href="#cb34-932"></a>  ) <span class="sc">+</span></span>
<span id="cb34-933"><a href="#cb34-933"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb34-934"><a href="#cb34-934"></a><span class="in">```</span></span>
<span id="cb34-935"><a href="#cb34-935"></a></span>
<span id="cb34-938"><a href="#cb34-938"></a><span class="in">```{r}</span></span>
<span id="cb34-939"><a href="#cb34-939"></a><span class="co">#| label: fig-mean-rain-bar</span></span>
<span id="cb34-940"><a href="#cb34-940"></a><span class="co">#| fig-cap: "Average rainfall intensity on non-zero days by month. February records the highest mean intensity at 10.1 mm, nearly double July's 4.9 mm."</span></span>
<span id="cb34-941"><a href="#cb34-941"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb34-942"><a href="#cb34-942"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb34-943"><a href="#cb34-943"></a><span class="co">#| echo: true</span></span>
<span id="cb34-944"><a href="#cb34-944"></a><span class="co">#| warning: false</span></span>
<span id="cb34-945"><a href="#cb34-945"></a></span>
<span id="cb34-946"><a href="#cb34-946"></a>monthly_stats <span class="sc">%&gt;%</span></span>
<span id="cb34-947"><a href="#cb34-947"></a>  <span class="fu">mutate</span>(<span class="at">month_label =</span> <span class="fu">factor</span>(month.abb[month], <span class="at">levels =</span> month.abb)) <span class="sc">%&gt;%</span></span>
<span id="cb34-948"><a href="#cb34-948"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(month_label, mean_rain)) <span class="sc">+</span></span>
<span id="cb34-949"><a href="#cb34-949"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> mean_rain, <span class="at">alpha =</span> <span class="fl">0.8</span>), <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb34-950"><a href="#cb34-950"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb34-951"><a href="#cb34-951"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(mean_rain, <span class="dv">1</span>)),</span>
<span id="cb34-952"><a href="#cb34-952"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb34-953"><a href="#cb34-953"></a>    <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb34-954"><a href="#cb34-954"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span></span>
<span id="cb34-955"><a href="#cb34-955"></a>  ) <span class="sc">+</span></span>
<span id="cb34-956"><a href="#cb34-956"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"mako"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-957"><a href="#cb34-957"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-958"><a href="#cb34-958"></a>    <span class="at">title =</span> <span class="st">"Mean Rainfall by Month (Non-Zero Days)"</span>,</span>
<span id="cb34-959"><a href="#cb34-959"></a>    <span class="at">subtitle =</span> <span class="st">"Seasonal variation in intensity is distinct from seasonal variation in frequency"</span>,</span>
<span id="cb34-960"><a href="#cb34-960"></a>    <span class="at">y =</span> <span class="st">"Mean Rainfall (mm)"</span>,</span>
<span id="cb34-961"><a href="#cb34-961"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb34-962"><a href="#cb34-962"></a>  ) <span class="sc">+</span></span>
<span id="cb34-963"><a href="#cb34-963"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb34-964"><a href="#cb34-964"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-965"><a href="#cb34-965"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb34-966"><a href="#cb34-966"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb34-967"><a href="#cb34-967"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-968"><a href="#cb34-968"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb34-969"><a href="#cb34-969"></a>  )</span>
<span id="cb34-970"><a href="#cb34-970"></a><span class="in">```</span></span>
<span id="cb34-971"><a href="#cb34-971"></a></span>
<span id="cb34-972"><a href="#cb34-972"></a>The earlier frequency analysis (@sec-frequency) established *when* rain tends to occur. This section investigates *how much* falls when it does.</span>
<span id="cb34-973"><a href="#cb34-973"></a></span>
<span id="cb34-974"><a href="#cb34-974"></a>January and February distributions are shifted systematically right of the global median: summer storms are considerably more intense when they arrive, even though they occur less frequently. June through August cluster left, representing lower but more consistent rainfall. February records the highest mean intensity per wet day at 10.1 mm, nearly double July's 4.9 mm.</span>
<span id="cb34-975"><a href="#cb34-975"></a></span>
<span id="cb34-976"><a href="#cb34-976"></a>Summer rainfall has a wide interquartile range and a pronounced right tail beyond 100 mm per day, reflecting episodic convective storms. Winter shows a narrower, more peaked distribution. Both the frequency variation (more rain in winter) and the intensity variation (heavier rain in summer) carry independent information; a complete model must account for both dimensions.</span>
<span id="cb34-977"><a href="#cb34-977"></a></span>
<span id="cb34-978"><a href="#cb34-978"></a>**Encoding implication.** Because the seasonal cycle is continuous the transition from December to January is climatologically smooth treating <span class="in">`Month`</span> as unordered discards proximity information. Cyclical encoding via sine and cosine transformations of the month number preserves the circular geometry of the annual cycle.</span>
<span id="cb34-979"><a href="#cb34-979"></a></span>
<span id="cb34-980"><a href="#cb34-980"></a><span class="fu">### Statistical Validation</span></span>
<span id="cb34-981"><a href="#cb34-981"></a></span>
<span id="cb34-984"><a href="#cb34-984"></a><span class="in">```{r}</span></span>
<span id="cb34-985"><a href="#cb34-985"></a><span class="co">#| label: seasonal-descriptive-stats</span></span>
<span id="cb34-986"><a href="#cb34-986"></a><span class="co">#| echo: true</span></span>
<span id="cb34-987"><a href="#cb34-987"></a><span class="co">#| message: false</span></span>
<span id="cb34-988"><a href="#cb34-988"></a></span>
<span id="cb34-989"><a href="#cb34-989"></a>seasonal_data <span class="sc">%&gt;%</span></span>
<span id="cb34-990"><a href="#cb34-990"></a>  <span class="fu">select</span>(season, rainfall) <span class="sc">%&gt;%</span></span>
<span id="cb34-991"><a href="#cb34-991"></a>  <span class="fu">group_by</span>(season) <span class="sc">%&gt;%</span></span>
<span id="cb34-992"><a href="#cb34-992"></a>  <span class="fu">get_summary_stats</span>(rainfall, <span class="at">type =</span> <span class="st">"mean_sd"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-993"><a href="#cb34-993"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-994"><a href="#cb34-994"></a>    <span class="at">caption =</span> <span class="st">"Descriptive Statistics of Rainfall Intensity by Season"</span>,</span>
<span id="cb34-995"><a href="#cb34-995"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Season"</span>, <span class="st">"Variable"</span>, <span class="st">"N (Events)"</span>, <span class="st">"Mean (mm)"</span>, <span class="st">"SD (mm)"</span>)</span>
<span id="cb34-996"><a href="#cb34-996"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-997"><a href="#cb34-997"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-998"><a href="#cb34-998"></a><span class="in">```</span></span>
<span id="cb34-999"><a href="#cb34-999"></a></span>
<span id="cb34-1002"><a href="#cb34-1002"></a><span class="in">```{r}</span></span>
<span id="cb34-1003"><a href="#cb34-1003"></a><span class="co">#| label: kruskal-wallis-test</span></span>
<span id="cb34-1004"><a href="#cb34-1004"></a><span class="co">#| echo: true</span></span>
<span id="cb34-1005"><a href="#cb34-1005"></a><span class="co">#| message: false</span></span>
<span id="cb34-1006"><a href="#cb34-1006"></a></span>
<span id="cb34-1007"><a href="#cb34-1007"></a>kw_result <span class="ot">&lt;-</span> <span class="fu">kruskal_test</span>(rainfall <span class="sc">~</span> season, <span class="at">data =</span> seasonal_data)</span>
<span id="cb34-1008"><a href="#cb34-1008"></a>epsilon_sq <span class="ot">&lt;-</span> <span class="fu">kruskal_effsize</span>(rainfall <span class="sc">~</span> season, <span class="at">data =</span> seasonal_data)</span>
<span id="cb34-1009"><a href="#cb34-1009"></a></span>
<span id="cb34-1010"><a href="#cb34-1010"></a><span class="fu">tibble</span>(</span>
<span id="cb34-1011"><a href="#cb34-1011"></a>  <span class="at">Test =</span> <span class="st">"Kruskal-Wallis Rank Sum Test"</span>,</span>
<span id="cb34-1012"><a href="#cb34-1012"></a>  <span class="st">`</span><span class="at">Chi-squared</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(kw_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb34-1013"><a href="#cb34-1013"></a>  <span class="at">df =</span> kw_result<span class="sc">$</span>df,</span>
<span id="cb34-1014"><a href="#cb34-1014"></a>  <span class="st">`</span><span class="at">P-value</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(kw_result<span class="sc">$</span>p, <span class="at">accuracy =</span> <span class="fl">0.001</span>),</span>
<span id="cb34-1015"><a href="#cb34-1015"></a>  <span class="st">`</span><span class="at">Effect Size</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(epsilon_sq<span class="sc">$</span>effsize, <span class="dv">4</span>),</span>
<span id="cb34-1016"><a href="#cb34-1016"></a>  <span class="at">Magnitude =</span> <span class="fu">as.character</span>(epsilon_sq<span class="sc">$</span>magnitude)</span>
<span id="cb34-1017"><a href="#cb34-1017"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb34-1018"><a href="#cb34-1018"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-1019"><a href="#cb34-1019"></a>    <span class="at">caption =</span> <span class="st">"Statistical Significance of Seasonal Differences (Non-Parametric)"</span>,</span>
<span id="cb34-1020"><a href="#cb34-1020"></a>    <span class="at">align =</span> <span class="st">"lccccr"</span></span>
<span id="cb34-1021"><a href="#cb34-1021"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-1022"><a href="#cb34-1022"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb34-1023"><a href="#cb34-1023"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb34-1024"><a href="#cb34-1024"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-1025"><a href="#cb34-1025"></a>    <span class="at">position =</span> <span class="st">"left"</span></span>
<span id="cb34-1026"><a href="#cb34-1026"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-1027"><a href="#cb34-1027"></a>  <span class="fu">add_footnote</span>(</span>
<span id="cb34-1028"><a href="#cb34-1028"></a>    <span class="fu">c</span>(<span class="st">"Effect size: Epsilon-squared."</span>, <span class="st">"Alpha = 0.05"</span>),</span>
<span id="cb34-1029"><a href="#cb34-1029"></a>    <span class="at">notation =</span> <span class="st">"symbol"</span></span>
<span id="cb34-1030"><a href="#cb34-1030"></a>  )</span>
<span id="cb34-1031"><a href="#cb34-1031"></a><span class="in">```</span></span>
<span id="cb34-1032"><a href="#cb34-1032"></a></span>
<span id="cb34-1035"><a href="#cb34-1035"></a><span class="in">```{r}</span></span>
<span id="cb34-1036"><a href="#cb34-1036"></a><span class="co">#| label: dunns-test</span></span>
<span id="cb34-1037"><a href="#cb34-1037"></a><span class="co">#| echo: true</span></span>
<span id="cb34-1038"><a href="#cb34-1038"></a><span class="co">#| message: false</span></span>
<span id="cb34-1039"><a href="#cb34-1039"></a></span>
<span id="cb34-1040"><a href="#cb34-1040"></a>dunn_result <span class="ot">&lt;-</span> <span class="fu">dunn_test</span>(</span>
<span id="cb34-1041"><a href="#cb34-1041"></a>  rainfall <span class="sc">~</span> season,</span>
<span id="cb34-1042"><a href="#cb34-1042"></a>  <span class="at">data =</span> seasonal_data,</span>
<span id="cb34-1043"><a href="#cb34-1043"></a>  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span></span>
<span id="cb34-1044"><a href="#cb34-1044"></a>)</span>
<span id="cb34-1045"><a href="#cb34-1045"></a></span>
<span id="cb34-1046"><a href="#cb34-1046"></a>dunn_result <span class="sc">%&gt;%</span></span>
<span id="cb34-1047"><a href="#cb34-1047"></a>  <span class="fu">select</span>(group1, group2, statistic, p.adj, p.adj.signif) <span class="sc">%&gt;%</span></span>
<span id="cb34-1048"><a href="#cb34-1048"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-1049"><a href="#cb34-1049"></a>    <span class="at">caption =</span> <span class="st">"Dunn's Pairwise Comparison Test (Bonferroni Corrected)"</span>,</span>
<span id="cb34-1050"><a href="#cb34-1050"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb34-1051"><a href="#cb34-1051"></a>      <span class="st">"Group 1"</span>,</span>
<span id="cb34-1052"><a href="#cb34-1052"></a>      <span class="st">"Group 2"</span>,</span>
<span id="cb34-1053"><a href="#cb34-1053"></a>      <span class="st">"Z-Statistic"</span>,</span>
<span id="cb34-1054"><a href="#cb34-1054"></a>      <span class="st">"Adj. P-Value"</span>,</span>
<span id="cb34-1055"><a href="#cb34-1055"></a>      <span class="st">"Significance"</span></span>
<span id="cb34-1056"><a href="#cb34-1056"></a>    )</span>
<span id="cb34-1057"><a href="#cb34-1057"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-1058"><a href="#cb34-1058"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-1059"><a href="#cb34-1059"></a><span class="in">```</span></span>
<span id="cb34-1060"><a href="#cb34-1060"></a></span>
<span id="cb34-1063"><a href="#cb34-1063"></a><span class="in">```{r}</span></span>
<span id="cb34-1064"><a href="#cb34-1064"></a><span class="co">#| label: fig-seasonal-stat-groups</span></span>
<span id="cb34-1065"><a href="#cb34-1065"></a><span class="co">#| fig-cap: "Mean seasonal rainfall with statistical groupings. Shared letters indicate seasons not significantly different from one another (Dunn's test, p &lt; 0.05)."</span></span>
<span id="cb34-1066"><a href="#cb34-1066"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb34-1067"><a href="#cb34-1067"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb34-1068"><a href="#cb34-1068"></a><span class="co">#| echo: true</span></span>
<span id="cb34-1069"><a href="#cb34-1069"></a><span class="co">#| warning: false</span></span>
<span id="cb34-1070"><a href="#cb34-1070"></a></span>
<span id="cb34-1071"><a href="#cb34-1071"></a>p_vals <span class="ot">&lt;-</span> dunn_result<span class="sc">$</span>p.adj</span>
<span id="cb34-1072"><a href="#cb34-1072"></a><span class="fu">names</span>(p_vals) <span class="ot">&lt;-</span> <span class="fu">paste</span>(dunn_result<span class="sc">$</span>group1, dunn_result<span class="sc">$</span>group2, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb34-1073"><a href="#cb34-1073"></a>letters_vec <span class="ot">&lt;-</span> <span class="fu">multcompLetters</span>(p_vals)<span class="sc">$</span>Letters</span>
<span id="cb34-1074"><a href="#cb34-1074"></a>letters_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">season =</span> <span class="fu">names</span>(letters_vec), <span class="at">Letter =</span> letters_vec)</span>
<span id="cb34-1075"><a href="#cb34-1075"></a></span>
<span id="cb34-1076"><a href="#cb34-1076"></a>seasonal_data <span class="sc">%&gt;%</span></span>
<span id="cb34-1077"><a href="#cb34-1077"></a>  <span class="fu">group_by</span>(season) <span class="sc">%&gt;%</span></span>
<span id="cb34-1078"><a href="#cb34-1078"></a>  <span class="fu">summarise</span>(<span class="at">mean_rain =</span> <span class="fu">mean</span>(rainfall, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb34-1079"><a href="#cb34-1079"></a>  <span class="fu">left_join</span>(letters_df, <span class="at">by =</span> <span class="st">"season"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-1080"><a href="#cb34-1080"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> mean_rain, <span class="at">fill =</span> season)) <span class="sc">+</span></span>
<span id="cb34-1081"><a href="#cb34-1081"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb34-1082"><a href="#cb34-1082"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Letter), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb34-1083"><a href="#cb34-1083"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb34-1084"><a href="#cb34-1084"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(mean_rain, <span class="dv">1</span>)),</span>
<span id="cb34-1085"><a href="#cb34-1085"></a>    <span class="at">vjust =</span> <span class="fl">1.5</span>,</span>
<span id="cb34-1086"><a href="#cb34-1086"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb34-1087"><a href="#cb34-1087"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb34-1088"><a href="#cb34-1088"></a>    <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb34-1089"><a href="#cb34-1089"></a>  ) <span class="sc">+</span></span>
<span id="cb34-1090"><a href="#cb34-1090"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb34-1091"><a href="#cb34-1091"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb34-1092"><a href="#cb34-1092"></a>      <span class="st">"Summer"</span> <span class="ot">=</span> <span class="st">"#E69F00"</span>,</span>
<span id="cb34-1093"><a href="#cb34-1093"></a>      <span class="st">"Autumn"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>,</span>
<span id="cb34-1094"><a href="#cb34-1094"></a>      <span class="st">"Winter"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>,</span>
<span id="cb34-1095"><a href="#cb34-1095"></a>      <span class="st">"Spring"</span> <span class="ot">=</span> <span class="st">"#009E73"</span></span>
<span id="cb34-1096"><a href="#cb34-1096"></a>    )</span>
<span id="cb34-1097"><a href="#cb34-1097"></a>  ) <span class="sc">+</span></span>
<span id="cb34-1098"><a href="#cb34-1098"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-1099"><a href="#cb34-1099"></a>    <span class="at">title =</span> <span class="st">"Seasonal Rainfall with Statistical Groupings"</span>,</span>
<span id="cb34-1100"><a href="#cb34-1100"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(</span>
<span id="cb34-1101"><a href="#cb34-1101"></a>      <span class="st">"Kruskal-Wallis: p &lt; 0.001, Effect Size: %s</span><span class="sc">\n</span><span class="st">Seasons sharing a letter are not significantly different."</span>,</span>
<span id="cb34-1102"><a href="#cb34-1102"></a>      <span class="fu">as.character</span>(epsilon_sq<span class="sc">$</span>magnitude)</span>
<span id="cb34-1103"><a href="#cb34-1103"></a>    ),</span>
<span id="cb34-1104"><a href="#cb34-1104"></a>    <span class="at">y =</span> <span class="st">"Mean Rainfall (mm)"</span>,</span>
<span id="cb34-1105"><a href="#cb34-1105"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb34-1106"><a href="#cb34-1106"></a>  ) <span class="sc">+</span></span>
<span id="cb34-1107"><a href="#cb34-1107"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb34-1108"><a href="#cb34-1108"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-1109"><a href="#cb34-1109"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb34-1110"><a href="#cb34-1110"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb34-1111"><a href="#cb34-1111"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb34-1112"><a href="#cb34-1112"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb34-1113"><a href="#cb34-1113"></a>  )</span>
<span id="cb34-1114"><a href="#cb34-1114"></a><span class="in">```</span></span>
<span id="cb34-1115"><a href="#cb34-1115"></a></span>
<span id="cb34-1116"><a href="#cb34-1116"></a>The Kruskal-Wallis test yields $\chi^2 = 230$, $p &lt; 0.001$, strongly rejecting the null. The epsilon-squared effect size ($\eta^2 \approx 0.004$) is small the seasonal signal is real but accounts for only a minor fraction of total variance in rainfall intensity, reinforcing the necessity of a multivariate approach.</span>
<span id="cb34-1117"><a href="#cb34-1117"></a></span>
<span id="cb34-1118"><a href="#cb34-1118"></a>Post-hoc Dunn's tests identify three distinct statistical groups (@fig-seasonal-stat-groups). Summer stands alone as the most intense season ($\bar{x} = 9.1$ mm, $p &lt; 0.001$ vs. all others). Autumn and Spring are statistically indistinguishable ($p = 1.0$). Winter registers the lowest mean intensity ($\bar{x} = 5.5$ mm) and is statistically distinct from Spring ($p_\text{adj} = 0.026$).</span>
<span id="cb34-1119"><a href="#cb34-1119"></a></span>
<span id="cb34-1120"><a href="#cb34-1120"></a>---</span>
<span id="cb34-1121"><a href="#cb34-1121"></a></span>
<span id="cb34-1122"><a href="#cb34-1122"></a><span class="fu">## Feature Interactions: The "Rain Corner" {#sec-bivariate-density}</span></span>
<span id="cb34-1123"><a href="#cb34-1123"></a></span>
<span id="cb34-1126"><a href="#cb34-1126"></a><span class="in">```{r}</span></span>
<span id="cb34-1127"><a href="#cb34-1127"></a><span class="co">#| label: fig-interaction-rain-corner</span></span>
<span id="cb34-1128"><a href="#cb34-1128"></a><span class="co">#| fig-cap: "Bivariate density of Humidity3pm vs. Sunshine, faceted by rainfall occurrence. Rain events concentrate tightly in the upper-left 'Rain Corner' (high humidity, low sunshine), while dry days are dispersed broadly. This structural asymmetry justifies a multiplicative interaction term."</span></span>
<span id="cb34-1129"><a href="#cb34-1129"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb34-1130"><a href="#cb34-1130"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb34-1131"><a href="#cb34-1131"></a><span class="co">#| echo: true</span></span>
<span id="cb34-1132"><a href="#cb34-1132"></a><span class="co">#| warning: false</span></span>
<span id="cb34-1133"><a href="#cb34-1133"></a></span>
<span id="cb34-1134"><a href="#cb34-1134"></a>df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-1135"><a href="#cb34-1135"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb34-1136"><a href="#cb34-1136"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb34-1137"><a href="#cb34-1137"></a>  <span class="fu">mutate</span>(<span class="at">rain_index_ref =</span> <span class="fu">ifelse</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="fu">row_number</span>(), <span class="cn">NA_integer_</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-1138"><a href="#cb34-1138"></a>  <span class="fu">fill</span>(rain_index_ref, <span class="at">.direction =</span> <span class="st">"down"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-1139"><a href="#cb34-1139"></a>  <span class="fu">mutate</span>(<span class="at">days_since_rain =</span> <span class="fu">row_number</span>() <span class="sc">-</span> <span class="fu">lag</span>(rain_index_ref)) <span class="sc">%&gt;%</span></span>
<span id="cb34-1140"><a href="#cb34-1140"></a>  <span class="fu">select</span>(<span class="sc">-</span>rain_index_ref) <span class="sc">%&gt;%</span></span>
<span id="cb34-1141"><a href="#cb34-1141"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sunshine, humidity3pm)) <span class="sc">+</span></span>
<span id="cb34-1142"><a href="#cb34-1142"></a>  <span class="fu">geom_density2d_filled</span>(<span class="at">continuous_var =</span> <span class="st">"ndensity"</span>, <span class="at">bins =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb34-1143"><a href="#cb34-1143"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>rain_today, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb34-1144"><a href="#cb34-1144"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb34-1145"><a href="#cb34-1145"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-1146"><a href="#cb34-1146"></a>    <span class="at">title =</span> <span class="st">"Justifying Interaction: The 'Rain Corner'"</span>,</span>
<span id="cb34-1147"><a href="#cb34-1147"></a>    <span class="at">subtitle =</span> <span class="st">"Rain (right panel) concentrates in high humidity / low sunshine.</span><span class="sc">\n</span><span class="st">Dry days (left panel) are dispersed across feature space.</span><span class="sc">\n</span><span class="st">This structural asymmetry justifies a sunshine * humidity interaction term."</span>,</span>
<span id="cb34-1148"><a href="#cb34-1148"></a>    <span class="at">x =</span> <span class="st">"Sunshine (hours)"</span>,</span>
<span id="cb34-1149"><a href="#cb34-1149"></a>    <span class="at">y =</span> <span class="st">"Humidity 3pm (%)"</span></span>
<span id="cb34-1150"><a href="#cb34-1150"></a>  ) <span class="sc">+</span></span>
<span id="cb34-1151"><a href="#cb34-1151"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-1152"><a href="#cb34-1152"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-1153"><a href="#cb34-1153"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb34-1154"><a href="#cb34-1154"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb34-1155"><a href="#cb34-1155"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb34-1156"><a href="#cb34-1156"></a>  )</span>
<span id="cb34-1157"><a href="#cb34-1157"></a><span class="in">```</span></span>
<span id="cb34-1158"><a href="#cb34-1158"></a></span>
<span id="cb34-1159"><a href="#cb34-1159"></a>The correlation analysis in @sec-correlation established that humidity and sunshine are individually among the strongest predictors. A standard additive model treats their effects as independent. This section tests whether that assumption holds.</span>
<span id="cb34-1160"><a href="#cb34-1160"></a></span>
<span id="cb34-1161"><a href="#cb34-1161"></a>The bivariate density plots (@fig-interaction-rain-corner) reveal a striking structural difference. On dry days, the density is dispersed broadly across the humidity-sunshine space: high humidity can occur without rain under high-pressure suppression, and low sunshine can occur without rain under thin overcast. No single region clearly separates the two states.</span>
<span id="cb34-1162"><a href="#cb34-1162"></a></span>
<span id="cb34-1163"><a href="#cb34-1163"></a>On rainy days, the density collapses into a tight cluster in the upper-left quadrant: high afternoon humidity (above approximately 50%) combined with low sunshine (below approximately 5 hours). This is the "Rain Corner". Neither condition alone is sufficient; both must coincide simultaneously. This is statistical interaction: the effect of one variable on the outcome is conditional on the level of the other.</span>
<span id="cb34-1164"><a href="#cb34-1164"></a></span>
<span id="cb34-1165"><a href="#cb34-1165"></a>**Modelling implication.** An additive model that includes <span class="in">`Humidity3pm`</span> and <span class="in">`Sunshine`</span> as separate terms cannot express the idea that their joint occurrence not their individual magnitudes is what matters. Capturing the Rain Corner requires a multiplicative interaction term ($\text{Humidity} \times \text{Sunshine}$) in the model specification.</span>
<span id="cb34-1166"><a href="#cb34-1166"></a></span>
<span id="cb34-1167"><a href="#cb34-1167"></a>---</span>
<span id="cb34-1168"><a href="#cb34-1168"></a></span>
<span id="cb34-1169"><a href="#cb34-1169"></a><span class="fu">## Summary and Modelling Implications</span></span>
<span id="cb34-1170"><a href="#cb34-1170"></a></span>
<span id="cb34-1171"><a href="#cb34-1171"></a>The preceding analyses characterise the dataset along six interconnected dimensions, each producing a specific modelling requirement.</span>
<span id="cb34-1172"><a href="#cb34-1172"></a></span>
<span id="cb34-1173"><a href="#cb34-1173"></a>The **distributional structure** of the target variable 64% zeros, extreme positive skew, kurtosis of 181 rules out any single-component Gaussian model. A two-part framework separating occurrence from intensity is the appropriate response.</span>
<span id="cb34-1174"><a href="#cb34-1174"></a></span>
<span id="cb34-1175"><a href="#cb34-1175"></a>The **missingness analysis** (documented in @sec-data, summarised in Section 1 above) establishes that imputation is necessary to preserve both sample size and the predictive signal in <span class="in">`sunshine`</span> and <span class="in">`evaporation`</span>, and that the imputed values do not introduce outcome-related bias.</span>
<span id="cb34-1176"><a href="#cb34-1176"></a></span>
<span id="cb34-1177"><a href="#cb34-1177"></a>The **correlation structure** identifies humidity, cloud cover, sunshine, and evaporation as the strongest individual predictors, and flags severe multicollinearity among morning-afternoon pairs. VIF-based feature selection is required.</span>
<span id="cb34-1178"><a href="#cb34-1178"></a></span>
<span id="cb34-1179"><a href="#cb34-1179"></a>The **temporal analyses** establish that both the day-to-day Markov state and the cumulative dry spell duration carry predictive signal. Month should be cyclically encoded. The dry spell decay is non-linear and warrants a natural spline parameterisation of <span class="in">`days_since_rain`</span>.</span>
<span id="cb34-1180"><a href="#cb34-1180"></a></span>
<span id="cb34-1181"><a href="#cb34-1181"></a>The **pressure analysis** identifies the diurnal pressure change as the more discriminating pressure-derived feature, with Cohen's $d = 0.72$ separating rainy from dry days more effectively than absolute pressure level.</span>
<span id="cb34-1182"><a href="#cb34-1182"></a></span>
<span id="cb34-1183"><a href="#cb34-1183"></a>The **interaction analysis** provides empirical justification for a $\text{Humidity} \times \text{Sunshine}$ interaction term, reflecting the physical reality that precipitation concentrates where high moisture and low solar radiation coincide in the "Rain Corner" of the feature space.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/blob/main/03-eda.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>