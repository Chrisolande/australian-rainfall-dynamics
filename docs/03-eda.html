<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="A comprehensive statistical analysis of rainfall patterns across 49 Australian cities using Zero-Inflated Gamma GLMMs.">

<title>3&nbsp; Exploratory Data Analysis – Australian Rainfall Dynamics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-features.html" rel="next">
<link href="./02-data-prep.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-0348920b7671f696dc9078d39bff215e.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f12a4a8ba9751daca4e771316b711af2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-27bd61dac4ddfacab4795c71a0bdc5ec.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-f12a4a8ba9751daca4e771316b711af2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-data-prep.html">Data</a></li><li class="breadcrumb-item"><a href="./03-eda.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Australian Rainfall Dynamics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predicting the Unpredictable</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-data-prep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Cleaning and Preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-eda.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Feature Engineering</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-features.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Signal Extraction via Moving Averages</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Modelling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model Evaluation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-model-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Model Selection</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#temporal-dynamics-of-rainfall-occurrence" id="toc-temporal-dynamics-of-rainfall-occurrence" class="nav-link active" data-scroll-target="#temporal-dynamics-of-rainfall-occurrence"><span class="header-section-number">3.1</span> Temporal Dynamics of Rainfall Occurrence</a></li>
  <li><a href="#assessment-of-data-completeness" id="toc-assessment-of-data-completeness" class="nav-link" data-scroll-target="#assessment-of-data-completeness"><span class="header-section-number">3.2</span> Assessment of Data Completeness</a></li>
  <li><a href="#distributional-characteristics-of-the-target-variable" id="toc-distributional-characteristics-of-the-target-variable" class="nav-link" data-scroll-target="#distributional-characteristics-of-the-target-variable"><span class="header-section-number">3.3</span> Distributional Characteristics of the Target Variable</a></li>
  <li><a href="#bivariate-correlation-analysis" id="toc-bivariate-correlation-analysis" class="nav-link" data-scroll-target="#bivariate-correlation-analysis"><span class="header-section-number">3.4</span> Bivariate Correlation Analysis</a></li>
  <li><a href="#pattern-analysis" id="toc-pattern-analysis" class="nav-link" data-scroll-target="#pattern-analysis"><span class="header-section-number">3.5</span> Pattern Analysis</a>
  <ul class="collapse">
  <li><a href="#temporal-dependence-and-markov-chain-analysis" id="toc-temporal-dependence-and-markov-chain-analysis" class="nav-link" data-scroll-target="#temporal-dependence-and-markov-chain-analysis"><span class="header-section-number">3.5.1</span> Temporal Dependence and Markov Chain Analysis</a></li>
  <li><a href="#justification-for-interaction-terms" id="toc-justification-for-interaction-terms" class="nav-link" data-scroll-target="#justification-for-interaction-terms"><span class="header-section-number">3.5.2</span> Justification for Interaction Terms</a></li>
  <li><a href="#the-drying-effect-and-temporal-decay" id="toc-the-drying-effect-and-temporal-decay" class="nav-link" data-scroll-target="#the-drying-effect-and-temporal-decay"><span class="header-section-number">3.5.3</span> The ‘Drying Effect’ and Temporal Decay</a></li>
  <li><a href="#atmospheric-pressure-and-diurnal-variation" id="toc-atmospheric-pressure-and-diurnal-variation" class="nav-link" data-scroll-target="#atmospheric-pressure-and-diurnal-variation"><span class="header-section-number">3.5.4</span> Atmospheric Pressure and Diurnal Variation</a></li>
  <li><a href="#seasonal-dynamics-and-intensity-cycles" id="toc-seasonal-dynamics-and-intensity-cycles" class="nav-link" data-scroll-target="#seasonal-dynamics-and-intensity-cycles"><span class="header-section-number">3.5.5</span> Seasonal Dynamics and Intensity Cycles</a></li>
  <li><a href="#statistical-validation-of-seasonal-intensity" id="toc-statistical-validation-of-seasonal-intensity" class="nav-link" data-scroll-target="#statistical-validation-of-seasonal-intensity"><span class="header-section-number">3.5.6</span> Statistical Validation of Seasonal Intensity</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/blob/main/03-eda.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-data-prep.html">Data</a></li><li class="breadcrumb-item"><a href="./03-eda.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="temporal-dynamics-of-rainfall-occurrence" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="temporal-dynamics-of-rainfall-occurrence"><span class="header-section-number">3.1</span> Temporal Dynamics of Rainfall Occurrence</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Day Distribution Table</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>df_clean <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="fu">tabyl</span>(day) <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="fu">kable</span>(</span>
<span id="cb1-8"><a href="#cb1-8"></a>    <span class="at">caption =</span> <span class="st">"Frequency of Rainfall Days by Day of the Week"</span>,</span>
<span id="cb1-9"><a href="#cb1-9"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Day"</span>, <span class="st">"Count (n)"</span>, <span class="st">"Percentage"</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Frequency of Rainfall Days by Day of the Week</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Day</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Count (n)</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Tue</td>
<td style="text-align: right;">7508</td>
<td style="text-align: left;">14.7%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mon</td>
<td style="text-align: right;">7480</td>
<td style="text-align: left;">14.6%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fri</td>
<td style="text-align: right;">7378</td>
<td style="text-align: left;">14.4%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wed</td>
<td style="text-align: right;">7342</td>
<td style="text-align: left;">14.4%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Thu</td>
<td style="text-align: right;">7314</td>
<td style="text-align: left;">14.3%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sat</td>
<td style="text-align: right;">7057</td>
<td style="text-align: left;">13.8%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sun</td>
<td style="text-align: right;">7040</td>
<td style="text-align: left;">13.8%</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Month Distribution Table</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>df_clean <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="fu">tabyl</span>(month) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="fu">kable</span>(</span>
<span id="cb2-8"><a href="#cb2-8"></a>    <span class="at">caption =</span> <span class="st">"Frequency of Rainfall Days by Month"</span>,</span>
<span id="cb2-9"><a href="#cb2-9"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Month"</span>, <span class="st">"Count (n)"</span>, <span class="st">"Percentage"</span>)</span>
<span id="cb2-10"><a href="#cb2-10"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Frequency of Rainfall Days by Month</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Month</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Count (n)</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">5448</td>
<td style="text-align: left;">10.7%</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">5250</td>
<td style="text-align: left;">10.3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">4937</td>
<td style="text-align: left;">9.7%</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: right;">4704</td>
<td style="text-align: left;">9.2%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">4444</td>
<td style="text-align: left;">8.7%</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">4234</td>
<td style="text-align: left;">8.3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">4001</td>
<td style="text-align: left;">7.8%</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">3770</td>
<td style="text-align: left;">7.4%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">3760</td>
<td style="text-align: left;">7.4%</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">3702</td>
<td style="text-align: left;">7.2%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: right;">3562</td>
<td style="text-align: left;">7.0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">3307</td>
<td style="text-align: left;">6.5%</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Cross-tabulation: Month vs Day</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>df_clean <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">tabyl</span>(month, day) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="fu">adorn_totals</span>(<span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Cross-tabulation of Rainfall Frequency: Month vs. Day"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="at">font_size =</span> <span class="dv">11</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Cross-tabulation of Rainfall Frequency: Month vs. Day</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">month</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sun</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mon</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Tue</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Wed</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Thu</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Fri</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sat</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">536</td>
<td style="text-align: right;">570</td>
<td style="text-align: right;">514</td>
<td style="text-align: right;">482</td>
<td style="text-align: right;">493</td>
<td style="text-align: right;">567</td>
<td style="text-align: right;">540</td>
<td style="text-align: right;">3702</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">480</td>
<td style="text-align: right;">530</td>
<td style="text-align: right;">469</td>
<td style="text-align: right;">466</td>
<td style="text-align: right;">443</td>
<td style="text-align: right;">471</td>
<td style="text-align: right;">448</td>
<td style="text-align: right;">3307</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">636</td>
<td style="text-align: right;">645</td>
<td style="text-align: right;">639</td>
<td style="text-align: right;">592</td>
<td style="text-align: right;">662</td>
<td style="text-align: right;">644</td>
<td style="text-align: right;">626</td>
<td style="text-align: right;">4444</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">578</td>
<td style="text-align: right;">597</td>
<td style="text-align: right;">566</td>
<td style="text-align: right;">604</td>
<td style="text-align: right;">579</td>
<td style="text-align: right;">515</td>
<td style="text-align: right;">562</td>
<td style="text-align: right;">4001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">710</td>
<td style="text-align: right;">722</td>
<td style="text-align: right;">765</td>
<td style="text-align: right;">714</td>
<td style="text-align: right;">678</td>
<td style="text-align: right;">681</td>
<td style="text-align: right;">667</td>
<td style="text-align: right;">4937</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">766</td>
<td style="text-align: right;">801</td>
<td style="text-align: right;">804</td>
<td style="text-align: right;">797</td>
<td style="text-align: right;">760</td>
<td style="text-align: right;">753</td>
<td style="text-align: right;">767</td>
<td style="text-align: right;">5448</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">694</td>
<td style="text-align: right;">717</td>
<td style="text-align: right;">728</td>
<td style="text-align: right;">796</td>
<td style="text-align: right;">773</td>
<td style="text-align: right;">818</td>
<td style="text-align: right;">724</td>
<td style="text-align: right;">5250</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: right;">612</td>
<td style="text-align: right;">702</td>
<td style="text-align: right;">694</td>
<td style="text-align: right;">679</td>
<td style="text-align: right;">689</td>
<td style="text-align: right;">687</td>
<td style="text-align: right;">641</td>
<td style="text-align: right;">4704</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">516</td>
<td style="text-align: right;">571</td>
<td style="text-align: right;">616</td>
<td style="text-align: right;">639</td>
<td style="text-align: right;">648</td>
<td style="text-align: right;">659</td>
<td style="text-align: right;">585</td>
<td style="text-align: right;">4234</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">507</td>
<td style="text-align: right;">606</td>
<td style="text-align: right;">579</td>
<td style="text-align: right;">550</td>
<td style="text-align: right;">517</td>
<td style="text-align: right;">456</td>
<td style="text-align: right;">555</td>
<td style="text-align: right;">3770</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">556</td>
<td style="text-align: right;">526</td>
<td style="text-align: right;">554</td>
<td style="text-align: right;">480</td>
<td style="text-align: right;">538</td>
<td style="text-align: right;">575</td>
<td style="text-align: right;">531</td>
<td style="text-align: right;">3760</td>
</tr>
<tr class="even">
<td style="text-align: left;">12</td>
<td style="text-align: right;">449</td>
<td style="text-align: right;">493</td>
<td style="text-align: right;">580</td>
<td style="text-align: right;">543</td>
<td style="text-align: right;">534</td>
<td style="text-align: right;">552</td>
<td style="text-align: right;">411</td>
<td style="text-align: right;">3562</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">7040</td>
<td style="text-align: right;">7480</td>
<td style="text-align: right;">7508</td>
<td style="text-align: right;">7342</td>
<td style="text-align: right;">7314</td>
<td style="text-align: right;">7378</td>
<td style="text-align: right;">7057</td>
<td style="text-align: right;">51119</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>To understand the temporal drivers of precipitation, we analyzed the frequency of wet days (rainfall &gt; 0) across weekly and monthly cycles.</p>
<p><strong>Weekly Variation:</strong> The distribution of rainfall across the days of the week appears largely uniform, with a slight variation in frequency. Tuesdays (14.7%) and Mondays (14.6%) exhibit the highest incidence of rain, while weekends (Saturday and Sunday) show marginally lower frequencies (approx. 13.8%). Statistically, this suggests that the mechanism generating rainfall is independent of the anthropogenic weekly cycle, as expected in meteorological data.</p>
<p><strong>Seasonal (Monthly) Variation:</strong> In contrast, the monthly distribution reveals distinct seasonal patterns.</p>
<ul>
<li><strong>Peak Season:</strong> The winter months of June (10.7%) and July (10.3%) record the highest frequency of rainfall events, consistent with the southern hemisphere’s winter weather patterns which often bring frontal systems to southern Australia.</li>
<li><strong>Low Season:</strong> The summer months, particularly February (6.5%) and December (7.0%), exhibit the lowest frequency of rain days.</li>
</ul>
<p><strong>Interaction Effects:</strong> The cross-tabulation of Month versus Day confirms that the seasonal signal dominates the weekly noise. For instance, the high counts in June and July are robustly distributed across all days of the week (e.g., June averages ~750-800 events per day), whereas February counts drop significantly (averaging ~450-480 events per day). This validates the necessity of including <code>Month</code> as a seasonal predictor in our subsequent modeling, while <code>Day</code> may serve as a minor control variable.</p>
</section>
<section id="assessment-of-data-completeness" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="assessment-of-data-completeness"><span class="header-section-number">3.2</span> Assessment of Data Completeness</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Calculate total count of missing values in the entire dataframe</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>total_na <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(df_clean))</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Total Missing values:"</span>, total_na))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Total Missing values: 314146"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Generate missingness table using the utility function defined earlier</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="fu">missing_val</span>(df_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Percentage of Missing Values by Feature</caption>
<thead>
<tr class="header">
<th style="text-align: left;">column</th>
<th style="text-align: right;">pct_missing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sunshine</td>
<td style="text-align: right;">47.6937250</td>
</tr>
<tr class="even">
<td style="text-align: left;">evaporation</td>
<td style="text-align: right;">42.5375706</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cloud3pm</td>
<td style="text-align: right;">39.9960619</td>
</tr>
<tr class="even">
<td style="text-align: left;">cloud9am</td>
<td style="text-align: right;">37.5044832</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pressure3pm</td>
<td style="text-align: right;">9.8404349</td>
</tr>
<tr class="even">
<td style="text-align: left;">pressure9am</td>
<td style="text-align: right;">9.8031632</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wind_dir9am</td>
<td style="text-align: right;">6.8840147</td>
</tr>
<tr class="even">
<td style="text-align: left;">wind_gust_dir</td>
<td style="text-align: right;">6.8390073</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wind_gust_speed</td>
<td style="text-align: right;">6.7968129</td>
</tr>
<tr class="even">
<td style="text-align: left;">wind_dir3pm</td>
<td style="text-align: right;">2.6716081</td>
</tr>
<tr class="odd">
<td style="text-align: left;">humidity3pm</td>
<td style="text-align: right;">2.5527606</td>
</tr>
<tr class="even">
<td style="text-align: left;">temp3pm</td>
<td style="text-align: right;">1.9310966</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wind_speed3pm</td>
<td style="text-align: right;">1.8614758</td>
</tr>
<tr class="even">
<td style="text-align: left;">humidity9am</td>
<td style="text-align: right;">1.0928347</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rain_tomorrow</td>
<td style="text-align: right;">0.9929746</td>
</tr>
<tr class="even">
<td style="text-align: left;">wind_speed9am</td>
<td style="text-align: right;">0.7672347</td>
</tr>
<tr class="odd">
<td style="text-align: left;">temp9am</td>
<td style="text-align: right;">0.4817193</td>
</tr>
<tr class="even">
<td style="text-align: left;">min_temp</td>
<td style="text-align: right;">0.3424778</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max_temp</td>
<td style="text-align: right;">0.3305227</td>
</tr>
<tr class="even">
<td style="text-align: left;">date</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">location</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">rainfall</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rain_today</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">month</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">day</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>A critical examination of missing data reveals significant gaps in specific meteorological measurements. While the total number of missing entries is substantial (314,146), the missingness is not uniformly distributed across features:</p>
<ul>
<li><strong>High Missingness:</strong> The variables <code>sunshine</code> (47.7%) and <code>evaporation</code> (42.5%) exhibit the highest rates of missing data. This is likely due to the limited availability of specialized recording equipment at smaller weather stations.</li>
<li><strong>Moderate Missingness:</strong> Cloud cover observations (<code>cloud3pm</code> and <code>cloud9am</code>) are missing in approximately 37–40% of records, suggesting potential observational challenges or station-specific reporting protocols.</li>
<li><strong>Low Missingness:</strong> Critical core variables, including <code>pressure</code>, <code>wind</code>, and <code>temperature</code>, show much lower missingness rates (&lt; 10%).</li>
</ul>
<p><strong>Implications for Modeling:</strong> The severity of missingness in <code>sunshine</code> and <code>evaporation</code> poses a strategic dilemma. Applying standard listwise deletion (removing any row with a missing value) would result in the loss of nearly half the dataset, potentially introducing bias and reducing statistical power. This finding empirically justifies the <strong>Random Forest imputation strategy</strong> proposed in the study’s objectives. By imputing these values rather than discarding them, we preserve the integrity of the dataset and allow for the inclusion of these potentially predictive features in the final models.</p>
</section>
<section id="distributional-characteristics-of-the-target-variable" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="distributional-characteristics-of-the-target-variable"><span class="header-section-number">3.3</span> Distributional Characteristics of the Target Variable</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>rainfall_stats <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">summarise</span>(</span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb7-4"><a href="#cb7-4"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(rainfall),</span>
<span id="cb7-5"><a href="#cb7-5"></a>    <span class="at">median =</span> <span class="fu">median</span>(rainfall),</span>
<span id="cb7-6"><a href="#cb7-6"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(rainfall),</span>
<span id="cb7-7"><a href="#cb7-7"></a>    <span class="at">min =</span> <span class="fu">min</span>(rainfall),</span>
<span id="cb7-8"><a href="#cb7-8"></a>    <span class="at">max =</span> <span class="fu">max</span>(rainfall),</span>
<span id="cb7-9"><a href="#cb7-9"></a>    <span class="at">q25 =</span> <span class="fu">quantile</span>(rainfall, <span class="fl">0.25</span>),</span>
<span id="cb7-10"><a href="#cb7-10"></a>    <span class="at">q75 =</span> <span class="fu">quantile</span>(rainfall, .<span class="dv">75</span>),</span>
<span id="cb7-11"><a href="#cb7-11"></a>    <span class="at">iqr =</span> <span class="fu">IQR</span>(rainfall),</span>
<span id="cb7-12"><a href="#cb7-12"></a>    <span class="at">n_zeros =</span> <span class="fu">sum</span>(rainfall <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb7-13"><a href="#cb7-13"></a>    <span class="at">pct_zeros =</span> <span class="fu">mean</span>(rainfall <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb7-14"><a href="#cb7-14"></a>    <span class="at">n_large =</span> <span class="fu">sum</span>(rainfall <span class="sc">&gt;</span> <span class="dv">100</span>),</span>
<span id="cb7-15"><a href="#cb7-15"></a>    <span class="at">pct_large =</span> <span class="fu">mean</span>(rainfall <span class="sc">&gt;</span> <span class="dv">100</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb7-16"><a href="#cb7-16"></a>    <span class="at">skewness =</span> moments<span class="sc">::</span><span class="fu">skewness</span>(rainfall),</span>
<span id="cb7-17"><a href="#cb7-17"></a>    <span class="at">kurtosis =</span> moments<span class="sc">::</span><span class="fu">kurtosis</span>(rainfall)</span>
<span id="cb7-18"><a href="#cb7-18"></a>  )</span>
<span id="cb7-19"><a href="#cb7-19"></a></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co"># Transpose and format</span></span>
<span id="cb7-21"><a href="#cb7-21"></a>rainfall_stats <span class="sc">%&gt;%</span></span>
<span id="cb7-22"><a href="#cb7-22"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Statistic"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-23"><a href="#cb7-23"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-24"><a href="#cb7-24"></a>    <span class="at">Value =</span> <span class="fu">ifelse</span>(</span>
<span id="cb7-25"><a href="#cb7-25"></a>      Value <span class="sc">&gt;</span> <span class="dv">1000</span>,</span>
<span id="cb7-26"><a href="#cb7-26"></a>      <span class="fu">format</span>(Value, <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb7-27"><a href="#cb7-27"></a>      <span class="fu">round</span>(Value, <span class="dv">3</span>)</span>
<span id="cb7-28"><a href="#cb7-28"></a>    )</span>
<span id="cb7-29"><a href="#cb7-29"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-30"><a href="#cb7-30"></a>  <span class="fu">kable</span>(</span>
<span id="cb7-31"><a href="#cb7-31"></a>    <span class="at">caption =</span> <span class="st">"Descriptive Statistics: Daily Rainfall (mm)"</span>,</span>
<span id="cb7-32"><a href="#cb7-32"></a>    <span class="at">align =</span> <span class="st">"lr"</span></span>
<span id="cb7-33"><a href="#cb7-33"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-34"><a href="#cb7-34"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Descriptive Statistics: Daily Rainfall (mm)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">n</td>
<td style="text-align: right;">1.42e+05</td>
</tr>
<tr class="even">
<td style="text-align: left;">mean</td>
<td style="text-align: right;">2.361</td>
</tr>
<tr class="odd">
<td style="text-align: left;">median</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">sd</td>
<td style="text-align: right;">8.478</td>
</tr>
<tr class="odd">
<td style="text-align: left;">min</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">max</td>
<td style="text-align: right;">371</td>
</tr>
<tr class="odd">
<td style="text-align: left;">q25</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">q75</td>
<td style="text-align: right;">0.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">iqr</td>
<td style="text-align: right;">0.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">n_zeros</td>
<td style="text-align: right;">9.11e+04</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pct_zeros</td>
<td style="text-align: right;">64.051</td>
</tr>
<tr class="even">
<td style="text-align: left;">n_large</td>
<td style="text-align: right;">151</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pct_large</td>
<td style="text-align: right;">0.106</td>
</tr>
<tr class="even">
<td style="text-align: left;">skewness</td>
<td style="text-align: right;">9.836</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kurtosis</td>
<td style="text-align: right;">181.146</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Zero-Inflation Check (Dry vs. Wet Days)</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>rain_check <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">summarise</span>(</span>
<span id="cb8-4"><a href="#cb8-4"></a>    <span class="at">total_days =</span> <span class="fu">n</span>(),</span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="at">dry_days =</span> <span class="fu">sum</span>(rainfall <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="at">rainy_days =</span> <span class="fu">sum</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb8-7"><a href="#cb8-7"></a>    <span class="at">zero_inflation_pct =</span> (dry_days <span class="sc">/</span> total_days) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>  )</span>
<span id="cb8-9"><a href="#cb8-9"></a></span>
<span id="cb8-10"><a href="#cb8-10"></a></span>
<span id="cb8-11"><a href="#cb8-11"></a>rain_check <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>  <span class="fu">kable</span>(</span>
<span id="cb8-13"><a href="#cb8-13"></a>    <span class="at">caption =</span> <span class="st">"Prevalence of Zero-Inflation (Dry Days)"</span>,</span>
<span id="cb8-14"><a href="#cb8-14"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb8-15"><a href="#cb8-15"></a>      <span class="st">"Total Days"</span>,</span>
<span id="cb8-16"><a href="#cb8-16"></a>      <span class="st">"Dry Days (0mm)"</span>,</span>
<span id="cb8-17"><a href="#cb8-17"></a>      <span class="st">"Rainy Days (&gt;0mm)"</span>,</span>
<span id="cb8-18"><a href="#cb8-18"></a>      <span class="st">"Zero Inflation (%)"</span></span>
<span id="cb8-19"><a href="#cb8-19"></a>    )</span>
<span id="cb8-20"><a href="#cb8-20"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-21"><a href="#cb8-21"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb8-22"><a href="#cb8-22"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"bordered"</span>),</span>
<span id="cb8-23"><a href="#cb8-23"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span></span>
<span id="cb8-24"><a href="#cb8-24"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-bordered caption-top table-sm small" data-quarto-postprocess="true">
<caption>Prevalence of Zero-Inflation (Dry Days)</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Total Days</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dry Days (0mm)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Rainy Days (&gt;0mm)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Zero Inflation (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">142199</td>
<td style="text-align: right;">91080</td>
<td style="text-align: right;">51119</td>
<td style="text-align: right;">64.05108</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>A deep statistical examination of the target variable, <code>rainfall</code>, confirms extreme distributional irregularities that challenge standard modeling approaches.</p>
<p><strong>Central Tendency and Dispersion:</strong> The data exhibits a massive discrepancy between the mean (2.36 mm) and the median (0.00 mm). This zero-median property immediately signals a highly skewed distribution. The standard deviation (8.48 mm) is nearly four times the mean, indicating high variability and volatility in daily precipitation.</p>
<p><strong>Zero-Inflation:</strong> The most critical finding is the prevalence of zero-inflation. Out of 142,199 recorded observations, 91,080 are dry days. This translates to a <strong>zero-inflation rate of 64.05%</strong>. In statistical terms, this “hurdle” of zeros implies that any predictive model must effectively answer two distinct questions: “Will it rain?” (binary classification) and “If so, how much?” (regression).</p>
<p><strong>Tail Behavior:</strong> The distribution is extremely heavy-tailed.</p>
<ul>
<li><p><strong>Skewness (9.84):</strong> Indicates a severe rightward skew, with the mass of the data concentrated near zero and a long tail extending towards extreme values.</p></li>
<li><p><strong>Kurtosis (181.15):</strong> This exceptionally high value points to a “leptokurtic” distribution, meaning extreme outliers are far more frequent than in a normal distribution. The maximum recorded rainfall of 371 mm, alongside 151 events exceeding 100 mm, confirms the presence of extreme weather events that models must be robust enough to handle.</p></li>
</ul>
<p><strong>Conclusion:</strong> The combination of ~64% zeros and extreme kurtosis confirms that a standard Gaussian Linear Model (OLS) would be severely biased. These statistics strongly support the adoption of a <strong>Hurdle Model</strong> or <strong>Zero-Inflated Gamma</strong> framework to separately model the zero-state and the positive continuous state.</p>
</section>
<section id="bivariate-correlation-analysis" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="bivariate-correlation-analysis"><span class="header-section-number">3.4</span> Bivariate Correlation Analysis</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Select numeric columns excluding the target</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>numeric_cols <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">names</span>()</span>
<span id="cb9-5"><a href="#cb9-5"></a>numeric_cols <span class="ot">&lt;-</span> numeric_cols[numeric_cols <span class="sc">!=</span> <span class="st">"rainfall"</span>]</span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co"># Compute Spearman correlations and format interpretation</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>cors <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>  rstatix<span class="sc">::</span><span class="fu">cor_test</span>(</span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="at">vars =</span> <span class="st">"rainfall"</span>,</span>
<span id="cb9-11"><a href="#cb9-11"></a>    <span class="at">vars2 =</span> numeric_cols,</span>
<span id="cb9-12"><a href="#cb9-12"></a>    <span class="at">method =</span> <span class="st">"spearman"</span></span>
<span id="cb9-13"><a href="#cb9-13"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-14"><a href="#cb9-14"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(cor)) <span class="sc">%&gt;%</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(cor))) <span class="sc">%&gt;%</span></span>
<span id="cb9-16"><a href="#cb9-16"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(var2, cor, p) <span class="sc">%&gt;%</span></span>
<span id="cb9-17"><a href="#cb9-17"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-18"><a href="#cb9-18"></a>    <span class="at">interpretation =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-19"><a href="#cb9-19"></a>      <span class="fu">abs</span>(cor) <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"Negligible"</span>,</span>
<span id="cb9-20"><a href="#cb9-20"></a>      <span class="fu">abs</span>(cor) <span class="sc">&lt;</span> <span class="fl">0.3</span> <span class="sc">~</span> <span class="st">"Small"</span>,</span>
<span id="cb9-21"><a href="#cb9-21"></a>      <span class="fu">abs</span>(cor) <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Moderate"</span>,</span>
<span id="cb9-22"><a href="#cb9-22"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Large"</span></span>
<span id="cb9-23"><a href="#cb9-23"></a>    )</span>
<span id="cb9-24"><a href="#cb9-24"></a>  )</span>
<span id="cb9-25"><a href="#cb9-25"></a></span>
<span id="cb9-26"><a href="#cb9-26"></a></span>
<span id="cb9-27"><a href="#cb9-27"></a>cors <span class="sc">%&gt;%</span></span>
<span id="cb9-28"><a href="#cb9-28"></a>  <span class="fu">kable</span>(</span>
<span id="cb9-29"><a href="#cb9-29"></a>    <span class="at">caption =</span> <span class="st">"Spearman Correlation with Rainfall (Ranked by Strength)"</span>,</span>
<span id="cb9-30"><a href="#cb9-30"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Predictor"</span>, <span class="st">"Correlation (r)"</span>, <span class="st">"P-Value"</span>, <span class="st">"Strength"</span>)</span>
<span id="cb9-31"><a href="#cb9-31"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-32"><a href="#cb9-32"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Spearman Correlation with Rainfall (Ranked by Strength)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Predictor</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Correlation (r)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">P-Value</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Strength</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">humidity9am</td>
<td style="text-align: right;">0.440</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr class="even">
<td style="text-align: left;">humidity3pm</td>
<td style="text-align: right;">0.440</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sunshine</td>
<td style="text-align: right;">-0.400</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr class="even">
<td style="text-align: left;">cloud9am</td>
<td style="text-align: right;">0.370</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cloud3pm</td>
<td style="text-align: right;">0.320</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr class="even">
<td style="text-align: left;">evaporation</td>
<td style="text-align: right;">-0.310</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr class="odd">
<td style="text-align: left;">temp3pm</td>
<td style="text-align: right;">-0.310</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr class="even">
<td style="text-align: left;">max_temp</td>
<td style="text-align: right;">-0.300</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pressure9am</td>
<td style="text-align: right;">-0.150</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Small</td>
</tr>
<tr class="even">
<td style="text-align: left;">temp9am</td>
<td style="text-align: right;">-0.150</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Small</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wind_gust_speed</td>
<td style="text-align: right;">0.130</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Small</td>
</tr>
<tr class="even">
<td style="text-align: left;">wind_speed9am</td>
<td style="text-align: right;">0.083</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Negligible</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wind_speed3pm</td>
<td style="text-align: right;">0.068</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Negligible</td>
</tr>
<tr class="even">
<td style="text-align: left;">pressure3pm</td>
<td style="text-align: right;">-0.063</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Negligible</td>
</tr>
<tr class="odd">
<td style="text-align: left;">min_temp</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Negligible</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Calculate full pairwise correlation matrix</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>cor_matrix <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co"># Reshape for ggplot</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>cor_melt <span class="ot">&lt;-</span> cor_matrix <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Var1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Var1, <span class="at">names_to =</span> <span class="st">"Var2"</span>, <span class="at">values_to =</span> <span class="st">"Correlation"</span>)</span>
<span id="cb10-11"><a href="#cb10-11"></a></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co"># Generate Heatmap</span></span>
<span id="cb10-13"><a href="#cb10-13"></a>cor_melt <span class="sc">%&gt;%</span></span>
<span id="cb10-14"><a href="#cb10-14"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb10-15"><a href="#cb10-15"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb10-17"><a href="#cb10-17"></a>    <span class="at">low =</span> <span class="st">"#D73027"</span>,</span>
<span id="cb10-18"><a href="#cb10-18"></a>    <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb10-19"><a href="#cb10-19"></a>    <span class="at">high =</span> <span class="st">"#4575B4"</span>,</span>
<span id="cb10-20"><a href="#cb10-20"></a>    <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb10-21"><a href="#cb10-21"></a>    <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb10-22"><a href="#cb10-22"></a>    <span class="at">name =</span> <span class="st">"Spearman</span><span class="sc">\n</span><span class="st">Correlation"</span></span>
<span id="cb10-23"><a href="#cb10-23"></a>  ) <span class="sc">+</span></span>
<span id="cb10-24"><a href="#cb10-24"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-25"><a href="#cb10-25"></a>  <span class="fu">theme</span>(</span>
<span id="cb10-26"><a href="#cb10-26"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb10-27"><a href="#cb10-27"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb10-28"><a href="#cb10-28"></a>    <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-29"><a href="#cb10-29"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-30"><a href="#cb10-30"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb10-31"><a href="#cb10-31"></a>  ) <span class="sc">+</span></span>
<span id="cb10-32"><a href="#cb10-32"></a>  <span class="co"># Add correlation coefficients for significant relationships</span></span>
<span id="cb10-33"><a href="#cb10-33"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb10-34"><a href="#cb10-34"></a>    <span class="at">data =</span> <span class="fu">filter</span>(cor_melt, <span class="fu">abs</span>(Correlation) <span class="sc">&gt;</span> <span class="fl">0.3</span>),</span>
<span id="cb10-35"><a href="#cb10-35"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Correlation, <span class="dv">2</span>)),</span>
<span id="cb10-36"><a href="#cb10-36"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb10-37"><a href="#cb10-37"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb10-38"><a href="#cb10-38"></a>  ) <span class="sc">+</span></span>
<span id="cb10-39"><a href="#cb10-39"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-40"><a href="#cb10-40"></a>    <span class="at">title =</span> <span class="st">"Feature Correlation Matrix"</span>,</span>
<span id="cb10-41"><a href="#cb10-41"></a>    <span class="at">subtitle =</span> <span class="st">"Strongest predictors: Humidity (Positive) and Sunshine (Negative)"</span></span>
<span id="cb10-42"><a href="#cb10-42"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-correlation-matrix" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-correlation-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-correlation-matrix-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-correlation-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Spearman Correlation Matrix of Meteorological Features. Red indicates negative correlation; Blue indicates positive correlation.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Hypothesis: Is Humidity (3pm) a significantly different predictor than Sunshine?</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>cor_humidity <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(</span>
<span id="cb11-3"><a href="#cb11-3"></a>  df_clean<span class="sc">$</span>rainfall,</span>
<span id="cb11-4"><a href="#cb11-4"></a>  df_clean<span class="sc">$</span>humidity3pm,</span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="at">method =</span> <span class="st">"spearman"</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>)</span>
<span id="cb11-7"><a href="#cb11-7"></a>cor_sunshine <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(</span>
<span id="cb11-8"><a href="#cb11-8"></a>  df_clean<span class="sc">$</span>rainfall,</span>
<span id="cb11-9"><a href="#cb11-9"></a>  df_clean<span class="sc">$</span>sunshine,</span>
<span id="cb11-10"><a href="#cb11-10"></a>  <span class="at">method =</span> <span class="st">"spearman"</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>)</span>
<span id="cb11-12"><a href="#cb11-12"></a></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co"># Compare the two dependent correlations using Steiger's Z-test</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co"># Tests if the difference between r_humidity and r_sunshine is non-zero</span></span>
<span id="cb11-15"><a href="#cb11-15"></a>cocor_result <span class="ot">&lt;-</span> <span class="fu">cocor.dep.groups.overlap</span>(</span>
<span id="cb11-16"><a href="#cb11-16"></a>  <span class="at">r.jk =</span> cor_humidity<span class="sc">$</span>estimate, <span class="co"># Rainfall vs Humidity</span></span>
<span id="cb11-17"><a href="#cb11-17"></a>  <span class="at">r.jh =</span> cor_sunshine<span class="sc">$</span>estimate, <span class="co"># Rainfall vs Sunshine</span></span>
<span id="cb11-18"><a href="#cb11-18"></a>  <span class="at">r.kh =</span> <span class="fu">cor</span>(</span>
<span id="cb11-19"><a href="#cb11-19"></a>    df_clean<span class="sc">$</span>humidity3pm,</span>
<span id="cb11-20"><a href="#cb11-20"></a>    df_clean<span class="sc">$</span>sunshine,</span>
<span id="cb11-21"><a href="#cb11-21"></a>    <span class="at">use =</span> <span class="st">"complete.obs"</span>,</span>
<span id="cb11-22"><a href="#cb11-22"></a>    <span class="at">method =</span> <span class="st">"spearman"</span></span>
<span id="cb11-23"><a href="#cb11-23"></a>  ), <span class="co"># Humidity vs Sunshine</span></span>
<span id="cb11-24"><a href="#cb11-24"></a>  <span class="at">n =</span> <span class="fu">nrow</span>(df_clean),</span>
<span id="cb11-25"><a href="#cb11-25"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span>,</span>
<span id="cb11-26"><a href="#cb11-26"></a>  <span class="at">test =</span> <span class="st">"steiger1980"</span>, <span class="co"># Using Steiger's Z for robustness</span></span>
<span id="cb11-27"><a href="#cb11-27"></a>  <span class="at">return.htest =</span> <span class="cn">TRUE</span></span>
<span id="cb11-28"><a href="#cb11-28"></a>)</span>
<span id="cb11-29"><a href="#cb11-29"></a></span>
<span id="cb11-30"><a href="#cb11-30"></a><span class="fu">print</span>(cocor_result)</span>
<span id="cb11-31"><a href="#cb11-31"></a><span class="do">## $pearson1898</span></span>
<span id="cb11-32"><a href="#cb11-32"></a><span class="do">## </span></span>
<span id="cb11-33"><a href="#cb11-33"></a><span class="do">##  Pearson and Filon's z (1898)</span></span>
<span id="cb11-34"><a href="#cb11-34"></a><span class="do">## </span></span>
<span id="cb11-35"><a href="#cb11-35"></a><span class="do">## data:  </span></span>
<span id="cb11-36"><a href="#cb11-36"></a><span class="do">## </span></span>
<span id="cb11-37"><a href="#cb11-37"></a><span class="do">## alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb11-38"><a href="#cb11-38"></a><span class="do">## sample estimates:</span></span>
<span id="cb11-39"><a href="#cb11-39"></a><span class="do">##   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb11-40"><a href="#cb11-40"></a><span class="do">##  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb11-41"><a href="#cb11-41"></a><span class="do">## </span></span>
<span id="cb11-42"><a href="#cb11-42"></a><span class="do">## </span></span>
<span id="cb11-43"><a href="#cb11-43"></a><span class="do">## $hotelling1940</span></span>
<span id="cb11-44"><a href="#cb11-44"></a><span class="do">## </span></span>
<span id="cb11-45"><a href="#cb11-45"></a><span class="do">##  Hotelling's t (1940)</span></span>
<span id="cb11-46"><a href="#cb11-46"></a><span class="do">## </span></span>
<span id="cb11-47"><a href="#cb11-47"></a><span class="do">## data:  </span></span>
<span id="cb11-48"><a href="#cb11-48"></a><span class="do">## </span></span>
<span id="cb11-49"><a href="#cb11-49"></a><span class="do">## alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb11-50"><a href="#cb11-50"></a><span class="do">## sample estimates:</span></span>
<span id="cb11-51"><a href="#cb11-51"></a><span class="do">##   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb11-52"><a href="#cb11-52"></a><span class="do">##  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb11-53"><a href="#cb11-53"></a><span class="do">## </span></span>
<span id="cb11-54"><a href="#cb11-54"></a><span class="do">## </span></span>
<span id="cb11-55"><a href="#cb11-55"></a><span class="do">## $williams1959</span></span>
<span id="cb11-56"><a href="#cb11-56"></a><span class="do">## </span></span>
<span id="cb11-57"><a href="#cb11-57"></a><span class="do">##  Williams' t (1959)</span></span>
<span id="cb11-58"><a href="#cb11-58"></a><span class="do">## </span></span>
<span id="cb11-59"><a href="#cb11-59"></a><span class="do">## data:  </span></span>
<span id="cb11-60"><a href="#cb11-60"></a><span class="do">## </span></span>
<span id="cb11-61"><a href="#cb11-61"></a><span class="do">## alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb11-62"><a href="#cb11-62"></a><span class="do">## sample estimates:</span></span>
<span id="cb11-63"><a href="#cb11-63"></a><span class="do">##   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb11-64"><a href="#cb11-64"></a><span class="do">##  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb11-65"><a href="#cb11-65"></a><span class="do">## </span></span>
<span id="cb11-66"><a href="#cb11-66"></a><span class="do">## </span></span>
<span id="cb11-67"><a href="#cb11-67"></a><span class="do">## $hendrickson1970</span></span>
<span id="cb11-68"><a href="#cb11-68"></a><span class="do">## </span></span>
<span id="cb11-69"><a href="#cb11-69"></a><span class="do">##  Hendrickson, Stanley, and Hills' (1970) modification of Williams' t</span></span>
<span id="cb11-70"><a href="#cb11-70"></a><span class="do">##  (1959)</span></span>
<span id="cb11-71"><a href="#cb11-71"></a><span class="do">## </span></span>
<span id="cb11-72"><a href="#cb11-72"></a><span class="do">## data:  </span></span>
<span id="cb11-73"><a href="#cb11-73"></a><span class="do">## </span></span>
<span id="cb11-74"><a href="#cb11-74"></a><span class="do">## alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb11-75"><a href="#cb11-75"></a><span class="do">## sample estimates:</span></span>
<span id="cb11-76"><a href="#cb11-76"></a><span class="do">##   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb11-77"><a href="#cb11-77"></a><span class="do">##  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb11-78"><a href="#cb11-78"></a><span class="do">## </span></span>
<span id="cb11-79"><a href="#cb11-79"></a><span class="do">## </span></span>
<span id="cb11-80"><a href="#cb11-80"></a><span class="do">## $olkin1967</span></span>
<span id="cb11-81"><a href="#cb11-81"></a><span class="do">## </span></span>
<span id="cb11-82"><a href="#cb11-82"></a><span class="do">##  Olkin's z (1967)</span></span>
<span id="cb11-83"><a href="#cb11-83"></a><span class="do">## </span></span>
<span id="cb11-84"><a href="#cb11-84"></a><span class="do">## data:  </span></span>
<span id="cb11-85"><a href="#cb11-85"></a><span class="do">## </span></span>
<span id="cb11-86"><a href="#cb11-86"></a><span class="do">## alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb11-87"><a href="#cb11-87"></a><span class="do">## sample estimates:</span></span>
<span id="cb11-88"><a href="#cb11-88"></a><span class="do">##   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb11-89"><a href="#cb11-89"></a><span class="do">##  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb11-90"><a href="#cb11-90"></a><span class="do">## </span></span>
<span id="cb11-91"><a href="#cb11-91"></a><span class="do">## </span></span>
<span id="cb11-92"><a href="#cb11-92"></a><span class="do">## $dunn1969</span></span>
<span id="cb11-93"><a href="#cb11-93"></a><span class="do">## </span></span>
<span id="cb11-94"><a href="#cb11-94"></a><span class="do">##  Dunn and Clark's z (1969)</span></span>
<span id="cb11-95"><a href="#cb11-95"></a><span class="do">## </span></span>
<span id="cb11-96"><a href="#cb11-96"></a><span class="do">## data:  </span></span>
<span id="cb11-97"><a href="#cb11-97"></a><span class="do">## </span></span>
<span id="cb11-98"><a href="#cb11-98"></a><span class="do">## alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb11-99"><a href="#cb11-99"></a><span class="do">## sample estimates:</span></span>
<span id="cb11-100"><a href="#cb11-100"></a><span class="do">##   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb11-101"><a href="#cb11-101"></a><span class="do">##  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb11-102"><a href="#cb11-102"></a><span class="do">## </span></span>
<span id="cb11-103"><a href="#cb11-103"></a><span class="do">## </span></span>
<span id="cb11-104"><a href="#cb11-104"></a><span class="do">## $steiger1980</span></span>
<span id="cb11-105"><a href="#cb11-105"></a><span class="do">## </span></span>
<span id="cb11-106"><a href="#cb11-106"></a><span class="do">##  Steiger's (1980) modification of Dunn and Clark's z (1969) using</span></span>
<span id="cb11-107"><a href="#cb11-107"></a><span class="do">##  average correlations</span></span>
<span id="cb11-108"><a href="#cb11-108"></a><span class="do">## </span></span>
<span id="cb11-109"><a href="#cb11-109"></a><span class="do">## data:  </span></span>
<span id="cb11-110"><a href="#cb11-110"></a><span class="do">## z = 188.91, p-value &lt; 2.2e-16</span></span>
<span id="cb11-111"><a href="#cb11-111"></a><span class="do">## alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb11-112"><a href="#cb11-112"></a><span class="do">## sample estimates:</span></span>
<span id="cb11-113"><a href="#cb11-113"></a><span class="do">##   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb11-114"><a href="#cb11-114"></a><span class="do">##  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb11-115"><a href="#cb11-115"></a><span class="do">## </span></span>
<span id="cb11-116"><a href="#cb11-116"></a><span class="do">## </span></span>
<span id="cb11-117"><a href="#cb11-117"></a><span class="do">## $meng1992</span></span>
<span id="cb11-118"><a href="#cb11-118"></a><span class="do">## </span></span>
<span id="cb11-119"><a href="#cb11-119"></a><span class="do">##  Meng, Rosenthal, and Rubin's z (1992)</span></span>
<span id="cb11-120"><a href="#cb11-120"></a><span class="do">## </span></span>
<span id="cb11-121"><a href="#cb11-121"></a><span class="do">## data:  </span></span>
<span id="cb11-122"><a href="#cb11-122"></a><span class="do">## </span></span>
<span id="cb11-123"><a href="#cb11-123"></a><span class="do">## alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb11-124"><a href="#cb11-124"></a><span class="do">## sample estimates:</span></span>
<span id="cb11-125"><a href="#cb11-125"></a><span class="do">##   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb11-126"><a href="#cb11-126"></a><span class="do">##  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb11-127"><a href="#cb11-127"></a><span class="do">## </span></span>
<span id="cb11-128"><a href="#cb11-128"></a><span class="do">## </span></span>
<span id="cb11-129"><a href="#cb11-129"></a><span class="do">## $hittner2003</span></span>
<span id="cb11-130"><a href="#cb11-130"></a><span class="do">## </span></span>
<span id="cb11-131"><a href="#cb11-131"></a><span class="do">##  Hittner, May, and Silver's (2003) modification of Dunn and Clark's z</span></span>
<span id="cb11-132"><a href="#cb11-132"></a><span class="do">##  (1969) using a backtransformed average Fisher's (1921) Z procedure</span></span>
<span id="cb11-133"><a href="#cb11-133"></a><span class="do">## </span></span>
<span id="cb11-134"><a href="#cb11-134"></a><span class="do">## data:  </span></span>
<span id="cb11-135"><a href="#cb11-135"></a><span class="do">## </span></span>
<span id="cb11-136"><a href="#cb11-136"></a><span class="do">## alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb11-137"><a href="#cb11-137"></a><span class="do">## sample estimates:</span></span>
<span id="cb11-138"><a href="#cb11-138"></a><span class="do">##   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb11-139"><a href="#cb11-139"></a><span class="do">##  0.4436352 -0.4013063 -0.6206376 </span></span>
<span id="cb11-140"><a href="#cb11-140"></a><span class="do">## </span></span>
<span id="cb11-141"><a href="#cb11-141"></a><span class="do">## </span></span>
<span id="cb11-142"><a href="#cb11-142"></a><span class="do">## $zou2007</span></span>
<span id="cb11-143"><a href="#cb11-143"></a><span class="do">## </span></span>
<span id="cb11-144"><a href="#cb11-144"></a><span class="do">##  Zou's (2007) confidence interval</span></span>
<span id="cb11-145"><a href="#cb11-145"></a><span class="do">## </span></span>
<span id="cb11-146"><a href="#cb11-146"></a><span class="do">## data:  </span></span>
<span id="cb11-147"><a href="#cb11-147"></a><span class="do">## </span></span>
<span id="cb11-148"><a href="#cb11-148"></a><span class="do">## alternative hypothesis: true difference in correlations is not equal to 0</span></span>
<span id="cb11-149"><a href="#cb11-149"></a><span class="do">## sample estimates:</span></span>
<span id="cb11-150"><a href="#cb11-150"></a><span class="do">##   r.jk.rho   r.jh.rho       r.kh </span></span>
<span id="cb11-151"><a href="#cb11-151"></a><span class="do">##  0.4436352 -0.4013063 -0.6206376</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To identify the primary meteorological drivers of rainfall, we performed a Spearman rank correlation analysis. This non-parametric method was selected to accommodate the non-linear, skewed nature of the rainfall data identified in the previous section.</p>
<p><strong>Key Predictors:</strong> As visualized in <a href="#fig-correlation-matrix" class="quarto-xref">Figure&nbsp;<span>3.1</span></a>, the analysis reveals two distinct clusters of predictive features:</p>
<ol type="1">
<li><strong>Positive Drivers:</strong> <code>Humidity3pm</code> (<span class="math inline">\(r = 0.44\)</span>) and <code>Cloud Cover</code> (<span class="math inline">\(r \approx 0.37\)</span>) show the strongest positive association with rainfall. This aligns with physical expectations: higher atmospheric moisture and cloud density are precursors to precipitation.</li>
<li><strong>Negative Drivers:</strong> <code>Sunshine</code> (<span class="math inline">\(r = -0.40\)</span>) and <code>Evaporation</code> (<span class="math inline">\(r = -0.31\)</span>) exhibit the strongest negative correlations. Increased solar exposure and evaporation rates typically indicate clear skies and high pressure systems, conditions unfavorable for rain.</li>
</ol>
<p><strong>Multicollinearity Warning:</strong> The heatmap also highlights significant collinearity among predictors. For instance, <code>temp9am</code> and <code>temp3pm</code> are highly correlated (<span class="math inline">\(r &gt; 0.8\)</span>), as are <code>pressure9am</code> and <code>pressure3pm</code> (<span class="math inline">\(r = 0.96\)</span>). This reinforces the necessity of the VIF-based feature selection strategy outlined in our methodology to prevent model instability.</p>
<p><strong>Statistical Validation:</strong> To confirm that the opposing effects of moisture and solar radiation are statistically distinct, we applied Steiger’s Z-test for dependent correlations (<span class="math inline">\(z \approx 188.9, p &lt; 2.2e-16\)</span>). While this formally rejects the null hypothesis, we exercise caution in interpreting the p-value; in datasets of this magnitude (<span class="math inline">\(N &gt; 140,000\)</span>), statistical significance is often achieved even for trivial effects due to high power. However, the substantial magnitude of the Z-statistic confirms that the difference is not merely an artifact of sample size. We therefore conclude that <code>Humidity3pm</code> and <code>Sunshine</code> represent distinct, opposing physical forces in the generation of Australian rainfall, rather than relying solely on the p-value for “certainty.”</p>
</section>
<section id="pattern-analysis" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="pattern-analysis"><span class="header-section-number">3.5</span> Pattern Analysis</h2>
<section id="temporal-dependence-and-markov-chain-analysis" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="temporal-dependence-and-markov-chain-analysis"><span class="header-section-number">3.5.1</span> Temporal Dependence and Markov Chain Analysis</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Construct Markov transitions by lagging the 'rain_today' variable</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co"># Grouping by location ensures we don't lag across different cities</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>markov_table <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>  <span class="fu">mutate</span>(<span class="at">yesterday_rain =</span> <span class="fu">lag</span>(rain_today)) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(rain_today), <span class="sc">!</span><span class="fu">is.na</span>(yesterday_rain)) <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="fu">count</span>(yesterday_rain, rain_today)</span>
<span id="cb12-10"><a href="#cb12-10"></a></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co"># Create contingency table for statistical testing</span></span>
<span id="cb12-12"><a href="#cb12-12"></a>cont_table <span class="ot">&lt;-</span> markov_table <span class="sc">%&gt;%</span></span>
<span id="cb12-13"><a href="#cb12-13"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> rain_today, <span class="at">values_from =</span> n, <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-14"><a href="#cb12-14"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"yesterday_rain"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-15"><a href="#cb12-15"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb12-16"><a href="#cb12-16"></a></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="co"># Display raw counts</span></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="fu">print</span>(cont_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       No   Yes
No  93231 17043
Yes 17047 14829</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Pearson's Chi-squared Test for Independence</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co"># H0: Rain today is independent of rain yesterday</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>chi_result <span class="ot">&lt;-</span> <span class="fu">chisq_test</span>(<span class="fu">as.table</span>(cont_table))</span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="fu">print</span>(chi_result)</span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="do">## # A tibble: 1 × 6</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="do">##        n statistic     p    df method          p.signif</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="do">## *  &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;   </span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="do">## 1 142150    13718.     0     1 Chi-square test ****</span></span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co"># Effect Size Calculation (Cramér's V)</span></span>
<span id="cb14-11"><a href="#cb14-11"></a>cramers_v <span class="ot">&lt;-</span> <span class="fu">cramer_v</span>(cont_table)</span>
<span id="cb14-12"><a href="#cb14-12"></a></span>
<span id="cb14-13"><a href="#cb14-13"></a></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effect Size Interpretation</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="do">## </span></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="do">## Effect Size Interpretation</span></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"V = %.4f: "</span>, cramers_v))</span>
<span id="cb14-18"><a href="#cb14-18"></a><span class="do">## V = 0.3107:</span></span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="cf">if</span> (cramers_v <span class="sc">&lt;</span> <span class="fl">0.1</span>) {</span>
<span id="cb14-20"><a href="#cb14-20"></a>  <span class="fu">cat</span>(<span class="st">"Negligible Association</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-21"><a href="#cb14-21"></a>} <span class="cf">else</span> <span class="cf">if</span> (cramers_v <span class="sc">&lt;</span> <span class="fl">0.3</span>) {</span>
<span id="cb14-22"><a href="#cb14-22"></a>  <span class="fu">cat</span>(<span class="st">"Weak Association</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-23"><a href="#cb14-23"></a>} <span class="cf">else</span> <span class="cf">if</span> (cramers_v <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb14-24"><a href="#cb14-24"></a>  <span class="fu">cat</span>(<span class="st">"Moderate Association</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-25"><a href="#cb14-25"></a>} <span class="cf">else</span> {</span>
<span id="cb14-26"><a href="#cb14-26"></a>  <span class="fu">cat</span>(<span class="st">"Strong Association</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-27"><a href="#cb14-27"></a>}</span>
<span id="cb14-28"><a href="#cb14-28"></a><span class="do">## Moderate Association</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># Calculate transition probabilities for plotting</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>markov_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">mutate</span>(<span class="at">yesterday_rain =</span> <span class="fu">lag</span>(rain_today)) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(rain_today), <span class="sc">!</span><span class="fu">is.na</span>(yesterday_rain))</span>
<span id="cb15-8"><a href="#cb15-8"></a></span>
<span id="cb15-9"><a href="#cb15-9"></a>markov_data <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>  <span class="fu">count</span>(yesterday_rain, rain_today) <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11"></a>  <span class="fu">group_by</span>(yesterday_rain) <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb15-13"><a href="#cb15-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> yesterday_rain, <span class="at">y =</span> rain_today, <span class="at">fill =</span> prob)) <span class="sc">+</span></span>
<span id="cb15-14"><a href="#cb15-14"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb15-15"><a href="#cb15-15"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb15-16"><a href="#cb15-16"></a>    <span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(prob, <span class="at">accuracy =</span> <span class="dv">1</span>)),</span>
<span id="cb15-17"><a href="#cb15-17"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb15-18"><a href="#cb15-18"></a>    <span class="at">size =</span> <span class="dv">8</span>,</span>
<span id="cb15-19"><a href="#cb15-19"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span></span>
<span id="cb15-20"><a href="#cb15-20"></a>  ) <span class="sc">+</span></span>
<span id="cb15-21"><a href="#cb15-21"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"viridis"</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-23"><a href="#cb15-23"></a>    <span class="at">title =</span> <span class="st">"Markov Chain: Rain Persistence Effect"</span>,</span>
<span id="cb15-24"><a href="#cb15-24"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(</span>
<span id="cb15-25"><a href="#cb15-25"></a>      <span class="st">"X^2 = %.2f, p &lt; 0.001, Cramer's V = %.3f (Moderate Association)</span><span class="sc">\n</span><span class="st">Yesterday's rain strongly predicts today's rain state."</span>,</span>
<span id="cb15-26"><a href="#cb15-26"></a>      chi_result<span class="sc">$</span>statistic,</span>
<span id="cb15-27"><a href="#cb15-27"></a>      cramers_v</span>
<span id="cb15-28"><a href="#cb15-28"></a>    ),</span>
<span id="cb15-29"><a href="#cb15-29"></a>    <span class="at">x =</span> <span class="st">"Did it Rain Yesterday?"</span>,</span>
<span id="cb15-30"><a href="#cb15-30"></a>    <span class="at">y =</span> <span class="st">"Did it Rain Today?"</span>,</span>
<span id="cb15-31"><a href="#cb15-31"></a>    <span class="at">fill =</span> <span class="st">"Probability"</span></span>
<span id="cb15-32"><a href="#cb15-32"></a>  ) <span class="sc">+</span></span>
<span id="cb15-33"><a href="#cb15-33"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-34"><a href="#cb15-34"></a>  <span class="fu">theme</span>(</span>
<span id="cb15-35"><a href="#cb15-35"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb15-36"><a href="#cb15-36"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb15-37"><a href="#cb15-37"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb15-38"><a href="#cb15-38"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-markov-chain" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-markov-chain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-markov-chain-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-markov-chain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Markov Chain Transition Matrix: Visualizing the ‘Persistence Effect’ in Australian Rainfall.
</figcaption>
</figure>
</div>
</div>
</div>
<p>To quantify the “persistence” of weather patterns (the tendency of current weather to resemble past weather), we modeled the rainfall sequence as a first-order Markov Chain. This approach tests the hypothesis that the probability of rain today (<span class="math inline">\(P(\text{Rain}_t)\)</span>) is conditionally dependent on the state of the previous day (<span class="math inline">\(P(\text{Rain}_{t-1})\)</span>).</p>
<p><strong>Statistical Significance:</strong> The Pearson Chi-squared test (<span class="math inline">\(\chi^2 \approx 13,718, p &lt; 0.001\)</span>) overwhelmingly rejects the null hypothesis of independence. Furthermore, Cramér’s V (<span class="math inline">\(V \approx 0.31\)</span>) indicates a <strong>moderate effect size</strong>, confirming that yesterday’s weather is not just statistically significant but practically meaningful for prediction.</p>
<p><strong>Transition Probabilities:</strong> As illustrated in <a href="#fig-markov-chain" class="quarto-xref">Figure&nbsp;<span>3.2</span></a>, the transition matrix reveals distinct stability patterns:</p>
<ul>
<li><strong>Dry Persistence (Stability):</strong> If it was dry yesterday, there is an <strong>85% probability</strong> it will remain dry today. This highlights the stability of high-pressure systems in the Australian climate.</li>
<li><strong>Wet Persistence (Instability):</strong> If it rained yesterday, there is only a <strong>47% probability</strong> it will rain again today. Conversely, there is a 53% chance the weather will clear up.</li>
</ul>
<p><strong>Conclusion:</strong> While the “Dry” state is highly stable (sticky), the “Wet” state is transient. This asymmetry suggests that while past rainfall is a useful predictor, it cannot be the <em>sole</em> predictor. A robust model must incorporate other meteorological covariates (humidity, pressure) to accurately predict the onset and cessation of rainfall events.</p>
</section>
<section id="justification-for-interaction-terms" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="justification-for-interaction-terms"><span class="header-section-number">3.5.2</span> Justification for Interaction Terms</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>df_final <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-5"><a href="#cb16-5"></a>    <span class="co"># Create a reference index for the last rainy day</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>    <span class="at">rain_index_ref =</span> <span class="fu">ifelse</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="fu">row_number</span>(), <span class="cn">NA_integer_</span>)</span>
<span id="cb16-7"><a href="#cb16-7"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8"></a>  <span class="fu">fill</span>(rain_index_ref, <span class="at">.direction =</span> <span class="st">"down"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-10"><a href="#cb16-10"></a>    <span class="co"># Calculate days elapsed since the last rainfall event</span></span>
<span id="cb16-11"><a href="#cb16-11"></a>    <span class="at">days_since_rain =</span> <span class="fu">row_number</span>() <span class="sc">-</span> <span class="fu">lag</span>(rain_index_ref)</span>
<span id="cb16-12"><a href="#cb16-12"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-13"><a href="#cb16-13"></a>  <span class="fu">select</span>(<span class="sc">-</span>rain_index_ref) <span class="sc">%&gt;%</span></span>
<span id="cb16-14"><a href="#cb16-14"></a>  <span class="co"># Plotting the "Rain Corner"</span></span>
<span id="cb16-15"><a href="#cb16-15"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sunshine, humidity3pm)) <span class="sc">+</span></span>
<span id="cb16-16"><a href="#cb16-16"></a>  <span class="fu">geom_density2d_filled</span>(<span class="at">continuous_var =</span> <span class="st">"ndensity"</span>, <span class="at">bins =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb16-17"><a href="#cb16-17"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>rain_today, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb16-19"><a href="#cb16-19"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-20"><a href="#cb16-20"></a>    <span class="at">title =</span> <span class="st">"Justifying Interaction: The 'Rain Corner'"</span>,</span>
<span id="cb16-21"><a href="#cb16-21"></a>    <span class="at">subtitle =</span> <span class="st">"Rain (Right) concentrates in High Humidity/Low Sun, while No Rain (Left) is spread out.</span><span class="sc">\n</span><span class="st">This structural difference justifies a 'Sunshine * Humidity' interaction feature."</span>,</span>
<span id="cb16-22"><a href="#cb16-22"></a>    <span class="at">x =</span> <span class="st">"Sunshine (hours)"</span>,</span>
<span id="cb16-23"><a href="#cb16-23"></a>    <span class="at">y =</span> <span class="st">"Humidity 3pm (%)"</span></span>
<span id="cb16-24"><a href="#cb16-24"></a>  ) <span class="sc">+</span></span>
<span id="cb16-25"><a href="#cb16-25"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-26"><a href="#cb16-26"></a>  <span class="fu">theme</span>(</span>
<span id="cb16-27"><a href="#cb16-27"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb16-28"><a href="#cb16-28"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb16-29"><a href="#cb16-29"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb16-30"><a href="#cb16-30"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-interaction-rain-corner" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interaction-rain-corner-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-interaction-rain-corner-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interaction-rain-corner-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: Bivariate Density Plot of Humidity vs.&nbsp;Sunshine, faceted by Rainfall Occurrence. The concentration of the ‘Yes’ class in the upper-left quadrant (High Humidity, Low Sunshine) visually justifies the inclusion of an interaction term.
</figcaption>
</figure>
</div>
</div>
</div>
<p>To refine our model specification, we investigated potential non-linear interactions between key predictors. Specifically, we examined the joint distribution of <code>Humidity3pm</code> and <code>Sunshine</code>, conditional on the occurrence of rain (<code>rain_today</code>).</p>
<p><strong>The “Rain Corner” Phenomenon:</strong> As demonstrated in <a href="#fig-interaction-rain-corner" class="quarto-xref">Figure&nbsp;<span>3.3</span></a>, the two weather states exhibit fundamentally different geometric structures in feature space:</p>
<ul>
<li><strong>Dry State (<code>rain_today: No</code>):</strong> The density is dispersed broadly across the plot. It is possible to have high humidity without rain (if other conditions like pressure prevent it) or high sunshine without rain. The relationship is loose and unstructured.</li>
<li><strong>Wet State (<code>rain_today: Yes</code>):</strong> The density collapses into a distinct, tight cluster in the upper-left quadrant, a region we term the <strong>“Rain Corner”</strong>. Rain occurs almost exclusively when <strong>Humidity is High (&gt;50%) AND Sunshine is Low (&lt;5 hours)</strong>.</li>
</ul>
<p><strong>Modeling Implication:</strong> This stark visual contrast confirms that <code>Humidity</code> and <code>Sunshine</code> do not act independently. The effect of humidity on rainfall probability is conditional on the level of sunshine. Consequently, a standard additive model (<span class="math inline">\(Rain \sim Humidity + Sunshine\)</span>) would fail to capture this specific “corner” effect. This finding empirically justifies the inclusion of a multiplicative interaction term (<span class="math inline">\(Humidity \times Sunshine\)</span>) in our final model to mathematically capture this synergistic threshold.</p>
</section>
<section id="the-drying-effect-and-temporal-decay" class="level3" data-number="3.5.3">
<h3 data-number="3.5.3" class="anchored" data-anchor-id="the-drying-effect-and-temporal-decay"><span class="header-section-number">3.5.3</span> The ‘Drying Effect’ and Temporal Decay</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Construct 'Days Since Last Rain' counter for each location</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>dry_spell_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-6"><a href="#cb17-6"></a>    <span class="at">did_rain_yesterday =</span> <span class="fu">lag</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">default =</span> <span class="cn">FALSE</span>),</span>
<span id="cb17-7"><a href="#cb17-7"></a>    <span class="co"># Identify unique dry spells by cumulative sum of wet days</span></span>
<span id="cb17-8"><a href="#cb17-8"></a>    <span class="at">dry_spell_id =</span> <span class="fu">cumsum</span>(did_rain_yesterday)</span>
<span id="cb17-9"><a href="#cb17-9"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>  <span class="fu">group_by</span>(location, dry_spell_id) <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>  <span class="fu">mutate</span>(<span class="at">days_since_rain =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13"></a>  <span class="co"># Filter to focus on the first month of a dry spell for stability</span></span>
<span id="cb17-14"><a href="#cb17-14"></a>  <span class="fu">filter</span>(days_since_rain <span class="sc">&lt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-15"><a href="#cb17-15"></a>  <span class="fu">mutate</span>(<span class="at">rain_binary =</span> <span class="fu">as.numeric</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Fit Logistic Regression (Linear Trend)</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co"># Hypothesis: As the dry spell lengthens, probability of rain decreases</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb18-4"><a href="#cb18-4"></a>  rain_binary <span class="sc">~</span> days_since_rain,</span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="at">data =</span> dry_spell_data,</span>
<span id="cb18-6"><a href="#cb18-6"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb18-7"><a href="#cb18-7"></a>)</span>
<span id="cb18-8"><a href="#cb18-8"></a></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co"># Wald Test for Coefficient Significance</span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co"># Tests if the 'days_since_rain' effect is significantly different from 0</span></span>
<span id="cb18-11"><a href="#cb18-11"></a>wald_test <span class="ot">&lt;-</span> aod<span class="sc">::</span><span class="fu">wald.test</span>(</span>
<span id="cb18-12"><a href="#cb18-12"></a>  <span class="at">b =</span> <span class="fu">coef</span>(logit_model),</span>
<span id="cb18-13"><a href="#cb18-13"></a>  <span class="at">Sigma =</span> <span class="fu">vcov</span>(logit_model),</span>
<span id="cb18-14"><a href="#cb18-14"></a>  <span class="at">Terms =</span> <span class="dv">2</span></span>
<span id="cb18-15"><a href="#cb18-15"></a>)</span>
<span id="cb18-16"><a href="#cb18-16"></a></span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="co"># Calculate Odds Ratios</span></span>
<span id="cb18-18"><a href="#cb18-18"></a>or_results <span class="ot">&lt;-</span> <span class="fu">tidy</span>(logit_model, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-19"><a href="#cb18-19"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"days_since_rain"</span>)</span>
<span id="cb18-20"><a href="#cb18-20"></a></span>
<span id="cb18-21"><a href="#cb18-21"></a><span class="co"># Output Results</span></span>
<span id="cb18-22"><a href="#cb18-22"></a><span class="fu">print</span>(wald_test)</span>
<span id="cb18-23"><a href="#cb18-23"></a><span class="do">## Wald test:</span></span>
<span id="cb18-24"><a href="#cb18-24"></a><span class="do">## ----------</span></span>
<span id="cb18-25"><a href="#cb18-25"></a><span class="do">## </span></span>
<span id="cb18-26"><a href="#cb18-26"></a><span class="do">## Chi-squared test:</span></span>
<span id="cb18-27"><a href="#cb18-27"></a><span class="do">## X2 = 8099.7, df = 1, P(&gt; X2) = 0.0</span></span>
<span id="cb18-28"><a href="#cb18-28"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(</span>
<span id="cb18-29"><a href="#cb18-29"></a>  <span class="st">"</span><span class="sc">\n</span><span class="st">For each additional day without rain, odds of rainfall decrease by %.1f%%</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb18-30"><a href="#cb18-30"></a>  (<span class="dv">1</span> <span class="sc">-</span> or_results<span class="sc">$</span>estimate) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb18-31"><a href="#cb18-31"></a>))</span>
<span id="cb18-32"><a href="#cb18-32"></a><span class="do">## </span></span>
<span id="cb18-33"><a href="#cb18-33"></a><span class="do">## For each additional day without rain, odds of rainfall decrease by 16.5%</span></span>
<span id="cb18-34"><a href="#cb18-34"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(</span>
<span id="cb18-35"><a href="#cb18-35"></a>  <span class="st">"95%% CI: [%.3f, %.3f]</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb18-36"><a href="#cb18-36"></a>  or_results<span class="sc">$</span>conf.low,</span>
<span id="cb18-37"><a href="#cb18-37"></a>  or_results<span class="sc">$</span>conf.high</span>
<span id="cb18-38"><a href="#cb18-38"></a>))</span>
<span id="cb18-39"><a href="#cb18-39"></a><span class="do">## 95% CI: [0.831, 0.838]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Fit a Natural Spline model (df=4) to detect non-linear patterns</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>logit_spline <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb19-3"><a href="#cb19-3"></a>  rain_binary <span class="sc">~</span> splines<span class="sc">::</span><span class="fu">ns</span>(days_since_rain, <span class="at">df =</span> <span class="dv">4</span>),</span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="at">data =</span> dry_spell_data,</span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="at">family =</span> binomial</span>
<span id="cb19-6"><a href="#cb19-6"></a>)</span>
<span id="cb19-7"><a href="#cb19-7"></a></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="co"># Likelihood Ratio Test (LRT): Compare Linear vs. Spline Model</span></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="co"># H0: The relationship is linear (simpler model is sufficient)</span></span>
<span id="cb19-10"><a href="#cb19-10"></a>lrt_result <span class="ot">&lt;-</span> <span class="fu">anova</span>(logit_model, logit_spline, <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="fu">print</span>(lrt_result)</span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="do">## Analysis of Deviance Table</span></span>
<span id="cb19-13"><a href="#cb19-13"></a><span class="do">## </span></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="do">## Model 1: rain_binary ~ days_since_rain</span></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="do">## Model 2: rain_binary ~ splines::ns(days_since_rain, df = 4)</span></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="do">##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="do">## 1    138444     169706                          </span></span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="do">## 2    138441     162027  3   7678.7 &lt; 2.2e-16 ***</span></span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="do">## ---</span></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="do">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># Generate predictions for the trend line</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">days_since_rain =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>pred_data<span class="sc">$</span>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb20-4"><a href="#cb20-4"></a>  logit_model,</span>
<span id="cb20-5"><a href="#cb20-5"></a>  <span class="at">newdata =</span> pred_data,</span>
<span id="cb20-6"><a href="#cb20-6"></a>  <span class="at">type =</span> <span class="st">"response"</span></span>
<span id="cb20-7"><a href="#cb20-7"></a>)</span>
<span id="cb20-8"><a href="#cb20-8"></a>pred_data<span class="sc">$</span>pred_se <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb20-9"><a href="#cb20-9"></a>  logit_model,</span>
<span id="cb20-10"><a href="#cb20-10"></a>  <span class="at">newdata =</span> pred_data,</span>
<span id="cb20-11"><a href="#cb20-11"></a>  <span class="at">type =</span> <span class="st">"response"</span>,</span>
<span id="cb20-12"><a href="#cb20-12"></a>  <span class="at">se.fit =</span> <span class="cn">TRUE</span></span>
<span id="cb20-13"><a href="#cb20-13"></a>)<span class="sc">$</span>se.fit</span>
<span id="cb20-14"><a href="#cb20-14"></a></span>
<span id="cb20-15"><a href="#cb20-15"></a><span class="co"># Calculate empirical probabilities (Actual data points)</span></span>
<span id="cb20-16"><a href="#cb20-16"></a>empirical_probs <span class="ot">&lt;-</span> dry_spell_data <span class="sc">%&gt;%</span></span>
<span id="cb20-17"><a href="#cb20-17"></a>  <span class="fu">group_by</span>(days_since_rain) <span class="sc">%&gt;%</span></span>
<span id="cb20-18"><a href="#cb20-18"></a>  <span class="fu">summarise</span>(</span>
<span id="cb20-19"><a href="#cb20-19"></a>    <span class="at">prob_rain =</span> <span class="fu">mean</span>(rain_binary, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-20"><a href="#cb20-20"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb20-21"><a href="#cb20-21"></a>    <span class="at">se =</span> <span class="fu">sqrt</span>(prob_rain <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prob_rain) <span class="sc">/</span> n)</span>
<span id="cb20-22"><a href="#cb20-22"></a>  )</span>
<span id="cb20-23"><a href="#cb20-23"></a></span>
<span id="cb20-24"><a href="#cb20-24"></a><span class="co"># Plot</span></span>
<span id="cb20-25"><a href="#cb20-25"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb20-26"><a href="#cb20-26"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb20-27"><a href="#cb20-27"></a>    <span class="at">data =</span> pred_data,</span>
<span id="cb20-28"><a href="#cb20-28"></a>    <span class="fu">aes</span>(</span>
<span id="cb20-29"><a href="#cb20-29"></a>      <span class="at">x =</span> days_since_rain,</span>
<span id="cb20-30"><a href="#cb20-30"></a>      <span class="at">ymin =</span> pred_prob <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_se,</span>
<span id="cb20-31"><a href="#cb20-31"></a>      <span class="at">ymax =</span> pred_prob <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_se</span>
<span id="cb20-32"><a href="#cb20-32"></a>    ),</span>
<span id="cb20-33"><a href="#cb20-33"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb20-34"><a href="#cb20-34"></a>    <span class="at">fill =</span> <span class="st">"firebrick"</span></span>
<span id="cb20-35"><a href="#cb20-35"></a>  ) <span class="sc">+</span></span>
<span id="cb20-36"><a href="#cb20-36"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb20-37"><a href="#cb20-37"></a>    <span class="at">data =</span> pred_data,</span>
<span id="cb20-38"><a href="#cb20-38"></a>    <span class="fu">aes</span>(<span class="at">x =</span> days_since_rain, <span class="at">y =</span> pred_prob),</span>
<span id="cb20-39"><a href="#cb20-39"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span>,</span>
<span id="cb20-40"><a href="#cb20-40"></a>    <span class="at">size =</span> <span class="fl">1.2</span>,</span>
<span id="cb20-41"><a href="#cb20-41"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb20-42"><a href="#cb20-42"></a>  ) <span class="sc">+</span></span>
<span id="cb20-43"><a href="#cb20-43"></a>  <span class="co"># Empirical Data (Points + Error Bars)</span></span>
<span id="cb20-44"><a href="#cb20-44"></a>  <span class="fu">geom_pointrange</span>(</span>
<span id="cb20-45"><a href="#cb20-45"></a>    <span class="at">data =</span> empirical_probs,</span>
<span id="cb20-46"><a href="#cb20-46"></a>    <span class="fu">aes</span>(</span>
<span id="cb20-47"><a href="#cb20-47"></a>      <span class="at">x =</span> days_since_rain,</span>
<span id="cb20-48"><a href="#cb20-48"></a>      <span class="at">y =</span> prob_rain,</span>
<span id="cb20-49"><a href="#cb20-49"></a>      <span class="at">ymin =</span> prob_rain <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb20-50"><a href="#cb20-50"></a>      <span class="at">ymax =</span> prob_rain <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se</span>
<span id="cb20-51"><a href="#cb20-51"></a>    ),</span>
<span id="cb20-52"><a href="#cb20-52"></a>    <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb20-53"><a href="#cb20-53"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb20-54"><a href="#cb20-54"></a>  ) <span class="sc">+</span></span>
<span id="cb20-55"><a href="#cb20-55"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb20-56"><a href="#cb20-56"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="dv">1</span>),</span>
<span id="cb20-57"><a href="#cb20-57"></a>    <span class="at">breaks =</span> <span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">6</span>)</span>
<span id="cb20-58"><a href="#cb20-58"></a>  ) <span class="sc">+</span></span>
<span id="cb20-59"><a href="#cb20-59"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>()) <span class="sc">+</span></span>
<span id="cb20-60"><a href="#cb20-60"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-61"><a href="#cb20-61"></a>    <span class="at">x =</span> <span class="st">"Days Since Last Rain"</span>,</span>
<span id="cb20-62"><a href="#cb20-62"></a>    <span class="at">y =</span> <span class="st">"Probability of Rainfall"</span>,</span>
<span id="cb20-63"><a href="#cb20-63"></a>    <span class="at">title =</span> <span class="st">"Dry Spell Effect on Rain Probability"</span>,</span>
<span id="cb20-64"><a href="#cb20-64"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(</span>
<span id="cb20-65"><a href="#cb20-65"></a>      <span class="st">"Logistic Regression: B = %.4f, Wald χ2 = %.2f, p &lt; 0.001</span><span class="sc">\n</span><span class="st">Each additional dry day reduces odds of rain by %.1f%%"</span>,</span>
<span id="cb20-66"><a href="#cb20-66"></a>      <span class="fu">coef</span>(logit_model)[<span class="dv">2</span>],</span>
<span id="cb20-67"><a href="#cb20-67"></a>      wald_test<span class="sc">$</span>result<span class="sc">$</span>chi2[<span class="dv">1</span>],</span>
<span id="cb20-68"><a href="#cb20-68"></a>      (<span class="dv">1</span> <span class="sc">-</span> or_results<span class="sc">$</span>estimate) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb20-69"><a href="#cb20-69"></a>    ),</span>
<span id="cb20-70"><a href="#cb20-70"></a>    <span class="at">caption =</span> <span class="st">"Points: Empirical probabilities ± 95% CI | Line: Logistic model fit"</span></span>
<span id="cb20-71"><a href="#cb20-71"></a>  ) <span class="sc">+</span></span>
<span id="cb20-72"><a href="#cb20-72"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-dry-spell" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dry-spell-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-dry-spell-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dry-spell-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: The ‘Drying Effect’: Empirical vs.&nbsp;Modeled Probability of Rainfall. The probability of rain decays exponentially as the dry spell lengthens.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Beyond simple day-to-day persistence, we modeled the <strong>cumulative effect of dry spells</strong> on the probability of rain re-occurring. We formulated this as a survival-style problem: <em>Does the length of an ongoing drought influence the likelihood of it ending today?</em></p>
<p><strong>Linear Trend Analysis:</strong> A logistic regression model reveals a statistically significant negative relationship (Wald <span class="math inline">\(\chi^2 \approx 8099, p &lt; 0.001\)</span>).</p>
<ul>
<li><p><strong>The Decay Rate:</strong> The model estimates that for <strong>each additional day</strong> a dry spell continues, the odds of it raining decrease by approximately <strong>16.5%</strong> (<span class="math inline">\(OR = 0.83\)</span>).</p></li>
<li><p><strong>Physical Interpretation:</strong> This suggests a feedback loop where dry conditions promote stability (e.g., persistent high-pressure ridges), making it progressively harder for rain systems to penetrate as the dry spell lengthens.</p></li>
</ul>
<p><strong>Non-Linear Complexity:</strong> While the linear decay model is robust, the Likelihood Ratio Test comparing it to a Natural Spline model (LRT <span class="math inline">\(\chi^2 \approx 7678, p &lt; 0.001\)</span>) indicates significant non-linearity.</p>
<ul>
<li><strong>Visual Evidence:</strong> As seen in <a href="#fig-dry-spell" class="quarto-xref">Figure&nbsp;<span>3.4</span></a>, the empirical data (black dots) shows a “kink” around Day 10-12. The probability of rain drops sharply from Day 1 (~48%) to Day 10 (~18%), but then stabilizes or decays much slower from Day 15 to Day 30.</li>
<li><strong>Implication:</strong> A simple linear term underestimates the rapid initial drying and overestimates the decay in long-term droughts. Future models should utilize spline terms for <code>days_since_rain</code> to capture this “rapid-then-gradual” decay dynamic.</li>
</ul>
</section>
<section id="atmospheric-pressure-and-diurnal-variation" class="level3" data-number="3.5.4">
<h3 data-number="3.5.4" class="anchored" data-anchor-id="atmospheric-pressure-and-diurnal-variation"><span class="header-section-number">3.5.4</span> Atmospheric Pressure and Diurnal Variation</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># Diurnal Pressure Change</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>pressure_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">mutate</span>(<span class="at">pressure_change =</span> pressure3pm <span class="sc">-</span> pressure9am) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="fu">select</span>(rain_today, pressure9am, pressure3pm, pressure_change) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pressure9am), <span class="sc">!</span><span class="fu">is.na</span>(rain_today))</span>
<span id="cb21-6"><a href="#cb21-6"></a></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="co"># Visual Inspection of Normality (Q-Q Plots)</span></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="co"># Using a random subsample of 5k points for clear visualization</span></span>
<span id="cb21-9"><a href="#cb21-9"></a>pressure_data <span class="sc">%&gt;%</span></span>
<span id="cb21-10"><a href="#cb21-10"></a>  <span class="fu">sample_n</span>(<span class="dv">5000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-11"><a href="#cb21-11"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb21-12"><a href="#cb21-12"></a>    <span class="at">cols =</span> <span class="fu">c</span>(pressure9am, pressure3pm, pressure_change),</span>
<span id="cb21-13"><a href="#cb21-13"></a>    <span class="at">names_to =</span> <span class="st">"metric"</span>,</span>
<span id="cb21-14"><a href="#cb21-14"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb21-15"><a href="#cb21-15"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-16"><a href="#cb21-16"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> value)) <span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17"></a>  <span class="fu">stat_qq</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb21-19"><a href="#cb21-19"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb21-20"><a href="#cb21-20"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-21"><a href="#cb21-21"></a>    <span class="at">title =</span> <span class="st">"Q-Q Plots: Checking Normality Assumption"</span>,</span>
<span id="cb21-22"><a href="#cb21-22"></a>    <span class="at">subtitle =</span> <span class="st">"Points should hug the red line. Slight deviations are acceptable due to large N (CLT)."</span></span>
<span id="cb21-23"><a href="#cb21-23"></a>  ) <span class="sc">+</span></span>
<span id="cb21-24"><a href="#cb21-24"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-eda_files/figure-html/pressure-prep-normality-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Prepare data for testing</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>test_data <span class="ot">&lt;-</span> pressure_data <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb22-4"><a href="#cb22-4"></a>    <span class="at">cols =</span> <span class="fu">c</span>(pressure9am, pressure3pm, pressure_change),</span>
<span id="cb22-5"><a href="#cb22-5"></a>    <span class="at">names_to =</span> <span class="st">"metric"</span>,</span>
<span id="cb22-6"><a href="#cb22-6"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb22-7"><a href="#cb22-7"></a>  )</span>
<span id="cb22-8"><a href="#cb22-8"></a></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="co"># Execute Welch's t-test (robust to unequal variances)</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>stats_results <span class="ot">&lt;-</span> test_data <span class="sc">%&gt;%</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>  <span class="fu">group_by</span>(metric) <span class="sc">%&gt;%</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>  <span class="fu">t_test</span>(value <span class="sc">~</span> rain_today, <span class="at">var.equal =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-13"><a href="#cb22-13"></a>  <span class="fu">adjust_pvalue</span>(<span class="at">method =</span> <span class="st">"holm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-14"><a href="#cb22-14"></a>  <span class="fu">add_significance</span>()</span>
<span id="cb22-15"><a href="#cb22-15"></a></span>
<span id="cb22-16"><a href="#cb22-16"></a>stats_results <span class="sc">%&gt;%</span></span>
<span id="cb22-17"><a href="#cb22-17"></a>  <span class="fu">select</span>(metric, group1, group2, statistic, df, p.adj, p.adj.signif) <span class="sc">%&gt;%</span></span>
<span id="cb22-18"><a href="#cb22-18"></a>  <span class="fu">kable</span>(</span>
<span id="cb22-19"><a href="#cb22-19"></a>    <span class="at">caption =</span> <span class="st">"Welch's Two Sample t-test Results (Bonferroni-Holm Corrected)"</span>,</span>
<span id="cb22-20"><a href="#cb22-20"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb22-21"><a href="#cb22-21"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb22-22"><a href="#cb22-22"></a>      <span class="st">"Metric"</span>,</span>
<span id="cb22-23"><a href="#cb22-23"></a>      <span class="st">"Group 1"</span>,</span>
<span id="cb22-24"><a href="#cb22-24"></a>      <span class="st">"Group 2"</span>,</span>
<span id="cb22-25"><a href="#cb22-25"></a>      <span class="st">"t-statistic"</span>,</span>
<span id="cb22-26"><a href="#cb22-26"></a>      <span class="st">"df"</span>,</span>
<span id="cb22-27"><a href="#cb22-27"></a>      <span class="st">"Adj. P-Value"</span>,</span>
<span id="cb22-28"><a href="#cb22-28"></a>      <span class="st">"Significance"</span></span>
<span id="cb22-29"><a href="#cb22-29"></a>    )</span>
<span id="cb22-30"><a href="#cb22-30"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-31"><a href="#cb22-31"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Welch's Two Sample t-test Results (Bonferroni-Holm Corrected)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Group 1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Group 2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t-statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Adj. P-Value</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Significance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">pressure3pm</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">42.016</td>
<td style="text-align: right;">47512.35</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="even">
<td style="text-align: left;">pressure9am</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">72.192</td>
<td style="text-align: right;">47290.28</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pressure_change</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">-105.393</td>
<td style="text-align: right;">44171.84</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">****</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># Calculate Cohen's d Effect Size</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>effect_sizes <span class="ot">&lt;-</span> test_data <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="fu">group_by</span>(metric) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="fu">cohens_d</span>(value <span class="sc">~</span> rain_today, <span class="at">var.equal =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>  <span class="co"># Categorize magnitude</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-7"><a href="#cb23-7"></a>    <span class="at">magnitude =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-8"><a href="#cb23-8"></a>      <span class="fu">abs</span>(effsize) <span class="sc">&lt;</span> <span class="fl">0.2</span> <span class="sc">~</span> <span class="st">"Negligible"</span>,</span>
<span id="cb23-9"><a href="#cb23-9"></a>      <span class="fu">abs</span>(effsize) <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Small"</span>,</span>
<span id="cb23-10"><a href="#cb23-10"></a>      <span class="fu">abs</span>(effsize) <span class="sc">&lt;</span> <span class="fl">0.8</span> <span class="sc">~</span> <span class="st">"Medium"</span>,</span>
<span id="cb23-11"><a href="#cb23-11"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Large"</span></span>
<span id="cb23-12"><a href="#cb23-12"></a>    )</span>
<span id="cb23-13"><a href="#cb23-13"></a>  )</span>
<span id="cb23-14"><a href="#cb23-14"></a></span>
<span id="cb23-15"><a href="#cb23-15"></a>effect_sizes <span class="sc">%&gt;%</span></span>
<span id="cb23-16"><a href="#cb23-16"></a>  <span class="fu">select</span>(metric, effsize, magnitude) <span class="sc">%&gt;%</span></span>
<span id="cb23-17"><a href="#cb23-17"></a>  <span class="fu">kable</span>(</span>
<span id="cb23-18"><a href="#cb23-18"></a>    <span class="at">caption =</span> <span class="st">"Cohen's d Effect Size Analysis"</span>,</span>
<span id="cb23-19"><a href="#cb23-19"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb23-20"><a href="#cb23-20"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Effect Size (d)"</span>, <span class="st">"Interpretation"</span>)</span>
<span id="cb23-21"><a href="#cb23-21"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb23-22"><a href="#cb23-22"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Cohen's d Effect Size Analysis</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Metric</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Effect Size (d)</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">pressure3pm</td>
<td style="text-align: right;">0.275</td>
<td style="text-align: left;">Small</td>
</tr>
<tr class="even">
<td style="text-align: left;">pressure9am</td>
<td style="text-align: right;">0.474</td>
<td style="text-align: left;">Small</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pressure_change</td>
<td style="text-align: right;">-0.711</td>
<td style="text-align: left;">Medium</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># Merge statistics for annotation</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>plot_annotations <span class="ot">&lt;-</span> stats_results <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">left_join</span>(effect_sizes, <span class="at">by =</span> <span class="st">"metric"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-5"><a href="#cb24-5"></a>    <span class="at">label_text =</span> <span class="fu">sprintf</span>(</span>
<span id="cb24-6"><a href="#cb24-6"></a>      <span class="st">"p %s</span><span class="sc">\n</span><span class="st">Cohen's d = %.2f (%s)"</span>,</span>
<span id="cb24-7"><a href="#cb24-7"></a>      p.adj.signif,</span>
<span id="cb24-8"><a href="#cb24-8"></a>      effsize,</span>
<span id="cb24-9"><a href="#cb24-9"></a>      magnitude</span>
<span id="cb24-10"><a href="#cb24-10"></a>    ),</span>
<span id="cb24-11"><a href="#cb24-11"></a>    <span class="at">y_pos =</span> <span class="fu">case_when</span>(</span>
<span id="cb24-12"><a href="#cb24-12"></a>      metric <span class="sc">==</span> <span class="st">"pressure9am"</span> <span class="sc">~</span> <span class="dv">1045</span>,</span>
<span id="cb24-13"><a href="#cb24-13"></a>      metric <span class="sc">==</span> <span class="st">"pressure3pm"</span> <span class="sc">~</span> <span class="dv">1040</span>,</span>
<span id="cb24-14"><a href="#cb24-14"></a>      metric <span class="sc">==</span> <span class="st">"pressure_change"</span> <span class="sc">~</span> <span class="dv">15</span></span>
<span id="cb24-15"><a href="#cb24-15"></a>    )</span>
<span id="cb24-16"><a href="#cb24-16"></a>  )</span>
<span id="cb24-17"><a href="#cb24-17"></a></span>
<span id="cb24-18"><a href="#cb24-18"></a><span class="fu">ggplot</span>(test_data, <span class="fu">aes</span>(rain_today, value, <span class="at">fill =</span> rain_today)) <span class="sc">+</span></span>
<span id="cb24-19"><a href="#cb24-19"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb24-20"><a href="#cb24-20"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb24-21"><a href="#cb24-21"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb24-22"><a href="#cb24-22"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb24-23"><a href="#cb24-23"></a>    <span class="at">data =</span> plot_annotations,</span>
<span id="cb24-24"><a href="#cb24-24"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> y_pos, <span class="at">label =</span> label_text),</span>
<span id="cb24-25"><a href="#cb24-25"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-26"><a href="#cb24-26"></a>    <span class="at">vjust =</span> <span class="dv">0</span>,</span>
<span id="cb24-27"><a href="#cb24-27"></a>    <span class="at">fontface =</span> <span class="st">"italic"</span>,</span>
<span id="cb24-28"><a href="#cb24-28"></a>    <span class="at">size =</span> <span class="fl">3.5</span></span>
<span id="cb24-29"><a href="#cb24-29"></a>  ) <span class="sc">+</span></span>
<span id="cb24-30"><a href="#cb24-30"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#B0B0B0"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>)) <span class="sc">+</span></span>
<span id="cb24-31"><a href="#cb24-31"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-32"><a href="#cb24-32"></a>    <span class="at">title =</span> <span class="st">"Atmospheric Pressure vs. Rainfall"</span>,</span>
<span id="cb24-33"><a href="#cb24-33"></a>    <span class="at">subtitle =</span> <span class="st">"Statistical validation using Welch's t-test and Cohen's d effect size"</span>,</span>
<span id="cb24-34"><a href="#cb24-34"></a>    <span class="at">y =</span> <span class="st">"Pressure (hPa)"</span>,</span>
<span id="cb24-35"><a href="#cb24-35"></a>    <span class="at">x =</span> <span class="st">"Did it rain?"</span></span>
<span id="cb24-36"><a href="#cb24-36"></a>  ) <span class="sc">+</span></span>
<span id="cb24-37"><a href="#cb24-37"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-38"><a href="#cb24-38"></a>  <span class="fu">theme</span>(</span>
<span id="cb24-39"><a href="#cb24-39"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb24-40"><a href="#cb24-40"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb24-41"><a href="#cb24-41"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-pressure-violin" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pressure-violin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-pressure-violin-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pressure-violin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.5: Violin Plots of Atmospheric Pressure Variables by Rainfall State. Annotations indicate statistical significance and effect size.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>data_wide <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="fu">group_by</span>(rain_today) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="fu">summarise</span>(</span>
<span id="cb25-4"><a href="#cb25-4"></a>    <span class="st">`</span><span class="at">9:00 AM</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(pressure9am, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-5"><a href="#cb25-5"></a>    <span class="st">`</span><span class="at">3:00 PM</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(pressure3pm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-6"><a href="#cb25-6"></a>    <span class="co"># Calculate positive drop (9am - 3pm)</span></span>
<span id="cb25-7"><a href="#cb25-7"></a>    <span class="st">`</span><span class="at">Pressure Drop</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(pressure9am, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>      <span class="fu">mean</span>(pressure3pm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-9"><a href="#cb25-9"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>rain_today, <span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-11"><a href="#cb25-11"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-12"><a href="#cb25-12"></a>    <span class="at">metric =</span> <span class="fu">factor</span>(metric, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"9:00 AM"</span>, <span class="st">"3:00 PM"</span>, <span class="st">"Pressure Drop"</span>)),</span>
<span id="cb25-13"><a href="#cb25-13"></a>    <span class="at">label_txt =</span> <span class="fu">round</span>(value, <span class="dv">1</span>)</span>
<span id="cb25-14"><a href="#cb25-14"></a>  )</span>
<span id="cb25-15"><a href="#cb25-15"></a></span>
<span id="cb25-16"><a href="#cb25-16"></a><span class="fu">ggplot</span>(data_wide, <span class="fu">aes</span>(<span class="at">x =</span> rain_today, <span class="at">y =</span> value, <span class="at">fill =</span> rain_today)) <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb25-18"><a href="#cb25-18"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label_txt), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb25-20"><a href="#cb25-20"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#B0B0B0"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>)) <span class="sc">+</span></span>
<span id="cb25-21"><a href="#cb25-21"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"Dry Days"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"Rainy Days"</span>)) <span class="sc">+</span></span>
<span id="cb25-22"><a href="#cb25-22"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-23"><a href="#cb25-23"></a>    <span class="at">title =</span> <span class="st">"Rainy Days Exhibit Lower Baseline Pressure and Suppressed Diurnal Variation"</span>,</span>
<span id="cb25-24"><a href="#cb25-24"></a>    <span class="at">subtitle =</span> <span class="st">"Lower absolute pressure at 9am is the key distinguishing factor"</span>,</span>
<span id="cb25-25"><a href="#cb25-25"></a>    <span class="at">y =</span> <span class="st">"Pressure (hPa) / Drop (hPa)"</span>,</span>
<span id="cb25-26"><a href="#cb25-26"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb25-27"><a href="#cb25-27"></a>  ) <span class="sc">+</span></span>
<span id="cb25-28"><a href="#cb25-28"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb25-29"><a href="#cb25-29"></a>  <span class="fu">theme</span>(</span>
<span id="cb25-30"><a href="#cb25-30"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb25-31"><a href="#cb25-31"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb25-32"><a href="#cb25-32"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"grey30"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">15</span>)),</span>
<span id="cb25-33"><a href="#cb25-33"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb25-34"><a href="#cb25-34"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb25-35"><a href="#cb25-35"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb25-36"><a href="#cb25-36"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-pressure-means" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pressure-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-pressure-means-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pressure-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.6: Comparison of Mean Pressure Levels and Diurnal Drop. Rainy days are characterized by lower absolute pressure and a suppressed diurnal drop.
</figcaption>
</figure>
</div>
</div>
</div>
<p>We analyzed atmospheric pressure dynamics to determine how barometric baselines and diurnal fluctuations correlate with rainfall.</p>
<p><strong>1. Statistical Validity:</strong></p>
<ul>
<li><strong>Normality:</strong> The Q-Q plots show that while pressure data generally follows a normal distribution, there are deviations in the tails. However, given our large sample size (<span class="math inline">\(N &gt; 140,000\)</span>), the Central Limit Theorem ensures the validity of parametric testing.</li>
<li><strong>Significance:</strong> Welch’s t-test confirms that all pressure metrics are significantly different between dry and rainy days (<span class="math inline">\(p &lt; 0.001\)</span>).</li>
</ul>
<p><strong>2. Key Findings:</strong></p>
<ul>
<li><strong>Baseline Pressure:</strong> Rainy days are characterized by significantly lower atmospheric pressure. As shown in <a href="#fig-pressure-means" class="quarto-xref">Figure&nbsp;<span>3.6</span></a>, the mean pressure at 9:00 AM is <strong>1015 hPa for rainy days</strong> compared to <strong>1018.5 hPa for dry days</strong>. This aligns with the meteorological principle that low-pressure systems facilitate cloud formation and precipitation.</li>
<li><strong>Diurnal Drop:</strong> We observed a distinct “suppression” effect on rainy days.
<ul>
<li><strong>Dry Days:</strong> Pressure drops significantly by <strong>2.7 hPa</strong> from morning to afternoon, driven by solar heating (thermal lows).</li>
<li><strong>Rainy Days:</strong> The drop is suppressed to just <strong>1.3 hPa</strong>. Cloud cover likely limits surface heating, reducing the intensity of the thermal low formation.</li>
</ul></li>
</ul>
<p><strong>3. Effect Size:</strong> The Cohen’s <span class="math inline">\(d\)</span> analysis reveals that the <strong>magnitude of change</strong> (<code>pressure_change</code>) has a <strong>medium effect size</strong> (<span class="math inline">\(d = -0.72\)</span>), which is notably stronger than the absolute pressure readings (<span class="math inline">\(d \approx 0.28-0.48\)</span>). This suggests that the <em>stability</em> of pressure (or lack thereof) during the day is a potent predictor of rainfall, potentially more so than the raw pressure reading itself.</p>
</section>
<section id="seasonal-dynamics-and-intensity-cycles" class="level3" data-number="3.5.5">
<h3 data-number="3.5.5" class="anchored" data-anchor-id="seasonal-dynamics-and-intensity-cycles"><span class="header-section-number">3.5.5</span> Seasonal Dynamics and Intensity Cycles</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># Calculate aggregated monthly statistics (Mean, Median, Count)</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>monthly_stats <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="fu">group_by</span>(month) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="fu">summarise</span>(</span>
<span id="cb26-6"><a href="#cb26-6"></a>    <span class="at">median_rain =</span> <span class="fu">median</span>(rainfall),</span>
<span id="cb26-7"><a href="#cb26-7"></a>    <span class="at">mean_rain =</span> <span class="fu">mean</span>(rainfall),</span>
<span id="cb26-8"><a href="#cb26-8"></a>    <span class="at">rain_days =</span> <span class="fu">n</span>(),</span>
<span id="cb26-9"><a href="#cb26-9"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb26-11"><a href="#cb26-11"></a>  <span class="fu">mutate</span>(<span class="at">month_label =</span> <span class="fu">factor</span>(month.abb[month], <span class="at">levels =</span> <span class="fu">rev</span>(month.abb)))</span>
<span id="cb26-12"><a href="#cb26-12"></a></span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="co"># Prepare data for density plotting (Log transformation for skewness)</span></span>
<span id="cb26-14"><a href="#cb26-14"></a>plot_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb26-15"><a href="#cb26-15"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-16"><a href="#cb26-16"></a>  <span class="fu">mutate</span>(</span>
<span id="cb26-17"><a href="#cb26-17"></a>    <span class="at">month_label =</span> <span class="fu">factor</span>(month.abb[month], <span class="at">levels =</span> <span class="fu">rev</span>(month.abb)),</span>
<span id="cb26-18"><a href="#cb26-18"></a>    <span class="at">log_rain =</span> <span class="fu">log</span>(rainfall)</span>
<span id="cb26-19"><a href="#cb26-19"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb26-20"><a href="#cb26-20"></a>  <span class="fu">left_join</span>(monthly_stats, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"month"</span>, <span class="st">"month_label"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(log_rain, month_label, <span class="at">fill =</span> <span class="fu">after_stat</span>(x))) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">geom_density_ridges_gradient</span>(</span>
<span id="cb27-3"><a href="#cb27-3"></a>    <span class="at">scale =</span> <span class="fl">2.5</span>,</span>
<span id="cb27-4"><a href="#cb27-4"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.01</span>,</span>
<span id="cb27-5"><a href="#cb27-5"></a>    <span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-6"><a href="#cb27-6"></a>    <span class="at">quantiles =</span> <span class="dv">2</span>, <span class="co"># Marks the median</span></span>
<span id="cb27-7"><a href="#cb27-7"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb27-8"><a href="#cb27-8"></a>  ) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9"></a>  <span class="co"># Global Median Line for reference</span></span>
<span id="cb27-10"><a href="#cb27-10"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb27-11"><a href="#cb27-11"></a>    <span class="at">xintercept =</span> <span class="fu">median</span>(<span class="fu">log</span>(df_final<span class="sc">$</span>rainfall[df_final<span class="sc">$</span>rainfall <span class="sc">&gt;</span> <span class="dv">0</span>])),</span>
<span id="cb27-12"><a href="#cb27-12"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb27-13"><a href="#cb27-13"></a>    <span class="at">color =</span> <span class="st">"grey30"</span>,</span>
<span id="cb27-14"><a href="#cb27-14"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span></span>
<span id="cb27-15"><a href="#cb27-15"></a>  ) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16"></a>  <span class="fu">scale_fill_viridis_c</span>(</span>
<span id="cb27-17"><a href="#cb27-17"></a>    <span class="at">option =</span> <span class="st">"mako"</span>,</span>
<span id="cb27-18"><a href="#cb27-18"></a>    <span class="at">name =</span> <span class="st">"Log</span><span class="sc">\n</span><span class="st">Rainfall"</span>,</span>
<span id="cb27-19"><a href="#cb27-19"></a>    <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb27-20"><a href="#cb27-20"></a>  ) <span class="sc">+</span></span>
<span id="cb27-21"><a href="#cb27-21"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">pretty_breaks</span>()) <span class="sc">+</span></span>
<span id="cb27-22"><a href="#cb27-22"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-23"><a href="#cb27-23"></a>    <span class="at">title =</span> <span class="st">"Monthly Rainfall Distribution Patterns"</span>,</span>
<span id="cb27-24"><a href="#cb27-24"></a>    <span class="at">subtitle =</span> <span class="st">"Solid lines mark monthly medians vs. the Global Median (dashed).</span><span class="sc">\n</span><span class="st">Notice how the distribution's shape and center shift cyclically relative to the global baseline."</span>,</span>
<span id="cb27-25"><a href="#cb27-25"></a>    <span class="at">x =</span> <span class="st">"Rainfall Amount (mm, log scale)"</span>,</span>
<span id="cb27-26"><a href="#cb27-26"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb27-27"><a href="#cb27-27"></a>  ) <span class="sc">+</span></span>
<span id="cb27-28"><a href="#cb27-28"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-monthly-dist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-monthly-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-monthly-dist-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-monthly-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.7: Ridgeline Plot of Monthly Log-Rainfall Distributions. The shifting peaks illustrate how rainfall intensity varies across the year compared to the global median (dashed line).
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># Assign based on the Australian seasons</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>seasonal_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-5"><a href="#cb28-5"></a>    <span class="at">season =</span> <span class="fu">case_when</span>(</span>
<span id="cb28-6"><a href="#cb28-6"></a>      month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">~</span> <span class="st">"Summer"</span>,</span>
<span id="cb28-7"><a href="#cb28-7"></a>      month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>) <span class="sc">~</span> <span class="st">"Autumn"</span>,</span>
<span id="cb28-8"><a href="#cb28-8"></a>      month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>) <span class="sc">~</span> <span class="st">"Winter"</span>,</span>
<span id="cb28-9"><a href="#cb28-9"></a>      month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>) <span class="sc">~</span> <span class="st">"Spring"</span></span>
<span id="cb28-10"><a href="#cb28-10"></a>    ),</span>
<span id="cb28-11"><a href="#cb28-11"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Summer"</span>, <span class="st">"Autumn"</span>, <span class="st">"Winter"</span>, <span class="st">"Spring"</span>))</span>
<span id="cb28-12"><a href="#cb28-12"></a>  )</span>
<span id="cb28-13"><a href="#cb28-13"></a>plot_data_seasonal <span class="ot">&lt;-</span> seasonal_data <span class="sc">%&gt;%</span></span>
<span id="cb28-14"><a href="#cb28-14"></a>  <span class="fu">mutate</span>(<span class="at">month_label =</span> <span class="fu">factor</span>(month.abb[month], <span class="at">levels =</span> month.abb))</span>
<span id="cb28-15"><a href="#cb28-15"></a></span>
<span id="cb28-16"><a href="#cb28-16"></a><span class="fu">ggplot</span>(plot_data_seasonal, <span class="fu">aes</span>(rainfall, month_label, <span class="at">fill =</span> season)) <span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb28-18"><a href="#cb28-18"></a>    <span class="at">scale =</span> <span class="fl">1.5</span>,</span>
<span id="cb28-19"><a href="#cb28-19"></a>    <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb28-20"><a href="#cb28-20"></a>    <span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-21"><a href="#cb28-21"></a>    <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)</span>
<span id="cb28-22"><a href="#cb28-22"></a>  ) <span class="sc">+</span></span>
<span id="cb28-23"><a href="#cb28-23"></a>  <span class="fu">scale_x_log10</span>(</span>
<span id="cb28-24"><a href="#cb28-24"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">300</span>),</span>
<span id="cb28-25"><a href="#cb28-25"></a>    <span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb28-26"><a href="#cb28-26"></a>  ) <span class="sc">+</span></span>
<span id="cb28-27"><a href="#cb28-27"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb28-28"><a href="#cb28-28"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb28-29"><a href="#cb28-29"></a>      <span class="st">"Summer"</span> <span class="ot">=</span> <span class="st">"#E69F00"</span>,</span>
<span id="cb28-30"><a href="#cb28-30"></a>      <span class="st">"Autumn"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>,</span>
<span id="cb28-31"><a href="#cb28-31"></a>      <span class="st">"Winter"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>,</span>
<span id="cb28-32"><a href="#cb28-32"></a>      <span class="st">"Spring"</span> <span class="ot">=</span> <span class="st">"#009E73"</span></span>
<span id="cb28-33"><a href="#cb28-33"></a>    )</span>
<span id="cb28-34"><a href="#cb28-34"></a>  ) <span class="sc">+</span></span>
<span id="cb28-35"><a href="#cb28-35"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>season, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb28-36"><a href="#cb28-36"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-37"><a href="#cb28-37"></a>    <span class="at">title =</span> <span class="st">"Seasonal Rainfall Patterns"</span>,</span>
<span id="cb28-38"><a href="#cb28-38"></a>    <span class="at">subtitle =</span> <span class="st">"Quartile lines show 25th, 50th, and 75th percentiles"</span>,</span>
<span id="cb28-39"><a href="#cb28-39"></a>    <span class="at">x =</span> <span class="st">"Rainfall Amount (mm, log scale)"</span>,</span>
<span id="cb28-40"><a href="#cb28-40"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb28-41"><a href="#cb28-41"></a>  ) <span class="sc">+</span></span>
<span id="cb28-42"><a href="#cb28-42"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-seasonal-facet" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-seasonal-facet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-seasonal-facet-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-seasonal-facet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.8: Seasonal Rainfall Patterns separated by Meteorological Seasons. Summer months exhibit higher variance and intensity compared to Winter.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>monthly_stats <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">mutate</span>(<span class="at">month_label =</span> <span class="fu">factor</span>(month.abb[month], <span class="at">levels =</span> month.abb)) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(month_label, mean_rain)) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> mean_rain, <span class="at">alpha =</span> <span class="fl">0.8</span>), <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb29-6"><a href="#cb29-6"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(mean_rain, <span class="dv">1</span>)),</span>
<span id="cb29-7"><a href="#cb29-7"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb29-8"><a href="#cb29-8"></a>    <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb29-9"><a href="#cb29-9"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span></span>
<span id="cb29-10"><a href="#cb29-10"></a>  ) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"mako"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-13"><a href="#cb29-13"></a>    <span class="at">title =</span> <span class="st">"Mean Rainfall by Month (Non-Zero Days)"</span>,</span>
<span id="cb29-14"><a href="#cb29-14"></a>    <span class="at">subtitle =</span> <span class="st">"Confirms seasonal variation justifying cyclical encoding"</span>,</span>
<span id="cb29-15"><a href="#cb29-15"></a>    <span class="at">y =</span> <span class="st">"Mean Rainfall (mm)"</span>,</span>
<span id="cb29-16"><a href="#cb29-16"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb29-17"><a href="#cb29-17"></a>  ) <span class="sc">+</span></span>
<span id="cb29-18"><a href="#cb29-18"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb29-19"><a href="#cb29-19"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-20"><a href="#cb29-20"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb29-21"><a href="#cb29-21"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"grey30"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb29-22"><a href="#cb29-22"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb29-23"><a href="#cb29-23"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-24"><a href="#cb29-24"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb29-25"><a href="#cb29-25"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mean-rain-bar" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mean-rain-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-mean-rain-bar-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mean-rain-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.9: Average Rainfall Intensity (Non-Zero Days) by Month. Summer months (Feb/Jan) clearly exhibit higher average rainfall per event than winter months.
</figcaption>
</figure>
</div>
</div>
</div>
<p>While our earlier contingency analysis focused on the <em>frequency</em> of rainfall events, this section investigates the <em>intensity</em> of rainfall when it does occur.</p>
<p><strong>1. Cyclical Shifts in Intensity:</strong> The ridgeline analysis reveals a clear cyclical pattern in rainfall distribution relative to the global median.</p>
<ul>
<li><strong>Summer Peaks:</strong> The distributions for January and February are visibly shifted to the right of the global median (dashed line), indicating that summer storms, while potentially less frequent, are significantly more intense.</li>
<li><strong>Winter Consistency:</strong> In contrast, winter months (June-August) show distributions clustered tightly around lower rainfall values.</li>
</ul>
<p><strong>2. Seasonal Variance:</strong> Segmenting the data by season clarifies the mechanism:</p>
<ul>
<li><strong>Summer (Gold):</strong> Characterized by high variance and “fat tails” extending to &gt;100mm. The interquartile range (IQR) is wider, reflecting the sporadic nature of convective summer storms.</li>
<li><strong>Winter (Blue):</strong> Characterized by narrower, peaked distributions. The rainfall is consistent but generally lighter, typical of frontal systems.</li>
</ul>
<p><strong>3. Mean Intensity Confirmation:</strong> The bar chart quantifies this observation. February records the highest average rainfall per wet day (<strong>10.1 mm</strong>), nearly double that of July (<strong>4.9 mm</strong>). This stark contrast confirms that <code>Month</code> carries critical information not just about <em>whether</em> it will rain, but <em>how hard</em>.</p>
<p><strong>Modeling Implication:</strong> Because the relationship between Month 12 (Dec) and Month 1 (Jan) is continuous rather than categorical, treating <code>Month</code> as a standard factor may lose information. These plots strongly support using <strong>Cyclical Encoding (Sine/Cosine transformation)</strong> for the <code>Month</code> variable in our final model to mathematically capture this smooth, wave-like transition from summer peaks to winter troughs.</p>
</section>
<section id="statistical-validation-of-seasonal-intensity" class="level3" data-number="3.5.6">
<h3 data-number="3.5.6" class="anchored" data-anchor-id="statistical-validation-of-seasonal-intensity"><span class="header-section-number">3.5.6</span> Statistical Validation of Seasonal Intensity</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># Calculate Mean and SD for each season to establish baseline differences</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>seasonal_stats <span class="ot">&lt;-</span> seasonal_data <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="fu">select</span>(season, rainfall) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>  <span class="fu">group_by</span>(season) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>  <span class="fu">get_summary_stats</span>(rainfall, <span class="at">type =</span> <span class="st">"mean_sd"</span>)</span>
<span id="cb30-6"><a href="#cb30-6"></a></span>
<span id="cb30-7"><a href="#cb30-7"></a>seasonal_stats <span class="sc">%&gt;%</span></span>
<span id="cb30-8"><a href="#cb30-8"></a>  <span class="fu">kable</span>(</span>
<span id="cb30-9"><a href="#cb30-9"></a>    <span class="at">caption =</span> <span class="st">"Descriptive Statistics of Rainfall Intensity by Season"</span>,</span>
<span id="cb30-10"><a href="#cb30-10"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Season"</span>, <span class="st">"Variable"</span>, <span class="st">"N (Events)"</span>, <span class="st">"Mean (mm)"</span>, <span class="st">"SD (mm)"</span>)</span>
<span id="cb30-11"><a href="#cb30-11"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb30-12"><a href="#cb30-12"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Descriptive Statistics of Rainfall Intensity by Season</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Season</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N (Events)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean (mm)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD (mm)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Summer</td>
<td style="text-align: left;">rainfall</td>
<td style="text-align: right;">10571</td>
<td style="text-align: right;">9.070</td>
<td style="text-align: right;">18.195</td>
</tr>
<tr class="even">
<td style="text-align: left;">Autumn</td>
<td style="text-align: left;">rainfall</td>
<td style="text-align: right;">13382</td>
<td style="text-align: right;">6.667</td>
<td style="text-align: right;">13.495</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Winter</td>
<td style="text-align: left;">rainfall</td>
<td style="text-align: right;">15402</td>
<td style="text-align: right;">5.463</td>
<td style="text-align: right;">9.809</td>
</tr>
<tr class="even">
<td style="text-align: left;">Spring</td>
<td style="text-align: left;">rainfall</td>
<td style="text-align: right;">11764</td>
<td style="text-align: right;">5.651</td>
<td style="text-align: right;">10.495</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># Kruskal-Wallis Test</span></span>
<span id="cb31-2"><a href="#cb31-2"></a></span>
<span id="cb31-3"><a href="#cb31-3"></a>kw_result <span class="ot">&lt;-</span> <span class="fu">kruskal_test</span>(rainfall <span class="sc">~</span> season, <span class="at">data =</span> seasonal_data)</span>
<span id="cb31-4"><a href="#cb31-4"></a></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="co"># Effect Size (Epsilon-squared)</span></span>
<span id="cb31-6"><a href="#cb31-6"></a>epsilon_sq <span class="ot">&lt;-</span> <span class="fu">kruskal_effsize</span>(rainfall <span class="sc">~</span> season, <span class="at">data =</span> seasonal_data)</span>
<span id="cb31-7"><a href="#cb31-7"></a></span>
<span id="cb31-8"><a href="#cb31-8"></a>kw_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb31-9"><a href="#cb31-9"></a>  <span class="at">Test =</span> <span class="st">"Kruskal-Wallis Rank Sum Test"</span>,</span>
<span id="cb31-10"><a href="#cb31-10"></a>  <span class="st">`</span><span class="at">Chi-squared</span><span class="st">`</span> <span class="ot">=</span> kw_result<span class="sc">$</span>statistic,</span>
<span id="cb31-11"><a href="#cb31-11"></a>  <span class="at">df =</span> kw_result<span class="sc">$</span>df,</span>
<span id="cb31-12"><a href="#cb31-12"></a>  <span class="st">`</span><span class="at">P-value</span><span class="st">`</span> <span class="ot">=</span> kw_result<span class="sc">$</span>p,</span>
<span id="cb31-13"><a href="#cb31-13"></a>  <span class="st">`</span><span class="at">Effect Size</span><span class="st">`</span> <span class="ot">=</span> epsilon_sq<span class="sc">$</span>effsize,</span>
<span id="cb31-14"><a href="#cb31-14"></a>  <span class="at">Magnitude =</span> <span class="fu">as.character</span>(epsilon_sq<span class="sc">$</span>magnitude)</span>
<span id="cb31-15"><a href="#cb31-15"></a>)</span>
<span id="cb31-16"><a href="#cb31-16"></a></span>
<span id="cb31-17"><a href="#cb31-17"></a>kw_summary <span class="sc">%&gt;%</span></span>
<span id="cb31-18"><a href="#cb31-18"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-19"><a href="#cb31-19"></a>    <span class="st">`</span><span class="at">Chi-squared</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">Chi-squared</span><span class="st">`</span>, <span class="dv">2</span>),</span>
<span id="cb31-20"><a href="#cb31-20"></a>    <span class="st">`</span><span class="at">Effect Size</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">Effect Size</span><span class="st">`</span>, <span class="dv">4</span>),</span>
<span id="cb31-21"><a href="#cb31-21"></a>    <span class="st">`</span><span class="at">P-value</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(<span class="st">`</span><span class="at">P-value</span><span class="st">`</span>, <span class="at">accuracy =</span> <span class="fl">0.001</span>)</span>
<span id="cb31-22"><a href="#cb31-22"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-23"><a href="#cb31-23"></a>  <span class="fu">kable</span>(</span>
<span id="cb31-24"><a href="#cb31-24"></a>    <span class="at">caption =</span> <span class="st">"Statistical Significance of Seasonal Differences (Non-Parametric)"</span>,</span>
<span id="cb31-25"><a href="#cb31-25"></a>    <span class="at">align =</span> <span class="st">"lccccr"</span></span>
<span id="cb31-26"><a href="#cb31-26"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-27"><a href="#cb31-27"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb31-28"><a href="#cb31-28"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb31-29"><a href="#cb31-29"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb31-30"><a href="#cb31-30"></a>    <span class="at">position =</span> <span class="st">"left"</span></span>
<span id="cb31-31"><a href="#cb31-31"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-32"><a href="#cb31-32"></a>  <span class="fu">add_footnote</span>(</span>
<span id="cb31-33"><a href="#cb31-33"></a>    <span class="fu">c</span>(</span>
<span id="cb31-34"><a href="#cb31-34"></a>      <span class="st">"Effect size measured by Epsilon-squared."</span>,</span>
<span id="cb31-35"><a href="#cb31-35"></a>      <span class="st">"Significance level: alpha = 0.05"</span></span>
<span id="cb31-36"><a href="#cb31-36"></a>    ),</span>
<span id="cb31-37"><a href="#cb31-37"></a>    <span class="at">notation =</span> <span class="st">"symbol"</span></span>
<span id="cb31-38"><a href="#cb31-38"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Statistical Significance of Seasonal Differences (Non-Parametric)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Chi-squared</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">P-value</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Effect Size</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Magnitude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Kruskal-Wallis Rank Sum Test</td>
<td style="text-align: center;">230.44</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">&lt;0.001</td>
<td style="text-align: center;">0.0044</td>
<td style="text-align: right;">small</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0; border: 0;"><sup>*</sup> Effect size measured by Epsilon-squared.</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0; border: 0;"><sup>†</sup> Significance level: alpha = 0.05</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># Pairwise comparisons using Dunn's test with Bonferroni correction</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>dunn_result <span class="ot">&lt;-</span> <span class="fu">dunn_test</span>(</span>
<span id="cb32-3"><a href="#cb32-3"></a>  rainfall <span class="sc">~</span> season,</span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="at">data =</span> seasonal_data,</span>
<span id="cb32-5"><a href="#cb32-5"></a>  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span></span>
<span id="cb32-6"><a href="#cb32-6"></a>)</span>
<span id="cb32-7"><a href="#cb32-7"></a></span>
<span id="cb32-8"><a href="#cb32-8"></a>dunn_result <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9"></a>  <span class="fu">select</span>(group1, group2, statistic, p.adj, p.adj.signif) <span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="#cb32-10"></a>  <span class="fu">kable</span>(</span>
<span id="cb32-11"><a href="#cb32-11"></a>    <span class="at">caption =</span> <span class="st">"Dunn's Pairwise Comparison Test (Bonferroni Corrected)"</span>,</span>
<span id="cb32-12"><a href="#cb32-12"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb32-13"><a href="#cb32-13"></a>      <span class="st">"Group 1"</span>,</span>
<span id="cb32-14"><a href="#cb32-14"></a>      <span class="st">"Group 2"</span>,</span>
<span id="cb32-15"><a href="#cb32-15"></a>      <span class="st">"Z-Statistic"</span>,</span>
<span id="cb32-16"><a href="#cb32-16"></a>      <span class="st">"Adj. P-Value"</span>,</span>
<span id="cb32-17"><a href="#cb32-17"></a>      <span class="st">"Significance"</span></span>
<span id="cb32-18"><a href="#cb32-18"></a>    )</span>
<span id="cb32-19"><a href="#cb32-19"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-20"><a href="#cb32-20"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Dunn's Pairwise Comparison Test (Bonferroni Corrected)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Group 1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Group 2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Z-Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Adj. P-Value</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Significance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Summer</td>
<td style="text-align: left;">Autumn</td>
<td style="text-align: right;">-11.4684561</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="even">
<td style="text-align: left;">Summer</td>
<td style="text-align: left;">Winter</td>
<td style="text-align: right;">-14.4832877</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Summer</td>
<td style="text-align: left;">Spring</td>
<td style="text-align: right;">-11.0494713</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="even">
<td style="text-align: left;">Autumn</td>
<td style="text-align: left;">Winter</td>
<td style="text-align: right;">-2.8512817</td>
<td style="text-align: right;">0.0261260</td>
<td style="text-align: left;">*</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Autumn</td>
<td style="text-align: left;">Spring</td>
<td style="text-align: right;">0.0912015</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: left;">ns</td>
</tr>
<tr class="even">
<td style="text-align: left;">Winter</td>
<td style="text-align: left;">Spring</td>
<td style="text-align: right;">2.8459539</td>
<td style="text-align: right;">0.0265672</td>
<td style="text-align: left;">*</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># Generate Compact Letter Display (CLD)</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="co"># Extract p-values and name them by comparison pair</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>p_vals <span class="ot">&lt;-</span> dunn_result<span class="sc">$</span>p.adj</span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="fu">names</span>(p_vals) <span class="ot">&lt;-</span> <span class="fu">paste</span>(dunn_result<span class="sc">$</span>group1, dunn_result<span class="sc">$</span>group2, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb33-5"><a href="#cb33-5"></a></span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="co"># Generate letters (eg, 'a', 'b', 'ab')</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>letters_vec <span class="ot">&lt;-</span> <span class="fu">multcompLetters</span>(p_vals)<span class="sc">$</span>Letters</span>
<span id="cb33-8"><a href="#cb33-8"></a></span>
<span id="cb33-9"><a href="#cb33-9"></a><span class="co"># Create annotation dataframe</span></span>
<span id="cb33-10"><a href="#cb33-10"></a>letters_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-11"><a href="#cb33-11"></a>  <span class="at">season =</span> <span class="fu">names</span>(letters_vec),</span>
<span id="cb33-12"><a href="#cb33-12"></a>  <span class="at">Letter =</span> letters_vec</span>
<span id="cb33-13"><a href="#cb33-13"></a>)</span>
<span id="cb33-14"><a href="#cb33-14"></a></span>
<span id="cb33-15"><a href="#cb33-15"></a><span class="co"># Aggregation for Plotting</span></span>
<span id="cb33-16"><a href="#cb33-16"></a>plot_data <span class="ot">&lt;-</span> seasonal_data <span class="sc">%&gt;%</span></span>
<span id="cb33-17"><a href="#cb33-17"></a>  <span class="fu">group_by</span>(season) <span class="sc">%&gt;%</span></span>
<span id="cb33-18"><a href="#cb33-18"></a>  <span class="fu">summarise</span>(</span>
<span id="cb33-19"><a href="#cb33-19"></a>    <span class="at">mean_rain =</span> <span class="fu">mean</span>(rainfall, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-20"><a href="#cb33-20"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb33-21"><a href="#cb33-21"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-22"><a href="#cb33-22"></a>  <span class="fu">left_join</span>(letters_df, <span class="at">by =</span> <span class="st">"season"</span>)</span>
<span id="cb33-23"><a href="#cb33-23"></a></span>
<span id="cb33-24"><a href="#cb33-24"></a></span>
<span id="cb33-25"><a href="#cb33-25"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> mean_rain, <span class="at">fill =</span> season)) <span class="sc">+</span></span>
<span id="cb33-26"><a href="#cb33-26"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb33-27"><a href="#cb33-27"></a>  <span class="co"># Add Statistical Letters</span></span>
<span id="cb33-28"><a href="#cb33-28"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Letter), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb33-29"><a href="#cb33-29"></a>  <span class="co"># Add Mean Values</span></span>
<span id="cb33-30"><a href="#cb33-30"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb33-31"><a href="#cb33-31"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(mean_rain, <span class="dv">1</span>)),</span>
<span id="cb33-32"><a href="#cb33-32"></a>    <span class="at">vjust =</span> <span class="fl">1.5</span>,</span>
<span id="cb33-33"><a href="#cb33-33"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb33-34"><a href="#cb33-34"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb33-35"><a href="#cb33-35"></a>    <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb33-36"><a href="#cb33-36"></a>  ) <span class="sc">+</span></span>
<span id="cb33-37"><a href="#cb33-37"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb33-38"><a href="#cb33-38"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb33-39"><a href="#cb33-39"></a>      <span class="st">"Summer"</span> <span class="ot">=</span> <span class="st">"#E69F00"</span>,</span>
<span id="cb33-40"><a href="#cb33-40"></a>      <span class="st">"Autumn"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>,</span>
<span id="cb33-41"><a href="#cb33-41"></a>      <span class="st">"Winter"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>,</span>
<span id="cb33-42"><a href="#cb33-42"></a>      <span class="st">"Spring"</span> <span class="ot">=</span> <span class="st">"#009E73"</span></span>
<span id="cb33-43"><a href="#cb33-43"></a>    )</span>
<span id="cb33-44"><a href="#cb33-44"></a>  ) <span class="sc">+</span></span>
<span id="cb33-45"><a href="#cb33-45"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-46"><a href="#cb33-46"></a>    <span class="at">title =</span> <span class="st">"Seasonal Rainfall with Statistical Groupings"</span>,</span>
<span id="cb33-47"><a href="#cb33-47"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(</span>
<span id="cb33-48"><a href="#cb33-48"></a>      <span class="st">"Kruskal-Wallis: p &lt; 0.001, Effect Size: %s</span><span class="sc">\n</span><span class="st">Seasons sharing a letter are not significantly different."</span>,</span>
<span id="cb33-49"><a href="#cb33-49"></a>      <span class="fu">as.character</span>(epsilon_sq<span class="sc">$</span>magnitude)</span>
<span id="cb33-50"><a href="#cb33-50"></a>    ),</span>
<span id="cb33-51"><a href="#cb33-51"></a>    <span class="at">y =</span> <span class="st">"Mean Rainfall (mm)"</span>,</span>
<span id="cb33-52"><a href="#cb33-52"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb33-53"><a href="#cb33-53"></a>  ) <span class="sc">+</span></span>
<span id="cb33-54"><a href="#cb33-54"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb33-55"><a href="#cb33-55"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-56"><a href="#cb33-56"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb33-57"><a href="#cb33-57"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb33-58"><a href="#cb33-58"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb33-59"><a href="#cb33-59"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb33-60"><a href="#cb33-60"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-seasonal-stat-groups" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-seasonal-stat-groups-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-eda_files/figure-html/fig-seasonal-stat-groups-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-seasonal-stat-groups-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.10: Mean Seasonal Rainfall with Statistical Groupings. Letters (a, b, c) indicate significant differences based on Dunn’s test (p &lt; 0.05). Seasons sharing the same letter are statistically indistinguishable.
</figcaption>
</figure>
</div>
</div>
</div>
<p>To robustly confirm the seasonal patterns observed in the exploratory phase, we employed non-parametric statistical testing. The Kruskal-Wallis test was selected over ANOVA due to the skewed, non-normal distribution of rainfall data.</p>
<p><strong>1. Global Significance:</strong> The Kruskal-Wallis test yields a highly significant result (<span class="math inline">\(\chi^2 = 230, p &lt; 0.001\)</span>). This confirms that the differences in rainfall intensity across seasons are not due to random chance. However, the effect size (<span class="math inline">\(\eta^2 \approx 0.004\)</span>) is classified as “small,” suggesting that while season is a significant predictor, it explains a minor portion of the total variance in rainfall intensity (implying other factors like location and pressure are also critical).</p>
<p><strong>2. Pairwise Comparisons (Post-Hoc Analysis):</strong> The Dunn’s test with Bonferroni correction reveals three distinct statistical groups, visualized in <a href="#fig-seasonal-stat-groups" class="quarto-xref">Figure&nbsp;<span>3.10</span></a> :</p>
<ul>
<li><strong>Group ‘a’ (Summer):</strong> Significantly the wettest season (<span class="math inline">\(Mean = 9.1mm\)</span>). It stands alone, statistically distinct from all other seasons (<span class="math inline">\(p &lt; 0.001\)</span>).</li>
<li><strong>Group ‘b’ (Autumn &amp; Spring):</strong> These transition seasons are statistically indistinguishable from each other (<span class="math inline">\(p = 1.0\)</span>). Their mean intensities (<span class="math inline">\(6.7mm\)</span> and <span class="math inline">\(5.7mm\)</span>) represent a middle ground.</li>
<li><strong>Group ‘c’ (Winter):</strong> Significantly the driest season in terms of intensity (<span class="math inline">\(Mean = 5.5mm\)</span>). While visually close to Spring, the statistical test confirms a significant difference (<span class="math inline">\(p_{adj} = 0.026\)</span>).</li>
</ul>
<p><strong>Modeling Recommendation:</strong> These statistical groupings suggest that we might simplify the model by grouping Autumn and Spring together, or more robustly, using <strong>Cyclical Encoding</strong> (sine/cosine of Month) which naturally handles the smooth transition from the “Peak” (Summer) through the “Transition” (Autumn/Spring) to the “Trough” (Winter).</p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-data-prep.html" class="pagination-link" aria-label="Data Cleaning and Preprocessing">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Cleaning and Preprocessing</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-features.html" class="pagination-link" aria-label="Signal Extraction via Moving Averages">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Signal Extraction via Moving Averages</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb34" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu"># Exploratory Data Analysis</span></span>
<span id="cb34-2"><a href="#cb34-2"></a></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="fu">## Temporal Dynamics of Rainfall Occurrence</span></span>
<span id="cb34-4"><a href="#cb34-4"></a></span>
<span id="cb34-7"><a href="#cb34-7"></a><span class="in">```{r}</span></span>
<span id="cb34-8"><a href="#cb34-8"></a><span class="co">#| label: setup-eda</span></span>
<span id="cb34-9"><a href="#cb34-9"></a><span class="co">#| include: false</span></span>
<span id="cb34-10"><a href="#cb34-10"></a></span>
<span id="cb34-11"><a href="#cb34-11"></a>librarian<span class="sc">::</span><span class="fu">shelf</span>(</span>
<span id="cb34-12"><a href="#cb34-12"></a>  tidyverse,</span>
<span id="cb34-13"><a href="#cb34-13"></a>  janitor,</span>
<span id="cb34-14"><a href="#cb34-14"></a>  kableExtra,</span>
<span id="cb34-15"><a href="#cb34-15"></a>  ggridges,</span>
<span id="cb34-16"><a href="#cb34-16"></a>  here,</span>
<span id="cb34-17"><a href="#cb34-17"></a>  rstatix,</span>
<span id="cb34-18"><a href="#cb34-18"></a>  moments,</span>
<span id="cb34-19"><a href="#cb34-19"></a>  cocor,</span>
<span id="cb34-20"><a href="#cb34-20"></a>  broom,</span>
<span id="cb34-21"><a href="#cb34-21"></a>  aod,</span>
<span id="cb34-22"><a href="#cb34-22"></a>  multcompView,</span>
<span id="cb34-23"><a href="#cb34-23"></a>  scales,</span>
<span id="cb34-24"><a href="#cb34-24"></a>  patchwork</span>
<span id="cb34-25"><a href="#cb34-25"></a>)</span>
<span id="cb34-26"><a href="#cb34-26"></a></span>
<span id="cb34-27"><a href="#cb34-27"></a></span>
<span id="cb34-28"><a href="#cb34-28"></a>df_clean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"df_clean.rds"</span>))</span>
<span id="cb34-29"><a href="#cb34-29"></a>df_final <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/df_final.csv"</span>)</span>
<span id="cb34-30"><a href="#cb34-30"></a></span>
<span id="cb34-31"><a href="#cb34-31"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"utils.R"</span>))</span>
<span id="cb34-32"><a href="#cb34-32"></a><span class="in">```</span></span>
<span id="cb34-33"><a href="#cb34-33"></a></span>
<span id="cb34-36"><a href="#cb34-36"></a><span class="in">```{r}</span></span>
<span id="cb34-37"><a href="#cb34-37"></a><span class="co">#| label: temporal-dist</span></span>
<span id="cb34-38"><a href="#cb34-38"></a><span class="co">#| echo: true</span></span>
<span id="cb34-39"><a href="#cb34-39"></a><span class="co">#| message: false</span></span>
<span id="cb34-40"><a href="#cb34-40"></a><span class="co">#| warning: false</span></span>
<span id="cb34-41"><a href="#cb34-41"></a></span>
<span id="cb34-42"><a href="#cb34-42"></a><span class="co"># Day Distribution Table</span></span>
<span id="cb34-43"><a href="#cb34-43"></a>df_clean <span class="sc">%&gt;%</span></span>
<span id="cb34-44"><a href="#cb34-44"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-45"><a href="#cb34-45"></a>  <span class="fu">tabyl</span>(day) <span class="sc">%&gt;%</span></span>
<span id="cb34-46"><a href="#cb34-46"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-47"><a href="#cb34-47"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb34-48"><a href="#cb34-48"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-49"><a href="#cb34-49"></a>    <span class="at">caption =</span> <span class="st">"Frequency of Rainfall Days by Day of the Week"</span>,</span>
<span id="cb34-50"><a href="#cb34-50"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Day"</span>, <span class="st">"Count (n)"</span>, <span class="st">"Percentage"</span>)</span>
<span id="cb34-51"><a href="#cb34-51"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-52"><a href="#cb34-52"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-53"><a href="#cb34-53"></a></span>
<span id="cb34-54"><a href="#cb34-54"></a><span class="co"># Month Distribution Table</span></span>
<span id="cb34-55"><a href="#cb34-55"></a>df_clean <span class="sc">%&gt;%</span></span>
<span id="cb34-56"><a href="#cb34-56"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-57"><a href="#cb34-57"></a>  <span class="fu">tabyl</span>(month) <span class="sc">%&gt;%</span></span>
<span id="cb34-58"><a href="#cb34-58"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-59"><a href="#cb34-59"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb34-60"><a href="#cb34-60"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-61"><a href="#cb34-61"></a>    <span class="at">caption =</span> <span class="st">"Frequency of Rainfall Days by Month"</span>,</span>
<span id="cb34-62"><a href="#cb34-62"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Month"</span>, <span class="st">"Count (n)"</span>, <span class="st">"Percentage"</span>)</span>
<span id="cb34-63"><a href="#cb34-63"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-64"><a href="#cb34-64"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-65"><a href="#cb34-65"></a></span>
<span id="cb34-66"><a href="#cb34-66"></a><span class="co"># Cross-tabulation: Month vs Day</span></span>
<span id="cb34-67"><a href="#cb34-67"></a>df_clean <span class="sc">%&gt;%</span></span>
<span id="cb34-68"><a href="#cb34-68"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-69"><a href="#cb34-69"></a>  <span class="fu">tabyl</span>(month, day) <span class="sc">%&gt;%</span></span>
<span id="cb34-70"><a href="#cb34-70"></a>  <span class="fu">adorn_totals</span>(<span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-71"><a href="#cb34-71"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Cross-tabulation of Rainfall Frequency: Month vs. Day"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-72"><a href="#cb34-72"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb34-73"><a href="#cb34-73"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb34-74"><a href="#cb34-74"></a>    <span class="at">font_size =</span> <span class="dv">11</span></span>
<span id="cb34-75"><a href="#cb34-75"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-76"><a href="#cb34-76"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>)</span>
<span id="cb34-77"><a href="#cb34-77"></a><span class="in">```</span></span>
<span id="cb34-78"><a href="#cb34-78"></a></span>
<span id="cb34-79"><a href="#cb34-79"></a>To understand the temporal drivers of precipitation, we analyzed the frequency of wet days (rainfall <span class="sc">\&gt;</span> 0) across weekly and monthly cycles.</span>
<span id="cb34-80"><a href="#cb34-80"></a></span>
<span id="cb34-81"><a href="#cb34-81"></a>**Weekly Variation:** The distribution of rainfall across the days of the week appears largely uniform, with a slight variation in frequency. Tuesdays (14.7%) and Mondays (14.6%) exhibit the highest incidence of rain, while weekends (Saturday and Sunday) show marginally lower frequencies (approx. 13.8%). Statistically, this suggests that the mechanism generating rainfall is independent of the anthropogenic weekly cycle, as expected in meteorological data.</span>
<span id="cb34-82"><a href="#cb34-82"></a></span>
<span id="cb34-83"><a href="#cb34-83"></a>**Seasonal (Monthly) Variation:** In contrast, the monthly distribution reveals distinct seasonal patterns.</span>
<span id="cb34-84"><a href="#cb34-84"></a></span>
<span id="cb34-85"><a href="#cb34-85"></a><span class="ss">-   </span>**Peak Season:** The winter months of June (10.7%) and July (10.3%) record the highest frequency of rainfall events, consistent with the southern hemisphere's winter weather patterns which often bring frontal systems to southern Australia.</span>
<span id="cb34-86"><a href="#cb34-86"></a><span class="ss">-   </span>**Low Season:** The summer months, particularly February (6.5%) and December (7.0%), exhibit the lowest frequency of rain days.</span>
<span id="cb34-87"><a href="#cb34-87"></a></span>
<span id="cb34-88"><a href="#cb34-88"></a>**Interaction Effects:** The cross-tabulation of Month versus Day confirms that the seasonal signal dominates the weekly noise. For instance, the high counts in June and July are robustly distributed across all days of the week (e.g., June averages \~750-800 events per day), whereas February counts drop significantly (averaging \~450-480 events per day). This validates the necessity of including <span class="in">`Month`</span> as a seasonal predictor in our subsequent modeling, while <span class="in">`Day`</span> may serve as a minor control variable.</span>
<span id="cb34-89"><a href="#cb34-89"></a></span>
<span id="cb34-90"><a href="#cb34-90"></a><span class="fu">## Assessment of Data Completeness</span></span>
<span id="cb34-91"><a href="#cb34-91"></a></span>
<span id="cb34-94"><a href="#cb34-94"></a><span class="in">```{r}</span></span>
<span id="cb34-95"><a href="#cb34-95"></a><span class="co">#| label: missing-values</span></span>
<span id="cb34-96"><a href="#cb34-96"></a><span class="co">#| echo: true</span></span>
<span id="cb34-97"><a href="#cb34-97"></a><span class="co">#| message: false</span></span>
<span id="cb34-98"><a href="#cb34-98"></a><span class="co">#| warning: false</span></span>
<span id="cb34-99"><a href="#cb34-99"></a></span>
<span id="cb34-100"><a href="#cb34-100"></a><span class="co"># Calculate total count of missing values in the entire dataframe</span></span>
<span id="cb34-101"><a href="#cb34-101"></a>total_na <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(df_clean))</span>
<span id="cb34-102"><a href="#cb34-102"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Total Missing values:"</span>, total_na))</span>
<span id="cb34-103"><a href="#cb34-103"></a></span>
<span id="cb34-104"><a href="#cb34-104"></a><span class="co"># Generate missingness table using the utility function defined earlier</span></span>
<span id="cb34-105"><a href="#cb34-105"></a><span class="fu">missing_val</span>(df_clean)</span>
<span id="cb34-106"><a href="#cb34-106"></a><span class="in">```</span></span>
<span id="cb34-107"><a href="#cb34-107"></a></span>
<span id="cb34-108"><a href="#cb34-108"></a>A critical examination of missing data reveals significant gaps in specific meteorological measurements. While the total number of missing entries is substantial (314,146), the missingness is not uniformly distributed across features:</span>
<span id="cb34-109"><a href="#cb34-109"></a></span>
<span id="cb34-110"><a href="#cb34-110"></a><span class="ss">-   </span>**High Missingness:** The variables <span class="in">`sunshine`</span> (47.7%) and <span class="in">`evaporation`</span> (42.5%) exhibit the highest rates of missing data. This is likely due to the limited availability of specialized recording equipment at smaller weather stations.</span>
<span id="cb34-111"><a href="#cb34-111"></a><span class="ss">-   </span>**Moderate Missingness:** Cloud cover observations (<span class="in">`cloud3pm`</span> and <span class="in">`cloud9am`</span>) are missing in approximately 37–40% of records, suggesting potential observational challenges or station-specific reporting protocols.</span>
<span id="cb34-112"><a href="#cb34-112"></a><span class="ss">-   </span>**Low Missingness:** Critical core variables, including <span class="in">`pressure`</span>, <span class="in">`wind`</span>, and <span class="in">`temperature`</span>, show much lower missingness rates (<span class="sc">\&lt;</span> 10%).</span>
<span id="cb34-113"><a href="#cb34-113"></a></span>
<span id="cb34-114"><a href="#cb34-114"></a>**Implications for Modeling:** The severity of missingness in `sunshine` and `evaporation` poses a strategic dilemma. Applying standard listwise deletion (removing any row with a missing value) would result in the loss of nearly half the dataset, potentially introducing bias and reducing statistical power. This finding empirically justifies the **Random Forest imputation strategy** proposed in the study's objectives. By imputing these values rather than discarding them, we preserve the integrity of the dataset and allow for the inclusion of these potentially predictive features in the final models.</span>
<span id="cb34-115"><a href="#cb34-115"></a></span>
<span id="cb34-116"><a href="#cb34-116"></a><span class="fu">## Distributional Characteristics of the Target Variable</span></span>
<span id="cb34-117"><a href="#cb34-117"></a></span>
<span id="cb34-120"><a href="#cb34-120"></a><span class="in">```{r}</span></span>
<span id="cb34-121"><a href="#cb34-121"></a><span class="co">#| label: target-stats</span></span>
<span id="cb34-122"><a href="#cb34-122"></a><span class="co">#| echo: true</span></span>
<span id="cb34-123"><a href="#cb34-123"></a><span class="co">#| message: false</span></span>
<span id="cb34-124"><a href="#cb34-124"></a><span class="co">#| warning: false</span></span>
<span id="cb34-125"><a href="#cb34-125"></a></span>
<span id="cb34-126"><a href="#cb34-126"></a>rainfall_stats <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb34-127"><a href="#cb34-127"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-128"><a href="#cb34-128"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb34-129"><a href="#cb34-129"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(rainfall),</span>
<span id="cb34-130"><a href="#cb34-130"></a>    <span class="at">median =</span> <span class="fu">median</span>(rainfall),</span>
<span id="cb34-131"><a href="#cb34-131"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(rainfall),</span>
<span id="cb34-132"><a href="#cb34-132"></a>    <span class="at">min =</span> <span class="fu">min</span>(rainfall),</span>
<span id="cb34-133"><a href="#cb34-133"></a>    <span class="at">max =</span> <span class="fu">max</span>(rainfall),</span>
<span id="cb34-134"><a href="#cb34-134"></a>    <span class="at">q25 =</span> <span class="fu">quantile</span>(rainfall, <span class="fl">0.25</span>),</span>
<span id="cb34-135"><a href="#cb34-135"></a>    <span class="at">q75 =</span> <span class="fu">quantile</span>(rainfall, .<span class="dv">75</span>),</span>
<span id="cb34-136"><a href="#cb34-136"></a>    <span class="at">iqr =</span> <span class="fu">IQR</span>(rainfall),</span>
<span id="cb34-137"><a href="#cb34-137"></a>    <span class="at">n_zeros =</span> <span class="fu">sum</span>(rainfall <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb34-138"><a href="#cb34-138"></a>    <span class="at">pct_zeros =</span> <span class="fu">mean</span>(rainfall <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb34-139"><a href="#cb34-139"></a>    <span class="at">n_large =</span> <span class="fu">sum</span>(rainfall <span class="sc">&gt;</span> <span class="dv">100</span>),</span>
<span id="cb34-140"><a href="#cb34-140"></a>    <span class="at">pct_large =</span> <span class="fu">mean</span>(rainfall <span class="sc">&gt;</span> <span class="dv">100</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb34-141"><a href="#cb34-141"></a>    <span class="at">skewness =</span> moments<span class="sc">::</span><span class="fu">skewness</span>(rainfall),</span>
<span id="cb34-142"><a href="#cb34-142"></a>    <span class="at">kurtosis =</span> moments<span class="sc">::</span><span class="fu">kurtosis</span>(rainfall)</span>
<span id="cb34-143"><a href="#cb34-143"></a>  )</span>
<span id="cb34-144"><a href="#cb34-144"></a></span>
<span id="cb34-145"><a href="#cb34-145"></a><span class="co"># Transpose and format</span></span>
<span id="cb34-146"><a href="#cb34-146"></a>rainfall_stats <span class="sc">%&gt;%</span></span>
<span id="cb34-147"><a href="#cb34-147"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Statistic"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-148"><a href="#cb34-148"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-149"><a href="#cb34-149"></a>    <span class="at">Value =</span> <span class="fu">ifelse</span>(</span>
<span id="cb34-150"><a href="#cb34-150"></a>      Value <span class="sc">&gt;</span> <span class="dv">1000</span>,</span>
<span id="cb34-151"><a href="#cb34-151"></a>      <span class="fu">format</span>(Value, <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb34-152"><a href="#cb34-152"></a>      <span class="fu">round</span>(Value, <span class="dv">3</span>)</span>
<span id="cb34-153"><a href="#cb34-153"></a>    )</span>
<span id="cb34-154"><a href="#cb34-154"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-155"><a href="#cb34-155"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-156"><a href="#cb34-156"></a>    <span class="at">caption =</span> <span class="st">"Descriptive Statistics: Daily Rainfall (mm)"</span>,</span>
<span id="cb34-157"><a href="#cb34-157"></a>    <span class="at">align =</span> <span class="st">"lr"</span></span>
<span id="cb34-158"><a href="#cb34-158"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-159"><a href="#cb34-159"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-160"><a href="#cb34-160"></a></span>
<span id="cb34-161"><a href="#cb34-161"></a><span class="co"># Zero-Inflation Check (Dry vs. Wet Days)</span></span>
<span id="cb34-162"><a href="#cb34-162"></a>rain_check <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb34-163"><a href="#cb34-163"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-164"><a href="#cb34-164"></a>    <span class="at">total_days =</span> <span class="fu">n</span>(),</span>
<span id="cb34-165"><a href="#cb34-165"></a>    <span class="at">dry_days =</span> <span class="fu">sum</span>(rainfall <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb34-166"><a href="#cb34-166"></a>    <span class="at">rainy_days =</span> <span class="fu">sum</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb34-167"><a href="#cb34-167"></a>    <span class="at">zero_inflation_pct =</span> (dry_days <span class="sc">/</span> total_days) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb34-168"><a href="#cb34-168"></a>  )</span>
<span id="cb34-169"><a href="#cb34-169"></a></span>
<span id="cb34-170"><a href="#cb34-170"></a></span>
<span id="cb34-171"><a href="#cb34-171"></a>rain_check <span class="sc">%&gt;%</span></span>
<span id="cb34-172"><a href="#cb34-172"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-173"><a href="#cb34-173"></a>    <span class="at">caption =</span> <span class="st">"Prevalence of Zero-Inflation (Dry Days)"</span>,</span>
<span id="cb34-174"><a href="#cb34-174"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb34-175"><a href="#cb34-175"></a>      <span class="st">"Total Days"</span>,</span>
<span id="cb34-176"><a href="#cb34-176"></a>      <span class="st">"Dry Days (0mm)"</span>,</span>
<span id="cb34-177"><a href="#cb34-177"></a>      <span class="st">"Rainy Days (&gt;0mm)"</span>,</span>
<span id="cb34-178"><a href="#cb34-178"></a>      <span class="st">"Zero Inflation (%)"</span></span>
<span id="cb34-179"><a href="#cb34-179"></a>    )</span>
<span id="cb34-180"><a href="#cb34-180"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-181"><a href="#cb34-181"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb34-182"><a href="#cb34-182"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"bordered"</span>),</span>
<span id="cb34-183"><a href="#cb34-183"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span></span>
<span id="cb34-184"><a href="#cb34-184"></a>  )</span>
<span id="cb34-185"><a href="#cb34-185"></a><span class="in">```</span></span>
<span id="cb34-186"><a href="#cb34-186"></a></span>
<span id="cb34-187"><a href="#cb34-187"></a>A deep statistical examination of the target variable, <span class="in">`rainfall`</span>, confirms extreme distributional irregularities that challenge standard modeling approaches.</span>
<span id="cb34-188"><a href="#cb34-188"></a></span>
<span id="cb34-189"><a href="#cb34-189"></a>**Central Tendency and Dispersion:** The data exhibits a massive discrepancy between the mean (2.36 mm) and the median (0.00 mm). This zero-median property immediately signals a highly skewed distribution. The standard deviation (8.48 mm) is nearly four times the mean, indicating high variability and volatility in daily precipitation.</span>
<span id="cb34-190"><a href="#cb34-190"></a></span>
<span id="cb34-191"><a href="#cb34-191"></a>**Zero-Inflation:** The most critical finding is the prevalence of zero-inflation. Out of 142,199 recorded observations, 91,080 are dry days. This translates to a **zero-inflation rate of 64.05%**. In statistical terms, this "hurdle" of zeros implies that any predictive model must effectively answer two distinct questions: "Will it rain?" (binary classification) and "If so, how much?" (regression).</span>
<span id="cb34-192"><a href="#cb34-192"></a></span>
<span id="cb34-193"><a href="#cb34-193"></a>**Tail Behavior:** The distribution is extremely heavy-tailed.</span>
<span id="cb34-194"><a href="#cb34-194"></a></span>
<span id="cb34-195"><a href="#cb34-195"></a><span class="ss">-   </span>**Skewness (9.84):** Indicates a severe rightward skew, with the mass of the data concentrated near zero and a long tail extending towards extreme values.</span>
<span id="cb34-196"><a href="#cb34-196"></a></span>
<span id="cb34-197"><a href="#cb34-197"></a><span class="ss">-   </span>**Kurtosis (181.15):** This exceptionally high value points to a "leptokurtic" distribution, meaning extreme outliers are far more frequent than in a normal distribution. The maximum recorded rainfall of 371 mm, alongside 151 events exceeding 100 mm, confirms the presence of extreme weather events that models must be robust enough to handle.</span>
<span id="cb34-198"><a href="#cb34-198"></a></span>
<span id="cb34-199"><a href="#cb34-199"></a>**Conclusion:** The combination of \~64% zeros and extreme kurtosis confirms that a standard Gaussian Linear Model (OLS) would be severely biased. These statistics strongly support the adoption of a **Hurdle Model** or **Zero-Inflated Gamma** framework to separately model the zero-state and the positive continuous state.</span>
<span id="cb34-200"><a href="#cb34-200"></a></span>
<span id="cb34-201"><a href="#cb34-201"></a><span class="fu">## Bivariate Correlation Analysis</span></span>
<span id="cb34-202"><a href="#cb34-202"></a></span>
<span id="cb34-205"><a href="#cb34-205"></a><span class="in">```{r}</span></span>
<span id="cb34-206"><a href="#cb34-206"></a><span class="co">#| label: correlation-table</span></span>
<span id="cb34-207"><a href="#cb34-207"></a><span class="co">#| echo: true</span></span>
<span id="cb34-208"><a href="#cb34-208"></a><span class="co">#| message: false</span></span>
<span id="cb34-209"><a href="#cb34-209"></a><span class="co">#| warning: false</span></span>
<span id="cb34-210"><a href="#cb34-210"></a></span>
<span id="cb34-211"><a href="#cb34-211"></a><span class="co"># Select numeric columns excluding the target</span></span>
<span id="cb34-212"><a href="#cb34-212"></a>numeric_cols <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb34-213"><a href="#cb34-213"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb34-214"><a href="#cb34-214"></a>  <span class="fu">names</span>()</span>
<span id="cb34-215"><a href="#cb34-215"></a>numeric_cols <span class="ot">&lt;-</span> numeric_cols[numeric_cols <span class="sc">!=</span> <span class="st">"rainfall"</span>]</span>
<span id="cb34-216"><a href="#cb34-216"></a></span>
<span id="cb34-217"><a href="#cb34-217"></a><span class="co"># Compute Spearman correlations and format interpretation</span></span>
<span id="cb34-218"><a href="#cb34-218"></a>cors <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb34-219"><a href="#cb34-219"></a>  rstatix<span class="sc">::</span><span class="fu">cor_test</span>(</span>
<span id="cb34-220"><a href="#cb34-220"></a>    <span class="at">vars =</span> <span class="st">"rainfall"</span>,</span>
<span id="cb34-221"><a href="#cb34-221"></a>    <span class="at">vars2 =</span> numeric_cols,</span>
<span id="cb34-222"><a href="#cb34-222"></a>    <span class="at">method =</span> <span class="st">"spearman"</span></span>
<span id="cb34-223"><a href="#cb34-223"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-224"><a href="#cb34-224"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(cor)) <span class="sc">%&gt;%</span></span>
<span id="cb34-225"><a href="#cb34-225"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(cor))) <span class="sc">%&gt;%</span></span>
<span id="cb34-226"><a href="#cb34-226"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(var2, cor, p) <span class="sc">%&gt;%</span></span>
<span id="cb34-227"><a href="#cb34-227"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-228"><a href="#cb34-228"></a>    <span class="at">interpretation =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-229"><a href="#cb34-229"></a>      <span class="fu">abs</span>(cor) <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"Negligible"</span>,</span>
<span id="cb34-230"><a href="#cb34-230"></a>      <span class="fu">abs</span>(cor) <span class="sc">&lt;</span> <span class="fl">0.3</span> <span class="sc">~</span> <span class="st">"Small"</span>,</span>
<span id="cb34-231"><a href="#cb34-231"></a>      <span class="fu">abs</span>(cor) <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Moderate"</span>,</span>
<span id="cb34-232"><a href="#cb34-232"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Large"</span></span>
<span id="cb34-233"><a href="#cb34-233"></a>    )</span>
<span id="cb34-234"><a href="#cb34-234"></a>  )</span>
<span id="cb34-235"><a href="#cb34-235"></a></span>
<span id="cb34-236"><a href="#cb34-236"></a></span>
<span id="cb34-237"><a href="#cb34-237"></a>cors <span class="sc">%&gt;%</span></span>
<span id="cb34-238"><a href="#cb34-238"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-239"><a href="#cb34-239"></a>    <span class="at">caption =</span> <span class="st">"Spearman Correlation with Rainfall (Ranked by Strength)"</span>,</span>
<span id="cb34-240"><a href="#cb34-240"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Predictor"</span>, <span class="st">"Correlation (r)"</span>, <span class="st">"P-Value"</span>, <span class="st">"Strength"</span>)</span>
<span id="cb34-241"><a href="#cb34-241"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-242"><a href="#cb34-242"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-243"><a href="#cb34-243"></a><span class="in">```</span></span>
<span id="cb34-244"><a href="#cb34-244"></a></span>
<span id="cb34-247"><a href="#cb34-247"></a><span class="in">```{r}</span></span>
<span id="cb34-248"><a href="#cb34-248"></a><span class="co">#| label: fig-correlation-matrix</span></span>
<span id="cb34-249"><a href="#cb34-249"></a><span class="co">#| fig-cap: "Spearman Correlation Matrix of Meteorological Features. Red indicates negative correlation; Blue indicates positive correlation."</span></span>
<span id="cb34-250"><a href="#cb34-250"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb34-251"><a href="#cb34-251"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb34-252"><a href="#cb34-252"></a><span class="co">#| echo: true</span></span>
<span id="cb34-253"><a href="#cb34-253"></a><span class="co">#| warning: false</span></span>
<span id="cb34-254"><a href="#cb34-254"></a></span>
<span id="cb34-255"><a href="#cb34-255"></a><span class="co"># Calculate full pairwise correlation matrix</span></span>
<span id="cb34-256"><a href="#cb34-256"></a>cor_matrix <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb34-257"><a href="#cb34-257"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb34-258"><a href="#cb34-258"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb34-259"><a href="#cb34-259"></a></span>
<span id="cb34-260"><a href="#cb34-260"></a><span class="co"># Reshape for ggplot</span></span>
<span id="cb34-261"><a href="#cb34-261"></a>cor_melt <span class="ot">&lt;-</span> cor_matrix <span class="sc">%&gt;%</span></span>
<span id="cb34-262"><a href="#cb34-262"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-263"><a href="#cb34-263"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Var1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-264"><a href="#cb34-264"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Var1, <span class="at">names_to =</span> <span class="st">"Var2"</span>, <span class="at">values_to =</span> <span class="st">"Correlation"</span>)</span>
<span id="cb34-265"><a href="#cb34-265"></a></span>
<span id="cb34-266"><a href="#cb34-266"></a><span class="co"># Generate Heatmap</span></span>
<span id="cb34-267"><a href="#cb34-267"></a>cor_melt <span class="sc">%&gt;%</span></span>
<span id="cb34-268"><a href="#cb34-268"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb34-269"><a href="#cb34-269"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb34-270"><a href="#cb34-270"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb34-271"><a href="#cb34-271"></a>    <span class="at">low =</span> <span class="st">"#D73027"</span>,</span>
<span id="cb34-272"><a href="#cb34-272"></a>    <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb34-273"><a href="#cb34-273"></a>    <span class="at">high =</span> <span class="st">"#4575B4"</span>,</span>
<span id="cb34-274"><a href="#cb34-274"></a>    <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb34-275"><a href="#cb34-275"></a>    <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb34-276"><a href="#cb34-276"></a>    <span class="at">name =</span> <span class="st">"Spearman</span><span class="sc">\n</span><span class="st">Correlation"</span></span>
<span id="cb34-277"><a href="#cb34-277"></a>  ) <span class="sc">+</span></span>
<span id="cb34-278"><a href="#cb34-278"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-279"><a href="#cb34-279"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-280"><a href="#cb34-280"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb34-281"><a href="#cb34-281"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb34-282"><a href="#cb34-282"></a>    <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-283"><a href="#cb34-283"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-284"><a href="#cb34-284"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb34-285"><a href="#cb34-285"></a>  ) <span class="sc">+</span></span>
<span id="cb34-286"><a href="#cb34-286"></a>  <span class="co"># Add correlation coefficients for significant relationships</span></span>
<span id="cb34-287"><a href="#cb34-287"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb34-288"><a href="#cb34-288"></a>    <span class="at">data =</span> <span class="fu">filter</span>(cor_melt, <span class="fu">abs</span>(Correlation) <span class="sc">&gt;</span> <span class="fl">0.3</span>),</span>
<span id="cb34-289"><a href="#cb34-289"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Correlation, <span class="dv">2</span>)),</span>
<span id="cb34-290"><a href="#cb34-290"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb34-291"><a href="#cb34-291"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb34-292"><a href="#cb34-292"></a>  ) <span class="sc">+</span></span>
<span id="cb34-293"><a href="#cb34-293"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-294"><a href="#cb34-294"></a>    <span class="at">title =</span> <span class="st">"Feature Correlation Matrix"</span>,</span>
<span id="cb34-295"><a href="#cb34-295"></a>    <span class="at">subtitle =</span> <span class="st">"Strongest predictors: Humidity (Positive) and Sunshine (Negative)"</span></span>
<span id="cb34-296"><a href="#cb34-296"></a>  )</span>
<span id="cb34-297"><a href="#cb34-297"></a><span class="in">```</span></span>
<span id="cb34-298"><a href="#cb34-298"></a></span>
<span id="cb34-301"><a href="#cb34-301"></a><span class="in">```{r}</span></span>
<span id="cb34-302"><a href="#cb34-302"></a><span class="co">#| label: correlation-significance-test</span></span>
<span id="cb34-303"><a href="#cb34-303"></a><span class="co">#| echo: true</span></span>
<span id="cb34-304"><a href="#cb34-304"></a><span class="co">#| collapse: true</span></span>
<span id="cb34-305"><a href="#cb34-305"></a></span>
<span id="cb34-306"><a href="#cb34-306"></a><span class="co"># Hypothesis: Is Humidity (3pm) a significantly different predictor than Sunshine?</span></span>
<span id="cb34-307"><a href="#cb34-307"></a>cor_humidity <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(</span>
<span id="cb34-308"><a href="#cb34-308"></a>  df_clean<span class="sc">$</span>rainfall,</span>
<span id="cb34-309"><a href="#cb34-309"></a>  df_clean<span class="sc">$</span>humidity3pm,</span>
<span id="cb34-310"><a href="#cb34-310"></a>  <span class="at">method =</span> <span class="st">"spearman"</span></span>
<span id="cb34-311"><a href="#cb34-311"></a>)</span>
<span id="cb34-312"><a href="#cb34-312"></a>cor_sunshine <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(</span>
<span id="cb34-313"><a href="#cb34-313"></a>  df_clean<span class="sc">$</span>rainfall,</span>
<span id="cb34-314"><a href="#cb34-314"></a>  df_clean<span class="sc">$</span>sunshine,</span>
<span id="cb34-315"><a href="#cb34-315"></a>  <span class="at">method =</span> <span class="st">"spearman"</span></span>
<span id="cb34-316"><a href="#cb34-316"></a>)</span>
<span id="cb34-317"><a href="#cb34-317"></a></span>
<span id="cb34-318"><a href="#cb34-318"></a><span class="co"># Compare the two dependent correlations using Steiger's Z-test</span></span>
<span id="cb34-319"><a href="#cb34-319"></a><span class="co"># Tests if the difference between r_humidity and r_sunshine is non-zero</span></span>
<span id="cb34-320"><a href="#cb34-320"></a>cocor_result <span class="ot">&lt;-</span> <span class="fu">cocor.dep.groups.overlap</span>(</span>
<span id="cb34-321"><a href="#cb34-321"></a>  <span class="at">r.jk =</span> cor_humidity<span class="sc">$</span>estimate, <span class="co"># Rainfall vs Humidity</span></span>
<span id="cb34-322"><a href="#cb34-322"></a>  <span class="at">r.jh =</span> cor_sunshine<span class="sc">$</span>estimate, <span class="co"># Rainfall vs Sunshine</span></span>
<span id="cb34-323"><a href="#cb34-323"></a>  <span class="at">r.kh =</span> <span class="fu">cor</span>(</span>
<span id="cb34-324"><a href="#cb34-324"></a>    df_clean<span class="sc">$</span>humidity3pm,</span>
<span id="cb34-325"><a href="#cb34-325"></a>    df_clean<span class="sc">$</span>sunshine,</span>
<span id="cb34-326"><a href="#cb34-326"></a>    <span class="at">use =</span> <span class="st">"complete.obs"</span>,</span>
<span id="cb34-327"><a href="#cb34-327"></a>    <span class="at">method =</span> <span class="st">"spearman"</span></span>
<span id="cb34-328"><a href="#cb34-328"></a>  ), <span class="co"># Humidity vs Sunshine</span></span>
<span id="cb34-329"><a href="#cb34-329"></a>  <span class="at">n =</span> <span class="fu">nrow</span>(df_clean),</span>
<span id="cb34-330"><a href="#cb34-330"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span>,</span>
<span id="cb34-331"><a href="#cb34-331"></a>  <span class="at">test =</span> <span class="st">"steiger1980"</span>, <span class="co"># Using Steiger's Z for robustness</span></span>
<span id="cb34-332"><a href="#cb34-332"></a>  <span class="at">return.htest =</span> <span class="cn">TRUE</span></span>
<span id="cb34-333"><a href="#cb34-333"></a>)</span>
<span id="cb34-334"><a href="#cb34-334"></a></span>
<span id="cb34-335"><a href="#cb34-335"></a><span class="fu">print</span>(cocor_result)</span>
<span id="cb34-336"><a href="#cb34-336"></a><span class="in">```</span></span>
<span id="cb34-337"><a href="#cb34-337"></a></span>
<span id="cb34-338"><a href="#cb34-338"></a>To identify the primary meteorological drivers of rainfall, we performed a Spearman rank correlation analysis. This non-parametric method was selected to accommodate the non-linear, skewed nature of the rainfall data identified in the previous section.</span>
<span id="cb34-339"><a href="#cb34-339"></a></span>
<span id="cb34-340"><a href="#cb34-340"></a>**Key Predictors:** As visualized in @fig-correlation-matrix, the analysis reveals two distinct clusters of predictive features:</span>
<span id="cb34-341"><a href="#cb34-341"></a></span>
<span id="cb34-342"><a href="#cb34-342"></a><span class="ss">1.  </span>**Positive Drivers:** <span class="in">`Humidity3pm`</span> ($r = 0.44$) and <span class="in">`Cloud Cover`</span> ($r \approx 0.37$) show the strongest positive association with rainfall. This aligns with physical expectations: higher atmospheric moisture and cloud density are precursors to precipitation.</span>
<span id="cb34-343"><a href="#cb34-343"></a><span class="ss">2.  </span>**Negative Drivers:** <span class="in">`Sunshine`</span> ($r = -0.40$) and <span class="in">`Evaporation`</span> ($r = -0.31$) exhibit the strongest negative correlations. Increased solar exposure and evaporation rates typically indicate clear skies and high pressure systems, conditions unfavorable for rain.</span>
<span id="cb34-344"><a href="#cb34-344"></a></span>
<span id="cb34-345"><a href="#cb34-345"></a>**Multicollinearity Warning:** The heatmap also highlights significant collinearity among predictors. For instance, <span class="in">`temp9am`</span> and <span class="in">`temp3pm`</span> are highly correlated ($r &gt; 0.8$), as are <span class="in">`pressure9am`</span> and <span class="in">`pressure3pm`</span> ($r = 0.96$). This reinforces the necessity of the VIF-based feature selection strategy outlined in our methodology to prevent model instability.</span>
<span id="cb34-346"><a href="#cb34-346"></a></span>
<span id="cb34-347"><a href="#cb34-347"></a>**Statistical Validation:** To confirm that the opposing effects of moisture and solar radiation are statistically distinct, we applied Steiger’s Z-test for dependent correlations ($z \approx 188.9, p &lt; 2.2e-16$). While this formally rejects the null hypothesis, we exercise caution in interpreting the p-value; in datasets of this magnitude ($N &gt; 140,000$), statistical significance is often achieved even for trivial effects due to high power. However, the substantial magnitude of the Z-statistic confirms that the difference is not merely an artifact of sample size. We therefore conclude that <span class="in">`Humidity3pm`</span> and <span class="in">`Sunshine`</span> represent distinct, opposing physical forces in the generation of Australian rainfall, rather than relying solely on the p-value for "certainty."</span>
<span id="cb34-348"><a href="#cb34-348"></a></span>
<span id="cb34-349"><a href="#cb34-349"></a></span>
<span id="cb34-350"><a href="#cb34-350"></a><span class="fu">## Pattern Analysis</span></span>
<span id="cb34-351"><a href="#cb34-351"></a></span>
<span id="cb34-352"><a href="#cb34-352"></a><span class="fu">### Temporal Dependence and Markov Chain Analysis</span></span>
<span id="cb34-353"><a href="#cb34-353"></a></span>
<span id="cb34-356"><a href="#cb34-356"></a><span class="in">```{r}</span></span>
<span id="cb34-357"><a href="#cb34-357"></a><span class="co">#| label: markov-prep</span></span>
<span id="cb34-358"><a href="#cb34-358"></a><span class="co">#| echo: true</span></span>
<span id="cb34-359"><a href="#cb34-359"></a><span class="co">#| message: false</span></span>
<span id="cb34-360"><a href="#cb34-360"></a><span class="co">#| warning: false</span></span>
<span id="cb34-361"><a href="#cb34-361"></a></span>
<span id="cb34-362"><a href="#cb34-362"></a><span class="co"># Construct Markov transitions by lagging the 'rain_today' variable</span></span>
<span id="cb34-363"><a href="#cb34-363"></a><span class="co"># Grouping by location ensures we don't lag across different cities</span></span>
<span id="cb34-364"><a href="#cb34-364"></a>markov_table <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-365"><a href="#cb34-365"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb34-366"><a href="#cb34-366"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb34-367"><a href="#cb34-367"></a>  <span class="fu">mutate</span>(<span class="at">yesterday_rain =</span> <span class="fu">lag</span>(rain_today)) <span class="sc">%&gt;%</span></span>
<span id="cb34-368"><a href="#cb34-368"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-369"><a href="#cb34-369"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(rain_today), <span class="sc">!</span><span class="fu">is.na</span>(yesterday_rain)) <span class="sc">%&gt;%</span></span>
<span id="cb34-370"><a href="#cb34-370"></a>  <span class="fu">count</span>(yesterday_rain, rain_today)</span>
<span id="cb34-371"><a href="#cb34-371"></a></span>
<span id="cb34-372"><a href="#cb34-372"></a><span class="co"># Create contingency table for statistical testing</span></span>
<span id="cb34-373"><a href="#cb34-373"></a>cont_table <span class="ot">&lt;-</span> markov_table <span class="sc">%&gt;%</span></span>
<span id="cb34-374"><a href="#cb34-374"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> rain_today, <span class="at">values_from =</span> n, <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-375"><a href="#cb34-375"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"yesterday_rain"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-376"><a href="#cb34-376"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb34-377"><a href="#cb34-377"></a></span>
<span id="cb34-378"><a href="#cb34-378"></a><span class="co"># Display raw counts</span></span>
<span id="cb34-379"><a href="#cb34-379"></a><span class="fu">print</span>(cont_table)</span>
<span id="cb34-380"><a href="#cb34-380"></a><span class="in">```</span></span>
<span id="cb34-381"><a href="#cb34-381"></a></span>
<span id="cb34-384"><a href="#cb34-384"></a><span class="in">```{r}</span></span>
<span id="cb34-385"><a href="#cb34-385"></a><span class="co">#| label: markov-stats</span></span>
<span id="cb34-386"><a href="#cb34-386"></a><span class="co">#| echo: true</span></span>
<span id="cb34-387"><a href="#cb34-387"></a><span class="co">#| collapse: true</span></span>
<span id="cb34-388"><a href="#cb34-388"></a></span>
<span id="cb34-389"><a href="#cb34-389"></a><span class="co"># Pearson's Chi-squared Test for Independence</span></span>
<span id="cb34-390"><a href="#cb34-390"></a><span class="co"># H0: Rain today is independent of rain yesterday</span></span>
<span id="cb34-391"><a href="#cb34-391"></a>chi_result <span class="ot">&lt;-</span> <span class="fu">chisq_test</span>(<span class="fu">as.table</span>(cont_table))</span>
<span id="cb34-392"><a href="#cb34-392"></a><span class="fu">print</span>(chi_result)</span>
<span id="cb34-393"><a href="#cb34-393"></a></span>
<span id="cb34-394"><a href="#cb34-394"></a><span class="co"># Effect Size Calculation (Cramér's V)</span></span>
<span id="cb34-395"><a href="#cb34-395"></a>cramers_v <span class="ot">&lt;-</span> <span class="fu">cramer_v</span>(cont_table)</span>
<span id="cb34-396"><a href="#cb34-396"></a></span>
<span id="cb34-397"><a href="#cb34-397"></a></span>
<span id="cb34-398"><a href="#cb34-398"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effect Size Interpretation</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-399"><a href="#cb34-399"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"V = %.4f: "</span>, cramers_v))</span>
<span id="cb34-400"><a href="#cb34-400"></a><span class="cf">if</span> (cramers_v <span class="sc">&lt;</span> <span class="fl">0.1</span>) {</span>
<span id="cb34-401"><a href="#cb34-401"></a>  <span class="fu">cat</span>(<span class="st">"Negligible Association</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-402"><a href="#cb34-402"></a>} <span class="cf">else</span> <span class="cf">if</span> (cramers_v <span class="sc">&lt;</span> <span class="fl">0.3</span>) {</span>
<span id="cb34-403"><a href="#cb34-403"></a>  <span class="fu">cat</span>(<span class="st">"Weak Association</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-404"><a href="#cb34-404"></a>} <span class="cf">else</span> <span class="cf">if</span> (cramers_v <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb34-405"><a href="#cb34-405"></a>  <span class="fu">cat</span>(<span class="st">"Moderate Association</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-406"><a href="#cb34-406"></a>} <span class="cf">else</span> {</span>
<span id="cb34-407"><a href="#cb34-407"></a>  <span class="fu">cat</span>(<span class="st">"Strong Association</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-408"><a href="#cb34-408"></a>}</span>
<span id="cb34-409"><a href="#cb34-409"></a><span class="in">```</span></span>
<span id="cb34-410"><a href="#cb34-410"></a></span>
<span id="cb34-413"><a href="#cb34-413"></a><span class="in">```{r}</span></span>
<span id="cb34-414"><a href="#cb34-414"></a><span class="co">#| label: fig-markov-chain</span></span>
<span id="cb34-415"><a href="#cb34-415"></a><span class="co">#| fig-cap: "Markov Chain Transition Matrix: Visualizing the 'Persistence Effect' in Australian Rainfall."</span></span>
<span id="cb34-416"><a href="#cb34-416"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb34-417"><a href="#cb34-417"></a><span class="co">#| fig-height: 7</span></span>
<span id="cb34-418"><a href="#cb34-418"></a><span class="co">#| echo: true</span></span>
<span id="cb34-419"><a href="#cb34-419"></a><span class="co">#| warning: false</span></span>
<span id="cb34-420"><a href="#cb34-420"></a></span>
<span id="cb34-421"><a href="#cb34-421"></a><span class="co"># Calculate transition probabilities for plotting</span></span>
<span id="cb34-422"><a href="#cb34-422"></a>markov_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-423"><a href="#cb34-423"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb34-424"><a href="#cb34-424"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb34-425"><a href="#cb34-425"></a>  <span class="fu">mutate</span>(<span class="at">yesterday_rain =</span> <span class="fu">lag</span>(rain_today)) <span class="sc">%&gt;%</span></span>
<span id="cb34-426"><a href="#cb34-426"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-427"><a href="#cb34-427"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(rain_today), <span class="sc">!</span><span class="fu">is.na</span>(yesterday_rain))</span>
<span id="cb34-428"><a href="#cb34-428"></a></span>
<span id="cb34-429"><a href="#cb34-429"></a>markov_data <span class="sc">%&gt;%</span></span>
<span id="cb34-430"><a href="#cb34-430"></a>  <span class="fu">count</span>(yesterday_rain, rain_today) <span class="sc">%&gt;%</span></span>
<span id="cb34-431"><a href="#cb34-431"></a>  <span class="fu">group_by</span>(yesterday_rain) <span class="sc">%&gt;%</span></span>
<span id="cb34-432"><a href="#cb34-432"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb34-433"><a href="#cb34-433"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> yesterday_rain, <span class="at">y =</span> rain_today, <span class="at">fill =</span> prob)) <span class="sc">+</span></span>
<span id="cb34-434"><a href="#cb34-434"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb34-435"><a href="#cb34-435"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb34-436"><a href="#cb34-436"></a>    <span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(prob, <span class="at">accuracy =</span> <span class="dv">1</span>)),</span>
<span id="cb34-437"><a href="#cb34-437"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb34-438"><a href="#cb34-438"></a>    <span class="at">size =</span> <span class="dv">8</span>,</span>
<span id="cb34-439"><a href="#cb34-439"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span></span>
<span id="cb34-440"><a href="#cb34-440"></a>  ) <span class="sc">+</span></span>
<span id="cb34-441"><a href="#cb34-441"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"viridis"</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb34-442"><a href="#cb34-442"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-443"><a href="#cb34-443"></a>    <span class="at">title =</span> <span class="st">"Markov Chain: Rain Persistence Effect"</span>,</span>
<span id="cb34-444"><a href="#cb34-444"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(</span>
<span id="cb34-445"><a href="#cb34-445"></a>      <span class="st">"X^2 = %.2f, p &lt; 0.001, Cramer's V = %.3f (Moderate Association)</span><span class="sc">\n</span><span class="st">Yesterday's rain strongly predicts today's rain state."</span>,</span>
<span id="cb34-446"><a href="#cb34-446"></a>      chi_result<span class="sc">$</span>statistic,</span>
<span id="cb34-447"><a href="#cb34-447"></a>      cramers_v</span>
<span id="cb34-448"><a href="#cb34-448"></a>    ),</span>
<span id="cb34-449"><a href="#cb34-449"></a>    <span class="at">x =</span> <span class="st">"Did it Rain Yesterday?"</span>,</span>
<span id="cb34-450"><a href="#cb34-450"></a>    <span class="at">y =</span> <span class="st">"Did it Rain Today?"</span>,</span>
<span id="cb34-451"><a href="#cb34-451"></a>    <span class="at">fill =</span> <span class="st">"Probability"</span></span>
<span id="cb34-452"><a href="#cb34-452"></a>  ) <span class="sc">+</span></span>
<span id="cb34-453"><a href="#cb34-453"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-454"><a href="#cb34-454"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-455"><a href="#cb34-455"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-456"><a href="#cb34-456"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb34-457"><a href="#cb34-457"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb34-458"><a href="#cb34-458"></a>  )</span>
<span id="cb34-459"><a href="#cb34-459"></a><span class="in">```</span></span>
<span id="cb34-460"><a href="#cb34-460"></a></span>
<span id="cb34-461"><a href="#cb34-461"></a>To quantify the "persistence" of weather patterns (the tendency of current weather to resemble past weather), we modeled the rainfall sequence as a first-order Markov Chain. This approach tests the hypothesis that the probability of rain today ($P(\text{Rain}_t)$) is conditionally dependent on the state of the previous day ($P(\text{Rain}_{t-1})$).</span>
<span id="cb34-462"><a href="#cb34-462"></a></span>
<span id="cb34-463"><a href="#cb34-463"></a>**Statistical Significance:** The Pearson Chi-squared test ($\chi^2 \approx 13,718, p &lt; 0.001$) overwhelmingly rejects the null hypothesis of independence. Furthermore, Cramér's V ($V \approx 0.31$) indicates a **moderate effect size**, confirming that yesterday’s weather is not just statistically significant but practically meaningful for prediction.</span>
<span id="cb34-464"><a href="#cb34-464"></a></span>
<span id="cb34-465"><a href="#cb34-465"></a>**Transition Probabilities:** As illustrated in @fig-markov-chain, the transition matrix reveals distinct stability patterns:</span>
<span id="cb34-466"><a href="#cb34-466"></a></span>
<span id="cb34-467"><a href="#cb34-467"></a><span class="ss">-   </span>**Dry Persistence (Stability):** If it was dry yesterday, there is an **85% probability** it will remain dry today. This highlights the stability of high-pressure systems in the Australian climate.</span>
<span id="cb34-468"><a href="#cb34-468"></a><span class="ss">-   </span>**Wet Persistence (Instability):** If it rained yesterday, there is only a **47% probability** it will rain again today. Conversely, there is a 53% chance the weather will clear up.</span>
<span id="cb34-469"><a href="#cb34-469"></a></span>
<span id="cb34-470"><a href="#cb34-470"></a>**Conclusion:** While the "Dry" state is highly stable (sticky), the "Wet" state is transient. This asymmetry suggests that while past rainfall is a useful predictor, it cannot be the *sole* predictor. A robust model must incorporate other meteorological covariates (humidity, pressure) to accurately predict the onset and cessation of rainfall events.</span>
<span id="cb34-471"><a href="#cb34-471"></a></span>
<span id="cb34-472"><a href="#cb34-472"></a><span class="fu">### Justification for Interaction Terms</span></span>
<span id="cb34-473"><a href="#cb34-473"></a></span>
<span id="cb34-476"><a href="#cb34-476"></a><span class="in">```{r}</span></span>
<span id="cb34-477"><a href="#cb34-477"></a><span class="co">#| label: fig-interaction-rain-corner</span></span>
<span id="cb34-478"><a href="#cb34-478"></a><span class="co">#| fig-cap: "Bivariate Density Plot of Humidity vs. Sunshine, faceted by Rainfall Occurrence. The concentration of the 'Yes' class in the upper-left quadrant (High Humidity, Low Sunshine) visually justifies the inclusion of an interaction term."</span></span>
<span id="cb34-479"><a href="#cb34-479"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb34-480"><a href="#cb34-480"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb34-481"><a href="#cb34-481"></a><span class="co">#| echo: true</span></span>
<span id="cb34-482"><a href="#cb34-482"></a><span class="co">#| warning: false</span></span>
<span id="cb34-483"><a href="#cb34-483"></a></span>
<span id="cb34-484"><a href="#cb34-484"></a>df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-485"><a href="#cb34-485"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb34-486"><a href="#cb34-486"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb34-487"><a href="#cb34-487"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-488"><a href="#cb34-488"></a>    <span class="co"># Create a reference index for the last rainy day</span></span>
<span id="cb34-489"><a href="#cb34-489"></a>    <span class="at">rain_index_ref =</span> <span class="fu">ifelse</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="fu">row_number</span>(), <span class="cn">NA_integer_</span>)</span>
<span id="cb34-490"><a href="#cb34-490"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-491"><a href="#cb34-491"></a>  <span class="fu">fill</span>(rain_index_ref, <span class="at">.direction =</span> <span class="st">"down"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-492"><a href="#cb34-492"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-493"><a href="#cb34-493"></a>    <span class="co"># Calculate days elapsed since the last rainfall event</span></span>
<span id="cb34-494"><a href="#cb34-494"></a>    <span class="at">days_since_rain =</span> <span class="fu">row_number</span>() <span class="sc">-</span> <span class="fu">lag</span>(rain_index_ref)</span>
<span id="cb34-495"><a href="#cb34-495"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-496"><a href="#cb34-496"></a>  <span class="fu">select</span>(<span class="sc">-</span>rain_index_ref) <span class="sc">%&gt;%</span></span>
<span id="cb34-497"><a href="#cb34-497"></a>  <span class="co"># Plotting the "Rain Corner"</span></span>
<span id="cb34-498"><a href="#cb34-498"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sunshine, humidity3pm)) <span class="sc">+</span></span>
<span id="cb34-499"><a href="#cb34-499"></a>  <span class="fu">geom_density2d_filled</span>(<span class="at">continuous_var =</span> <span class="st">"ndensity"</span>, <span class="at">bins =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb34-500"><a href="#cb34-500"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>rain_today, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb34-501"><a href="#cb34-501"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb34-502"><a href="#cb34-502"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-503"><a href="#cb34-503"></a>    <span class="at">title =</span> <span class="st">"Justifying Interaction: The 'Rain Corner'"</span>,</span>
<span id="cb34-504"><a href="#cb34-504"></a>    <span class="at">subtitle =</span> <span class="st">"Rain (Right) concentrates in High Humidity/Low Sun, while No Rain (Left) is spread out.</span><span class="sc">\n</span><span class="st">This structural difference justifies a 'Sunshine * Humidity' interaction feature."</span>,</span>
<span id="cb34-505"><a href="#cb34-505"></a>    <span class="at">x =</span> <span class="st">"Sunshine (hours)"</span>,</span>
<span id="cb34-506"><a href="#cb34-506"></a>    <span class="at">y =</span> <span class="st">"Humidity 3pm (%)"</span></span>
<span id="cb34-507"><a href="#cb34-507"></a>  ) <span class="sc">+</span></span>
<span id="cb34-508"><a href="#cb34-508"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-509"><a href="#cb34-509"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-510"><a href="#cb34-510"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb34-511"><a href="#cb34-511"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb34-512"><a href="#cb34-512"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb34-513"><a href="#cb34-513"></a>  )</span>
<span id="cb34-514"><a href="#cb34-514"></a><span class="in">```</span></span>
<span id="cb34-515"><a href="#cb34-515"></a></span>
<span id="cb34-516"><a href="#cb34-516"></a>To refine our model specification, we investigated potential non-linear interactions between key predictors. Specifically, we examined the joint distribution of <span class="in">`Humidity3pm`</span> and <span class="in">`Sunshine`</span>, conditional on the occurrence of rain (<span class="in">`rain_today`</span>).</span>
<span id="cb34-517"><a href="#cb34-517"></a></span>
<span id="cb34-518"><a href="#cb34-518"></a>**The "Rain Corner" Phenomenon:** As demonstrated in @fig-interaction-rain-corner, the two weather states exhibit fundamentally different geometric structures in feature space:</span>
<span id="cb34-519"><a href="#cb34-519"></a></span>
<span id="cb34-520"><a href="#cb34-520"></a><span class="ss">-   </span>**Dry State (`rain_today: No`):** The density is dispersed broadly across the plot. It is possible to have high humidity without rain (if other conditions like pressure prevent it) or high sunshine without rain. The relationship is loose and unstructured.</span>
<span id="cb34-521"><a href="#cb34-521"></a><span class="ss">-   </span>**Wet State (`rain_today: Yes`):** The density collapses into a distinct, tight cluster in the upper-left quadrant, a region we term the **"Rain Corner"**. Rain occurs almost exclusively when **Humidity is High (\&gt;50%) AND Sunshine is Low (\&lt;5 hours)**.</span>
<span id="cb34-522"><a href="#cb34-522"></a></span>
<span id="cb34-523"><a href="#cb34-523"></a>**Modeling Implication:** This stark visual contrast confirms that <span class="in">`Humidity`</span> and <span class="in">`Sunshine`</span> do not act independently. The effect of humidity on rainfall probability is conditional on the level of sunshine. Consequently, a standard additive model ($Rain \sim Humidity + Sunshine$) would fail to capture this specific "corner" effect. This finding empirically justifies the inclusion of a multiplicative interaction term ($Humidity \times Sunshine$) in our final model to mathematically capture this synergistic threshold.</span>
<span id="cb34-524"><a href="#cb34-524"></a></span>
<span id="cb34-525"><a href="#cb34-525"></a><span class="fu">### The 'Drying Effect' and Temporal Decay</span></span>
<span id="cb34-526"><a href="#cb34-526"></a></span>
<span id="cb34-529"><a href="#cb34-529"></a><span class="in">```{r}</span></span>
<span id="cb34-530"><a href="#cb34-530"></a><span class="co">#| label: dry-spell-prep</span></span>
<span id="cb34-531"><a href="#cb34-531"></a><span class="co">#| echo: true</span></span>
<span id="cb34-532"><a href="#cb34-532"></a><span class="co">#| message: false</span></span>
<span id="cb34-533"><a href="#cb34-533"></a><span class="co">#| warning: false</span></span>
<span id="cb34-534"><a href="#cb34-534"></a></span>
<span id="cb34-535"><a href="#cb34-535"></a><span class="co"># Construct 'Days Since Last Rain' counter for each location</span></span>
<span id="cb34-536"><a href="#cb34-536"></a>dry_spell_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-537"><a href="#cb34-537"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb34-538"><a href="#cb34-538"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb34-539"><a href="#cb34-539"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-540"><a href="#cb34-540"></a>    <span class="at">did_rain_yesterday =</span> <span class="fu">lag</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">default =</span> <span class="cn">FALSE</span>),</span>
<span id="cb34-541"><a href="#cb34-541"></a>    <span class="co"># Identify unique dry spells by cumulative sum of wet days</span></span>
<span id="cb34-542"><a href="#cb34-542"></a>    <span class="at">dry_spell_id =</span> <span class="fu">cumsum</span>(did_rain_yesterday)</span>
<span id="cb34-543"><a href="#cb34-543"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-544"><a href="#cb34-544"></a>  <span class="fu">group_by</span>(location, dry_spell_id) <span class="sc">%&gt;%</span></span>
<span id="cb34-545"><a href="#cb34-545"></a>  <span class="fu">mutate</span>(<span class="at">days_since_rain =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb34-546"><a href="#cb34-546"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-547"><a href="#cb34-547"></a>  <span class="co"># Filter to focus on the first month of a dry spell for stability</span></span>
<span id="cb34-548"><a href="#cb34-548"></a>  <span class="fu">filter</span>(days_since_rain <span class="sc">&lt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-549"><a href="#cb34-549"></a>  <span class="fu">mutate</span>(<span class="at">rain_binary =</span> <span class="fu">as.numeric</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>))</span>
<span id="cb34-550"><a href="#cb34-550"></a><span class="in">```</span></span>
<span id="cb34-551"><a href="#cb34-551"></a></span>
<span id="cb34-554"><a href="#cb34-554"></a><span class="in">```{r}</span></span>
<span id="cb34-555"><a href="#cb34-555"></a><span class="co">#| label: dry-spell-model</span></span>
<span id="cb34-556"><a href="#cb34-556"></a><span class="co">#| echo: true</span></span>
<span id="cb34-557"><a href="#cb34-557"></a><span class="co">#| collapse: true</span></span>
<span id="cb34-558"><a href="#cb34-558"></a></span>
<span id="cb34-559"><a href="#cb34-559"></a><span class="co"># Fit Logistic Regression (Linear Trend)</span></span>
<span id="cb34-560"><a href="#cb34-560"></a><span class="co"># Hypothesis: As the dry spell lengthens, probability of rain decreases</span></span>
<span id="cb34-561"><a href="#cb34-561"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb34-562"><a href="#cb34-562"></a>  rain_binary <span class="sc">~</span> days_since_rain,</span>
<span id="cb34-563"><a href="#cb34-563"></a>  <span class="at">data =</span> dry_spell_data,</span>
<span id="cb34-564"><a href="#cb34-564"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb34-565"><a href="#cb34-565"></a>)</span>
<span id="cb34-566"><a href="#cb34-566"></a></span>
<span id="cb34-567"><a href="#cb34-567"></a><span class="co"># Wald Test for Coefficient Significance</span></span>
<span id="cb34-568"><a href="#cb34-568"></a><span class="co"># Tests if the 'days_since_rain' effect is significantly different from 0</span></span>
<span id="cb34-569"><a href="#cb34-569"></a>wald_test <span class="ot">&lt;-</span> aod<span class="sc">::</span><span class="fu">wald.test</span>(</span>
<span id="cb34-570"><a href="#cb34-570"></a>  <span class="at">b =</span> <span class="fu">coef</span>(logit_model),</span>
<span id="cb34-571"><a href="#cb34-571"></a>  <span class="at">Sigma =</span> <span class="fu">vcov</span>(logit_model),</span>
<span id="cb34-572"><a href="#cb34-572"></a>  <span class="at">Terms =</span> <span class="dv">2</span></span>
<span id="cb34-573"><a href="#cb34-573"></a>)</span>
<span id="cb34-574"><a href="#cb34-574"></a></span>
<span id="cb34-575"><a href="#cb34-575"></a><span class="co"># Calculate Odds Ratios</span></span>
<span id="cb34-576"><a href="#cb34-576"></a>or_results <span class="ot">&lt;-</span> <span class="fu">tidy</span>(logit_model, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-577"><a href="#cb34-577"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"days_since_rain"</span>)</span>
<span id="cb34-578"><a href="#cb34-578"></a></span>
<span id="cb34-579"><a href="#cb34-579"></a><span class="co"># Output Results</span></span>
<span id="cb34-580"><a href="#cb34-580"></a><span class="fu">print</span>(wald_test)</span>
<span id="cb34-581"><a href="#cb34-581"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(</span>
<span id="cb34-582"><a href="#cb34-582"></a>  <span class="st">"</span><span class="sc">\n</span><span class="st">For each additional day without rain, odds of rainfall decrease by %.1f%%</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb34-583"><a href="#cb34-583"></a>  (<span class="dv">1</span> <span class="sc">-</span> or_results<span class="sc">$</span>estimate) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb34-584"><a href="#cb34-584"></a>))</span>
<span id="cb34-585"><a href="#cb34-585"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(</span>
<span id="cb34-586"><a href="#cb34-586"></a>  <span class="st">"95%% CI: [%.3f, %.3f]</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb34-587"><a href="#cb34-587"></a>  or_results<span class="sc">$</span>conf.low,</span>
<span id="cb34-588"><a href="#cb34-588"></a>  or_results<span class="sc">$</span>conf.high</span>
<span id="cb34-589"><a href="#cb34-589"></a>))</span>
<span id="cb34-590"><a href="#cb34-590"></a><span class="in">```</span></span>
<span id="cb34-591"><a href="#cb34-591"></a></span>
<span id="cb34-594"><a href="#cb34-594"></a><span class="in">```{r}</span></span>
<span id="cb34-595"><a href="#cb34-595"></a><span class="co">#| label: dry-spell-spline</span></span>
<span id="cb34-596"><a href="#cb34-596"></a><span class="co">#| echo: true</span></span>
<span id="cb34-597"><a href="#cb34-597"></a><span class="co">#| collapse: true</span></span>
<span id="cb34-598"><a href="#cb34-598"></a></span>
<span id="cb34-599"><a href="#cb34-599"></a><span class="co"># Fit a Natural Spline model (df=4) to detect non-linear patterns</span></span>
<span id="cb34-600"><a href="#cb34-600"></a>logit_spline <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb34-601"><a href="#cb34-601"></a>  rain_binary <span class="sc">~</span> splines<span class="sc">::</span><span class="fu">ns</span>(days_since_rain, <span class="at">df =</span> <span class="dv">4</span>),</span>
<span id="cb34-602"><a href="#cb34-602"></a>  <span class="at">data =</span> dry_spell_data,</span>
<span id="cb34-603"><a href="#cb34-603"></a>  <span class="at">family =</span> binomial</span>
<span id="cb34-604"><a href="#cb34-604"></a>)</span>
<span id="cb34-605"><a href="#cb34-605"></a></span>
<span id="cb34-606"><a href="#cb34-606"></a><span class="co"># Likelihood Ratio Test (LRT): Compare Linear vs. Spline Model</span></span>
<span id="cb34-607"><a href="#cb34-607"></a><span class="co"># H0: The relationship is linear (simpler model is sufficient)</span></span>
<span id="cb34-608"><a href="#cb34-608"></a>lrt_result <span class="ot">&lt;-</span> <span class="fu">anova</span>(logit_model, logit_spline, <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb34-609"><a href="#cb34-609"></a><span class="fu">print</span>(lrt_result)</span>
<span id="cb34-610"><a href="#cb34-610"></a><span class="in">```</span></span>
<span id="cb34-611"><a href="#cb34-611"></a></span>
<span id="cb34-614"><a href="#cb34-614"></a><span class="in">```{r}</span></span>
<span id="cb34-615"><a href="#cb34-615"></a><span class="co">#| label: fig-dry-spell</span></span>
<span id="cb34-616"><a href="#cb34-616"></a><span class="co">#| fig-cap: "The 'Drying Effect': Empirical vs. Modeled Probability of Rainfall. The probability of rain decays exponentially as the dry spell lengthens."</span></span>
<span id="cb34-617"><a href="#cb34-617"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb34-618"><a href="#cb34-618"></a><span class="co">#| fig-height: 7</span></span>
<span id="cb34-619"><a href="#cb34-619"></a><span class="co">#| echo: true</span></span>
<span id="cb34-620"><a href="#cb34-620"></a><span class="co">#| warning: false</span></span>
<span id="cb34-621"><a href="#cb34-621"></a></span>
<span id="cb34-622"><a href="#cb34-622"></a><span class="co"># Generate predictions for the trend line</span></span>
<span id="cb34-623"><a href="#cb34-623"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">days_since_rain =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb34-624"><a href="#cb34-624"></a>pred_data<span class="sc">$</span>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb34-625"><a href="#cb34-625"></a>  logit_model,</span>
<span id="cb34-626"><a href="#cb34-626"></a>  <span class="at">newdata =</span> pred_data,</span>
<span id="cb34-627"><a href="#cb34-627"></a>  <span class="at">type =</span> <span class="st">"response"</span></span>
<span id="cb34-628"><a href="#cb34-628"></a>)</span>
<span id="cb34-629"><a href="#cb34-629"></a>pred_data<span class="sc">$</span>pred_se <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb34-630"><a href="#cb34-630"></a>  logit_model,</span>
<span id="cb34-631"><a href="#cb34-631"></a>  <span class="at">newdata =</span> pred_data,</span>
<span id="cb34-632"><a href="#cb34-632"></a>  <span class="at">type =</span> <span class="st">"response"</span>,</span>
<span id="cb34-633"><a href="#cb34-633"></a>  <span class="at">se.fit =</span> <span class="cn">TRUE</span></span>
<span id="cb34-634"><a href="#cb34-634"></a>)<span class="sc">$</span>se.fit</span>
<span id="cb34-635"><a href="#cb34-635"></a></span>
<span id="cb34-636"><a href="#cb34-636"></a><span class="co"># Calculate empirical probabilities (Actual data points)</span></span>
<span id="cb34-637"><a href="#cb34-637"></a>empirical_probs <span class="ot">&lt;-</span> dry_spell_data <span class="sc">%&gt;%</span></span>
<span id="cb34-638"><a href="#cb34-638"></a>  <span class="fu">group_by</span>(days_since_rain) <span class="sc">%&gt;%</span></span>
<span id="cb34-639"><a href="#cb34-639"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-640"><a href="#cb34-640"></a>    <span class="at">prob_rain =</span> <span class="fu">mean</span>(rain_binary, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-641"><a href="#cb34-641"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb34-642"><a href="#cb34-642"></a>    <span class="at">se =</span> <span class="fu">sqrt</span>(prob_rain <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prob_rain) <span class="sc">/</span> n)</span>
<span id="cb34-643"><a href="#cb34-643"></a>  )</span>
<span id="cb34-644"><a href="#cb34-644"></a></span>
<span id="cb34-645"><a href="#cb34-645"></a><span class="co"># Plot</span></span>
<span id="cb34-646"><a href="#cb34-646"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb34-647"><a href="#cb34-647"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb34-648"><a href="#cb34-648"></a>    <span class="at">data =</span> pred_data,</span>
<span id="cb34-649"><a href="#cb34-649"></a>    <span class="fu">aes</span>(</span>
<span id="cb34-650"><a href="#cb34-650"></a>      <span class="at">x =</span> days_since_rain,</span>
<span id="cb34-651"><a href="#cb34-651"></a>      <span class="at">ymin =</span> pred_prob <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_se,</span>
<span id="cb34-652"><a href="#cb34-652"></a>      <span class="at">ymax =</span> pred_prob <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_se</span>
<span id="cb34-653"><a href="#cb34-653"></a>    ),</span>
<span id="cb34-654"><a href="#cb34-654"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb34-655"><a href="#cb34-655"></a>    <span class="at">fill =</span> <span class="st">"firebrick"</span></span>
<span id="cb34-656"><a href="#cb34-656"></a>  ) <span class="sc">+</span></span>
<span id="cb34-657"><a href="#cb34-657"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb34-658"><a href="#cb34-658"></a>    <span class="at">data =</span> pred_data,</span>
<span id="cb34-659"><a href="#cb34-659"></a>    <span class="fu">aes</span>(<span class="at">x =</span> days_since_rain, <span class="at">y =</span> pred_prob),</span>
<span id="cb34-660"><a href="#cb34-660"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span>,</span>
<span id="cb34-661"><a href="#cb34-661"></a>    <span class="at">size =</span> <span class="fl">1.2</span>,</span>
<span id="cb34-662"><a href="#cb34-662"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb34-663"><a href="#cb34-663"></a>  ) <span class="sc">+</span></span>
<span id="cb34-664"><a href="#cb34-664"></a>  <span class="co"># Empirical Data (Points + Error Bars)</span></span>
<span id="cb34-665"><a href="#cb34-665"></a>  <span class="fu">geom_pointrange</span>(</span>
<span id="cb34-666"><a href="#cb34-666"></a>    <span class="at">data =</span> empirical_probs,</span>
<span id="cb34-667"><a href="#cb34-667"></a>    <span class="fu">aes</span>(</span>
<span id="cb34-668"><a href="#cb34-668"></a>      <span class="at">x =</span> days_since_rain,</span>
<span id="cb34-669"><a href="#cb34-669"></a>      <span class="at">y =</span> prob_rain,</span>
<span id="cb34-670"><a href="#cb34-670"></a>      <span class="at">ymin =</span> prob_rain <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb34-671"><a href="#cb34-671"></a>      <span class="at">ymax =</span> prob_rain <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se</span>
<span id="cb34-672"><a href="#cb34-672"></a>    ),</span>
<span id="cb34-673"><a href="#cb34-673"></a>    <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb34-674"><a href="#cb34-674"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb34-675"><a href="#cb34-675"></a>  ) <span class="sc">+</span></span>
<span id="cb34-676"><a href="#cb34-676"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb34-677"><a href="#cb34-677"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="dv">1</span>),</span>
<span id="cb34-678"><a href="#cb34-678"></a>    <span class="at">breaks =</span> <span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">6</span>)</span>
<span id="cb34-679"><a href="#cb34-679"></a>  ) <span class="sc">+</span></span>
<span id="cb34-680"><a href="#cb34-680"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>()) <span class="sc">+</span></span>
<span id="cb34-681"><a href="#cb34-681"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-682"><a href="#cb34-682"></a>    <span class="at">x =</span> <span class="st">"Days Since Last Rain"</span>,</span>
<span id="cb34-683"><a href="#cb34-683"></a>    <span class="at">y =</span> <span class="st">"Probability of Rainfall"</span>,</span>
<span id="cb34-684"><a href="#cb34-684"></a>    <span class="at">title =</span> <span class="st">"Dry Spell Effect on Rain Probability"</span>,</span>
<span id="cb34-685"><a href="#cb34-685"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(</span>
<span id="cb34-686"><a href="#cb34-686"></a>      <span class="st">"Logistic Regression: B = %.4f, Wald χ2 = %.2f, p &lt; 0.001</span><span class="sc">\n</span><span class="st">Each additional dry day reduces odds of rain by %.1f%%"</span>,</span>
<span id="cb34-687"><a href="#cb34-687"></a>      <span class="fu">coef</span>(logit_model)[<span class="dv">2</span>],</span>
<span id="cb34-688"><a href="#cb34-688"></a>      wald_test<span class="sc">$</span>result<span class="sc">$</span>chi2[<span class="dv">1</span>],</span>
<span id="cb34-689"><a href="#cb34-689"></a>      (<span class="dv">1</span> <span class="sc">-</span> or_results<span class="sc">$</span>estimate) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb34-690"><a href="#cb34-690"></a>    ),</span>
<span id="cb34-691"><a href="#cb34-691"></a>    <span class="at">caption =</span> <span class="st">"Points: Empirical probabilities ± 95% CI | Line: Logistic model fit"</span></span>
<span id="cb34-692"><a href="#cb34-692"></a>  ) <span class="sc">+</span></span>
<span id="cb34-693"><a href="#cb34-693"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb34-694"><a href="#cb34-694"></a><span class="in">```</span></span>
<span id="cb34-695"><a href="#cb34-695"></a></span>
<span id="cb34-696"><a href="#cb34-696"></a>Beyond simple day-to-day persistence, we modeled the **cumulative effect of dry spells** on the probability of rain re-occurring. We formulated this as a survival-style problem: *Does the length of an ongoing drought influence the likelihood of it ending today?*</span>
<span id="cb34-697"><a href="#cb34-697"></a></span>
<span id="cb34-698"><a href="#cb34-698"></a>**Linear Trend Analysis:** A logistic regression model reveals a statistically significant negative relationship (Wald $\chi^2 \approx 8099, p &lt; 0.001$).</span>
<span id="cb34-699"><a href="#cb34-699"></a></span>
<span id="cb34-700"><a href="#cb34-700"></a><span class="ss">-   </span>**The Decay Rate:** The model estimates that for **each additional day** a dry spell continues, the odds of it raining decrease by approximately **16.5%** ($OR = 0.83$).</span>
<span id="cb34-701"><a href="#cb34-701"></a></span>
<span id="cb34-702"><a href="#cb34-702"></a><span class="ss">-   </span>**Physical Interpretation:** This suggests a feedback loop where dry conditions promote stability (e.g., persistent high-pressure ridges), making it progressively harder for rain systems to penetrate as the dry spell lengthens.</span>
<span id="cb34-703"><a href="#cb34-703"></a></span>
<span id="cb34-704"><a href="#cb34-704"></a>**Non-Linear Complexity:** While the linear decay model is robust, the Likelihood Ratio Test comparing it to a Natural Spline model (LRT $\chi^2 \approx 7678, p &lt; 0.001$) indicates significant non-linearity.</span>
<span id="cb34-705"><a href="#cb34-705"></a></span>
<span id="cb34-706"><a href="#cb34-706"></a><span class="ss">-   </span>**Visual Evidence:** As seen in @fig-dry-spell, the empirical data (black dots) shows a "kink" around Day 10-12. The probability of rain drops sharply from Day 1 (\~48%) to Day 10 (\~18%), but then stabilizes or decays much slower from Day 15 to Day 30.</span>
<span id="cb34-707"><a href="#cb34-707"></a><span class="ss">-   </span>**Implication:** A simple linear term underestimates the rapid initial drying and overestimates the decay in long-term droughts. Future models should utilize spline terms for <span class="in">`days_since_rain`</span> to capture this "rapid-then-gradual" decay dynamic.</span>
<span id="cb34-708"><a href="#cb34-708"></a></span>
<span id="cb34-709"><a href="#cb34-709"></a><span class="fu">### Atmospheric Pressure and Diurnal Variation</span></span>
<span id="cb34-710"><a href="#cb34-710"></a></span>
<span id="cb34-713"><a href="#cb34-713"></a><span class="in">```{r}</span></span>
<span id="cb34-714"><a href="#cb34-714"></a><span class="co">#| label: pressure-prep-normality</span></span>
<span id="cb34-715"><a href="#cb34-715"></a><span class="co">#| echo: true</span></span>
<span id="cb34-716"><a href="#cb34-716"></a><span class="co">#| message: false</span></span>
<span id="cb34-717"><a href="#cb34-717"></a><span class="co">#| warning: false</span></span>
<span id="cb34-718"><a href="#cb34-718"></a></span>
<span id="cb34-719"><a href="#cb34-719"></a><span class="co"># Diurnal Pressure Change</span></span>
<span id="cb34-720"><a href="#cb34-720"></a>pressure_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-721"><a href="#cb34-721"></a>  <span class="fu">mutate</span>(<span class="at">pressure_change =</span> pressure3pm <span class="sc">-</span> pressure9am) <span class="sc">%&gt;%</span></span>
<span id="cb34-722"><a href="#cb34-722"></a>  <span class="fu">select</span>(rain_today, pressure9am, pressure3pm, pressure_change) <span class="sc">%&gt;%</span></span>
<span id="cb34-723"><a href="#cb34-723"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pressure9am), <span class="sc">!</span><span class="fu">is.na</span>(rain_today))</span>
<span id="cb34-724"><a href="#cb34-724"></a></span>
<span id="cb34-725"><a href="#cb34-725"></a><span class="co"># Visual Inspection of Normality (Q-Q Plots)</span></span>
<span id="cb34-726"><a href="#cb34-726"></a><span class="co"># Using a random subsample of 5k points for clear visualization</span></span>
<span id="cb34-727"><a href="#cb34-727"></a>pressure_data <span class="sc">%&gt;%</span></span>
<span id="cb34-728"><a href="#cb34-728"></a>  <span class="fu">sample_n</span>(<span class="dv">5000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-729"><a href="#cb34-729"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb34-730"><a href="#cb34-730"></a>    <span class="at">cols =</span> <span class="fu">c</span>(pressure9am, pressure3pm, pressure_change),</span>
<span id="cb34-731"><a href="#cb34-731"></a>    <span class="at">names_to =</span> <span class="st">"metric"</span>,</span>
<span id="cb34-732"><a href="#cb34-732"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb34-733"><a href="#cb34-733"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-734"><a href="#cb34-734"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> value)) <span class="sc">+</span></span>
<span id="cb34-735"><a href="#cb34-735"></a>  <span class="fu">stat_qq</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb34-736"><a href="#cb34-736"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb34-737"><a href="#cb34-737"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb34-738"><a href="#cb34-738"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-739"><a href="#cb34-739"></a>    <span class="at">title =</span> <span class="st">"Q-Q Plots: Checking Normality Assumption"</span>,</span>
<span id="cb34-740"><a href="#cb34-740"></a>    <span class="at">subtitle =</span> <span class="st">"Points should hug the red line. Slight deviations are acceptable due to large N (CLT)."</span></span>
<span id="cb34-741"><a href="#cb34-741"></a>  ) <span class="sc">+</span></span>
<span id="cb34-742"><a href="#cb34-742"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb34-743"><a href="#cb34-743"></a><span class="in">```</span></span>
<span id="cb34-744"><a href="#cb34-744"></a></span>
<span id="cb34-747"><a href="#cb34-747"></a><span class="in">```{r}</span></span>
<span id="cb34-748"><a href="#cb34-748"></a><span class="co">#| label: pressure-stats</span></span>
<span id="cb34-749"><a href="#cb34-749"></a><span class="co">#| echo: true</span></span>
<span id="cb34-750"><a href="#cb34-750"></a><span class="co">#| message: false</span></span>
<span id="cb34-751"><a href="#cb34-751"></a></span>
<span id="cb34-752"><a href="#cb34-752"></a><span class="co"># Prepare data for testing</span></span>
<span id="cb34-753"><a href="#cb34-753"></a>test_data <span class="ot">&lt;-</span> pressure_data <span class="sc">%&gt;%</span></span>
<span id="cb34-754"><a href="#cb34-754"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb34-755"><a href="#cb34-755"></a>    <span class="at">cols =</span> <span class="fu">c</span>(pressure9am, pressure3pm, pressure_change),</span>
<span id="cb34-756"><a href="#cb34-756"></a>    <span class="at">names_to =</span> <span class="st">"metric"</span>,</span>
<span id="cb34-757"><a href="#cb34-757"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb34-758"><a href="#cb34-758"></a>  )</span>
<span id="cb34-759"><a href="#cb34-759"></a></span>
<span id="cb34-760"><a href="#cb34-760"></a><span class="co"># Execute Welch's t-test (robust to unequal variances)</span></span>
<span id="cb34-761"><a href="#cb34-761"></a>stats_results <span class="ot">&lt;-</span> test_data <span class="sc">%&gt;%</span></span>
<span id="cb34-762"><a href="#cb34-762"></a>  <span class="fu">group_by</span>(metric) <span class="sc">%&gt;%</span></span>
<span id="cb34-763"><a href="#cb34-763"></a>  <span class="fu">t_test</span>(value <span class="sc">~</span> rain_today, <span class="at">var.equal =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-764"><a href="#cb34-764"></a>  <span class="fu">adjust_pvalue</span>(<span class="at">method =</span> <span class="st">"holm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-765"><a href="#cb34-765"></a>  <span class="fu">add_significance</span>()</span>
<span id="cb34-766"><a href="#cb34-766"></a></span>
<span id="cb34-767"><a href="#cb34-767"></a>stats_results <span class="sc">%&gt;%</span></span>
<span id="cb34-768"><a href="#cb34-768"></a>  <span class="fu">select</span>(metric, group1, group2, statistic, df, p.adj, p.adj.signif) <span class="sc">%&gt;%</span></span>
<span id="cb34-769"><a href="#cb34-769"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-770"><a href="#cb34-770"></a>    <span class="at">caption =</span> <span class="st">"Welch's Two Sample t-test Results (Bonferroni-Holm Corrected)"</span>,</span>
<span id="cb34-771"><a href="#cb34-771"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb34-772"><a href="#cb34-772"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb34-773"><a href="#cb34-773"></a>      <span class="st">"Metric"</span>,</span>
<span id="cb34-774"><a href="#cb34-774"></a>      <span class="st">"Group 1"</span>,</span>
<span id="cb34-775"><a href="#cb34-775"></a>      <span class="st">"Group 2"</span>,</span>
<span id="cb34-776"><a href="#cb34-776"></a>      <span class="st">"t-statistic"</span>,</span>
<span id="cb34-777"><a href="#cb34-777"></a>      <span class="st">"df"</span>,</span>
<span id="cb34-778"><a href="#cb34-778"></a>      <span class="st">"Adj. P-Value"</span>,</span>
<span id="cb34-779"><a href="#cb34-779"></a>      <span class="st">"Significance"</span></span>
<span id="cb34-780"><a href="#cb34-780"></a>    )</span>
<span id="cb34-781"><a href="#cb34-781"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-782"><a href="#cb34-782"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-783"><a href="#cb34-783"></a><span class="in">```</span></span>
<span id="cb34-784"><a href="#cb34-784"></a></span>
<span id="cb34-787"><a href="#cb34-787"></a><span class="in">```{r}</span></span>
<span id="cb34-788"><a href="#cb34-788"></a><span class="co">#| label: pressure-effect-size</span></span>
<span id="cb34-789"><a href="#cb34-789"></a><span class="co">#| echo: true</span></span>
<span id="cb34-790"><a href="#cb34-790"></a><span class="co">#| message: false</span></span>
<span id="cb34-791"><a href="#cb34-791"></a></span>
<span id="cb34-792"><a href="#cb34-792"></a><span class="co"># Calculate Cohen's d Effect Size</span></span>
<span id="cb34-793"><a href="#cb34-793"></a>effect_sizes <span class="ot">&lt;-</span> test_data <span class="sc">%&gt;%</span></span>
<span id="cb34-794"><a href="#cb34-794"></a>  <span class="fu">group_by</span>(metric) <span class="sc">%&gt;%</span></span>
<span id="cb34-795"><a href="#cb34-795"></a>  <span class="fu">cohens_d</span>(value <span class="sc">~</span> rain_today, <span class="at">var.equal =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-796"><a href="#cb34-796"></a>  <span class="co"># Categorize magnitude</span></span>
<span id="cb34-797"><a href="#cb34-797"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-798"><a href="#cb34-798"></a>    <span class="at">magnitude =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-799"><a href="#cb34-799"></a>      <span class="fu">abs</span>(effsize) <span class="sc">&lt;</span> <span class="fl">0.2</span> <span class="sc">~</span> <span class="st">"Negligible"</span>,</span>
<span id="cb34-800"><a href="#cb34-800"></a>      <span class="fu">abs</span>(effsize) <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Small"</span>,</span>
<span id="cb34-801"><a href="#cb34-801"></a>      <span class="fu">abs</span>(effsize) <span class="sc">&lt;</span> <span class="fl">0.8</span> <span class="sc">~</span> <span class="st">"Medium"</span>,</span>
<span id="cb34-802"><a href="#cb34-802"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Large"</span></span>
<span id="cb34-803"><a href="#cb34-803"></a>    )</span>
<span id="cb34-804"><a href="#cb34-804"></a>  )</span>
<span id="cb34-805"><a href="#cb34-805"></a></span>
<span id="cb34-806"><a href="#cb34-806"></a>effect_sizes <span class="sc">%&gt;%</span></span>
<span id="cb34-807"><a href="#cb34-807"></a>  <span class="fu">select</span>(metric, effsize, magnitude) <span class="sc">%&gt;%</span></span>
<span id="cb34-808"><a href="#cb34-808"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-809"><a href="#cb34-809"></a>    <span class="at">caption =</span> <span class="st">"Cohen's d Effect Size Analysis"</span>,</span>
<span id="cb34-810"><a href="#cb34-810"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb34-811"><a href="#cb34-811"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Effect Size (d)"</span>, <span class="st">"Interpretation"</span>)</span>
<span id="cb34-812"><a href="#cb34-812"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-813"><a href="#cb34-813"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-814"><a href="#cb34-814"></a><span class="in">```</span></span>
<span id="cb34-815"><a href="#cb34-815"></a></span>
<span id="cb34-818"><a href="#cb34-818"></a><span class="in">```{r}</span></span>
<span id="cb34-819"><a href="#cb34-819"></a><span class="co">#| label: fig-pressure-violin</span></span>
<span id="cb34-820"><a href="#cb34-820"></a><span class="co">#| fig-cap: "Violin Plots of Atmospheric Pressure Variables by Rainfall State. Annotations indicate statistical significance and effect size."</span></span>
<span id="cb34-821"><a href="#cb34-821"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb34-822"><a href="#cb34-822"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb34-823"><a href="#cb34-823"></a><span class="co">#| echo: true</span></span>
<span id="cb34-824"><a href="#cb34-824"></a><span class="co">#| warning: false</span></span>
<span id="cb34-825"><a href="#cb34-825"></a></span>
<span id="cb34-826"><a href="#cb34-826"></a><span class="co"># Merge statistics for annotation</span></span>
<span id="cb34-827"><a href="#cb34-827"></a>plot_annotations <span class="ot">&lt;-</span> stats_results <span class="sc">%&gt;%</span></span>
<span id="cb34-828"><a href="#cb34-828"></a>  <span class="fu">left_join</span>(effect_sizes, <span class="at">by =</span> <span class="st">"metric"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-829"><a href="#cb34-829"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-830"><a href="#cb34-830"></a>    <span class="at">label_text =</span> <span class="fu">sprintf</span>(</span>
<span id="cb34-831"><a href="#cb34-831"></a>      <span class="st">"p %s</span><span class="sc">\n</span><span class="st">Cohen's d = %.2f (%s)"</span>,</span>
<span id="cb34-832"><a href="#cb34-832"></a>      p.adj.signif,</span>
<span id="cb34-833"><a href="#cb34-833"></a>      effsize,</span>
<span id="cb34-834"><a href="#cb34-834"></a>      magnitude</span>
<span id="cb34-835"><a href="#cb34-835"></a>    ),</span>
<span id="cb34-836"><a href="#cb34-836"></a>    <span class="at">y_pos =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-837"><a href="#cb34-837"></a>      metric <span class="sc">==</span> <span class="st">"pressure9am"</span> <span class="sc">~</span> <span class="dv">1045</span>,</span>
<span id="cb34-838"><a href="#cb34-838"></a>      metric <span class="sc">==</span> <span class="st">"pressure3pm"</span> <span class="sc">~</span> <span class="dv">1040</span>,</span>
<span id="cb34-839"><a href="#cb34-839"></a>      metric <span class="sc">==</span> <span class="st">"pressure_change"</span> <span class="sc">~</span> <span class="dv">15</span></span>
<span id="cb34-840"><a href="#cb34-840"></a>    )</span>
<span id="cb34-841"><a href="#cb34-841"></a>  )</span>
<span id="cb34-842"><a href="#cb34-842"></a></span>
<span id="cb34-843"><a href="#cb34-843"></a><span class="fu">ggplot</span>(test_data, <span class="fu">aes</span>(rain_today, value, <span class="at">fill =</span> rain_today)) <span class="sc">+</span></span>
<span id="cb34-844"><a href="#cb34-844"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb34-845"><a href="#cb34-845"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb34-846"><a href="#cb34-846"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb34-847"><a href="#cb34-847"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb34-848"><a href="#cb34-848"></a>    <span class="at">data =</span> plot_annotations,</span>
<span id="cb34-849"><a href="#cb34-849"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> y_pos, <span class="at">label =</span> label_text),</span>
<span id="cb34-850"><a href="#cb34-850"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-851"><a href="#cb34-851"></a>    <span class="at">vjust =</span> <span class="dv">0</span>,</span>
<span id="cb34-852"><a href="#cb34-852"></a>    <span class="at">fontface =</span> <span class="st">"italic"</span>,</span>
<span id="cb34-853"><a href="#cb34-853"></a>    <span class="at">size =</span> <span class="fl">3.5</span></span>
<span id="cb34-854"><a href="#cb34-854"></a>  ) <span class="sc">+</span></span>
<span id="cb34-855"><a href="#cb34-855"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#B0B0B0"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>)) <span class="sc">+</span></span>
<span id="cb34-856"><a href="#cb34-856"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-857"><a href="#cb34-857"></a>    <span class="at">title =</span> <span class="st">"Atmospheric Pressure vs. Rainfall"</span>,</span>
<span id="cb34-858"><a href="#cb34-858"></a>    <span class="at">subtitle =</span> <span class="st">"Statistical validation using Welch's t-test and Cohen's d effect size"</span>,</span>
<span id="cb34-859"><a href="#cb34-859"></a>    <span class="at">y =</span> <span class="st">"Pressure (hPa)"</span>,</span>
<span id="cb34-860"><a href="#cb34-860"></a>    <span class="at">x =</span> <span class="st">"Did it rain?"</span></span>
<span id="cb34-861"><a href="#cb34-861"></a>  ) <span class="sc">+</span></span>
<span id="cb34-862"><a href="#cb34-862"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-863"><a href="#cb34-863"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-864"><a href="#cb34-864"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb34-865"><a href="#cb34-865"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb34-866"><a href="#cb34-866"></a>  )</span>
<span id="cb34-867"><a href="#cb34-867"></a><span class="in">```</span></span>
<span id="cb34-868"><a href="#cb34-868"></a></span>
<span id="cb34-871"><a href="#cb34-871"></a><span class="in">```{r}</span></span>
<span id="cb34-872"><a href="#cb34-872"></a><span class="co">#| label: fig-pressure-means</span></span>
<span id="cb34-873"><a href="#cb34-873"></a><span class="co">#| fig-cap: "Comparison of Mean Pressure Levels and Diurnal Drop. Rainy days are characterized by lower absolute pressure and a suppressed diurnal drop."</span></span>
<span id="cb34-874"><a href="#cb34-874"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb34-875"><a href="#cb34-875"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb34-876"><a href="#cb34-876"></a><span class="co">#| echo: true</span></span>
<span id="cb34-877"><a href="#cb34-877"></a><span class="co">#| warning: false</span></span>
<span id="cb34-878"><a href="#cb34-878"></a></span>
<span id="cb34-879"><a href="#cb34-879"></a>data_wide <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-880"><a href="#cb34-880"></a>  <span class="fu">group_by</span>(rain_today) <span class="sc">%&gt;%</span></span>
<span id="cb34-881"><a href="#cb34-881"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-882"><a href="#cb34-882"></a>    <span class="st">`</span><span class="at">9:00 AM</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(pressure9am, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-883"><a href="#cb34-883"></a>    <span class="st">`</span><span class="at">3:00 PM</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(pressure3pm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-884"><a href="#cb34-884"></a>    <span class="co"># Calculate positive drop (9am - 3pm)</span></span>
<span id="cb34-885"><a href="#cb34-885"></a>    <span class="st">`</span><span class="at">Pressure Drop</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(pressure9am, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span></span>
<span id="cb34-886"><a href="#cb34-886"></a>      <span class="fu">mean</span>(pressure3pm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-887"><a href="#cb34-887"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-888"><a href="#cb34-888"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>rain_today, <span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-889"><a href="#cb34-889"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-890"><a href="#cb34-890"></a>    <span class="at">metric =</span> <span class="fu">factor</span>(metric, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"9:00 AM"</span>, <span class="st">"3:00 PM"</span>, <span class="st">"Pressure Drop"</span>)),</span>
<span id="cb34-891"><a href="#cb34-891"></a>    <span class="at">label_txt =</span> <span class="fu">round</span>(value, <span class="dv">1</span>)</span>
<span id="cb34-892"><a href="#cb34-892"></a>  )</span>
<span id="cb34-893"><a href="#cb34-893"></a></span>
<span id="cb34-894"><a href="#cb34-894"></a><span class="fu">ggplot</span>(data_wide, <span class="fu">aes</span>(<span class="at">x =</span> rain_today, <span class="at">y =</span> value, <span class="at">fill =</span> rain_today)) <span class="sc">+</span></span>
<span id="cb34-895"><a href="#cb34-895"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb34-896"><a href="#cb34-896"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label_txt), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb34-897"><a href="#cb34-897"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-898"><a href="#cb34-898"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#B0B0B0"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>)) <span class="sc">+</span></span>
<span id="cb34-899"><a href="#cb34-899"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"Dry Days"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"Rainy Days"</span>)) <span class="sc">+</span></span>
<span id="cb34-900"><a href="#cb34-900"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-901"><a href="#cb34-901"></a>    <span class="at">title =</span> <span class="st">"Rainy Days Exhibit Lower Baseline Pressure and Suppressed Diurnal Variation"</span>,</span>
<span id="cb34-902"><a href="#cb34-902"></a>    <span class="at">subtitle =</span> <span class="st">"Lower absolute pressure at 9am is the key distinguishing factor"</span>,</span>
<span id="cb34-903"><a href="#cb34-903"></a>    <span class="at">y =</span> <span class="st">"Pressure (hPa) / Drop (hPa)"</span>,</span>
<span id="cb34-904"><a href="#cb34-904"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb34-905"><a href="#cb34-905"></a>  ) <span class="sc">+</span></span>
<span id="cb34-906"><a href="#cb34-906"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb34-907"><a href="#cb34-907"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-908"><a href="#cb34-908"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb34-909"><a href="#cb34-909"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-910"><a href="#cb34-910"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"grey30"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">15</span>)),</span>
<span id="cb34-911"><a href="#cb34-911"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb34-912"><a href="#cb34-912"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-913"><a href="#cb34-913"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb34-914"><a href="#cb34-914"></a>  )</span>
<span id="cb34-915"><a href="#cb34-915"></a><span class="in">```</span></span>
<span id="cb34-916"><a href="#cb34-916"></a></span>
<span id="cb34-917"><a href="#cb34-917"></a>We analyzed atmospheric pressure dynamics to determine how barometric baselines and diurnal fluctuations correlate with rainfall.</span>
<span id="cb34-918"><a href="#cb34-918"></a></span>
<span id="cb34-919"><a href="#cb34-919"></a>**1. Statistical Validity:**</span>
<span id="cb34-920"><a href="#cb34-920"></a></span>
<span id="cb34-921"><a href="#cb34-921"></a><span class="ss">-   </span>**Normality:** The Q-Q plots show that while pressure data generally follows a normal distribution, there are deviations in the tails. However, given our large sample size ($N &gt; 140,000$), the Central Limit Theorem ensures the validity of parametric testing.</span>
<span id="cb34-922"><a href="#cb34-922"></a><span class="ss">-   </span>**Significance:** Welch’s t-test confirms that all pressure metrics are significantly different between dry and rainy days ($p &lt; 0.001$).</span>
<span id="cb34-923"><a href="#cb34-923"></a></span>
<span id="cb34-924"><a href="#cb34-924"></a>**2. Key Findings:**</span>
<span id="cb34-925"><a href="#cb34-925"></a></span>
<span id="cb34-926"><a href="#cb34-926"></a><span class="ss">-   </span>**Baseline Pressure:** Rainy days are characterized by significantly lower atmospheric pressure. As shown in @fig-pressure-means, the mean pressure at 9:00 AM is **1015 hPa for rainy days** compared to **1018.5 hPa for dry days**. This aligns with the meteorological principle that low-pressure systems facilitate cloud formation and precipitation.</span>
<span id="cb34-927"><a href="#cb34-927"></a><span class="ss">-   </span>**Diurnal Drop:** We observed a distinct "suppression" effect on rainy days.</span>
<span id="cb34-928"><a href="#cb34-928"></a><span class="ss">    -   </span>**Dry Days:** Pressure drops significantly by **2.7 hPa** from morning to afternoon, driven by solar heating (thermal lows).</span>
<span id="cb34-929"><a href="#cb34-929"></a><span class="ss">    -   </span>**Rainy Days:** The drop is suppressed to just **1.3 hPa**. Cloud cover likely limits surface heating, reducing the intensity of the thermal low formation.</span>
<span id="cb34-930"><a href="#cb34-930"></a></span>
<span id="cb34-931"><a href="#cb34-931"></a>**3. Effect Size:** The Cohen's $d$ analysis reveals that the **magnitude of change** (`pressure_change`) has a **medium effect size** ($d = -0.72$), which is notably stronger than the absolute pressure readings ($d \approx 0.28-0.48$). This suggests that the *stability* of pressure (or lack thereof) during the day is a potent predictor of rainfall, potentially more so than the raw pressure reading itself.</span>
<span id="cb34-932"><a href="#cb34-932"></a></span>
<span id="cb34-933"><a href="#cb34-933"></a><span class="fu">### Seasonal Dynamics and Intensity Cycles</span></span>
<span id="cb34-934"><a href="#cb34-934"></a></span>
<span id="cb34-937"><a href="#cb34-937"></a><span class="in">```{r}</span></span>
<span id="cb34-938"><a href="#cb34-938"></a><span class="co">#| label: seasonality-prep</span></span>
<span id="cb34-939"><a href="#cb34-939"></a><span class="co">#| echo: true</span></span>
<span id="cb34-940"><a href="#cb34-940"></a><span class="co">#| message: false</span></span>
<span id="cb34-941"><a href="#cb34-941"></a><span class="co">#| warning: false</span></span>
<span id="cb34-942"><a href="#cb34-942"></a></span>
<span id="cb34-943"><a href="#cb34-943"></a><span class="co"># Calculate aggregated monthly statistics (Mean, Median, Count)</span></span>
<span id="cb34-944"><a href="#cb34-944"></a>monthly_stats <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-945"><a href="#cb34-945"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-946"><a href="#cb34-946"></a>  <span class="fu">group_by</span>(month) <span class="sc">%&gt;%</span></span>
<span id="cb34-947"><a href="#cb34-947"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-948"><a href="#cb34-948"></a>    <span class="at">median_rain =</span> <span class="fu">median</span>(rainfall),</span>
<span id="cb34-949"><a href="#cb34-949"></a>    <span class="at">mean_rain =</span> <span class="fu">mean</span>(rainfall),</span>
<span id="cb34-950"><a href="#cb34-950"></a>    <span class="at">rain_days =</span> <span class="fu">n</span>(),</span>
<span id="cb34-951"><a href="#cb34-951"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb34-952"><a href="#cb34-952"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-953"><a href="#cb34-953"></a>  <span class="fu">mutate</span>(<span class="at">month_label =</span> <span class="fu">factor</span>(month.abb[month], <span class="at">levels =</span> <span class="fu">rev</span>(month.abb)))</span>
<span id="cb34-954"><a href="#cb34-954"></a></span>
<span id="cb34-955"><a href="#cb34-955"></a><span class="co"># Prepare data for density plotting (Log transformation for skewness)</span></span>
<span id="cb34-956"><a href="#cb34-956"></a>plot_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-957"><a href="#cb34-957"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-958"><a href="#cb34-958"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-959"><a href="#cb34-959"></a>    <span class="at">month_label =</span> <span class="fu">factor</span>(month.abb[month], <span class="at">levels =</span> <span class="fu">rev</span>(month.abb)),</span>
<span id="cb34-960"><a href="#cb34-960"></a>    <span class="at">log_rain =</span> <span class="fu">log</span>(rainfall)</span>
<span id="cb34-961"><a href="#cb34-961"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-962"><a href="#cb34-962"></a>  <span class="fu">left_join</span>(monthly_stats, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"month"</span>, <span class="st">"month_label"</span>))</span>
<span id="cb34-963"><a href="#cb34-963"></a><span class="in">```</span></span>
<span id="cb34-964"><a href="#cb34-964"></a></span>
<span id="cb34-967"><a href="#cb34-967"></a><span class="in">```{r}</span></span>
<span id="cb34-968"><a href="#cb34-968"></a><span class="co">#| label: fig-monthly-dist</span></span>
<span id="cb34-969"><a href="#cb34-969"></a><span class="co">#| fig-cap: "Ridgeline Plot of Monthly Log-Rainfall Distributions. The shifting peaks illustrate how rainfall intensity varies across the year compared to the global median (dashed line)."</span></span>
<span id="cb34-970"><a href="#cb34-970"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb34-971"><a href="#cb34-971"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb34-972"><a href="#cb34-972"></a><span class="co">#| echo: true</span></span>
<span id="cb34-973"><a href="#cb34-973"></a><span class="co">#| warning: false</span></span>
<span id="cb34-974"><a href="#cb34-974"></a></span>
<span id="cb34-975"><a href="#cb34-975"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(log_rain, month_label, <span class="at">fill =</span> <span class="fu">after_stat</span>(x))) <span class="sc">+</span></span>
<span id="cb34-976"><a href="#cb34-976"></a>  <span class="fu">geom_density_ridges_gradient</span>(</span>
<span id="cb34-977"><a href="#cb34-977"></a>    <span class="at">scale =</span> <span class="fl">2.5</span>,</span>
<span id="cb34-978"><a href="#cb34-978"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.01</span>,</span>
<span id="cb34-979"><a href="#cb34-979"></a>    <span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-980"><a href="#cb34-980"></a>    <span class="at">quantiles =</span> <span class="dv">2</span>, <span class="co"># Marks the median</span></span>
<span id="cb34-981"><a href="#cb34-981"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb34-982"><a href="#cb34-982"></a>  ) <span class="sc">+</span></span>
<span id="cb34-983"><a href="#cb34-983"></a>  <span class="co"># Global Median Line for reference</span></span>
<span id="cb34-984"><a href="#cb34-984"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb34-985"><a href="#cb34-985"></a>    <span class="at">xintercept =</span> <span class="fu">median</span>(<span class="fu">log</span>(df_final<span class="sc">$</span>rainfall[df_final<span class="sc">$</span>rainfall <span class="sc">&gt;</span> <span class="dv">0</span>])),</span>
<span id="cb34-986"><a href="#cb34-986"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb34-987"><a href="#cb34-987"></a>    <span class="at">color =</span> <span class="st">"grey30"</span>,</span>
<span id="cb34-988"><a href="#cb34-988"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span></span>
<span id="cb34-989"><a href="#cb34-989"></a>  ) <span class="sc">+</span></span>
<span id="cb34-990"><a href="#cb34-990"></a>  <span class="fu">scale_fill_viridis_c</span>(</span>
<span id="cb34-991"><a href="#cb34-991"></a>    <span class="at">option =</span> <span class="st">"mako"</span>,</span>
<span id="cb34-992"><a href="#cb34-992"></a>    <span class="at">name =</span> <span class="st">"Log</span><span class="sc">\n</span><span class="st">Rainfall"</span>,</span>
<span id="cb34-993"><a href="#cb34-993"></a>    <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb34-994"><a href="#cb34-994"></a>  ) <span class="sc">+</span></span>
<span id="cb34-995"><a href="#cb34-995"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">pretty_breaks</span>()) <span class="sc">+</span></span>
<span id="cb34-996"><a href="#cb34-996"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-997"><a href="#cb34-997"></a>    <span class="at">title =</span> <span class="st">"Monthly Rainfall Distribution Patterns"</span>,</span>
<span id="cb34-998"><a href="#cb34-998"></a>    <span class="at">subtitle =</span> <span class="st">"Solid lines mark monthly medians vs. the Global Median (dashed).</span><span class="sc">\n</span><span class="st">Notice how the distribution's shape and center shift cyclically relative to the global baseline."</span>,</span>
<span id="cb34-999"><a href="#cb34-999"></a>    <span class="at">x =</span> <span class="st">"Rainfall Amount (mm, log scale)"</span>,</span>
<span id="cb34-1000"><a href="#cb34-1000"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb34-1001"><a href="#cb34-1001"></a>  ) <span class="sc">+</span></span>
<span id="cb34-1002"><a href="#cb34-1002"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span>
<span id="cb34-1003"><a href="#cb34-1003"></a><span class="in">```</span></span>
<span id="cb34-1004"><a href="#cb34-1004"></a></span>
<span id="cb34-1007"><a href="#cb34-1007"></a><span class="in">```{r}</span></span>
<span id="cb34-1008"><a href="#cb34-1008"></a><span class="co">#| label: fig-seasonal-facet</span></span>
<span id="cb34-1009"><a href="#cb34-1009"></a><span class="co">#| fig-cap: "Seasonal Rainfall Patterns separated by Meteorological Seasons. Summer months exhibit higher variance and intensity compared to Winter."</span></span>
<span id="cb34-1010"><a href="#cb34-1010"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb34-1011"><a href="#cb34-1011"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb34-1012"><a href="#cb34-1012"></a><span class="co">#| echo: true</span></span>
<span id="cb34-1013"><a href="#cb34-1013"></a><span class="co">#| warning: false</span></span>
<span id="cb34-1014"><a href="#cb34-1014"></a></span>
<span id="cb34-1015"><a href="#cb34-1015"></a><span class="co"># Assign based on the Australian seasons</span></span>
<span id="cb34-1016"><a href="#cb34-1016"></a>seasonal_data <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb34-1017"><a href="#cb34-1017"></a>  <span class="fu">filter</span>(rainfall <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-1018"><a href="#cb34-1018"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-1019"><a href="#cb34-1019"></a>    <span class="at">season =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-1020"><a href="#cb34-1020"></a>      month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">~</span> <span class="st">"Summer"</span>,</span>
<span id="cb34-1021"><a href="#cb34-1021"></a>      month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>) <span class="sc">~</span> <span class="st">"Autumn"</span>,</span>
<span id="cb34-1022"><a href="#cb34-1022"></a>      month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>) <span class="sc">~</span> <span class="st">"Winter"</span>,</span>
<span id="cb34-1023"><a href="#cb34-1023"></a>      month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>) <span class="sc">~</span> <span class="st">"Spring"</span></span>
<span id="cb34-1024"><a href="#cb34-1024"></a>    ),</span>
<span id="cb34-1025"><a href="#cb34-1025"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Summer"</span>, <span class="st">"Autumn"</span>, <span class="st">"Winter"</span>, <span class="st">"Spring"</span>))</span>
<span id="cb34-1026"><a href="#cb34-1026"></a>  )</span>
<span id="cb34-1027"><a href="#cb34-1027"></a>plot_data_seasonal <span class="ot">&lt;-</span> seasonal_data <span class="sc">%&gt;%</span></span>
<span id="cb34-1028"><a href="#cb34-1028"></a>  <span class="fu">mutate</span>(<span class="at">month_label =</span> <span class="fu">factor</span>(month.abb[month], <span class="at">levels =</span> month.abb))</span>
<span id="cb34-1029"><a href="#cb34-1029"></a></span>
<span id="cb34-1030"><a href="#cb34-1030"></a><span class="fu">ggplot</span>(plot_data_seasonal, <span class="fu">aes</span>(rainfall, month_label, <span class="at">fill =</span> season)) <span class="sc">+</span></span>
<span id="cb34-1031"><a href="#cb34-1031"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb34-1032"><a href="#cb34-1032"></a>    <span class="at">scale =</span> <span class="fl">1.5</span>,</span>
<span id="cb34-1033"><a href="#cb34-1033"></a>    <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb34-1034"><a href="#cb34-1034"></a>    <span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-1035"><a href="#cb34-1035"></a>    <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)</span>
<span id="cb34-1036"><a href="#cb34-1036"></a>  ) <span class="sc">+</span></span>
<span id="cb34-1037"><a href="#cb34-1037"></a>  <span class="fu">scale_x_log10</span>(</span>
<span id="cb34-1038"><a href="#cb34-1038"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">300</span>),</span>
<span id="cb34-1039"><a href="#cb34-1039"></a>    <span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb34-1040"><a href="#cb34-1040"></a>  ) <span class="sc">+</span></span>
<span id="cb34-1041"><a href="#cb34-1041"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb34-1042"><a href="#cb34-1042"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb34-1043"><a href="#cb34-1043"></a>      <span class="st">"Summer"</span> <span class="ot">=</span> <span class="st">"#E69F00"</span>,</span>
<span id="cb34-1044"><a href="#cb34-1044"></a>      <span class="st">"Autumn"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>,</span>
<span id="cb34-1045"><a href="#cb34-1045"></a>      <span class="st">"Winter"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>,</span>
<span id="cb34-1046"><a href="#cb34-1046"></a>      <span class="st">"Spring"</span> <span class="ot">=</span> <span class="st">"#009E73"</span></span>
<span id="cb34-1047"><a href="#cb34-1047"></a>    )</span>
<span id="cb34-1048"><a href="#cb34-1048"></a>  ) <span class="sc">+</span></span>
<span id="cb34-1049"><a href="#cb34-1049"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>season, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb34-1050"><a href="#cb34-1050"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-1051"><a href="#cb34-1051"></a>    <span class="at">title =</span> <span class="st">"Seasonal Rainfall Patterns"</span>,</span>
<span id="cb34-1052"><a href="#cb34-1052"></a>    <span class="at">subtitle =</span> <span class="st">"Quartile lines show 25th, 50th, and 75th percentiles"</span>,</span>
<span id="cb34-1053"><a href="#cb34-1053"></a>    <span class="at">x =</span> <span class="st">"Rainfall Amount (mm, log scale)"</span>,</span>
<span id="cb34-1054"><a href="#cb34-1054"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb34-1055"><a href="#cb34-1055"></a>  ) <span class="sc">+</span></span>
<span id="cb34-1056"><a href="#cb34-1056"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb34-1057"><a href="#cb34-1057"></a></span>
<span id="cb34-1058"><a href="#cb34-1058"></a><span class="in">```</span></span>
<span id="cb34-1059"><a href="#cb34-1059"></a></span>
<span id="cb34-1062"><a href="#cb34-1062"></a><span class="in">```{r}</span></span>
<span id="cb34-1063"><a href="#cb34-1063"></a><span class="co">#| label: fig-mean-rain-bar</span></span>
<span id="cb34-1064"><a href="#cb34-1064"></a><span class="co">#| fig-cap: "Average Rainfall Intensity (Non-Zero Days) by Month. Summer months (Feb/Jan) clearly exhibit higher average rainfall per event than winter months."</span></span>
<span id="cb34-1065"><a href="#cb34-1065"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb34-1066"><a href="#cb34-1066"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb34-1067"><a href="#cb34-1067"></a><span class="co">#| echo: true</span></span>
<span id="cb34-1068"><a href="#cb34-1068"></a><span class="co">#| warning: false</span></span>
<span id="cb34-1069"><a href="#cb34-1069"></a></span>
<span id="cb34-1070"><a href="#cb34-1070"></a>monthly_stats <span class="sc">%&gt;%</span></span>
<span id="cb34-1071"><a href="#cb34-1071"></a>  <span class="fu">mutate</span>(<span class="at">month_label =</span> <span class="fu">factor</span>(month.abb[month], <span class="at">levels =</span> month.abb)) <span class="sc">%&gt;%</span></span>
<span id="cb34-1072"><a href="#cb34-1072"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(month_label, mean_rain)) <span class="sc">+</span></span>
<span id="cb34-1073"><a href="#cb34-1073"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> mean_rain, <span class="at">alpha =</span> <span class="fl">0.8</span>), <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb34-1074"><a href="#cb34-1074"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb34-1075"><a href="#cb34-1075"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(mean_rain, <span class="dv">1</span>)),</span>
<span id="cb34-1076"><a href="#cb34-1076"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb34-1077"><a href="#cb34-1077"></a>    <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb34-1078"><a href="#cb34-1078"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span></span>
<span id="cb34-1079"><a href="#cb34-1079"></a>  ) <span class="sc">+</span></span>
<span id="cb34-1080"><a href="#cb34-1080"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"mako"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-1081"><a href="#cb34-1081"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-1082"><a href="#cb34-1082"></a>    <span class="at">title =</span> <span class="st">"Mean Rainfall by Month (Non-Zero Days)"</span>,</span>
<span id="cb34-1083"><a href="#cb34-1083"></a>    <span class="at">subtitle =</span> <span class="st">"Confirms seasonal variation justifying cyclical encoding"</span>,</span>
<span id="cb34-1084"><a href="#cb34-1084"></a>    <span class="at">y =</span> <span class="st">"Mean Rainfall (mm)"</span>,</span>
<span id="cb34-1085"><a href="#cb34-1085"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb34-1086"><a href="#cb34-1086"></a>  ) <span class="sc">+</span></span>
<span id="cb34-1087"><a href="#cb34-1087"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb34-1088"><a href="#cb34-1088"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-1089"><a href="#cb34-1089"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb34-1090"><a href="#cb34-1090"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"grey30"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb34-1091"><a href="#cb34-1091"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb34-1092"><a href="#cb34-1092"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-1093"><a href="#cb34-1093"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb34-1094"><a href="#cb34-1094"></a>  )</span>
<span id="cb34-1095"><a href="#cb34-1095"></a><span class="in">```</span></span>
<span id="cb34-1096"><a href="#cb34-1096"></a></span>
<span id="cb34-1097"><a href="#cb34-1097"></a>While our earlier contingency analysis focused on the *frequency* of rainfall events, this section investigates the *intensity* of rainfall when it does occur.</span>
<span id="cb34-1098"><a href="#cb34-1098"></a></span>
<span id="cb34-1099"><a href="#cb34-1099"></a>**1. Cyclical Shifts in Intensity:** The ridgeline analysis reveals a clear cyclical pattern in rainfall distribution relative to the global median.</span>
<span id="cb34-1100"><a href="#cb34-1100"></a></span>
<span id="cb34-1101"><a href="#cb34-1101"></a><span class="ss">-   </span>**Summer Peaks:** The distributions for January and February are visibly shifted to the right of the global median (dashed line), indicating that summer storms, while potentially less frequent, are significantly more intense.</span>
<span id="cb34-1102"><a href="#cb34-1102"></a><span class="ss">-   </span>**Winter Consistency:** In contrast, winter months (June-August) show distributions clustered tightly around lower rainfall values.</span>
<span id="cb34-1103"><a href="#cb34-1103"></a></span>
<span id="cb34-1104"><a href="#cb34-1104"></a>**2. Seasonal Variance:** Segmenting the data by season clarifies the mechanism:</span>
<span id="cb34-1105"><a href="#cb34-1105"></a></span>
<span id="cb34-1106"><a href="#cb34-1106"></a><span class="ss">-   </span>**Summer (Gold):** Characterized by high variance and "fat tails" extending to <span class="sc">\&gt;</span>100mm. The interquartile range (IQR) is wider, reflecting the sporadic nature of convective summer storms.</span>
<span id="cb34-1107"><a href="#cb34-1107"></a><span class="ss">-   </span>**Winter (Blue):** Characterized by narrower, peaked distributions. The rainfall is consistent but generally lighter, typical of frontal systems.</span>
<span id="cb34-1108"><a href="#cb34-1108"></a></span>
<span id="cb34-1109"><a href="#cb34-1109"></a>**3. Mean Intensity Confirmation:** The bar chart quantifies this observation. February records the highest average rainfall per wet day (**10.1 mm**), nearly double that of July (**4.9 mm**). This stark contrast confirms that <span class="in">`Month`</span> carries critical information not just about *whether* it will rain, but *how hard*.</span>
<span id="cb34-1110"><a href="#cb34-1110"></a></span>
<span id="cb34-1111"><a href="#cb34-1111"></a>**Modeling Implication:** Because the relationship between Month 12 (Dec) and Month 1 (Jan) is continuous rather than categorical, treating `Month` as a standard factor may lose information. These plots strongly support using **Cyclical Encoding (Sine/Cosine transformation)** for the <span class="in">`Month`</span> variable in our final model to mathematically capture this smooth, wave-like transition from summer peaks to winter troughs.</span>
<span id="cb34-1112"><a href="#cb34-1112"></a></span>
<span id="cb34-1113"><a href="#cb34-1113"></a><span class="fu">### Statistical Validation of Seasonal Intensity</span></span>
<span id="cb34-1114"><a href="#cb34-1114"></a></span>
<span id="cb34-1117"><a href="#cb34-1117"></a><span class="in">```{r}</span></span>
<span id="cb34-1118"><a href="#cb34-1118"></a><span class="co">#| label: seasonal-descriptive-stats</span></span>
<span id="cb34-1119"><a href="#cb34-1119"></a><span class="co">#| echo: true</span></span>
<span id="cb34-1120"><a href="#cb34-1120"></a><span class="co">#| message: false</span></span>
<span id="cb34-1121"><a href="#cb34-1121"></a></span>
<span id="cb34-1122"><a href="#cb34-1122"></a><span class="co"># Calculate Mean and SD for each season to establish baseline differences</span></span>
<span id="cb34-1123"><a href="#cb34-1123"></a>seasonal_stats <span class="ot">&lt;-</span> seasonal_data <span class="sc">%&gt;%</span></span>
<span id="cb34-1124"><a href="#cb34-1124"></a>  <span class="fu">select</span>(season, rainfall) <span class="sc">%&gt;%</span></span>
<span id="cb34-1125"><a href="#cb34-1125"></a>  <span class="fu">group_by</span>(season) <span class="sc">%&gt;%</span></span>
<span id="cb34-1126"><a href="#cb34-1126"></a>  <span class="fu">get_summary_stats</span>(rainfall, <span class="at">type =</span> <span class="st">"mean_sd"</span>)</span>
<span id="cb34-1127"><a href="#cb34-1127"></a></span>
<span id="cb34-1128"><a href="#cb34-1128"></a>seasonal_stats <span class="sc">%&gt;%</span></span>
<span id="cb34-1129"><a href="#cb34-1129"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-1130"><a href="#cb34-1130"></a>    <span class="at">caption =</span> <span class="st">"Descriptive Statistics of Rainfall Intensity by Season"</span>,</span>
<span id="cb34-1131"><a href="#cb34-1131"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Season"</span>, <span class="st">"Variable"</span>, <span class="st">"N (Events)"</span>, <span class="st">"Mean (mm)"</span>, <span class="st">"SD (mm)"</span>)</span>
<span id="cb34-1132"><a href="#cb34-1132"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-1133"><a href="#cb34-1133"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-1134"><a href="#cb34-1134"></a><span class="in">```</span></span>
<span id="cb34-1135"><a href="#cb34-1135"></a></span>
<span id="cb34-1138"><a href="#cb34-1138"></a><span class="in">```{r}</span></span>
<span id="cb34-1139"><a href="#cb34-1139"></a><span class="co">#| label: kruskal-wallis-test</span></span>
<span id="cb34-1140"><a href="#cb34-1140"></a><span class="co">#| echo: true</span></span>
<span id="cb34-1141"><a href="#cb34-1141"></a><span class="co">#| message: false</span></span>
<span id="cb34-1142"><a href="#cb34-1142"></a></span>
<span id="cb34-1143"><a href="#cb34-1143"></a><span class="co"># Kruskal-Wallis Test</span></span>
<span id="cb34-1144"><a href="#cb34-1144"></a></span>
<span id="cb34-1145"><a href="#cb34-1145"></a>kw_result <span class="ot">&lt;-</span> <span class="fu">kruskal_test</span>(rainfall <span class="sc">~</span> season, <span class="at">data =</span> seasonal_data)</span>
<span id="cb34-1146"><a href="#cb34-1146"></a></span>
<span id="cb34-1147"><a href="#cb34-1147"></a><span class="co"># Effect Size (Epsilon-squared)</span></span>
<span id="cb34-1148"><a href="#cb34-1148"></a>epsilon_sq <span class="ot">&lt;-</span> <span class="fu">kruskal_effsize</span>(rainfall <span class="sc">~</span> season, <span class="at">data =</span> seasonal_data)</span>
<span id="cb34-1149"><a href="#cb34-1149"></a></span>
<span id="cb34-1150"><a href="#cb34-1150"></a>kw_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb34-1151"><a href="#cb34-1151"></a>  <span class="at">Test =</span> <span class="st">"Kruskal-Wallis Rank Sum Test"</span>,</span>
<span id="cb34-1152"><a href="#cb34-1152"></a>  <span class="st">`</span><span class="at">Chi-squared</span><span class="st">`</span> <span class="ot">=</span> kw_result<span class="sc">$</span>statistic,</span>
<span id="cb34-1153"><a href="#cb34-1153"></a>  <span class="at">df =</span> kw_result<span class="sc">$</span>df,</span>
<span id="cb34-1154"><a href="#cb34-1154"></a>  <span class="st">`</span><span class="at">P-value</span><span class="st">`</span> <span class="ot">=</span> kw_result<span class="sc">$</span>p,</span>
<span id="cb34-1155"><a href="#cb34-1155"></a>  <span class="st">`</span><span class="at">Effect Size</span><span class="st">`</span> <span class="ot">=</span> epsilon_sq<span class="sc">$</span>effsize,</span>
<span id="cb34-1156"><a href="#cb34-1156"></a>  <span class="at">Magnitude =</span> <span class="fu">as.character</span>(epsilon_sq<span class="sc">$</span>magnitude)</span>
<span id="cb34-1157"><a href="#cb34-1157"></a>)</span>
<span id="cb34-1158"><a href="#cb34-1158"></a></span>
<span id="cb34-1159"><a href="#cb34-1159"></a>kw_summary <span class="sc">%&gt;%</span></span>
<span id="cb34-1160"><a href="#cb34-1160"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-1161"><a href="#cb34-1161"></a>    <span class="st">`</span><span class="at">Chi-squared</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">Chi-squared</span><span class="st">`</span>, <span class="dv">2</span>),</span>
<span id="cb34-1162"><a href="#cb34-1162"></a>    <span class="st">`</span><span class="at">Effect Size</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">Effect Size</span><span class="st">`</span>, <span class="dv">4</span>),</span>
<span id="cb34-1163"><a href="#cb34-1163"></a>    <span class="st">`</span><span class="at">P-value</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(<span class="st">`</span><span class="at">P-value</span><span class="st">`</span>, <span class="at">accuracy =</span> <span class="fl">0.001</span>)</span>
<span id="cb34-1164"><a href="#cb34-1164"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-1165"><a href="#cb34-1165"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-1166"><a href="#cb34-1166"></a>    <span class="at">caption =</span> <span class="st">"Statistical Significance of Seasonal Differences (Non-Parametric)"</span>,</span>
<span id="cb34-1167"><a href="#cb34-1167"></a>    <span class="at">align =</span> <span class="st">"lccccr"</span></span>
<span id="cb34-1168"><a href="#cb34-1168"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-1169"><a href="#cb34-1169"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb34-1170"><a href="#cb34-1170"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb34-1171"><a href="#cb34-1171"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-1172"><a href="#cb34-1172"></a>    <span class="at">position =</span> <span class="st">"left"</span></span>
<span id="cb34-1173"><a href="#cb34-1173"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-1174"><a href="#cb34-1174"></a>  <span class="fu">add_footnote</span>(</span>
<span id="cb34-1175"><a href="#cb34-1175"></a>    <span class="fu">c</span>(</span>
<span id="cb34-1176"><a href="#cb34-1176"></a>      <span class="st">"Effect size measured by Epsilon-squared."</span>,</span>
<span id="cb34-1177"><a href="#cb34-1177"></a>      <span class="st">"Significance level: alpha = 0.05"</span></span>
<span id="cb34-1178"><a href="#cb34-1178"></a>    ),</span>
<span id="cb34-1179"><a href="#cb34-1179"></a>    <span class="at">notation =</span> <span class="st">"symbol"</span></span>
<span id="cb34-1180"><a href="#cb34-1180"></a>  )</span>
<span id="cb34-1181"><a href="#cb34-1181"></a><span class="in">```</span></span>
<span id="cb34-1182"><a href="#cb34-1182"></a></span>
<span id="cb34-1185"><a href="#cb34-1185"></a><span class="in">```{r}</span></span>
<span id="cb34-1186"><a href="#cb34-1186"></a><span class="co">#| label: dunns-test</span></span>
<span id="cb34-1187"><a href="#cb34-1187"></a><span class="co">#| echo: true</span></span>
<span id="cb34-1188"><a href="#cb34-1188"></a><span class="co">#| message: false</span></span>
<span id="cb34-1189"><a href="#cb34-1189"></a></span>
<span id="cb34-1190"><a href="#cb34-1190"></a><span class="co"># Pairwise comparisons using Dunn's test with Bonferroni correction</span></span>
<span id="cb34-1191"><a href="#cb34-1191"></a>dunn_result <span class="ot">&lt;-</span> <span class="fu">dunn_test</span>(</span>
<span id="cb34-1192"><a href="#cb34-1192"></a>  rainfall <span class="sc">~</span> season,</span>
<span id="cb34-1193"><a href="#cb34-1193"></a>  <span class="at">data =</span> seasonal_data,</span>
<span id="cb34-1194"><a href="#cb34-1194"></a>  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span></span>
<span id="cb34-1195"><a href="#cb34-1195"></a>)</span>
<span id="cb34-1196"><a href="#cb34-1196"></a></span>
<span id="cb34-1197"><a href="#cb34-1197"></a>dunn_result <span class="sc">%&gt;%</span></span>
<span id="cb34-1198"><a href="#cb34-1198"></a>  <span class="fu">select</span>(group1, group2, statistic, p.adj, p.adj.signif) <span class="sc">%&gt;%</span></span>
<span id="cb34-1199"><a href="#cb34-1199"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-1200"><a href="#cb34-1200"></a>    <span class="at">caption =</span> <span class="st">"Dunn's Pairwise Comparison Test (Bonferroni Corrected)"</span>,</span>
<span id="cb34-1201"><a href="#cb34-1201"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb34-1202"><a href="#cb34-1202"></a>      <span class="st">"Group 1"</span>,</span>
<span id="cb34-1203"><a href="#cb34-1203"></a>      <span class="st">"Group 2"</span>,</span>
<span id="cb34-1204"><a href="#cb34-1204"></a>      <span class="st">"Z-Statistic"</span>,</span>
<span id="cb34-1205"><a href="#cb34-1205"></a>      <span class="st">"Adj. P-Value"</span>,</span>
<span id="cb34-1206"><a href="#cb34-1206"></a>      <span class="st">"Significance"</span></span>
<span id="cb34-1207"><a href="#cb34-1207"></a>    )</span>
<span id="cb34-1208"><a href="#cb34-1208"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-1209"><a href="#cb34-1209"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-1210"><a href="#cb34-1210"></a><span class="in">```</span></span>
<span id="cb34-1211"><a href="#cb34-1211"></a></span>
<span id="cb34-1214"><a href="#cb34-1214"></a><span class="in">```{r}</span></span>
<span id="cb34-1215"><a href="#cb34-1215"></a><span class="co">#| label: fig-seasonal-stat-groups</span></span>
<span id="cb34-1216"><a href="#cb34-1216"></a><span class="co">#| fig-cap: "Mean Seasonal Rainfall with Statistical Groupings. Letters (a, b, c) indicate significant differences based on Dunn's test (p &lt; 0.05). Seasons sharing the same letter are statistically indistinguishable."</span></span>
<span id="cb34-1217"><a href="#cb34-1217"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb34-1218"><a href="#cb34-1218"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb34-1219"><a href="#cb34-1219"></a><span class="co">#| echo: true</span></span>
<span id="cb34-1220"><a href="#cb34-1220"></a><span class="co">#| warning: false</span></span>
<span id="cb34-1221"><a href="#cb34-1221"></a></span>
<span id="cb34-1222"><a href="#cb34-1222"></a><span class="co"># Generate Compact Letter Display (CLD)</span></span>
<span id="cb34-1223"><a href="#cb34-1223"></a><span class="co"># Extract p-values and name them by comparison pair</span></span>
<span id="cb34-1224"><a href="#cb34-1224"></a>p_vals <span class="ot">&lt;-</span> dunn_result<span class="sc">$</span>p.adj</span>
<span id="cb34-1225"><a href="#cb34-1225"></a><span class="fu">names</span>(p_vals) <span class="ot">&lt;-</span> <span class="fu">paste</span>(dunn_result<span class="sc">$</span>group1, dunn_result<span class="sc">$</span>group2, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb34-1226"><a href="#cb34-1226"></a></span>
<span id="cb34-1227"><a href="#cb34-1227"></a><span class="co"># Generate letters (eg, 'a', 'b', 'ab')</span></span>
<span id="cb34-1228"><a href="#cb34-1228"></a>letters_vec <span class="ot">&lt;-</span> <span class="fu">multcompLetters</span>(p_vals)<span class="sc">$</span>Letters</span>
<span id="cb34-1229"><a href="#cb34-1229"></a></span>
<span id="cb34-1230"><a href="#cb34-1230"></a><span class="co"># Create annotation dataframe</span></span>
<span id="cb34-1231"><a href="#cb34-1231"></a>letters_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-1232"><a href="#cb34-1232"></a>  <span class="at">season =</span> <span class="fu">names</span>(letters_vec),</span>
<span id="cb34-1233"><a href="#cb34-1233"></a>  <span class="at">Letter =</span> letters_vec</span>
<span id="cb34-1234"><a href="#cb34-1234"></a>)</span>
<span id="cb34-1235"><a href="#cb34-1235"></a></span>
<span id="cb34-1236"><a href="#cb34-1236"></a><span class="co"># Aggregation for Plotting</span></span>
<span id="cb34-1237"><a href="#cb34-1237"></a>plot_data <span class="ot">&lt;-</span> seasonal_data <span class="sc">%&gt;%</span></span>
<span id="cb34-1238"><a href="#cb34-1238"></a>  <span class="fu">group_by</span>(season) <span class="sc">%&gt;%</span></span>
<span id="cb34-1239"><a href="#cb34-1239"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-1240"><a href="#cb34-1240"></a>    <span class="at">mean_rain =</span> <span class="fu">mean</span>(rainfall, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-1241"><a href="#cb34-1241"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb34-1242"><a href="#cb34-1242"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-1243"><a href="#cb34-1243"></a>  <span class="fu">left_join</span>(letters_df, <span class="at">by =</span> <span class="st">"season"</span>)</span>
<span id="cb34-1244"><a href="#cb34-1244"></a></span>
<span id="cb34-1245"><a href="#cb34-1245"></a></span>
<span id="cb34-1246"><a href="#cb34-1246"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> mean_rain, <span class="at">fill =</span> season)) <span class="sc">+</span></span>
<span id="cb34-1247"><a href="#cb34-1247"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb34-1248"><a href="#cb34-1248"></a>  <span class="co"># Add Statistical Letters</span></span>
<span id="cb34-1249"><a href="#cb34-1249"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Letter), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb34-1250"><a href="#cb34-1250"></a>  <span class="co"># Add Mean Values</span></span>
<span id="cb34-1251"><a href="#cb34-1251"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb34-1252"><a href="#cb34-1252"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(mean_rain, <span class="dv">1</span>)),</span>
<span id="cb34-1253"><a href="#cb34-1253"></a>    <span class="at">vjust =</span> <span class="fl">1.5</span>,</span>
<span id="cb34-1254"><a href="#cb34-1254"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb34-1255"><a href="#cb34-1255"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb34-1256"><a href="#cb34-1256"></a>    <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb34-1257"><a href="#cb34-1257"></a>  ) <span class="sc">+</span></span>
<span id="cb34-1258"><a href="#cb34-1258"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb34-1259"><a href="#cb34-1259"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb34-1260"><a href="#cb34-1260"></a>      <span class="st">"Summer"</span> <span class="ot">=</span> <span class="st">"#E69F00"</span>,</span>
<span id="cb34-1261"><a href="#cb34-1261"></a>      <span class="st">"Autumn"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>,</span>
<span id="cb34-1262"><a href="#cb34-1262"></a>      <span class="st">"Winter"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>,</span>
<span id="cb34-1263"><a href="#cb34-1263"></a>      <span class="st">"Spring"</span> <span class="ot">=</span> <span class="st">"#009E73"</span></span>
<span id="cb34-1264"><a href="#cb34-1264"></a>    )</span>
<span id="cb34-1265"><a href="#cb34-1265"></a>  ) <span class="sc">+</span></span>
<span id="cb34-1266"><a href="#cb34-1266"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-1267"><a href="#cb34-1267"></a>    <span class="at">title =</span> <span class="st">"Seasonal Rainfall with Statistical Groupings"</span>,</span>
<span id="cb34-1268"><a href="#cb34-1268"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(</span>
<span id="cb34-1269"><a href="#cb34-1269"></a>      <span class="st">"Kruskal-Wallis: p &lt; 0.001, Effect Size: %s</span><span class="sc">\n</span><span class="st">Seasons sharing a letter are not significantly different."</span>,</span>
<span id="cb34-1270"><a href="#cb34-1270"></a>      <span class="fu">as.character</span>(epsilon_sq<span class="sc">$</span>magnitude)</span>
<span id="cb34-1271"><a href="#cb34-1271"></a>    ),</span>
<span id="cb34-1272"><a href="#cb34-1272"></a>    <span class="at">y =</span> <span class="st">"Mean Rainfall (mm)"</span>,</span>
<span id="cb34-1273"><a href="#cb34-1273"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb34-1274"><a href="#cb34-1274"></a>  ) <span class="sc">+</span></span>
<span id="cb34-1275"><a href="#cb34-1275"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb34-1276"><a href="#cb34-1276"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-1277"><a href="#cb34-1277"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb34-1278"><a href="#cb34-1278"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb34-1279"><a href="#cb34-1279"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb34-1280"><a href="#cb34-1280"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb34-1281"><a href="#cb34-1281"></a>  )</span>
<span id="cb34-1282"><a href="#cb34-1282"></a><span class="in">```</span></span>
<span id="cb34-1283"><a href="#cb34-1283"></a></span>
<span id="cb34-1284"><a href="#cb34-1284"></a>To robustly confirm the seasonal patterns observed in the exploratory phase, we employed non-parametric statistical testing. The Kruskal-Wallis test was selected over ANOVA due to the skewed, non-normal distribution of rainfall data.</span>
<span id="cb34-1285"><a href="#cb34-1285"></a></span>
<span id="cb34-1286"><a href="#cb34-1286"></a>**1. Global Significance:** The Kruskal-Wallis test yields a highly significant result ($\chi^2 = 230, p &lt; 0.001$). This confirms that the differences in rainfall intensity across seasons are not due to random chance. However, the effect size ($\eta^2 \approx 0.004$) is classified as "small," suggesting that while season is a significant predictor, it explains a minor portion of the total variance in rainfall intensity (implying other factors like location and pressure are also critical).</span>
<span id="cb34-1287"><a href="#cb34-1287"></a></span>
<span id="cb34-1288"><a href="#cb34-1288"></a>**2. Pairwise Comparisons (Post-Hoc Analysis):** The Dunn’s test with Bonferroni correction reveals three distinct statistical groups, visualized in @fig-seasonal-stat-groups :</span>
<span id="cb34-1289"><a href="#cb34-1289"></a></span>
<span id="cb34-1290"><a href="#cb34-1290"></a><span class="ss">-   </span>**Group 'a' (Summer):** Significantly the wettest season ($Mean = 9.1mm$). It stands alone, statistically distinct from all other seasons ($p &lt; 0.001$).</span>
<span id="cb34-1291"><a href="#cb34-1291"></a><span class="ss">-   </span>**Group 'b' (Autumn &amp; Spring):** These transition seasons are statistically indistinguishable from each other ($p = 1.0$). Their mean intensities ($6.7mm$ and $5.7mm$) represent a middle ground.</span>
<span id="cb34-1292"><a href="#cb34-1292"></a><span class="ss">-   </span>**Group 'c' (Winter):** Significantly the driest season in terms of intensity ($Mean = 5.5mm$). While visually close to Spring, the statistical test confirms a significant difference ($p_{adj} = 0.026$).</span>
<span id="cb34-1293"><a href="#cb34-1293"></a></span>
<span id="cb34-1294"><a href="#cb34-1294"></a>**Modeling Recommendation:** These statistical groupings suggest that we might simplify the model by grouping Autumn and Spring together, or more robustly, using **Cyclical Encoding** (sine/cosine of Month) which naturally handles the smooth transition from the "Peak" (Summer) through the "Transition" (Autumn/Spring) to the "Trough" (Winter).</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/blob/main/03-eda.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>