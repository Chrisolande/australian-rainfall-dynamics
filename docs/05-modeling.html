<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="An in-depth statistical analysis of rainfall patterns across 49 Australian cities using Zero-Inflated Gamma GLMMs.">

<title>5&nbsp; Modelling – Australian Rainfall Dynamics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-evaluation.html" rel="next">
<link href="./04-features.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-9eae319670a971b7aedd265dafd44b4f.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-e66b50aa4120364bfa72329fe8653b98.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-9eae319670a971b7aedd265dafd44b4f.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c16d967f7cb0c9f8ebae126fb3a45419.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-463e05341c278a50bd9d8b9e5c352418.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-c16d967f7cb0c9f8ebae126fb3a45419.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-modeling.html">Modelling</a></li><li class="breadcrumb-item"><a href="./05-modeling.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelling</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Australian Rainfall Dynamics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predicting Australian Rainfall</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Data</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-data-prep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Preparation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Feature Engineering</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-features.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Feature Engineering</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Modelling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-modeling.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model Evaluation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-model-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Model Selection</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#a-progressive-zero-inflated-gamma-framework-for-australian-rainfall" id="toc-a-progressive-zero-inflated-gamma-framework-for-australian-rainfall" class="nav-link active" data-scroll-target="#a-progressive-zero-inflated-gamma-framework-for-australian-rainfall"><span class="header-section-number">5.1</span> A Progressive Zero-Inflated Gamma Framework for Australian Rainfall</a></li>
  <li><a href="#model-architecture" id="toc-model-architecture" class="nav-link" data-scroll-target="#model-architecture"><span class="header-section-number">5.2</span> Model Architecture</a></li>
  <li><a href="#model-0-null-baseline" id="toc-model-0-null-baseline" class="nav-link" data-scroll-target="#model-0-null-baseline"><span class="header-section-number">5.3</span> Model 0: Null Baseline</a></li>
  <li><a href="#model-1-moisture-and-pressure-dynamics" id="toc-model-1-moisture-and-pressure-dynamics" class="nav-link" data-scroll-target="#model-1-moisture-and-pressure-dynamics"><span class="header-section-number">5.4</span> Model 1: Moisture and Pressure Dynamics</a></li>
  <li><a href="#model-2-seasonality-and-day-to-day-persistence" id="toc-model-2-seasonality-and-day-to-day-persistence" class="nav-link" data-scroll-target="#model-2-seasonality-and-day-to-day-persistence"><span class="header-section-number">5.5</span> Model 2: Seasonality and Day-to-Day Persistence</a></li>
  <li><a href="#model-3-accumulated-weather-history" id="toc-model-3-accumulated-weather-history" class="nav-link" data-scroll-target="#model-3-accumulated-weather-history"><span class="header-section-number">5.6</span> Model 3: Accumulated Weather History</a></li>
  <li><a href="#model-4-thermodynamic-energy-and-the-rain-corner-interaction" id="toc-model-4-thermodynamic-energy-and-the-rain-corner-interaction" class="nav-link" data-scroll-target="#model-4-thermodynamic-energy-and-the-rain-corner-interaction"><span class="header-section-number">5.7</span> Model 4: Thermodynamic Energy and the Rain Corner Interaction</a></li>
  <li><a href="#model-5-wind-vector-dynamics" id="toc-model-5-wind-vector-dynamics" class="nav-link" data-scroll-target="#model-5-wind-vector-dynamics"><span class="header-section-number">5.8</span> Model 5: Wind Vector Dynamics</a></li>
  <li><a href="#model-6-spatial-heterogeneity-via-mixed-effects" id="toc-model-6-spatial-heterogeneity-via-mixed-effects" class="nav-link" data-scroll-target="#model-6-spatial-heterogeneity-via-mixed-effects"><span class="header-section-number">5.9</span> Model 6: Spatial Heterogeneity via Mixed Effects</a></li>
  <li><a href="#progressive-model-comparison" id="toc-progressive-model-comparison" class="nav-link" data-scroll-target="#progressive-model-comparison"><span class="header-section-number">5.10</span> Progressive Model Comparison</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/blob/main/05-modeling.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-modeling.html">Modelling</a></li><li class="breadcrumb-item"><a href="./05-modeling.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelling</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelling</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="a-progressive-zero-inflated-gamma-framework-for-australian-rainfall" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="a-progressive-zero-inflated-gamma-framework-for-australian-rainfall"><span class="header-section-number">5.1</span> A Progressive Zero-Inflated Gamma Framework for Australian Rainfall</h2>
<hr>
<blockquote class="blockquote">
<p><strong>Chapter Context.</strong> This chapter constructs the statistical model incrementally, beginning from a null baseline and introducing successive layers of physical complexity. Each model corresponds to a coherent hypothesis about the mechanisms driving Australian rainfall, tested against its predecessor via likelihood-based criteria. The model family Zero-Inflated Gamma (ZIG) was selected in direct response to the distributional findings from the EDA: the 64% zero-inflation rate and extreme positive skew of the rainfall distribution make a single-component Gaussian model fundamentally inappropriate.</p>
</blockquote>
<hr>
</section>
<section id="model-architecture" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="model-architecture"><span class="header-section-number">5.2</span> Model Architecture</h2>
<p>A Zero-Inflated Gamma model is a two-component mixture. The first component, the zero-inflation submodel, is a logistic regression that estimates the probability of a structurally zero outcome, a dry day on which no precipitation occurs regardless of atmospheric conditions. The second component, the conditional intensity submodel, is a Gamma regression (with log link) that models the expected rainfall given that rain does fall. Together they answer the two questions identified in the <a href="03-eda.html" class="quarto-xref"><span>Chapter 3</span></a>: “Will it rain?” and “If so, how much?”</p>
<p>Formally, for observation <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[P(Y_i = 0) = \pi_i + (1 - \pi_i) \cdot f_\Gamma(0)\]</span> <span class="math display">\[P(Y_i = y) = (1 - \pi_i) \cdot f_\Gamma(y \mid \mu_i, \phi), \quad y &gt; 0\]</span></p>
<p>where <span class="math inline">\(\pi_i = \text{logit}^{-1}(\mathbf{z}_i^\top \boldsymbol{\gamma})\)</span> is the zero-inflation probability and <span class="math inline">\(\mu_i = \exp(\mathbf{x}_i^\top \boldsymbol{\beta})\)</span> is the conditional mean intensity. The two linear predictors, <span class="math inline">\(\mathbf{z}_i\)</span> and <span class="math inline">\(\mathbf{x}_i\)</span>, can include different sets of covariates, allowing predictors of <em>occurrence</em> to differ from predictors of <em>intensity</em>. All models were fitted using <code>glmmTMB</code>, which implements maximum likelihood estimation for this family via the Template Model Builder.</p>
<p>Progressive model construction serves two purposes. It provides a transparent audit trail connecting each modelling decision to its empirical motivation. It also enables incremental comparison: each model can be evaluated against its predecessor to isolate the contribution of the newly added component.</p>
<hr>
</section>
<section id="model-0-null-baseline" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="model-0-null-baseline"><span class="header-section-number">5.3</span> Model 0: Null Baseline</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>m0_null <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb1-2"><a href="#cb1-2"></a>  <span class="at">formula =</span> rainfall <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="at">ziformula =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="at">data =</span> df_scaled</span>
<span id="cb1-6"><a href="#cb1-6"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">tab_model</span>(</span>
<span id="cb2-2"><a href="#cb2-2"></a>  m0_null,</span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="at">show.se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="at">show.aic =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="at">transform =</span> <span class="st">"exp"</span>,</span>
<span id="cb2-6"><a href="#cb2-6"></a>  <span class="at">collapse.se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="at">p.style =</span> <span class="st">"numeric_stars"</span>,</span>
<span id="cb2-8"><a href="#cb2-8"></a>  <span class="at">string.pred =</span> <span class="st">"Parameter"</span>,</span>
<span id="cb2-9"><a href="#cb2-9"></a>  <span class="at">string.est =</span> <span class="st">"Estimate (Exp)"</span>,</span>
<span id="cb2-10"><a href="#cb2-10"></a>  <span class="at">dv.labels =</span> <span class="st">"Baseline Rainfall Model"</span>,</span>
<span id="cb2-11"><a href="#cb2-11"></a>  <span class="at">title =</span> <span class="st">"Table 1: Baseline Zero-Inflated Gamma Model (Intercept Only)"</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Table 1: Baseline Zero-Inflated Gamma Model (Intercept Only)</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Baseline Rainfall Model</th>
<td></td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Parameter</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimate (Exp)</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
<td></td>
</tr>
<tr class="odd">
<td colspan="5" style="text-align: left; font-weight: bold; padding-top: .8em;">Count Model</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">6.57 <sup>***</sup><br>
(0.04)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">6.49&nbsp;–&nbsp;6.65</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">3.94 <sup></sup><br>
(NA)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">3.91&nbsp;–&nbsp;3.97</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td></td>
</tr>
<tr class="even">
<td colspan="4" style="text-align: left; font-weight: bold; padding-top: .8em;">Zero-Inflated Model</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.78 <sup>***</sup><br>
(0.01)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.76&nbsp;–&nbsp;1.80</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">141856</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> Nagelkerke</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.000</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">AIC</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">461669.678</td>
<td></td>
</tr>
<tr class="odd">
<td colspan="4" style="text-align: right; font-style: italic; border-top: double black;">* p&lt;0.05&nbsp;&nbsp;&nbsp;** p&lt;0.01&nbsp;&nbsp;&nbsp;*** p&lt;0.001</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Before introducing any covariates, we fit an intercept-only model whose sole purpose is to verify that the model structure correctly recovers the fundamental statistical properties of the dataset. A null model that fails this basic calibration check would call into question the validity of all subsequent extensions.</p>
<p>The zero-inflation intercept <span class="math inline">\(\hat{\beta}_{zi} = 0.5769\)</span> back-transforms through the logistic function to an implied dry-day probability of:</p>
<p><span class="math display">\[\hat{P}(\text{Dry}) = \frac{e^{0.5769}}{1 + e^{0.5769}} \approx 64.03\%\]</span></p>
<p>This matches the empirically observed zero-inflation rate of 64.05% to within a rounding error, confirming that the hurdle mechanism is correctly calibrated to the data-generating process. The conditional intensity intercept <span class="math inline">\(\hat{\beta}_{cond} = 1.8825\)</span> recovers a mean rainy-day intensity of <span class="math inline">\(e^{1.8825} \approx 6.57\)</span> mm, consistent with the non-zero mean established in the EDA.</p>
<p>This model yields AIC = 461,669.7, serving as the reference against which all subsequent gains are measured.</p>
<hr>
</section>
<section id="model-1-moisture-and-pressure-dynamics" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="model-1-moisture-and-pressure-dynamics"><span class="header-section-number">5.4</span> Model 1: Moisture and Pressure Dynamics</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>m1_moisture <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb3-2"><a href="#cb3-2"></a>  m0_null,</span>
<span id="cb3-3"><a href="#cb3-3"></a>  . <span class="sc">~</span> . <span class="sc">+</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> dewpoint_change <span class="sc">+</span> pressure_change,</span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span> dewpoint_9am</span>
<span id="cb3-5"><a href="#cb3-5"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="ipbncaaros" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ipbncaaros table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ipbncaaros thead, #ipbncaaros tbody, #ipbncaaros tfoot, #ipbncaaros tr, #ipbncaaros td, #ipbncaaros th {
  border-style: none;
}

#ipbncaaros p {
  margin: 0;
  padding: 0;
}

#ipbncaaros .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ipbncaaros .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ipbncaaros .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ipbncaaros .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ipbncaaros .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ipbncaaros .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ipbncaaros .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ipbncaaros .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ipbncaaros .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ipbncaaros .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ipbncaaros .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ipbncaaros .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ipbncaaros .gt_spanner_row {
  border-bottom-style: hidden;
}

#ipbncaaros .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ipbncaaros .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ipbncaaros .gt_from_md > :first-child {
  margin-top: 0;
}

#ipbncaaros .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ipbncaaros .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ipbncaaros .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ipbncaaros .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ipbncaaros .gt_row_group_first td {
  border-top-width: 2px;
}

#ipbncaaros .gt_row_group_first th {
  border-top-width: 2px;
}

#ipbncaaros .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ipbncaaros .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ipbncaaros .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ipbncaaros .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ipbncaaros .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ipbncaaros .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ipbncaaros .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ipbncaaros .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ipbncaaros .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ipbncaaros .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ipbncaaros .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ipbncaaros .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ipbncaaros .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ipbncaaros .gt_left {
  text-align: left;
}

#ipbncaaros .gt_center {
  text-align: center;
}

#ipbncaaros .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ipbncaaros .gt_font_normal {
  font-weight: normal;
}

#ipbncaaros .gt_font_bold {
  font-weight: bold;
}

#ipbncaaros .gt_font_italic {
  font-style: italic;
}

#ipbncaaros .gt_super {
  font-size: 65%;
}

#ipbncaaros .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ipbncaaros .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ipbncaaros .gt_indent_1 {
  text-indent: 5px;
}

#ipbncaaros .gt_indent_2 {
  text-indent: 10px;
}

#ipbncaaros .gt_indent_3 {
  text-indent: 15px;
}

#ipbncaaros .gt_indent_4 {
  text-indent: 20px;
}

#ipbncaaros .gt_indent_5 {
  text-indent: 25px;
}

#ipbncaaros .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ipbncaaros div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<caption><strong>Model 1: Moisture and Pressure Dynamics</strong></caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Predictor</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>exp(Beta)</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="4" id="cond" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">cond</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="cond  label">Humidity (3pm)</td>
<td class="gt_row gt_center" headers="cond  estimate">1.46</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.44, 1.48</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Dewpoint (9am)</td>
<td class="gt_row gt_center" headers="cond  estimate">1.48</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.46, 1.49</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Dewpoint Change (Delta)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.91</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.90, 0.92</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Pressure Change (Delta)</td>
<td class="gt_row gt_center" headers="cond  estimate">1.28</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.26, 1.29</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row even">
<th colspan="4" id="zi" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">zi</th>
</tr>
<tr class="gt_row_group_first odd">
<td class="gt_row gt_left" headers="zi  label">Humidity (3pm)</td>
<td class="gt_row gt_center" headers="zi  estimate">0.34</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.34, 0.35</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">Dewpoint (9am)</td>
<td class="gt_row gt_center" headers="zi  estimate">1.00</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.99, 1.01</td>
<td class="gt_row gt_center" headers="zi  p.value">&gt;0.9</td>
</tr>
<tr class="gt_group_heading_row odd">
<th colspan="4" id="NA" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">NA</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="NA  label" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">AIC</td>
<td class="gt_row gt_center" headers="NA  estimate" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">422,630</td>
<td class="gt_row gt_center" headers="NA  conf.low" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NA  label">BIC</td>
<td class="gt_row gt_center" headers="NA  estimate">422,719</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="NA  label">Log-likelihood</td>
<td class="gt_row gt_center" headers="NA  estimate">-211,306</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>The correlation analysis identified afternoon humidity and sunshine as the two strongest individual predictors of rainfall, and the pressure analysis established that both baseline level and diurnal change carry discriminating signal. Model 1 formalises these findings by introducing the four most physically direct atmospheric drivers into the conditional intensity submodel, and a subset of moisture indicators into the zero-inflation submodel.</p>
<p>The AIC falls from 461,669.7 to 422,630, a reduction of approximately 39069.7 points, the largest single improvement in the entire model sequence. This magnitude confirms that atmospheric moisture and pressure dynamics are not merely correlated with rainfall but are its fundamental predictive substrate.</p>
<p>All four predictors in the conditional model are highly significant (<span class="math inline">\(p &lt; 2 \times 10^{-16}\)</span>). The positive coefficients for <code>humidity3pm</code> (<span class="math inline">\(\hat{\beta} = 0.38\)</span>) and <code>dewpoint_9am</code> (<span class="math inline">\(\hat{\beta} = 0.38\)</span>) indicate that both relative saturation of the afternoon air and the absolute moisture content of the morning atmosphere independently increase rainfall intensity when rain does occur.</p>
<p>The zero-inflation submodel reveals a meaningful asymmetry between the two moisture variables. <code>humidity3pm</code> carries a coefficient of <span class="math inline">\(-1.07\)</span>: the negative sign reflects the logistic parameterisation, where larger values reduce the probability of a <em>dry</em> outcome, so higher humidity strongly increases the probability of rain. <code>dewpoint_9am</code>, by contrast, is not significant in the zero-inflation component (<span class="math inline">\(p = 0.907\)</span>). This dissociation suggests that it is the relative saturation of the afternoon atmosphere that determines whether the threshold for precipitation is crossed, while the absolute morning moisture content shapes the intensity of rainfall once it occurs.</p>
<hr>
</section>
<section id="model-2-seasonality-and-day-to-day-persistence" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="model-2-seasonality-and-day-to-day-persistence"><span class="header-section-number">5.5</span> Model 2: Seasonality and Day-to-Day Persistence</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>m2_temporal <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb4-2"><a href="#cb4-2"></a>  m1_moisture,</span>
<span id="cb4-3"><a href="#cb4-3"></a>  . <span class="sc">~</span> . <span class="sc">+</span> day_cos <span class="sc">+</span> day_sin,</span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>    pressure_change</span>
<span id="cb4-9"><a href="#cb4-9"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="brcblabgvy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#brcblabgvy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#brcblabgvy thead, #brcblabgvy tbody, #brcblabgvy tfoot, #brcblabgvy tr, #brcblabgvy td, #brcblabgvy th {
  border-style: none;
}

#brcblabgvy p {
  margin: 0;
  padding: 0;
}

#brcblabgvy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#brcblabgvy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#brcblabgvy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#brcblabgvy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#brcblabgvy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#brcblabgvy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#brcblabgvy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#brcblabgvy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#brcblabgvy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#brcblabgvy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#brcblabgvy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#brcblabgvy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#brcblabgvy .gt_spanner_row {
  border-bottom-style: hidden;
}

#brcblabgvy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#brcblabgvy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#brcblabgvy .gt_from_md > :first-child {
  margin-top: 0;
}

#brcblabgvy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#brcblabgvy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#brcblabgvy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#brcblabgvy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#brcblabgvy .gt_row_group_first td {
  border-top-width: 2px;
}

#brcblabgvy .gt_row_group_first th {
  border-top-width: 2px;
}

#brcblabgvy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#brcblabgvy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#brcblabgvy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#brcblabgvy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#brcblabgvy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#brcblabgvy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#brcblabgvy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#brcblabgvy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#brcblabgvy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#brcblabgvy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#brcblabgvy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#brcblabgvy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#brcblabgvy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#brcblabgvy .gt_left {
  text-align: left;
}

#brcblabgvy .gt_center {
  text-align: center;
}

#brcblabgvy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#brcblabgvy .gt_font_normal {
  font-weight: normal;
}

#brcblabgvy .gt_font_bold {
  font-weight: bold;
}

#brcblabgvy .gt_font_italic {
  font-style: italic;
}

#brcblabgvy .gt_super {
  font-size: 65%;
}

#brcblabgvy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#brcblabgvy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#brcblabgvy .gt_indent_1 {
  text-indent: 5px;
}

#brcblabgvy .gt_indent_2 {
  text-indent: 10px;
}

#brcblabgvy .gt_indent_3 {
  text-indent: 15px;
}

#brcblabgvy .gt_indent_4 {
  text-indent: 20px;
}

#brcblabgvy .gt_indent_5 {
  text-indent: 25px;
}

#brcblabgvy .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#brcblabgvy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<caption><strong>Model 2: Seasonality and Persistence Effects</strong></caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Predictor</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>exp(Beta)</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="4" id="cond" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">cond</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="cond  label">humidity3pm</td>
<td class="gt_row gt_center" headers="cond  estimate">1.48</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.45, 1.50</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="cond  estimate">1.48</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.46, 1.51</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">dewpoint_change</td>
<td class="gt_row gt_center" headers="cond  estimate">0.91</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.89, 0.92</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Pressure Change</td>
<td class="gt_row gt_center" headers="cond  estimate">1.28</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.26, 1.29</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Seasonality (Cos)</td>
<td class="gt_row gt_center" headers="cond  estimate">1.02</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.00, 1.03</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">0.016</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Seasonality (Sin)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.95</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.94, 0.96</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row even">
<th colspan="4" id="zi" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">zi</th>
</tr>
<tr class="gt_row_group_first odd">
<td class="gt_row gt_left" headers="zi  label">humidity3pm</td>
<td class="gt_row gt_center" headers="zi  estimate">0.42</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.41, 0.42</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="zi  estimate">0.92</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.91, 0.94</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">Pressure Change</td>
<td class="gt_row gt_center" headers="zi  estimate">0.60</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.60, 0.61</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">Rain Yesterday (Persistence)</td>
<td class="gt_row gt_center" headers="zi  estimate"><br>
</td>
<td class="gt_row gt_center" headers="zi  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="zi  p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="zi  estimate">0.24</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.24, 0.25</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">Cloud Development</td>
<td class="gt_row gt_center" headers="zi  estimate">1.09</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.08, 1.11</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row odd">
<th colspan="4" id="NA" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">NA</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="NA  label" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">AIC</td>
<td class="gt_row gt_center" headers="NA  estimate" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">406,826</td>
<td class="gt_row gt_center" headers="NA  conf.low" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NA  label">BIC</td>
<td class="gt_row gt_center" headers="NA  estimate">406,964</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Having established moisture and pressure as foundational drivers, Model 2 incorporates the temporal structure identified in the EDA (<a href="03-eda.html" class="quarto-xref"><span>Chapter 3</span></a>). The Markov Chain analysis (<a href="03-eda.html#sec-markov" class="quarto-xref"><span>Section 3.5.2</span></a>) demonstrated that yesterday’s rain state carries a moderate but practically significant effect (<span class="math inline">\(V \approx 0.31\)</span>), and the seasonal analysis confirmed that both frequency and intensity of rainfall follow a smooth annual cycle. Cyclical sine/cosine encoding enters the conditional model, while <code>rain_yesterday</code>, <code>cloud_development</code>, and <code>pressure_change</code> are added to the zero-inflation component.</p>
<p>AIC falls to 406,826 (<span class="math inline">\(\Delta\text{AIC} \approx 15,804\)</span> relative to Model 1), confirming that temporal context when in the year and what happened the day before contributes substantial predictive information beyond the instantaneous atmospheric state.</p>
<p>Both seasonal components are highly significant, providing statistical confirmation of the cyclical pattern documented in the EDA(<a href="03-eda.html" class="quarto-xref"><span>Chapter 3</span></a>). The continuous circular encoding correctly captures the smooth transition between the winter trough and the summer peak rather than imposing an arbitrary step at the calendar year boundary.</p>
<p>The most striking result is the persistence coefficient. At <span class="math inline">\(\hat{\beta}_{zi} = -1.42\)</span> in the zero-inflation component, it is the strongest predictor in the hurdle submodel across the entire model sequence. Exponentiating gives <span class="math inline">\(e^{-1.42} \approx 0.24\)</span>: having rained yesterday reduces the odds of today being dry by approximately 76%. This quantifies the asymmetric persistence documented in the Markov transition matrix wet states are more likely to continue than to terminate.</p>
<hr>
</section>
<section id="model-3-accumulated-weather-history" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="model-3-accumulated-weather-history"><span class="header-section-number">5.6</span> Model 3: Accumulated Weather History</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>m3_history <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb5-2"><a href="#cb5-2"></a>  m2_temporal,</span>
<span id="cb5-3"><a href="#cb5-3"></a>  . <span class="sc">~</span> . <span class="sc">+</span> rainfall_ma7 <span class="sc">+</span> days_since_rain <span class="sc">+</span> humidity_ma7 <span class="sc">+</span> rain_yesterday,</span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>    pressure_change</span>
<span id="cb5-9"><a href="#cb5-9"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="ffaxtqbkhk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ffaxtqbkhk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ffaxtqbkhk thead, #ffaxtqbkhk tbody, #ffaxtqbkhk tfoot, #ffaxtqbkhk tr, #ffaxtqbkhk td, #ffaxtqbkhk th {
  border-style: none;
}

#ffaxtqbkhk p {
  margin: 0;
  padding: 0;
}

#ffaxtqbkhk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ffaxtqbkhk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ffaxtqbkhk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ffaxtqbkhk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ffaxtqbkhk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ffaxtqbkhk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ffaxtqbkhk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ffaxtqbkhk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ffaxtqbkhk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ffaxtqbkhk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ffaxtqbkhk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ffaxtqbkhk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ffaxtqbkhk .gt_spanner_row {
  border-bottom-style: hidden;
}

#ffaxtqbkhk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ffaxtqbkhk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ffaxtqbkhk .gt_from_md > :first-child {
  margin-top: 0;
}

#ffaxtqbkhk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ffaxtqbkhk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ffaxtqbkhk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ffaxtqbkhk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ffaxtqbkhk .gt_row_group_first td {
  border-top-width: 2px;
}

#ffaxtqbkhk .gt_row_group_first th {
  border-top-width: 2px;
}

#ffaxtqbkhk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ffaxtqbkhk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ffaxtqbkhk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ffaxtqbkhk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ffaxtqbkhk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ffaxtqbkhk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ffaxtqbkhk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ffaxtqbkhk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ffaxtqbkhk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ffaxtqbkhk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ffaxtqbkhk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ffaxtqbkhk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ffaxtqbkhk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ffaxtqbkhk .gt_left {
  text-align: left;
}

#ffaxtqbkhk .gt_center {
  text-align: center;
}

#ffaxtqbkhk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ffaxtqbkhk .gt_font_normal {
  font-weight: normal;
}

#ffaxtqbkhk .gt_font_bold {
  font-weight: bold;
}

#ffaxtqbkhk .gt_font_italic {
  font-style: italic;
}

#ffaxtqbkhk .gt_super {
  font-size: 65%;
}

#ffaxtqbkhk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ffaxtqbkhk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ffaxtqbkhk .gt_indent_1 {
  text-indent: 5px;
}

#ffaxtqbkhk .gt_indent_2 {
  text-indent: 10px;
}

#ffaxtqbkhk .gt_indent_3 {
  text-indent: 15px;
}

#ffaxtqbkhk .gt_indent_4 {
  text-indent: 20px;
}

#ffaxtqbkhk .gt_indent_5 {
  text-indent: 25px;
}

#ffaxtqbkhk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ffaxtqbkhk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<caption><strong>Model 3: Accumulated Weather History</strong></caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Predictor</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>exp(Beta)</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="4" id="cond" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">cond</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="cond  label">humidity3pm</td>
<td class="gt_row gt_center" headers="cond  estimate">1.47</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.45, 1.50</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="cond  estimate">1.42</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.40, 1.44</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">dewpoint_change</td>
<td class="gt_row gt_center" headers="cond  estimate">0.89</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.88, 0.90</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">pressure_change</td>
<td class="gt_row gt_center" headers="cond  estimate">1.27</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.25, 1.28</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">day_cos</td>
<td class="gt_row gt_center" headers="cond  estimate">1.01</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.00, 1.03</td>
<td class="gt_row gt_center" headers="cond  p.value">0.10</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">day_sin</td>
<td class="gt_row gt_center" headers="cond  estimate">0.95</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.93, 0.96</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Rainfall Trend (7-Day MA)</td>
<td class="gt_row gt_center" headers="cond  estimate">1.14</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.12, 1.15</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Dry Spell Length (Days)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.99</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.98, 1.00</td>
<td class="gt_row gt_center" headers="cond  p.value">0.13</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Humidity Trend (7-Day MA)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.90</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.89, 0.92</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Rain Yesterday (Indicator)</td>
<td class="gt_row gt_center" headers="cond  estimate"><br>
</td>
<td class="gt_row gt_center" headers="cond  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="cond  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="cond  estimate">1.36</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.33, 1.40</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row odd">
<th colspan="4" id="zi" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">zi</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="zi  label">humidity3pm</td>
<td class="gt_row gt_center" headers="zi  estimate">0.42</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.41, 0.42</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="zi  estimate">0.92</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.91, 0.94</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">pressure_change</td>
<td class="gt_row gt_center" headers="zi  estimate">0.60</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.60, 0.61</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">Rain Yesterday (Indicator)</td>
<td class="gt_row gt_center" headers="zi  estimate"><br>
</td>
<td class="gt_row gt_center" headers="zi  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="zi  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="zi  estimate">0.24</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.24, 0.25</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">cloud_development</td>
<td class="gt_row gt_center" headers="zi  estimate">1.09</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.08, 1.11</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row even">
<th colspan="4" id="NA" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">NA</th>
</tr>
<tr class="gt_row_group_first odd">
<td class="gt_row gt_left" headers="NA  label" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">AIC</td>
<td class="gt_row gt_center" headers="NA  estimate" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">405,125</td>
<td class="gt_row gt_center" headers="NA  conf.low" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="NA  label">BIC</td>
<td class="gt_row gt_center" headers="NA  estimate">405,303</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>While Model 2 captured the binary state of the previous day, it does not account for the <em>accumulated</em> atmospheric state over a longer preceding window. The dry spell analysis (<a href="03-eda.html#sec-dry-spell" class="quarto-xref"><span>Section 3.5.3</span></a>) demonstrated that rainfall probability decays as dry spells lengthen, and the moving average analysis showed that a 7-day smoothed signal substantially reduces the stochastic variance of the rainfall and humidity series. Model 3 introduces these medium-horizon history features into the conditional intensity submodel.</p>
<p>The improvement is AIC = 405,125 (<span class="math inline">\(\Delta\text{AIC} \approx 1,701\)</span> versus Model 2). This is smaller than the earlier gains, reflecting the natural diminishing returns of adding temporally redundant information once the most immediate history has been captured. The signal is nonetheless genuine.</p>
<p>The results reveal an interpretable separation between the roles of immediate and accumulated history. <code>rain_yesterday</code> in the conditional model (<span class="math inline">\(\hat{\beta} = 0.31\)</span>, <span class="math inline">\(e^{0.31} \approx 1.36\)</span>) indicates that if it rained the previous day, today’s rainfall is approximately 36% more intense on average consistent with a persisting frontal system delivering successive events of comparable severity. <code>rainfall_ma7</code> (<span class="math inline">\(\hat{\beta} = 0.13\)</span>) extends this logic to the weekly horizon: a wetter preceding week is associated with heavier current rainfall, suggesting that prolonged wet spells are symptomatic of deeper atmospheric systems rather than sequences of independent events.</p>
<p>The negative coefficient for <code>humidity_ma7</code> (<span class="math inline">\(\hat{\beta} = -0.10\)</span>) warrants careful interpretation. Conditional on all other terms, a persistently humid preceding week is associated with slightly <em>lower</em> rainfall intensity. This likely reflects a distinction between two meteorological regimes: stratiform cloud systems, which sustain high background humidity without producing intense precipitation, versus convective systems, which generate intense episodic rainfall under conditions of rapid moisture change rather than steady elevated humidity.</p>
<p>Finally, <code>days_since_rain</code> is not significant in the conditional intensity component (<span class="math inline">\(p = 0.14\)</span>). The dry spell length predicts <em>whether</em> rain occurs, but once the model knows rain is occurring, the duration of the preceding drought provides no additional information about how much will fall. This reinforces the conceptual separation between the occurrence and intensity sub-processes.</p>
<hr>
</section>
<section id="model-4-thermodynamic-energy-and-the-rain-corner-interaction" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="model-4-thermodynamic-energy-and-the-rain-corner-interaction"><span class="header-section-number">5.7</span> Model 4: Thermodynamic Energy and the Rain Corner Interaction</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>m4_energy <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb6-2"><a href="#cb6-2"></a>  m3_history,</span>
<span id="cb6-3"><a href="#cb6-3"></a>  . <span class="sc">~</span> . <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>    sunshine <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>    evaporation <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>    instability_index <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>    sun_humid_interaction <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>    cloud_development,</span>
<span id="cb6-9"><a href="#cb6-9"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>    pressure_change</span>
<span id="cb6-14"><a href="#cb6-14"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="qalxeobnda" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qalxeobnda table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qalxeobnda thead, #qalxeobnda tbody, #qalxeobnda tfoot, #qalxeobnda tr, #qalxeobnda td, #qalxeobnda th {
  border-style: none;
}

#qalxeobnda p {
  margin: 0;
  padding: 0;
}

#qalxeobnda .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qalxeobnda .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qalxeobnda .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qalxeobnda .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qalxeobnda .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qalxeobnda .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qalxeobnda .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qalxeobnda .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qalxeobnda .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qalxeobnda .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qalxeobnda .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qalxeobnda .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qalxeobnda .gt_spanner_row {
  border-bottom-style: hidden;
}

#qalxeobnda .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qalxeobnda .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qalxeobnda .gt_from_md > :first-child {
  margin-top: 0;
}

#qalxeobnda .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qalxeobnda .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qalxeobnda .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qalxeobnda .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qalxeobnda .gt_row_group_first td {
  border-top-width: 2px;
}

#qalxeobnda .gt_row_group_first th {
  border-top-width: 2px;
}

#qalxeobnda .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qalxeobnda .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qalxeobnda .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qalxeobnda .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qalxeobnda .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qalxeobnda .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qalxeobnda .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qalxeobnda .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qalxeobnda .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qalxeobnda .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qalxeobnda .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qalxeobnda .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qalxeobnda .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qalxeobnda .gt_left {
  text-align: left;
}

#qalxeobnda .gt_center {
  text-align: center;
}

#qalxeobnda .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qalxeobnda .gt_font_normal {
  font-weight: normal;
}

#qalxeobnda .gt_font_bold {
  font-weight: bold;
}

#qalxeobnda .gt_font_italic {
  font-style: italic;
}

#qalxeobnda .gt_super {
  font-size: 65%;
}

#qalxeobnda .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qalxeobnda .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qalxeobnda .gt_indent_1 {
  text-indent: 5px;
}

#qalxeobnda .gt_indent_2 {
  text-indent: 10px;
}

#qalxeobnda .gt_indent_3 {
  text-indent: 15px;
}

#qalxeobnda .gt_indent_4 {
  text-indent: 20px;
}

#qalxeobnda .gt_indent_5 {
  text-indent: 25px;
}

#qalxeobnda .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qalxeobnda div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<caption><strong>Model 4: Thermodynamic Energy and Interactions</strong></caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Predictor</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>exp(Beta)</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="4" id="cond" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">cond</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="cond  label">humidity3pm</td>
<td class="gt_row gt_center" headers="cond  estimate">1.17</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.15, 1.20</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="cond  estimate">1.44</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.42, 1.47</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">dewpoint_change</td>
<td class="gt_row gt_center" headers="cond  estimate">0.90</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.89, 0.91</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">pressure_change</td>
<td class="gt_row gt_center" headers="cond  estimate">1.31</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.30, 1.32</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">day_cos</td>
<td class="gt_row gt_center" headers="cond  estimate">0.93</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.91, 0.94</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">day_sin</td>
<td class="gt_row gt_center" headers="cond  estimate">0.94</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.93, 0.96</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">rainfall_ma7</td>
<td class="gt_row gt_center" headers="cond  estimate">1.12</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.11, 1.13</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">days_since_rain</td>
<td class="gt_row gt_center" headers="cond  estimate">0.99</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.98, 1.00</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">0.017</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">humidity_ma7</td>
<td class="gt_row gt_center" headers="cond  estimate">0.93</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.91, 0.94</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">rain_yesterday</td>
<td class="gt_row gt_center" headers="cond  estimate"><br>
</td>
<td class="gt_row gt_center" headers="cond  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="cond  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="cond  estimate">1.40</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.36, 1.43</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Sunshine Duration (Hours)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.99</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.98, 1.01</td>
<td class="gt_row gt_center" headers="cond  p.value">0.5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Evaporation Rate</td>
<td class="gt_row gt_center" headers="cond  estimate">1.15</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.13, 1.17</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Instability Index (Derived)</td>
<td class="gt_row gt_center" headers="cond  estimate">1.21</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.19, 1.22</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Interaction: Sunshine x Humidity</td>
<td class="gt_row gt_center" headers="cond  estimate">0.93</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.92, 0.94</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Cloud Development (Delta)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.98</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.97, 0.99</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row even">
<th colspan="4" id="zi" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">zi</th>
</tr>
<tr class="gt_row_group_first odd">
<td class="gt_row gt_left" headers="zi  label">humidity3pm</td>
<td class="gt_row gt_center" headers="zi  estimate">0.42</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.41, 0.42</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="zi  estimate">0.92</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.91, 0.94</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">pressure_change</td>
<td class="gt_row gt_center" headers="zi  estimate">0.60</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.60, 0.61</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">rain_yesterday</td>
<td class="gt_row gt_center" headers="zi  estimate"><br>
</td>
<td class="gt_row gt_center" headers="zi  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="zi  p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="zi  estimate">0.24</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.24, 0.25</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">Cloud Development (Delta)</td>
<td class="gt_row gt_center" headers="zi  estimate">1.09</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.08, 1.11</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row odd">
<th colspan="4" id="NA" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">NA</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="NA  label" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">AIC</td>
<td class="gt_row gt_center" headers="NA  estimate" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">403,742</td>
<td class="gt_row gt_center" headers="NA  conf.low" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NA  label">BIC</td>
<td class="gt_row gt_center" headers="NA  estimate">403,969</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>The bivariate density analysis (<a href="03-eda.html#sec-bivariate-density" class="quarto-xref"><span>Section 3.8</span></a>) identified a structural non-linearity in the joint distribution of humidity and sunshine: rain occurs almost exclusively when afternoon humidity is high and sunshine hours are simultaneously low. An additive model cannot represent this conditional structure. Model 4 introduces the multiplicative interaction term alongside the broader thermodynamic context from which it arises.</p>
<p>AIC falls to 403,742 (<span class="math inline">\(\Delta\text{AIC} \approx 1,383\)</span> versus Model 3).</p>
<p>The <code>sun_humid_interaction</code> coefficient of <span class="math inline">\(\hat{\beta} = -0.07\)</span> is highly significant and physically interpretable. The negative sign indicates that the combination of high humidity and low sunshine which, after mean-centring, produces a large negative product, is associated with heavier rainfall. This formalises the “Rain Corner” structure: neither variable alone is sufficient, but their adverse conjunction under saturated, overcast conditions is where the most intense events concentrate.</p>
<p>The entry of the interaction term also produces a marked reduction in the <code>humidity3pm</code> coefficient, from 0.39 in Model 3 to 0.16 in Model 4. This is not a loss of importance. It reflects a correct partitioning of explained variance: the portion of humidity’s effect that operates through its interaction with sunshine, and through the derived <code>instability_index</code>, is now carried by those terms. The model has moved from knowing that humidity matters to capturing the specific mechanism through which it matters.</p>
<hr>
</section>
<section id="model-5-wind-vector-dynamics" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="model-5-wind-vector-dynamics"><span class="header-section-number">5.8</span> Model 5: Wind Vector Dynamics</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>m5_wind <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb7-2"><a href="#cb7-2"></a>  m4_energy,</span>
<span id="cb7-3"><a href="#cb7-3"></a>  . <span class="sc">~</span> . <span class="sc">+</span> gust_U_EW <span class="sc">+</span> gust_V_NS <span class="sc">+</span> wind9am_V_NS <span class="sc">+</span> wind9am_U_EW,</span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>    pressure_change</span>
<span id="cb7-9"><a href="#cb7-9"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="kedzobbgrj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kedzobbgrj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kedzobbgrj thead, #kedzobbgrj tbody, #kedzobbgrj tfoot, #kedzobbgrj tr, #kedzobbgrj td, #kedzobbgrj th {
  border-style: none;
}

#kedzobbgrj p {
  margin: 0;
  padding: 0;
}

#kedzobbgrj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kedzobbgrj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kedzobbgrj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kedzobbgrj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kedzobbgrj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kedzobbgrj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kedzobbgrj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kedzobbgrj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kedzobbgrj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kedzobbgrj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kedzobbgrj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kedzobbgrj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kedzobbgrj .gt_spanner_row {
  border-bottom-style: hidden;
}

#kedzobbgrj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kedzobbgrj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kedzobbgrj .gt_from_md > :first-child {
  margin-top: 0;
}

#kedzobbgrj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kedzobbgrj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kedzobbgrj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kedzobbgrj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kedzobbgrj .gt_row_group_first td {
  border-top-width: 2px;
}

#kedzobbgrj .gt_row_group_first th {
  border-top-width: 2px;
}

#kedzobbgrj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kedzobbgrj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kedzobbgrj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kedzobbgrj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kedzobbgrj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kedzobbgrj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kedzobbgrj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kedzobbgrj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kedzobbgrj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kedzobbgrj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kedzobbgrj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kedzobbgrj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kedzobbgrj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kedzobbgrj .gt_left {
  text-align: left;
}

#kedzobbgrj .gt_center {
  text-align: center;
}

#kedzobbgrj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kedzobbgrj .gt_font_normal {
  font-weight: normal;
}

#kedzobbgrj .gt_font_bold {
  font-weight: bold;
}

#kedzobbgrj .gt_font_italic {
  font-style: italic;
}

#kedzobbgrj .gt_super {
  font-size: 65%;
}

#kedzobbgrj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kedzobbgrj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kedzobbgrj .gt_indent_1 {
  text-indent: 5px;
}

#kedzobbgrj .gt_indent_2 {
  text-indent: 10px;
}

#kedzobbgrj .gt_indent_3 {
  text-indent: 15px;
}

#kedzobbgrj .gt_indent_4 {
  text-indent: 20px;
}

#kedzobbgrj .gt_indent_5 {
  text-indent: 25px;
}

#kedzobbgrj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kedzobbgrj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<caption><strong>Model 5: Wind Vector Dynamics</strong></caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Predictor</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>exp(Beta)</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="4" id="cond" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">cond</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="cond  label">humidity3pm</td>
<td class="gt_row gt_center" headers="cond  estimate">1.16</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.13, 1.18</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="cond  estimate">1.48</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.46, 1.51</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">dewpoint_change</td>
<td class="gt_row gt_center" headers="cond  estimate">0.90</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.89, 0.92</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">pressure_change</td>
<td class="gt_row gt_center" headers="cond  estimate">1.25</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.24, 1.26</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">day_cos</td>
<td class="gt_row gt_center" headers="cond  estimate">0.92</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.90, 0.93</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">day_sin</td>
<td class="gt_row gt_center" headers="cond  estimate">0.94</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.93, 0.95</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">rainfall_ma7</td>
<td class="gt_row gt_center" headers="cond  estimate">1.11</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.10, 1.12</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">days_since_rain</td>
<td class="gt_row gt_center" headers="cond  estimate">0.98</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.97, 0.99</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">humidity_ma7</td>
<td class="gt_row gt_center" headers="cond  estimate">0.93</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.91, 0.94</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">rain_yesterday</td>
<td class="gt_row gt_center" headers="cond  estimate"><br>
</td>
<td class="gt_row gt_center" headers="cond  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="cond  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="cond  estimate">1.39</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.35, 1.42</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">sunshine</td>
<td class="gt_row gt_center" headers="cond  estimate">0.99</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.97, 1.01</td>
<td class="gt_row gt_center" headers="cond  p.value">0.3</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">evaporation</td>
<td class="gt_row gt_center" headers="cond  estimate">1.15</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.13, 1.17</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">instability_index</td>
<td class="gt_row gt_center" headers="cond  estimate">1.23</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.21, 1.25</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">sun_humid_interaction</td>
<td class="gt_row gt_center" headers="cond  estimate">0.93</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.92, 0.94</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">cloud_development</td>
<td class="gt_row gt_center" headers="cond  estimate">0.98</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.97, 0.99</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Gust Vector (East-West)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.97</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.96, 0.98</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Gust Vector (North-South)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.98</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.96, 0.99</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Wind 9am Vector (North-South)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.91</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.90, 0.92</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Wind 9am Vector (East-West)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.93</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.92, 0.94</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row even">
<th colspan="4" id="zi" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">zi</th>
</tr>
<tr class="gt_row_group_first odd">
<td class="gt_row gt_left" headers="zi  label">humidity3pm</td>
<td class="gt_row gt_center" headers="zi  estimate">0.42</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.41, 0.42</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="zi  estimate">0.92</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.91, 0.94</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">pressure_change</td>
<td class="gt_row gt_center" headers="zi  estimate">0.60</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.60, 0.61</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">rain_yesterday</td>
<td class="gt_row gt_center" headers="zi  estimate"><br>
</td>
<td class="gt_row gt_center" headers="zi  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="zi  p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="zi  estimate">0.24</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.24, 0.25</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">cloud_development</td>
<td class="gt_row gt_center" headers="zi  estimate">1.09</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.08, 1.11</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row odd">
<th colspan="4" id="NA" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">NA</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="NA  label" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">AIC</td>
<td class="gt_row gt_center" headers="NA  estimate" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">403,141</td>
<td class="gt_row gt_center" headers="NA  conf.low" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NA  label">BIC</td>
<td class="gt_row gt_center" headers="NA  estimate">403,408</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Model 5 tests whether the directional origin of air masses provides additional predictive information about rainfall intensity beyond the instantaneous atmospheric state. Wind direction is encoded as orthogonal U and V vector components, as developed in the feature engineering chapter, to preserve the circular geometry of directional data.</p>
<p>AIC falls to 403,141 (<span class="math inline">\(\Delta\text{AIC} \approx 601\)</span> versus Model 4). The improvement is the smallest in the sequence, but given the large sample size and the physical plausibility of the effects, the additional wind information is retained.</p>
<p>The most informative coefficients are those for the 9:00 AM wind vectors. <code>wind9am_V_NS</code> (<span class="math inline">\(\hat{\beta} = -0.094\)</span>) is negative, indicating that southerly airflow increases rainfall intensity. This is consistent with the “Southerly Buster” phenomenon, in which cool moisture-laden air from the Southern Ocean penetrates northward along the eastern seaboard. <code>wind9am_U_EW</code> (<span class="math inline">\(\hat{\beta} = -0.073\)</span>) similarly indicates that westerly airflow increases intensity, consistent with the “Roaring Forties” the band of persistent westerly winds at southern latitudes that deliver moisture from the Indian Ocean.</p>
<p>The morning wind vectors have coefficients approximately three to four times larger than their peak gust counterparts. This confirms that the prevailing direction of the air mass at the start of the day reflecting the broader synoptic circulation pattern is more informative than turbulent gusts associated with active storm cells. The storm’s provenance matters more than its local expression.</p>
<p>Coefficients for previously established predictors remain stable across this extension, confirming that the wind vectors explain variance genuinely unaccounted for by earlier components rather than displacing existing effects through collinearity.</p>
<hr>
</section>
<section id="model-6-spatial-heterogeneity-via-mixed-effects" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="model-6-spatial-heterogeneity-via-mixed-effects"><span class="header-section-number">5.9</span> Model 6: Spatial Heterogeneity via Mixed Effects</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>re_data <span class="ot">&lt;-</span> <span class="fu">select_model_features</span>(df_final, <span class="at">keep_location =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">scale_data</span>()</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">glmmTMBControl</span>(</span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="at">optimizer =</span> optim,</span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="at">optArgs =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">"BFGS"</span>),</span>
<span id="cb8-7"><a href="#cb8-7"></a>  <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxit =</span> <span class="dv">1000</span>)</span>
<span id="cb8-8"><a href="#cb8-8"></a>)</span>
<span id="cb8-9"><a href="#cb8-9"></a></span>
<span id="cb8-10"><a href="#cb8-10"></a>m6_mixed <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb8-11"><a href="#cb8-11"></a>  rainfall <span class="sc">~</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>    humidity3pm <span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>    dewpoint_change <span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>    pressure_change <span class="sc">+</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>    day_cos <span class="sc">+</span></span>
<span id="cb8-17"><a href="#cb8-17"></a>    day_sin <span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>    rainfall_ma7 <span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19"></a>    days_since_rain <span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20"></a>    humidity_ma7 <span class="sc">+</span></span>
<span id="cb8-21"><a href="#cb8-21"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb8-22"><a href="#cb8-22"></a>    sunshine <span class="sc">+</span></span>
<span id="cb8-23"><a href="#cb8-23"></a>    evaporation <span class="sc">+</span></span>
<span id="cb8-24"><a href="#cb8-24"></a>    instability_index <span class="sc">+</span></span>
<span id="cb8-25"><a href="#cb8-25"></a>    sun_humid_interaction <span class="sc">+</span></span>
<span id="cb8-26"><a href="#cb8-26"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb8-27"><a href="#cb8-27"></a>    gust_U_EW <span class="sc">+</span></span>
<span id="cb8-28"><a href="#cb8-28"></a>    gust_V_NS <span class="sc">+</span></span>
<span id="cb8-29"><a href="#cb8-29"></a>    wind9am_V_NS <span class="sc">+</span></span>
<span id="cb8-30"><a href="#cb8-30"></a>    wind9am_U_EW <span class="sc">+</span></span>
<span id="cb8-31"><a href="#cb8-31"></a>    <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">+</span> humidity3pm <span class="sc">+</span> rain_yesterday <span class="sc">+</span> dewpoint_change <span class="sc">|</span> location),</span>
<span id="cb8-32"><a href="#cb8-32"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb8-33"><a href="#cb8-33"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb8-34"><a href="#cb8-34"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb8-35"><a href="#cb8-35"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb8-36"><a href="#cb8-36"></a>    pressure_change <span class="sc">+</span></span>
<span id="cb8-37"><a href="#cb8-37"></a>    sunshine <span class="sc">+</span></span>
<span id="cb8-38"><a href="#cb8-38"></a>    evaporation <span class="sc">+</span></span>
<span id="cb8-39"><a href="#cb8-39"></a>    <span class="fu">ns</span>(days_since_rain, <span class="at">df =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb8-40"><a href="#cb8-40"></a>    humidity_ma7 <span class="sc">+</span></span>
<span id="cb8-41"><a href="#cb8-41"></a>    day_cos <span class="sc">+</span></span>
<span id="cb8-42"><a href="#cb8-42"></a>    day_sin,</span>
<span id="cb8-43"><a href="#cb8-43"></a>  <span class="at">data =</span> re_data,</span>
<span id="cb8-44"><a href="#cb8-44"></a>  <span class="at">control =</span> ctrl,</span>
<span id="cb8-45"><a href="#cb8-45"></a>  <span class="at">family =</span> <span class="fu">ziGamma</span>(<span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb8-46"><a href="#cb8-46"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="vupyvxxhjz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vupyvxxhjz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vupyvxxhjz thead, #vupyvxxhjz tbody, #vupyvxxhjz tfoot, #vupyvxxhjz tr, #vupyvxxhjz td, #vupyvxxhjz th {
  border-style: none;
}

#vupyvxxhjz p {
  margin: 0;
  padding: 0;
}

#vupyvxxhjz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vupyvxxhjz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vupyvxxhjz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vupyvxxhjz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vupyvxxhjz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vupyvxxhjz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vupyvxxhjz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vupyvxxhjz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vupyvxxhjz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vupyvxxhjz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vupyvxxhjz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vupyvxxhjz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vupyvxxhjz .gt_spanner_row {
  border-bottom-style: hidden;
}

#vupyvxxhjz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vupyvxxhjz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vupyvxxhjz .gt_from_md > :first-child {
  margin-top: 0;
}

#vupyvxxhjz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vupyvxxhjz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vupyvxxhjz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vupyvxxhjz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vupyvxxhjz .gt_row_group_first td {
  border-top-width: 2px;
}

#vupyvxxhjz .gt_row_group_first th {
  border-top-width: 2px;
}

#vupyvxxhjz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vupyvxxhjz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vupyvxxhjz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vupyvxxhjz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vupyvxxhjz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vupyvxxhjz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vupyvxxhjz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vupyvxxhjz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vupyvxxhjz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vupyvxxhjz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vupyvxxhjz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vupyvxxhjz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vupyvxxhjz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vupyvxxhjz .gt_left {
  text-align: left;
}

#vupyvxxhjz .gt_center {
  text-align: center;
}

#vupyvxxhjz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vupyvxxhjz .gt_font_normal {
  font-weight: normal;
}

#vupyvxxhjz .gt_font_bold {
  font-weight: bold;
}

#vupyvxxhjz .gt_font_italic {
  font-style: italic;
}

#vupyvxxhjz .gt_super {
  font-size: 65%;
}

#vupyvxxhjz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vupyvxxhjz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vupyvxxhjz .gt_indent_1 {
  text-indent: 5px;
}

#vupyvxxhjz .gt_indent_2 {
  text-indent: 10px;
}

#vupyvxxhjz .gt_indent_3 {
  text-indent: 15px;
}

#vupyvxxhjz .gt_indent_4 {
  text-indent: 20px;
}

#vupyvxxhjz .gt_indent_5 {
  text-indent: 25px;
}

#vupyvxxhjz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vupyvxxhjz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<caption><strong>Model 6: Final Mixed-Effects Model (Random Slopes)</strong></caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Predictor</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>exp(Beta)</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="4" id="cond" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">cond</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="cond  label">Humidity (3pm)</td>
<td class="gt_row gt_center" headers="cond  estimate">1.20</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.14, 1.26</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="cond  estimate">1.36</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.33, 1.40</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">dewpoint_change</td>
<td class="gt_row gt_center" headers="cond  estimate">0.87</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.84, 0.90</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">pressure_change</td>
<td class="gt_row gt_center" headers="cond  estimate">1.29</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.27, 1.30</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Seasonality (Cos)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.95</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.93, 0.97</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Seasonality (Sin)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.95</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.94, 0.97</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Rainfall Trend (7-Day MA)</td>
<td class="gt_row gt_center" headers="cond  estimate">1.06</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.05, 1.07</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Dry Spell Length (Linear)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.98</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.97, 0.99</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">humidity_ma7</td>
<td class="gt_row gt_center" headers="cond  estimate">0.97</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.95, 0.99</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">0.006</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Rain Yesterday (Indicator)</td>
<td class="gt_row gt_center" headers="cond  estimate"><br>
</td>
<td class="gt_row gt_center" headers="cond  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="cond  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="cond  estimate">1.35</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.30, 1.41</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Sunshine Duration</td>
<td class="gt_row gt_center" headers="cond  estimate">0.99</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.98, 1.01</td>
<td class="gt_row gt_center" headers="cond  p.value">0.3</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">evaporation</td>
<td class="gt_row gt_center" headers="cond  estimate">1.11</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.09, 1.13</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Instability Index</td>
<td class="gt_row gt_center" headers="cond  estimate">1.26</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.24, 1.28</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Interaction: Sunshine x Humidity</td>
<td class="gt_row gt_center" headers="cond  estimate">0.93</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.92, 0.95</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">cloud_development</td>
<td class="gt_row gt_center" headers="cond  estimate">0.98</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.97, 0.99</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Gust Vector (East-West)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.92</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.91, 0.94</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Gust Vector (North-South)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.99</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.97, 1.00</td>
<td class="gt_row gt_center" headers="cond  p.value">0.079</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">wind9am_V_NS</td>
<td class="gt_row gt_center" headers="cond  estimate">0.92</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.90, 0.93</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">wind9am_U_EW</td>
<td class="gt_row gt_center" headers="cond  estimate">0.95</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.93, 0.96</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row even">
<th colspan="4" id="zi" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">zi</th>
</tr>
<tr class="gt_row_group_first odd">
<td class="gt_row gt_left" headers="zi  label">Humidity (3pm)</td>
<td class="gt_row gt_center" headers="zi  estimate">0.61</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.59, 0.62</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="zi  estimate">0.70</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.69, 0.72</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">pressure_change</td>
<td class="gt_row gt_center" headers="zi  estimate">0.56</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.56, 0.57</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">Seasonality (Cos)</td>
<td class="gt_row gt_center" headers="zi  estimate">1.12</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.10, 1.14</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">Seasonality (Sin)</td>
<td class="gt_row gt_center" headers="zi  estimate">1.19</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.18, 1.21</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">humidity_ma7</td>
<td class="gt_row gt_center" headers="zi  estimate">0.87</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.85, 0.88</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">Rain Yesterday (Indicator)</td>
<td class="gt_row gt_center" headers="zi  estimate"><br>
</td>
<td class="gt_row gt_center" headers="zi  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="zi  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="zi  estimate">0.27</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.26, 0.27</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">Sunshine Duration</td>
<td class="gt_row gt_center" headers="zi  estimate">1.30</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.28, 1.32</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">evaporation</td>
<td class="gt_row gt_center" headers="zi  estimate">1.38</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.35, 1.41</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">cloud_development</td>
<td class="gt_row gt_center" headers="zi  estimate">1.07</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.06, 1.09</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">ns(days_since_rain, df = 4)</td>
<td class="gt_row gt_center" headers="zi  estimate"><br>
</td>
<td class="gt_row gt_center" headers="zi  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="zi  p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;ns(days_since_rain, df = 4)1</td>
<td class="gt_row gt_center" headers="zi  estimate">0.98</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.92, 1.04</td>
<td class="gt_row gt_center" headers="zi  p.value">0.5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;ns(days_since_rain, df = 4)2</td>
<td class="gt_row gt_center" headers="zi  estimate">1.09</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.02, 1.18</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">0.016</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;ns(days_since_rain, df = 4)3</td>
<td class="gt_row gt_center" headers="zi  estimate">1.00</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.87, 1.15</td>
<td class="gt_row gt_center" headers="zi  p.value">&gt;0.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;ns(days_since_rain, df = 4)4</td>
<td class="gt_row gt_center" headers="zi  estimate">0.94</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.84, 1.05</td>
<td class="gt_row gt_center" headers="zi  p.value">0.2</td>
</tr>
<tr class="gt_group_heading_row odd">
<th colspan="4" id="NA" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">NA</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="NA  label" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">AIC</td>
<td class="gt_row gt_center" headers="NA  estimate" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">396,638</td>
<td class="gt_row gt_center" headers="NA  conf.low" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NA  label">BIC</td>
<td class="gt_row gt_center" headers="NA  estimate">397,033</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="NA  label">Log-likelihood</td>
<td class="gt_row gt_center" headers="NA  estimate">-198,279</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NA  label">No. Obs.</td>
<td class="gt_row gt_center" headers="NA  estimate">141,856</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
</tbody><tfoot>
<tr class="gt_footnotes odd">
<td colspan="4" class="gt_footnote">Random effects structure: Uncorrelated random slopes for Humidity, Persistence, and Dewpoint by Location.</td>
</tr>
<tr class="gt_sourcenotes even">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>All five preceding models treat the data as if every observation were drawn from the same underlying population, as if the relationship between humidity and rainfall were identical in coastal Sydney and arid Alice Springs, or as if a wet spell in tropical Darwin carried the same statistical weight as one in temperate Melbourne. This homogeneity assumption is implausible for a continent as climatologically diverse as Australia.</p>
<p>Model 6 relaxes it through a mixed-effects structure. Location-specific random effects allow the intercept and three scientifically motivated slopes; humidity, persistence, and dewpoint change to vary across weather stations. Uncorrelated random slopes (<code>diag()</code>) are used rather than a full unstructured covariance matrix, avoiding the overparameterisation that would accompany a freely estimated <span class="math inline">\(4 \times 4\)</span> random covariance structure across the number of locations in this dataset.</p>
<p>Two further additions accompany the move to mixed effects. The zero-inflation submodel is expanded with sunshine, evaporation, and the day-of-year cyclical components, reflecting the hypothesis that occurrence probability is also subject to the full range of atmospheric drivers. And <code>days_since_rain</code> in the zero-inflation submodel is replaced with a four-degree-of-freedom natural spline <code>ns(days_since_rain, df = 4)</code> directly implementing the “rapid-then-gradual” decay identified in the EDA (<a href="03-eda.html" class="quarto-xref"><span>Chapter 3</span></a>). The spline allows the probability of a dry spell ending to drop steeply in the first ten days and stabilise thereafter, rather than assuming a constant log-odds decrement per day.</p>
<p>AIC falls to 396,638, an improvement of <span class="math inline">\(\Delta\text{AIC} \approx 6,503\)</span> relative to Model 5. This is the second-largest single gain after the initial moisture predictors, establishing that spatial heterogeneity is a dominant source of unexplained variance in all the fixed-effects models. The random effects estimates confirm meaningful variability: the random intercept variance (<span class="math inline">\(\hat{\sigma}^2 = 0.12\)</span>) captures substantial baseline differences in rainfall between locations; the humidity random slope variance (<span class="math inline">\(\hat{\sigma}^2 = 0.023\)</span>) shows that humidity’s effect on intensity differs across the country; and the persistence random slope variance (<span class="math inline">\(\hat{\sigma}^2 = 0.013\)</span>) indicates that the stickiness of wet weather is more pronounced in some climatic zones than others as one would expect contrasting the monsoonal north, where wet seasons persist for months, with the more variable climate of the southeast.</p>
<p>The fixed effects for global meteorological drivers; wind vectors, the instability index, and the sunshine-humidity interaction remain significant and directionally consistent with the preceding models. These are robust, continent-wide physical mechanisms whose effects persist even after allowing each location’s parameters to deviate from the global mean.</p>
<hr>
</section>
<section id="progressive-model-comparison" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="progressive-model-comparison"><span class="header-section-number">5.10</span> Progressive Model Comparison</h2>
<p>The table below summarises the AIC trajectory across the model sequence and the cumulative share of the total achievable gain measured relative to the null captured at each step.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small">
<caption>Progressive Model Comparison: AIC Trajectory</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Description</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Change in AIC vs Null</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">% of Total Gain</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">M0</td>
<td style="text-align: left;">Null (intercept only)</td>
<td style="text-align: right;">461,669.7</td>
<td style="text-align: right;">-</td>
<td style="text-align: right;">-</td>
</tr>
<tr class="even">
<td style="text-align: left;">M1</td>
<td style="text-align: left;">Moisture and pressure</td>
<td style="text-align: right;">422,630.0</td>
<td style="text-align: right;">39,039.7</td>
<td style="text-align: right;">60.0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">M2</td>
<td style="text-align: left;">Seasonality and persistence</td>
<td style="text-align: right;">406,826.0</td>
<td style="text-align: right;">54,843.7</td>
<td style="text-align: right;">84.3%</td>
</tr>
<tr class="even">
<td style="text-align: left;">M3</td>
<td style="text-align: left;">Accumulated history</td>
<td style="text-align: right;">405,125.0</td>
<td style="text-align: right;">56,544.7</td>
<td style="text-align: right;">86.9%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">M4</td>
<td style="text-align: left;">Thermodynamics and interactions</td>
<td style="text-align: right;">403,742.0</td>
<td style="text-align: right;">57,927.7</td>
<td style="text-align: right;">89.1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">M5</td>
<td style="text-align: left;">Wind vectors</td>
<td style="text-align: right;">403,141.0</td>
<td style="text-align: right;">58,528.7</td>
<td style="text-align: right;">90.0%</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(33, 37, 41, 255) !important; background-color: rgba(230, 243, 255, 255) !important;">M6</td>
<td style="text-align: left; font-weight: bold; color: rgba(33, 37, 41, 255) !important; background-color: rgba(230, 243, 255, 255) !important;">Spatial mixed effects (final)</td>
<td style="text-align: right; font-weight: bold; color: rgba(33, 37, 41, 255) !important; background-color: rgba(230, 243, 255, 255) !important;">396,638.0</td>
<td style="text-align: right; font-weight: bold; color: rgba(33, 37, 41, 255) !important; background-color: rgba(230, 243, 255, 255) !important;">65,031.7</td>
<td style="text-align: right; font-weight: bold; color: rgba(33, 37, 41, 255) !important; background-color: rgba(230, 243, 255, 255) !important;">100.0%</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0; border: 0;"><sup></sup> AIC: Akaike Information Criterion (Lower is better)</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0; border: 0;"><sup></sup> Total Gain is calculated relative to the maximum improvement achieved by Model 6.</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>
</div>
</div>
<p>The gains are steeply front-loaded. Moisture and pressure alone account for 60% of the total improvement, and adding seasonality and persistence brings the cumulative share to 84.3%. The thermodynamic, interaction, and wind components each contribute genuinely but with diminishing magnitude. The step to mixed effects, however, recovers a disproportionate share of the remaining variance, underscoring that spatial stratification is not a minor correction but a structurally important dimension of the problem that fixed-effects models cannot address by design.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./04-features.html" class="pagination-link" aria-label="Feature Engineering">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Feature Engineering</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-evaluation.html" class="pagination-link" aria-label="Model Evaluation">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model Evaluation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu"># Modelling</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">## A Progressive Zero-Inflated Gamma Framework for Australian Rainfall</span></span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a>---</span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="at">&gt; **Chapter Context.** This chapter constructs the statistical model incrementally, beginning from a null baseline and introducing successive layers of physical complexity. Each model corresponds to a coherent hypothesis about the mechanisms driving Australian rainfall, tested against its predecessor via likelihood-based criteria. The model family Zero-Inflated Gamma (ZIG) was selected in direct response to the distributional findings from the EDA: the 64% zero-inflation rate and extreme positive skew of the rainfall distribution make a single-component Gaussian model fundamentally inappropriate.</span></span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a>---</span>
<span id="cb9-9"><a href="#cb9-9"></a></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="fu">## Model Architecture</span></span>
<span id="cb9-11"><a href="#cb9-11"></a></span>
<span id="cb9-12"><a href="#cb9-12"></a>A Zero-Inflated Gamma model is a two-component mixture. The first component, the zero-inflation submodel, is a logistic regression that estimates the probability of a structurally zero outcome, a dry day on which no precipitation occurs regardless of atmospheric conditions. The second component, the conditional intensity submodel, is a Gamma regression (with log link) that models the expected rainfall given that rain does fall. Together they answer the two questions identified in the @sec-eda: "Will it rain?" and "If so, how much?"</span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a>Formally, for observation $i$:</span>
<span id="cb9-15"><a href="#cb9-15"></a></span>
<span id="cb9-16"><a href="#cb9-16"></a>$$P(Y_i = 0) = \pi_i + (1 - \pi_i) \cdot f_\Gamma(0)$$</span>
<span id="cb9-17"><a href="#cb9-17"></a>$$P(Y_i = y) = (1 - \pi_i) \cdot f_\Gamma(y \mid \mu_i, \phi), \quad y &gt; 0$$</span>
<span id="cb9-18"><a href="#cb9-18"></a></span>
<span id="cb9-19"><a href="#cb9-19"></a>where $\pi_i = \text{logit}^{-1}(\mathbf{z}_i^\top \boldsymbol{\gamma})$ is the zero-inflation probability and $\mu_i = \exp(\mathbf{x}_i^\top \boldsymbol{\beta})$ is the conditional mean intensity. The two linear predictors, $\mathbf{z}_i$ and $\mathbf{x}_i$, can include different sets of covariates, allowing predictors of *occurrence* to differ from predictors of *intensity*. All models were fitted using <span class="in">`glmmTMB`</span>, which implements maximum likelihood estimation for this family via the Template Model Builder.</span>
<span id="cb9-20"><a href="#cb9-20"></a></span>
<span id="cb9-21"><a href="#cb9-21"></a>Progressive model construction serves two purposes. It provides a transparent audit trail connecting each modelling decision to its empirical motivation. It also enables incremental comparison: each model can be evaluated against its predecessor to isolate the contribution of the newly added component.</span>
<span id="cb9-22"><a href="#cb9-22"></a></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="in">```{r}</span></span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="co">#| label: setup-modeling</span></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co">#| include: false</span></span>
<span id="cb9-28"><a href="#cb9-28"></a></span>
<span id="cb9-29"><a href="#cb9-29"></a>librarian<span class="sc">::</span><span class="fu">shelf</span>(</span>
<span id="cb9-30"><a href="#cb9-30"></a>  tidyverse,</span>
<span id="cb9-31"><a href="#cb9-31"></a>  glmmTMB,</span>
<span id="cb9-32"><a href="#cb9-32"></a>  sjPlot,</span>
<span id="cb9-33"><a href="#cb9-33"></a>  DHARMa,</span>
<span id="cb9-34"><a href="#cb9-34"></a>  kableExtra,</span>
<span id="cb9-35"><a href="#cb9-35"></a>  gtsummary,</span>
<span id="cb9-36"><a href="#cb9-36"></a>  lmtest,</span>
<span id="cb9-37"><a href="#cb9-37"></a>  performance,</span>
<span id="cb9-38"><a href="#cb9-38"></a>  gt,</span>
<span id="cb9-39"><a href="#cb9-39"></a>  splines,</span>
<span id="cb9-40"><a href="#cb9-40"></a>  pROC,</span>
<span id="cb9-41"><a href="#cb9-41"></a>  here</span>
<span id="cb9-42"><a href="#cb9-42"></a>)</span>
<span id="cb9-43"><a href="#cb9-43"></a></span>
<span id="cb9-44"><a href="#cb9-44"></a>df_scaled <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"df_scaled.csv"</span>))</span>
<span id="cb9-45"><a href="#cb9-45"></a>df_final <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"df_engineered.csv"</span>))</span>
<span id="cb9-46"><a href="#cb9-46"></a></span>
<span id="cb9-47"><a href="#cb9-47"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"utils.R"</span>))</span>
<span id="cb9-48"><a href="#cb9-48"></a></span>
<span id="cb9-49"><a href="#cb9-49"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models/all_models_bundle.RData"</span>))) {</span>
<span id="cb9-50"><a href="#cb9-50"></a>  <span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models/all_models_bundle.RData"</span>))</span>
<span id="cb9-51"><a href="#cb9-51"></a>}</span>
<span id="cb9-52"><a href="#cb9-52"></a><span class="in">```</span></span>
<span id="cb9-53"><a href="#cb9-53"></a></span>
<span id="cb9-54"><a href="#cb9-54"></a>---</span>
<span id="cb9-55"><a href="#cb9-55"></a></span>
<span id="cb9-56"><a href="#cb9-56"></a><span class="fu">## Model 0: Null Baseline</span></span>
<span id="cb9-57"><a href="#cb9-57"></a></span>
<span id="cb9-60"><a href="#cb9-60"></a><span class="in">```{r}</span></span>
<span id="cb9-61"><a href="#cb9-61"></a><span class="co">#| label: null-model-fit</span></span>
<span id="cb9-62"><a href="#cb9-62"></a><span class="co">#| echo: true</span></span>
<span id="cb9-63"><a href="#cb9-63"></a><span class="co">#| message: false</span></span>
<span id="cb9-64"><a href="#cb9-64"></a><span class="co">#| eval: false</span></span>
<span id="cb9-65"><a href="#cb9-65"></a></span>
<span id="cb9-66"><a href="#cb9-66"></a>m0_null <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb9-67"><a href="#cb9-67"></a>  <span class="at">formula =</span> rainfall <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb9-68"><a href="#cb9-68"></a>  <span class="at">ziformula =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb9-69"><a href="#cb9-69"></a>  <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb9-70"><a href="#cb9-70"></a>  <span class="at">data =</span> df_scaled</span>
<span id="cb9-71"><a href="#cb9-71"></a>)</span>
<span id="cb9-72"><a href="#cb9-72"></a><span class="in">```</span></span>
<span id="cb9-73"><a href="#cb9-73"></a></span>
<span id="cb9-76"><a href="#cb9-76"></a><span class="in">```{r}</span></span>
<span id="cb9-77"><a href="#cb9-77"></a><span class="co">#| label: null-model-output</span></span>
<span id="cb9-78"><a href="#cb9-78"></a></span>
<span id="cb9-79"><a href="#cb9-79"></a><span class="fu">tab_model</span>(</span>
<span id="cb9-80"><a href="#cb9-80"></a>  m0_null,</span>
<span id="cb9-81"><a href="#cb9-81"></a>  <span class="at">show.se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-82"><a href="#cb9-82"></a>  <span class="at">show.aic =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-83"><a href="#cb9-83"></a>  <span class="at">transform =</span> <span class="st">"exp"</span>,</span>
<span id="cb9-84"><a href="#cb9-84"></a>  <span class="at">collapse.se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-85"><a href="#cb9-85"></a>  <span class="at">p.style =</span> <span class="st">"numeric_stars"</span>,</span>
<span id="cb9-86"><a href="#cb9-86"></a>  <span class="at">string.pred =</span> <span class="st">"Parameter"</span>,</span>
<span id="cb9-87"><a href="#cb9-87"></a>  <span class="at">string.est =</span> <span class="st">"Estimate (Exp)"</span>,</span>
<span id="cb9-88"><a href="#cb9-88"></a>  <span class="at">dv.labels =</span> <span class="st">"Baseline Rainfall Model"</span>,</span>
<span id="cb9-89"><a href="#cb9-89"></a>  <span class="at">title =</span> <span class="st">"Table 1: Baseline Zero-Inflated Gamma Model (Intercept Only)"</span></span>
<span id="cb9-90"><a href="#cb9-90"></a>)</span>
<span id="cb9-91"><a href="#cb9-91"></a><span class="in">```</span></span>
<span id="cb9-92"><a href="#cb9-92"></a></span>
<span id="cb9-93"><a href="#cb9-93"></a>Before introducing any covariates, we fit an intercept-only model whose sole purpose is to verify that the model structure correctly recovers the fundamental statistical properties of the dataset. A null model that fails this basic calibration check would call into question the validity of all subsequent extensions.</span>
<span id="cb9-94"><a href="#cb9-94"></a></span>
<span id="cb9-95"><a href="#cb9-95"></a>The zero-inflation intercept $\hat{\beta}_{zi} = 0.5769$ back-transforms through the logistic function to an implied dry-day probability of:</span>
<span id="cb9-96"><a href="#cb9-96"></a></span>
<span id="cb9-97"><a href="#cb9-97"></a>$$\hat{P}(\text{Dry}) = \frac{e^{0.5769}}{1 + e^{0.5769}} \approx 64.03\%$$</span>
<span id="cb9-98"><a href="#cb9-98"></a></span>
<span id="cb9-99"><a href="#cb9-99"></a>This matches the empirically observed zero-inflation rate of 64.05% to within a rounding error, confirming that the hurdle mechanism is correctly calibrated to the data-generating process. The conditional intensity intercept $\hat{\beta}_{cond} = 1.8825$ recovers a mean rainy-day intensity of $e^{1.8825} \approx 6.57$ mm, consistent with the non-zero mean established in the EDA.</span>
<span id="cb9-100"><a href="#cb9-100"></a></span>
<span id="cb9-101"><a href="#cb9-101"></a>This model yields AIC = 461,669.7, serving as the reference against which all subsequent gains are measured.</span>
<span id="cb9-102"><a href="#cb9-102"></a></span>
<span id="cb9-103"><a href="#cb9-103"></a>---</span>
<span id="cb9-104"><a href="#cb9-104"></a></span>
<span id="cb9-105"><a href="#cb9-105"></a><span class="fu">## Model 1: Moisture and Pressure Dynamics</span></span>
<span id="cb9-106"><a href="#cb9-106"></a></span>
<span id="cb9-109"><a href="#cb9-109"></a><span class="in">```{r}</span></span>
<span id="cb9-110"><a href="#cb9-110"></a><span class="co">#| label: m1-moisture-code</span></span>
<span id="cb9-111"><a href="#cb9-111"></a><span class="co">#| echo: true</span></span>
<span id="cb9-112"><a href="#cb9-112"></a><span class="co">#| eval: false</span></span>
<span id="cb9-113"><a href="#cb9-113"></a></span>
<span id="cb9-114"><a href="#cb9-114"></a>m1_moisture <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb9-115"><a href="#cb9-115"></a>  m0_null,</span>
<span id="cb9-116"><a href="#cb9-116"></a>  . <span class="sc">~</span> . <span class="sc">+</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> dewpoint_change <span class="sc">+</span> pressure_change,</span>
<span id="cb9-117"><a href="#cb9-117"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span> dewpoint_9am</span>
<span id="cb9-118"><a href="#cb9-118"></a>)</span>
<span id="cb9-119"><a href="#cb9-119"></a><span class="in">```</span></span>
<span id="cb9-120"><a href="#cb9-120"></a></span>
<span id="cb9-123"><a href="#cb9-123"></a><span class="in">```{r}</span></span>
<span id="cb9-124"><a href="#cb9-124"></a><span class="co">#| label: m1-moisture-output</span></span>
<span id="cb9-125"><a href="#cb9-125"></a><span class="co">#| echo: false</span></span>
<span id="cb9-126"><a href="#cb9-126"></a></span>
<span id="cb9-127"><a href="#cb9-127"></a>m1_moisture <span class="sc">%&gt;%</span></span>
<span id="cb9-128"><a href="#cb9-128"></a>  <span class="fu">tbl_regression</span>(</span>
<span id="cb9-129"><a href="#cb9-129"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-130"><a href="#cb9-130"></a>    <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb9-131"><a href="#cb9-131"></a>      humidity3pm <span class="sc">~</span> <span class="st">"Humidity (3pm)"</span>,</span>
<span id="cb9-132"><a href="#cb9-132"></a>      dewpoint_9am <span class="sc">~</span> <span class="st">"Dewpoint (9am)"</span>,</span>
<span id="cb9-133"><a href="#cb9-133"></a>      dewpoint_change <span class="sc">~</span> <span class="st">"Dewpoint Change (Delta)"</span>,</span>
<span id="cb9-134"><a href="#cb9-134"></a>      pressure_change <span class="sc">~</span> <span class="st">"Pressure Change (Delta)"</span></span>
<span id="cb9-135"><a href="#cb9-135"></a>    )</span>
<span id="cb9-136"><a href="#cb9-136"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-137"><a href="#cb9-137"></a>  <span class="fu">bold_p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-138"><a href="#cb9-138"></a>  <span class="fu">add_glance_table</span>(<span class="at">include =</span> <span class="fu">c</span>(<span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"logLik"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-139"><a href="#cb9-139"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Predictor**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-140"><a href="#cb9-140"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Model 1: Moisture and Pressure Dynamics**"</span>)</span>
<span id="cb9-141"><a href="#cb9-141"></a><span class="in">```</span></span>
<span id="cb9-142"><a href="#cb9-142"></a></span>
<span id="cb9-143"><a href="#cb9-143"></a>The correlation analysis identified afternoon humidity and sunshine as the two strongest individual predictors of rainfall, and the pressure analysis established that both baseline level and diurnal change carry discriminating signal. Model 1 formalises these findings by introducing the four most physically direct atmospheric drivers into the conditional intensity submodel, and a subset of moisture indicators into the zero-inflation submodel.</span>
<span id="cb9-144"><a href="#cb9-144"></a></span>
<span id="cb9-145"><a href="#cb9-145"></a>The AIC falls from 461,669.7 to 422,630, a reduction of approximately 39069.7 points, the largest single improvement in the entire model sequence. This magnitude confirms that atmospheric moisture and pressure dynamics are not merely correlated with rainfall but are its fundamental predictive substrate.</span>
<span id="cb9-146"><a href="#cb9-146"></a></span>
<span id="cb9-147"><a href="#cb9-147"></a>All four predictors in the conditional model are highly significant ($p &lt; 2 \times 10^{-16}$). The positive coefficients for <span class="in">`humidity3pm`</span> ($\hat{\beta} = 0.38$) and <span class="in">`dewpoint_9am`</span> ($\hat{\beta} = 0.38$) indicate that both relative saturation of the afternoon air and the absolute moisture content of the morning atmosphere independently increase rainfall intensity when rain does occur.</span>
<span id="cb9-148"><a href="#cb9-148"></a></span>
<span id="cb9-149"><a href="#cb9-149"></a>The zero-inflation submodel reveals a meaningful asymmetry between the two moisture variables. <span class="in">`humidity3pm`</span> carries a coefficient of $-1.07$: the negative sign reflects the logistic parameterisation, where larger values reduce the probability of a *dry* outcome, so higher humidity strongly increases the probability of rain. <span class="in">`dewpoint_9am`</span>, by contrast, is not significant in the zero-inflation component ($p = 0.907$). This dissociation suggests that it is the relative saturation of the afternoon atmosphere that determines whether the threshold for precipitation is crossed, while the absolute morning moisture content shapes the intensity of rainfall once it occurs.</span>
<span id="cb9-150"><a href="#cb9-150"></a></span>
<span id="cb9-151"><a href="#cb9-151"></a>---</span>
<span id="cb9-152"><a href="#cb9-152"></a></span>
<span id="cb9-153"><a href="#cb9-153"></a><span class="fu">## Model 2: Seasonality and Day-to-Day Persistence</span></span>
<span id="cb9-154"><a href="#cb9-154"></a></span>
<span id="cb9-157"><a href="#cb9-157"></a><span class="in">```{r}</span></span>
<span id="cb9-158"><a href="#cb9-158"></a><span class="co">#| label: m2-temporal-code</span></span>
<span id="cb9-159"><a href="#cb9-159"></a><span class="co">#| echo: true</span></span>
<span id="cb9-160"><a href="#cb9-160"></a><span class="co">#| eval: false</span></span>
<span id="cb9-161"><a href="#cb9-161"></a></span>
<span id="cb9-162"><a href="#cb9-162"></a>m2_temporal <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb9-163"><a href="#cb9-163"></a>  m1_moisture,</span>
<span id="cb9-164"><a href="#cb9-164"></a>  . <span class="sc">~</span> . <span class="sc">+</span> day_cos <span class="sc">+</span> day_sin,</span>
<span id="cb9-165"><a href="#cb9-165"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb9-166"><a href="#cb9-166"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb9-167"><a href="#cb9-167"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb9-168"><a href="#cb9-168"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb9-169"><a href="#cb9-169"></a>    pressure_change</span>
<span id="cb9-170"><a href="#cb9-170"></a>)</span>
<span id="cb9-171"><a href="#cb9-171"></a><span class="in">```</span></span>
<span id="cb9-172"><a href="#cb9-172"></a></span>
<span id="cb9-175"><a href="#cb9-175"></a><span class="in">```{r}</span></span>
<span id="cb9-176"><a href="#cb9-176"></a><span class="co">#| label: m2-temporal-output</span></span>
<span id="cb9-177"><a href="#cb9-177"></a><span class="co">#| echo: false</span></span>
<span id="cb9-178"><a href="#cb9-178"></a></span>
<span id="cb9-179"><a href="#cb9-179"></a>m2_temporal <span class="sc">%&gt;%</span></span>
<span id="cb9-180"><a href="#cb9-180"></a>  <span class="fu">tbl_regression</span>(</span>
<span id="cb9-181"><a href="#cb9-181"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-182"><a href="#cb9-182"></a>    <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb9-183"><a href="#cb9-183"></a>      day_cos <span class="sc">~</span> <span class="st">"Seasonality (Cos)"</span>,</span>
<span id="cb9-184"><a href="#cb9-184"></a>      day_sin <span class="sc">~</span> <span class="st">"Seasonality (Sin)"</span>,</span>
<span id="cb9-185"><a href="#cb9-185"></a>      rain_yesterday <span class="sc">~</span> <span class="st">"Rain Yesterday (Persistence)"</span>,</span>
<span id="cb9-186"><a href="#cb9-186"></a>      cloud_development <span class="sc">~</span> <span class="st">"Cloud Development"</span>,</span>
<span id="cb9-187"><a href="#cb9-187"></a>      pressure_change <span class="sc">~</span> <span class="st">"Pressure Change"</span></span>
<span id="cb9-188"><a href="#cb9-188"></a>    )</span>
<span id="cb9-189"><a href="#cb9-189"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-190"><a href="#cb9-190"></a>  <span class="fu">bold_p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-191"><a href="#cb9-191"></a>  <span class="fu">add_glance_table</span>(<span class="at">include =</span> <span class="fu">c</span>(<span class="st">"AIC"</span>, <span class="st">"BIC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-192"><a href="#cb9-192"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Predictor**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-193"><a href="#cb9-193"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Model 2: Seasonality and Persistence Effects**"</span>)</span>
<span id="cb9-194"><a href="#cb9-194"></a><span class="in">```</span></span>
<span id="cb9-195"><a href="#cb9-195"></a></span>
<span id="cb9-196"><a href="#cb9-196"></a>Having established moisture and pressure as foundational drivers, Model 2 incorporates the temporal structure identified in the EDA (@sec-eda). The Markov Chain analysis (@sec-markov) demonstrated that yesterday's rain state carries a moderate but practically significant effect ($V \approx 0.31$), and the seasonal analysis confirmed that both frequency and intensity of rainfall follow a smooth annual cycle. Cyclical sine/cosine encoding enters the conditional model, while <span class="in">`rain_yesterday`</span>, <span class="in">`cloud_development`</span>, and <span class="in">`pressure_change`</span> are added to the zero-inflation component.</span>
<span id="cb9-197"><a href="#cb9-197"></a></span>
<span id="cb9-198"><a href="#cb9-198"></a>AIC falls to 406,826 ($\Delta\text{AIC} \approx 15,804$ relative to Model 1), confirming that temporal context when in the year and what happened the day before contributes substantial predictive information beyond the instantaneous atmospheric state.</span>
<span id="cb9-199"><a href="#cb9-199"></a></span>
<span id="cb9-200"><a href="#cb9-200"></a>Both seasonal components are highly significant, providing statistical confirmation of the cyclical pattern documented in the EDA(@sec-eda). The continuous circular encoding correctly captures the smooth transition between the winter trough and the summer peak rather than imposing an arbitrary step at the calendar year boundary.</span>
<span id="cb9-201"><a href="#cb9-201"></a></span>
<span id="cb9-202"><a href="#cb9-202"></a>The most striking result is the persistence coefficient. At $\hat{\beta}_{zi} = -1.42$ in the zero-inflation component, it is the strongest predictor in the hurdle submodel across the entire model sequence. Exponentiating gives $e^{-1.42} \approx 0.24$: having rained yesterday reduces the odds of today being dry by approximately 76%. This quantifies the asymmetric persistence documented in the Markov transition matrix wet states are more likely to continue than to terminate.</span>
<span id="cb9-203"><a href="#cb9-203"></a></span>
<span id="cb9-204"><a href="#cb9-204"></a>---</span>
<span id="cb9-205"><a href="#cb9-205"></a></span>
<span id="cb9-206"><a href="#cb9-206"></a><span class="fu">## Model 3: Accumulated Weather History</span></span>
<span id="cb9-207"><a href="#cb9-207"></a></span>
<span id="cb9-210"><a href="#cb9-210"></a><span class="in">```{r}</span></span>
<span id="cb9-211"><a href="#cb9-211"></a><span class="co">#| label: m3-history-code</span></span>
<span id="cb9-212"><a href="#cb9-212"></a><span class="co">#| echo: true</span></span>
<span id="cb9-213"><a href="#cb9-213"></a><span class="co">#| eval: false</span></span>
<span id="cb9-214"><a href="#cb9-214"></a></span>
<span id="cb9-215"><a href="#cb9-215"></a>m3_history <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb9-216"><a href="#cb9-216"></a>  m2_temporal,</span>
<span id="cb9-217"><a href="#cb9-217"></a>  . <span class="sc">~</span> . <span class="sc">+</span> rainfall_ma7 <span class="sc">+</span> days_since_rain <span class="sc">+</span> humidity_ma7 <span class="sc">+</span> rain_yesterday,</span>
<span id="cb9-218"><a href="#cb9-218"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb9-219"><a href="#cb9-219"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb9-220"><a href="#cb9-220"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb9-221"><a href="#cb9-221"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb9-222"><a href="#cb9-222"></a>    pressure_change</span>
<span id="cb9-223"><a href="#cb9-223"></a>)</span>
<span id="cb9-224"><a href="#cb9-224"></a><span class="in">```</span></span>
<span id="cb9-225"><a href="#cb9-225"></a></span>
<span id="cb9-228"><a href="#cb9-228"></a><span class="in">```{r}</span></span>
<span id="cb9-229"><a href="#cb9-229"></a><span class="co">#| label: m3-history-output</span></span>
<span id="cb9-230"><a href="#cb9-230"></a><span class="co">#| echo: false</span></span>
<span id="cb9-231"><a href="#cb9-231"></a></span>
<span id="cb9-232"><a href="#cb9-232"></a>m3_history <span class="sc">%&gt;%</span></span>
<span id="cb9-233"><a href="#cb9-233"></a>  <span class="fu">tbl_regression</span>(</span>
<span id="cb9-234"><a href="#cb9-234"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-235"><a href="#cb9-235"></a>    <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb9-236"><a href="#cb9-236"></a>      rainfall_ma7 <span class="sc">~</span> <span class="st">"Rainfall Trend (7-Day MA)"</span>,</span>
<span id="cb9-237"><a href="#cb9-237"></a>      humidity_ma7 <span class="sc">~</span> <span class="st">"Humidity Trend (7-Day MA)"</span>,</span>
<span id="cb9-238"><a href="#cb9-238"></a>      days_since_rain <span class="sc">~</span> <span class="st">"Dry Spell Length (Days)"</span>,</span>
<span id="cb9-239"><a href="#cb9-239"></a>      rain_yesterday <span class="sc">~</span> <span class="st">"Rain Yesterday (Indicator)"</span></span>
<span id="cb9-240"><a href="#cb9-240"></a>    )</span>
<span id="cb9-241"><a href="#cb9-241"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-242"><a href="#cb9-242"></a>  <span class="fu">bold_p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-243"><a href="#cb9-243"></a>  <span class="fu">add_glance_table</span>(<span class="at">include =</span> <span class="fu">c</span>(<span class="st">"AIC"</span>, <span class="st">"BIC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-244"><a href="#cb9-244"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Predictor**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-245"><a href="#cb9-245"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Model 3: Accumulated Weather History**"</span>)</span>
<span id="cb9-246"><a href="#cb9-246"></a><span class="in">```</span></span>
<span id="cb9-247"><a href="#cb9-247"></a></span>
<span id="cb9-248"><a href="#cb9-248"></a>While Model 2 captured the binary state of the previous day, it does not account for the *accumulated* atmospheric state over a longer preceding window. The dry spell analysis (@sec-dry-spell) demonstrated that rainfall probability decays as dry spells lengthen, and the moving average analysis showed that a 7-day smoothed signal substantially reduces the stochastic variance of the rainfall and humidity series. Model 3 introduces these medium-horizon history features into the conditional intensity submodel.</span>
<span id="cb9-249"><a href="#cb9-249"></a></span>
<span id="cb9-250"><a href="#cb9-250"></a>The improvement is AIC = 405,125 ($\Delta\text{AIC} \approx 1,701$ versus Model 2). This is smaller than the earlier gains, reflecting the natural diminishing returns of adding temporally redundant information once the most immediate history has been captured. The signal is nonetheless genuine.</span>
<span id="cb9-251"><a href="#cb9-251"></a></span>
<span id="cb9-252"><a href="#cb9-252"></a>The results reveal an interpretable separation between the roles of immediate and accumulated history. <span class="in">`rain_yesterday`</span> in the conditional model ($\hat{\beta} = 0.31$, $e^{0.31} \approx 1.36$) indicates that if it rained the previous day, today's rainfall is approximately 36% more intense on average consistent with a persisting frontal system delivering successive events of comparable severity. <span class="in">`rainfall_ma7`</span> ($\hat{\beta} = 0.13$) extends this logic to the weekly horizon: a wetter preceding week is associated with heavier current rainfall, suggesting that prolonged wet spells are symptomatic of deeper atmospheric systems rather than sequences of independent events.</span>
<span id="cb9-253"><a href="#cb9-253"></a></span>
<span id="cb9-254"><a href="#cb9-254"></a>The negative coefficient for <span class="in">`humidity_ma7`</span> ($\hat{\beta} = -0.10$) warrants careful interpretation. Conditional on all other terms, a persistently humid preceding week is associated with slightly *lower* rainfall intensity. This likely reflects a distinction between two meteorological regimes: stratiform cloud systems, which sustain high background humidity without producing intense precipitation, versus convective systems, which generate intense episodic rainfall under conditions of rapid moisture change rather than steady elevated humidity.</span>
<span id="cb9-255"><a href="#cb9-255"></a></span>
<span id="cb9-256"><a href="#cb9-256"></a>Finally, <span class="in">`days_since_rain`</span> is not significant in the conditional intensity component ($p = 0.14$). The dry spell length predicts *whether* rain occurs, but once the model knows rain is occurring, the duration of the preceding drought provides no additional information about how much will fall. This reinforces the conceptual separation between the occurrence and intensity sub-processes.</span>
<span id="cb9-257"><a href="#cb9-257"></a></span>
<span id="cb9-258"><a href="#cb9-258"></a>---</span>
<span id="cb9-259"><a href="#cb9-259"></a></span>
<span id="cb9-260"><a href="#cb9-260"></a><span class="fu">## Model 4: Thermodynamic Energy and the Rain Corner Interaction</span></span>
<span id="cb9-261"><a href="#cb9-261"></a></span>
<span id="cb9-264"><a href="#cb9-264"></a><span class="in">```{r}</span></span>
<span id="cb9-265"><a href="#cb9-265"></a><span class="co">#| label: m4-energy-code</span></span>
<span id="cb9-266"><a href="#cb9-266"></a><span class="co">#| echo: true</span></span>
<span id="cb9-267"><a href="#cb9-267"></a><span class="co">#| eval: false</span></span>
<span id="cb9-268"><a href="#cb9-268"></a></span>
<span id="cb9-269"><a href="#cb9-269"></a>m4_energy <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb9-270"><a href="#cb9-270"></a>  m3_history,</span>
<span id="cb9-271"><a href="#cb9-271"></a>  . <span class="sc">~</span> . <span class="sc">+</span></span>
<span id="cb9-272"><a href="#cb9-272"></a>    sunshine <span class="sc">+</span></span>
<span id="cb9-273"><a href="#cb9-273"></a>    evaporation <span class="sc">+</span></span>
<span id="cb9-274"><a href="#cb9-274"></a>    instability_index <span class="sc">+</span></span>
<span id="cb9-275"><a href="#cb9-275"></a>    sun_humid_interaction <span class="sc">+</span></span>
<span id="cb9-276"><a href="#cb9-276"></a>    cloud_development,</span>
<span id="cb9-277"><a href="#cb9-277"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb9-278"><a href="#cb9-278"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb9-279"><a href="#cb9-279"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb9-280"><a href="#cb9-280"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb9-281"><a href="#cb9-281"></a>    pressure_change</span>
<span id="cb9-282"><a href="#cb9-282"></a>)</span>
<span id="cb9-283"><a href="#cb9-283"></a><span class="in">```</span></span>
<span id="cb9-284"><a href="#cb9-284"></a></span>
<span id="cb9-287"><a href="#cb9-287"></a><span class="in">```{r}</span></span>
<span id="cb9-288"><a href="#cb9-288"></a><span class="co">#| label: m4-energy-output</span></span>
<span id="cb9-289"><a href="#cb9-289"></a><span class="co">#| echo: false</span></span>
<span id="cb9-290"><a href="#cb9-290"></a></span>
<span id="cb9-291"><a href="#cb9-291"></a>m4_energy <span class="sc">%&gt;%</span></span>
<span id="cb9-292"><a href="#cb9-292"></a>  <span class="fu">tbl_regression</span>(</span>
<span id="cb9-293"><a href="#cb9-293"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-294"><a href="#cb9-294"></a>    <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb9-295"><a href="#cb9-295"></a>      sunshine <span class="sc">~</span> <span class="st">"Sunshine Duration (Hours)"</span>,</span>
<span id="cb9-296"><a href="#cb9-296"></a>      evaporation <span class="sc">~</span> <span class="st">"Evaporation Rate"</span>,</span>
<span id="cb9-297"><a href="#cb9-297"></a>      instability_index <span class="sc">~</span> <span class="st">"Instability Index (Derived)"</span>,</span>
<span id="cb9-298"><a href="#cb9-298"></a>      sun_humid_interaction <span class="sc">~</span> <span class="st">"Interaction: Sunshine x Humidity"</span>,</span>
<span id="cb9-299"><a href="#cb9-299"></a>      cloud_development <span class="sc">~</span> <span class="st">"Cloud Development (Delta)"</span></span>
<span id="cb9-300"><a href="#cb9-300"></a>    )</span>
<span id="cb9-301"><a href="#cb9-301"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-302"><a href="#cb9-302"></a>  <span class="fu">bold_p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-303"><a href="#cb9-303"></a>  <span class="fu">add_glance_table</span>(<span class="at">include =</span> <span class="fu">c</span>(<span class="st">"AIC"</span>, <span class="st">"BIC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-304"><a href="#cb9-304"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Predictor**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-305"><a href="#cb9-305"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Model 4: Thermodynamic Energy and Interactions**"</span>)</span>
<span id="cb9-306"><a href="#cb9-306"></a><span class="in">```</span></span>
<span id="cb9-307"><a href="#cb9-307"></a></span>
<span id="cb9-308"><a href="#cb9-308"></a>The bivariate density analysis (@sec-bivariate-density) identified a structural non-linearity in the joint distribution of humidity and sunshine: rain occurs almost exclusively when afternoon humidity is high and sunshine hours are simultaneously low. An additive model cannot represent this conditional structure. Model 4 introduces the multiplicative interaction term alongside the broader thermodynamic context from which it arises.</span>
<span id="cb9-309"><a href="#cb9-309"></a></span>
<span id="cb9-310"><a href="#cb9-310"></a>AIC falls to 403,742 ($\Delta\text{AIC} \approx 1,383$ versus Model 3).</span>
<span id="cb9-311"><a href="#cb9-311"></a></span>
<span id="cb9-312"><a href="#cb9-312"></a>The <span class="in">`sun_humid_interaction`</span> coefficient of $\hat{\beta} = -0.07$ is highly significant and physically interpretable. The negative sign indicates that the combination of high humidity and low sunshine which, after mean-centring, produces a large negative product, is associated with heavier rainfall. This formalises the "Rain Corner" structure: neither variable alone is sufficient, but their adverse conjunction under saturated, overcast conditions is where the most intense events concentrate.</span>
<span id="cb9-313"><a href="#cb9-313"></a></span>
<span id="cb9-314"><a href="#cb9-314"></a>The entry of the interaction term also produces a marked reduction in the <span class="in">`humidity3pm`</span> coefficient, from 0.39 in Model 3 to 0.16 in Model 4. This is not a loss of importance. It reflects a correct partitioning of explained variance: the portion of humidity's effect that operates through its interaction with sunshine, and through the derived <span class="in">`instability_index`</span>, is now carried by those terms. The model has moved from knowing that humidity matters to capturing the specific mechanism through which it matters.</span>
<span id="cb9-315"><a href="#cb9-315"></a></span>
<span id="cb9-316"><a href="#cb9-316"></a>---</span>
<span id="cb9-317"><a href="#cb9-317"></a></span>
<span id="cb9-318"><a href="#cb9-318"></a><span class="fu">## Model 5: Wind Vector Dynamics</span></span>
<span id="cb9-319"><a href="#cb9-319"></a></span>
<span id="cb9-322"><a href="#cb9-322"></a><span class="in">```{r}</span></span>
<span id="cb9-323"><a href="#cb9-323"></a><span class="co">#| label: m5-wind-code</span></span>
<span id="cb9-324"><a href="#cb9-324"></a><span class="co">#| echo: true</span></span>
<span id="cb9-325"><a href="#cb9-325"></a><span class="co">#| eval: false</span></span>
<span id="cb9-326"><a href="#cb9-326"></a></span>
<span id="cb9-327"><a href="#cb9-327"></a>m5_wind <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb9-328"><a href="#cb9-328"></a>  m4_energy,</span>
<span id="cb9-329"><a href="#cb9-329"></a>  . <span class="sc">~</span> . <span class="sc">+</span> gust_U_EW <span class="sc">+</span> gust_V_NS <span class="sc">+</span> wind9am_V_NS <span class="sc">+</span> wind9am_U_EW,</span>
<span id="cb9-330"><a href="#cb9-330"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb9-331"><a href="#cb9-331"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb9-332"><a href="#cb9-332"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb9-333"><a href="#cb9-333"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb9-334"><a href="#cb9-334"></a>    pressure_change</span>
<span id="cb9-335"><a href="#cb9-335"></a>)</span>
<span id="cb9-336"><a href="#cb9-336"></a><span class="in">```</span></span>
<span id="cb9-337"><a href="#cb9-337"></a></span>
<span id="cb9-340"><a href="#cb9-340"></a><span class="in">```{r}</span></span>
<span id="cb9-341"><a href="#cb9-341"></a><span class="co">#| label: m5-wind-output</span></span>
<span id="cb9-342"><a href="#cb9-342"></a><span class="co">#| echo: false</span></span>
<span id="cb9-343"><a href="#cb9-343"></a></span>
<span id="cb9-344"><a href="#cb9-344"></a>m5_wind <span class="sc">%&gt;%</span></span>
<span id="cb9-345"><a href="#cb9-345"></a>  <span class="fu">tbl_regression</span>(</span>
<span id="cb9-346"><a href="#cb9-346"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-347"><a href="#cb9-347"></a>    <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb9-348"><a href="#cb9-348"></a>      gust_U_EW <span class="sc">~</span> <span class="st">"Gust Vector (East-West)"</span>,</span>
<span id="cb9-349"><a href="#cb9-349"></a>      gust_V_NS <span class="sc">~</span> <span class="st">"Gust Vector (North-South)"</span>,</span>
<span id="cb9-350"><a href="#cb9-350"></a>      wind9am_U_EW <span class="sc">~</span> <span class="st">"Wind 9am Vector (East-West)"</span>,</span>
<span id="cb9-351"><a href="#cb9-351"></a>      wind9am_V_NS <span class="sc">~</span> <span class="st">"Wind 9am Vector (North-South)"</span></span>
<span id="cb9-352"><a href="#cb9-352"></a>    )</span>
<span id="cb9-353"><a href="#cb9-353"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-354"><a href="#cb9-354"></a>  <span class="fu">bold_p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-355"><a href="#cb9-355"></a>  <span class="fu">add_glance_table</span>(<span class="at">include =</span> <span class="fu">c</span>(<span class="st">"AIC"</span>, <span class="st">"BIC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-356"><a href="#cb9-356"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Predictor**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-357"><a href="#cb9-357"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Model 5: Wind Vector Dynamics**"</span>)</span>
<span id="cb9-358"><a href="#cb9-358"></a><span class="in">```</span></span>
<span id="cb9-359"><a href="#cb9-359"></a></span>
<span id="cb9-360"><a href="#cb9-360"></a>Model 5 tests whether the directional origin of air masses provides additional predictive information about rainfall intensity beyond the instantaneous atmospheric state. Wind direction is encoded as orthogonal U and V vector components, as developed in the feature engineering chapter, to preserve the circular geometry of directional data.</span>
<span id="cb9-361"><a href="#cb9-361"></a></span>
<span id="cb9-362"><a href="#cb9-362"></a>AIC falls to 403,141 ($\Delta\text{AIC} \approx 601$ versus Model 4). The improvement is the smallest in the sequence, but given the large sample size and the physical plausibility of the effects, the additional wind information is retained.</span>
<span id="cb9-363"><a href="#cb9-363"></a></span>
<span id="cb9-364"><a href="#cb9-364"></a>The most informative coefficients are those for the 9:00 AM wind vectors. <span class="in">`wind9am_V_NS`</span> ($\hat{\beta} = -0.094$) is negative, indicating that southerly airflow increases rainfall intensity. This is consistent with the "Southerly Buster" phenomenon, in which cool moisture-laden air from the Southern Ocean penetrates northward along the eastern seaboard. <span class="in">`wind9am_U_EW`</span> ($\hat{\beta} = -0.073$) similarly indicates that westerly airflow increases intensity, consistent with the "Roaring Forties" the band of persistent westerly winds at southern latitudes that deliver moisture from the Indian Ocean.</span>
<span id="cb9-365"><a href="#cb9-365"></a></span>
<span id="cb9-366"><a href="#cb9-366"></a>The morning wind vectors have coefficients approximately three to four times larger than their peak gust counterparts. This confirms that the prevailing direction of the air mass at the start of the day reflecting the broader synoptic circulation pattern is more informative than turbulent gusts associated with active storm cells. The storm's provenance matters more than its local expression.</span>
<span id="cb9-367"><a href="#cb9-367"></a></span>
<span id="cb9-368"><a href="#cb9-368"></a>Coefficients for previously established predictors remain stable across this extension, confirming that the wind vectors explain variance genuinely unaccounted for by earlier components rather than displacing existing effects through collinearity.</span>
<span id="cb9-369"><a href="#cb9-369"></a></span>
<span id="cb9-370"><a href="#cb9-370"></a>---</span>
<span id="cb9-371"><a href="#cb9-371"></a></span>
<span id="cb9-372"><a href="#cb9-372"></a><span class="fu">## Model 6: Spatial Heterogeneity via Mixed Effects</span></span>
<span id="cb9-373"><a href="#cb9-373"></a></span>
<span id="cb9-376"><a href="#cb9-376"></a><span class="in">```{r}</span></span>
<span id="cb9-377"><a href="#cb9-377"></a><span class="co">#| label: m6-mixed-code</span></span>
<span id="cb9-378"><a href="#cb9-378"></a><span class="co">#| echo: true</span></span>
<span id="cb9-379"><a href="#cb9-379"></a><span class="co">#| eval: false</span></span>
<span id="cb9-380"><a href="#cb9-380"></a></span>
<span id="cb9-381"><a href="#cb9-381"></a>re_data <span class="ot">&lt;-</span> <span class="fu">select_model_features</span>(df_final, <span class="at">keep_location =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-382"><a href="#cb9-382"></a>  <span class="fu">scale_data</span>()</span>
<span id="cb9-383"><a href="#cb9-383"></a></span>
<span id="cb9-384"><a href="#cb9-384"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">glmmTMBControl</span>(</span>
<span id="cb9-385"><a href="#cb9-385"></a>  <span class="at">optimizer =</span> optim,</span>
<span id="cb9-386"><a href="#cb9-386"></a>  <span class="at">optArgs =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">"BFGS"</span>),</span>
<span id="cb9-387"><a href="#cb9-387"></a>  <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxit =</span> <span class="dv">1000</span>)</span>
<span id="cb9-388"><a href="#cb9-388"></a>)</span>
<span id="cb9-389"><a href="#cb9-389"></a></span>
<span id="cb9-390"><a href="#cb9-390"></a>m6_mixed <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb9-391"><a href="#cb9-391"></a>  rainfall <span class="sc">~</span></span>
<span id="cb9-392"><a href="#cb9-392"></a>    humidity3pm <span class="sc">+</span></span>
<span id="cb9-393"><a href="#cb9-393"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb9-394"><a href="#cb9-394"></a>    dewpoint_change <span class="sc">+</span></span>
<span id="cb9-395"><a href="#cb9-395"></a>    pressure_change <span class="sc">+</span></span>
<span id="cb9-396"><a href="#cb9-396"></a>    day_cos <span class="sc">+</span></span>
<span id="cb9-397"><a href="#cb9-397"></a>    day_sin <span class="sc">+</span></span>
<span id="cb9-398"><a href="#cb9-398"></a>    rainfall_ma7 <span class="sc">+</span></span>
<span id="cb9-399"><a href="#cb9-399"></a>    days_since_rain <span class="sc">+</span></span>
<span id="cb9-400"><a href="#cb9-400"></a>    humidity_ma7 <span class="sc">+</span></span>
<span id="cb9-401"><a href="#cb9-401"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb9-402"><a href="#cb9-402"></a>    sunshine <span class="sc">+</span></span>
<span id="cb9-403"><a href="#cb9-403"></a>    evaporation <span class="sc">+</span></span>
<span id="cb9-404"><a href="#cb9-404"></a>    instability_index <span class="sc">+</span></span>
<span id="cb9-405"><a href="#cb9-405"></a>    sun_humid_interaction <span class="sc">+</span></span>
<span id="cb9-406"><a href="#cb9-406"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb9-407"><a href="#cb9-407"></a>    gust_U_EW <span class="sc">+</span></span>
<span id="cb9-408"><a href="#cb9-408"></a>    gust_V_NS <span class="sc">+</span></span>
<span id="cb9-409"><a href="#cb9-409"></a>    wind9am_V_NS <span class="sc">+</span></span>
<span id="cb9-410"><a href="#cb9-410"></a>    wind9am_U_EW <span class="sc">+</span></span>
<span id="cb9-411"><a href="#cb9-411"></a>    <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">+</span> humidity3pm <span class="sc">+</span> rain_yesterday <span class="sc">+</span> dewpoint_change <span class="sc">|</span> location),</span>
<span id="cb9-412"><a href="#cb9-412"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb9-413"><a href="#cb9-413"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb9-414"><a href="#cb9-414"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb9-415"><a href="#cb9-415"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb9-416"><a href="#cb9-416"></a>    pressure_change <span class="sc">+</span></span>
<span id="cb9-417"><a href="#cb9-417"></a>    sunshine <span class="sc">+</span></span>
<span id="cb9-418"><a href="#cb9-418"></a>    evaporation <span class="sc">+</span></span>
<span id="cb9-419"><a href="#cb9-419"></a>    <span class="fu">ns</span>(days_since_rain, <span class="at">df =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb9-420"><a href="#cb9-420"></a>    humidity_ma7 <span class="sc">+</span></span>
<span id="cb9-421"><a href="#cb9-421"></a>    day_cos <span class="sc">+</span></span>
<span id="cb9-422"><a href="#cb9-422"></a>    day_sin,</span>
<span id="cb9-423"><a href="#cb9-423"></a>  <span class="at">data =</span> re_data,</span>
<span id="cb9-424"><a href="#cb9-424"></a>  <span class="at">control =</span> ctrl,</span>
<span id="cb9-425"><a href="#cb9-425"></a>  <span class="at">family =</span> <span class="fu">ziGamma</span>(<span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb9-426"><a href="#cb9-426"></a>)</span>
<span id="cb9-427"><a href="#cb9-427"></a><span class="in">```</span></span>
<span id="cb9-428"><a href="#cb9-428"></a></span>
<span id="cb9-431"><a href="#cb9-431"></a><span class="in">```{r}</span></span>
<span id="cb9-432"><a href="#cb9-432"></a><span class="co">#| label: m6-mixed-output</span></span>
<span id="cb9-433"><a href="#cb9-433"></a><span class="co">#| echo: false</span></span>
<span id="cb9-434"><a href="#cb9-434"></a></span>
<span id="cb9-435"><a href="#cb9-435"></a>m6_mixed <span class="sc">%&gt;%</span></span>
<span id="cb9-436"><a href="#cb9-436"></a>  <span class="fu">tbl_regression</span>(</span>
<span id="cb9-437"><a href="#cb9-437"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-438"><a href="#cb9-438"></a>    <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb9-439"><a href="#cb9-439"></a>      humidity3pm <span class="sc">~</span> <span class="st">"Humidity (3pm)"</span>,</span>
<span id="cb9-440"><a href="#cb9-440"></a>      sunshine <span class="sc">~</span> <span class="st">"Sunshine Duration"</span>,</span>
<span id="cb9-441"><a href="#cb9-441"></a>      sun_humid_interaction <span class="sc">~</span> <span class="st">"Interaction: Sunshine x Humidity"</span>,</span>
<span id="cb9-442"><a href="#cb9-442"></a>      rainfall_ma7 <span class="sc">~</span> <span class="st">"Rainfall Trend (7-Day MA)"</span>,</span>
<span id="cb9-443"><a href="#cb9-443"></a>      days_since_rain <span class="sc">~</span> <span class="st">"Dry Spell Length (Linear)"</span>,</span>
<span id="cb9-444"><a href="#cb9-444"></a>      rain_yesterday <span class="sc">~</span> <span class="st">"Rain Yesterday (Indicator)"</span>,</span>
<span id="cb9-445"><a href="#cb9-445"></a>      gust_U_EW <span class="sc">~</span> <span class="st">"Gust Vector (East-West)"</span>,</span>
<span id="cb9-446"><a href="#cb9-446"></a>      gust_V_NS <span class="sc">~</span> <span class="st">"Gust Vector (North-South)"</span>,</span>
<span id="cb9-447"><a href="#cb9-447"></a>      instability_index <span class="sc">~</span> <span class="st">"Instability Index"</span>,</span>
<span id="cb9-448"><a href="#cb9-448"></a>      day_cos <span class="sc">~</span> <span class="st">"Seasonality (Cos)"</span>,</span>
<span id="cb9-449"><a href="#cb9-449"></a>      day_sin <span class="sc">~</span> <span class="st">"Seasonality (Sin)"</span></span>
<span id="cb9-450"><a href="#cb9-450"></a>    )</span>
<span id="cb9-451"><a href="#cb9-451"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-452"><a href="#cb9-452"></a>  <span class="fu">bold_p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-453"><a href="#cb9-453"></a>  <span class="fu">add_glance_table</span>(<span class="at">include =</span> <span class="fu">c</span>(<span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"logLik"</span>, <span class="st">"nobs"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-454"><a href="#cb9-454"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Predictor**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-455"><a href="#cb9-455"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Model 6: Final Mixed-Effects Model (Random Slopes)**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-456"><a href="#cb9-456"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-457"><a href="#cb9-457"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(</span>
<span id="cb9-458"><a href="#cb9-458"></a>    <span class="at">footnote =</span> <span class="st">"Random effects structure: Uncorrelated random slopes for Humidity, Persistence, and Dewpoint by Location."</span></span>
<span id="cb9-459"><a href="#cb9-459"></a>  )</span>
<span id="cb9-460"><a href="#cb9-460"></a><span class="in">```</span></span>
<span id="cb9-461"><a href="#cb9-461"></a></span>
<span id="cb9-462"><a href="#cb9-462"></a>All five preceding models treat the data as if every observation were drawn from the same underlying population, as if the relationship between humidity and rainfall were identical in coastal Sydney and arid Alice Springs, or as if a wet spell in tropical Darwin carried the same statistical weight as one in temperate Melbourne. This homogeneity assumption is implausible for a continent as climatologically diverse as Australia.</span>
<span id="cb9-463"><a href="#cb9-463"></a></span>
<span id="cb9-464"><a href="#cb9-464"></a>Model 6 relaxes it through a mixed-effects structure. Location-specific random effects allow the intercept and three scientifically motivated slopes; humidity, persistence, and dewpoint change to vary across weather stations. Uncorrelated random slopes (<span class="in">`diag()`</span>) are used rather than a full unstructured covariance matrix, avoiding the overparameterisation that would accompany a freely estimated $4 \times 4$ random covariance structure across the number of locations in this dataset.</span>
<span id="cb9-465"><a href="#cb9-465"></a></span>
<span id="cb9-466"><a href="#cb9-466"></a>Two further additions accompany the move to mixed effects. The zero-inflation submodel is expanded with sunshine, evaporation, and the day-of-year cyclical components, reflecting the hypothesis that occurrence probability is also subject to the full range of atmospheric drivers. And <span class="in">`days_since_rain`</span> in the zero-inflation submodel is replaced with a four-degree-of-freedom natural spline <span class="in">`ns(days_since_rain, df = 4)`</span> directly implementing the "rapid-then-gradual" decay identified in the EDA (@sec-eda). The spline allows the probability of a dry spell ending to drop steeply in the first ten days and stabilise thereafter, rather than assuming a constant log-odds decrement per day.</span>
<span id="cb9-467"><a href="#cb9-467"></a></span>
<span id="cb9-468"><a href="#cb9-468"></a>AIC falls to 396,638, an improvement of $\Delta\text{AIC} \approx 6,503$ relative to Model 5. This is the second-largest single gain after the initial moisture predictors, establishing that spatial heterogeneity is a dominant source of unexplained variance in all the fixed-effects models. The random effects estimates confirm meaningful variability: the random intercept variance ($\hat{\sigma}^2 = 0.12$) captures substantial baseline differences in rainfall between locations; the humidity random slope variance ($\hat{\sigma}^2 = 0.023$) shows that humidity's effect on intensity differs across the country; and the persistence random slope variance ($\hat{\sigma}^2 = 0.013$) indicates that the stickiness of wet weather is more pronounced in some climatic zones than others as one would expect contrasting the monsoonal north, where wet seasons persist for months, with the more variable climate of the southeast.</span>
<span id="cb9-469"><a href="#cb9-469"></a></span>
<span id="cb9-470"><a href="#cb9-470"></a>The fixed effects for global meteorological drivers; wind vectors, the instability index, and the sunshine-humidity interaction remain significant and directionally consistent with the preceding models. These are robust, continent-wide physical mechanisms whose effects persist even after allowing each location's parameters to deviate from the global mean.</span>
<span id="cb9-471"><a href="#cb9-471"></a></span>
<span id="cb9-472"><a href="#cb9-472"></a>---</span>
<span id="cb9-473"><a href="#cb9-473"></a></span>
<span id="cb9-474"><a href="#cb9-474"></a><span class="fu">## Progressive Model Comparison</span></span>
<span id="cb9-475"><a href="#cb9-475"></a></span>
<span id="cb9-476"><a href="#cb9-476"></a>The table below summarises the AIC trajectory across the model sequence and the cumulative share of the total achievable gain measured relative to the null captured at each step.</span>
<span id="cb9-477"><a href="#cb9-477"></a></span>
<span id="cb9-480"><a href="#cb9-480"></a><span class="in">```{r}</span></span>
<span id="cb9-481"><a href="#cb9-481"></a><span class="co">#| label: final-table</span></span>
<span id="cb9-482"><a href="#cb9-482"></a><span class="co">#| echo: false</span></span>
<span id="cb9-483"><a href="#cb9-483"></a><span class="co">#| warning: false</span></span>
<span id="cb9-484"><a href="#cb9-484"></a><span class="co">#| message: false</span></span>
<span id="cb9-485"><a href="#cb9-485"></a></span>
<span id="cb9-486"><a href="#cb9-486"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb9-487"><a href="#cb9-487"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb9-488"><a href="#cb9-488"></a></span>
<span id="cb9-489"><a href="#cb9-489"></a>model_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-490"><a href="#cb9-490"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"M0"</span>, <span class="st">"M1"</span>, <span class="st">"M2"</span>, <span class="st">"M3"</span>, <span class="st">"M4"</span>, <span class="st">"M5"</span>, <span class="st">"M6"</span>),</span>
<span id="cb9-491"><a href="#cb9-491"></a>  <span class="at">Description =</span> <span class="fu">c</span>(</span>
<span id="cb9-492"><a href="#cb9-492"></a>    <span class="st">"Null (intercept only)"</span>,</span>
<span id="cb9-493"><a href="#cb9-493"></a>    <span class="st">"Moisture and pressure"</span>,</span>
<span id="cb9-494"><a href="#cb9-494"></a>    <span class="st">"Seasonality and persistence"</span>,</span>
<span id="cb9-495"><a href="#cb9-495"></a>    <span class="st">"Accumulated history"</span>,</span>
<span id="cb9-496"><a href="#cb9-496"></a>    <span class="st">"Thermodynamics and interactions"</span>,</span>
<span id="cb9-497"><a href="#cb9-497"></a>    <span class="st">"Wind vectors"</span>,</span>
<span id="cb9-498"><a href="#cb9-498"></a>    <span class="st">"Spatial mixed effects (final)"</span></span>
<span id="cb9-499"><a href="#cb9-499"></a>  ),</span>
<span id="cb9-500"><a href="#cb9-500"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(</span>
<span id="cb9-501"><a href="#cb9-501"></a>    <span class="fl">461669.7</span>, </span>
<span id="cb9-502"><a href="#cb9-502"></a>    <span class="dv">422630</span>,</span>
<span id="cb9-503"><a href="#cb9-503"></a>    <span class="dv">406826</span>,</span>
<span id="cb9-504"><a href="#cb9-504"></a>    <span class="dv">405125</span>,</span>
<span id="cb9-505"><a href="#cb9-505"></a>    <span class="dv">403742</span>,</span>
<span id="cb9-506"><a href="#cb9-506"></a>    <span class="dv">403141</span>,</span>
<span id="cb9-507"><a href="#cb9-507"></a>    <span class="dv">396638</span></span>
<span id="cb9-508"><a href="#cb9-508"></a>  )</span>
<span id="cb9-509"><a href="#cb9-509"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb9-510"><a href="#cb9-510"></a>  </span>
<span id="cb9-511"><a href="#cb9-511"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-512"><a href="#cb9-512"></a>    <span class="st">`</span><span class="at">Delta AIC</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">max</span>(AIC) <span class="sc">-</span> AIC,</span>
<span id="cb9-513"><a href="#cb9-513"></a>    <span class="st">`</span><span class="at">% of Total Gain</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Delta AIC</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">max</span>(<span class="st">`</span><span class="at">Delta AIC</span><span class="st">`</span>),</span>
<span id="cb9-514"><a href="#cb9-514"></a>    </span>
<span id="cb9-515"><a href="#cb9-515"></a>    </span>
<span id="cb9-516"><a href="#cb9-516"></a>    <span class="at">AIC =</span> scales<span class="sc">::</span><span class="fu">comma</span>(AIC, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb9-517"><a href="#cb9-517"></a>    <span class="st">`</span><span class="at">Delta AIC</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb9-518"><a href="#cb9-518"></a>      Model <span class="sc">==</span> <span class="st">"M0"</span>, <span class="st">"-"</span>, </span>
<span id="cb9-519"><a href="#cb9-519"></a>      scales<span class="sc">::</span><span class="fu">comma</span>(<span class="st">`</span><span class="at">Delta AIC</span><span class="st">`</span>, <span class="at">accuracy =</span> <span class="fl">0.1</span>)</span>
<span id="cb9-520"><a href="#cb9-520"></a>    ),</span>
<span id="cb9-521"><a href="#cb9-521"></a>    <span class="st">`</span><span class="at">% of Total Gain</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb9-522"><a href="#cb9-522"></a>      Model <span class="sc">==</span> <span class="st">"M0"</span>, <span class="st">"-"</span>, </span>
<span id="cb9-523"><a href="#cb9-523"></a>      scales<span class="sc">::</span><span class="fu">percent</span>(<span class="st">`</span><span class="at">% of Total Gain</span><span class="st">`</span>, <span class="at">accuracy =</span> <span class="fl">0.1</span>)</span>
<span id="cb9-524"><a href="#cb9-524"></a>    )</span>
<span id="cb9-525"><a href="#cb9-525"></a>  )</span>
<span id="cb9-526"><a href="#cb9-526"></a>model_summary <span class="sc">%&gt;%</span></span>
<span id="cb9-527"><a href="#cb9-527"></a>  <span class="fu">kable</span>(</span>
<span id="cb9-528"><a href="#cb9-528"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Model"</span>, <span class="st">"Description"</span>, <span class="st">"AIC"</span>, <span class="st">"Change in AIC vs Null"</span>, <span class="st">"% of Total Gain"</span>),</span>
<span id="cb9-529"><a href="#cb9-529"></a>    <span class="at">align =</span> <span class="st">"llrrr"</span>,</span>
<span id="cb9-530"><a href="#cb9-530"></a>    <span class="at">caption =</span> <span class="st">"Progressive Model Comparison: AIC Trajectory"</span></span>
<span id="cb9-531"><a href="#cb9-531"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-532"><a href="#cb9-532"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb9-533"><a href="#cb9-533"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb9-534"><a href="#cb9-534"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb9-535"><a href="#cb9-535"></a>    <span class="at">position =</span> <span class="st">"center"</span></span>
<span id="cb9-536"><a href="#cb9-536"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-537"><a href="#cb9-537"></a>  <span class="fu">row_spec</span>(<span class="dv">7</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">background =</span> <span class="st">"#e6f3ff"</span>, <span class="at">color =</span> <span class="st">"#212529"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-538"><a href="#cb9-538"></a>  <span class="fu">add_footnote</span>(</span>
<span id="cb9-539"><a href="#cb9-539"></a>    <span class="fu">c</span>(<span class="st">"AIC: Akaike Information Criterion (Lower is better)"</span>, </span>
<span id="cb9-540"><a href="#cb9-540"></a>      <span class="st">"Total Gain is calculated relative to the maximum improvement achieved by Model 6."</span>),</span>
<span id="cb9-541"><a href="#cb9-541"></a>    <span class="at">notation =</span> <span class="st">"none"</span></span>
<span id="cb9-542"><a href="#cb9-542"></a>  )</span>
<span id="cb9-543"><a href="#cb9-543"></a><span class="in">```</span></span>
<span id="cb9-544"><a href="#cb9-544"></a>The gains are steeply front-loaded. Moisture and pressure alone account for 60% of the total improvement, and adding seasonality and persistence brings the cumulative share to 84.3%. The thermodynamic, interaction, and wind components each contribute genuinely but with diminishing magnitude. The step to mixed effects, however, recovers a disproportionate share of the remaining variance, underscoring that spatial stratification is not a minor correction but a structurally important dimension of the problem that fixed-effects models cannot address by design.</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/blob/main/05-modeling.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>