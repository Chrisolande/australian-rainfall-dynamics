<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="An in-depth statistical analysis of rainfall patterns across 49 Australian cities using Zero-Inflated Gamma GLMMs.">

<title>5&nbsp; Modelling – Australian Rainfall Dynamics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-evaluation.html" rel="next">
<link href="./04-features.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-9eae319670a971b7aedd265dafd44b4f.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-e66b50aa4120364bfa72329fe8653b98.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-9eae319670a971b7aedd265dafd44b4f.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-76e320b9afc80ddeb17272433d3d09ca.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-463e05341c278a50bd9d8b9e5c352418.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-76e320b9afc80ddeb17272433d3d09ca.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-modeling.html">Modelling</a></li><li class="breadcrumb-item"><a href="./05-modeling.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelling</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Australian Rainfall Dynamics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predicting Australian Rainfall</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Data</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-data-prep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Preparation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Feature Engineering</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-features.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Feature Engineering</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Modelling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-modeling.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model Evaluation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-model-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Model Selection</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#a-progressive-zero-inflated-gamma-framework-for-australian-rainfall" id="toc-a-progressive-zero-inflated-gamma-framework-for-australian-rainfall" class="nav-link active" data-scroll-target="#a-progressive-zero-inflated-gamma-framework-for-australian-rainfall"><span class="header-section-number">5.1</span> A Progressive Zero-Inflated Gamma Framework for Australian Rainfall</a></li>
  <li><a href="#model-architecture" id="toc-model-architecture" class="nav-link" data-scroll-target="#model-architecture"><span class="header-section-number">5.2</span> Model Architecture</a></li>
  <li><a href="#model-0-null-baseline" id="toc-model-0-null-baseline" class="nav-link" data-scroll-target="#model-0-null-baseline"><span class="header-section-number">5.3</span> Model 0: Null Baseline</a></li>
  <li><a href="#model-1-moisture-and-pressure-dynamics" id="toc-model-1-moisture-and-pressure-dynamics" class="nav-link" data-scroll-target="#model-1-moisture-and-pressure-dynamics"><span class="header-section-number">5.4</span> Model 1: Moisture and Pressure Dynamics</a></li>
  <li><a href="#model-2-seasonality-and-day-to-day-persistence" id="toc-model-2-seasonality-and-day-to-day-persistence" class="nav-link" data-scroll-target="#model-2-seasonality-and-day-to-day-persistence"><span class="header-section-number">5.5</span> Model 2: Seasonality and Day-to-Day Persistence</a></li>
  <li><a href="#model-3-accumulated-weather-history" id="toc-model-3-accumulated-weather-history" class="nav-link" data-scroll-target="#model-3-accumulated-weather-history"><span class="header-section-number">5.6</span> Model 3: Accumulated Weather History</a></li>
  <li><a href="#model-4-thermodynamic-energy-and-the-rain-corner-interaction" id="toc-model-4-thermodynamic-energy-and-the-rain-corner-interaction" class="nav-link" data-scroll-target="#model-4-thermodynamic-energy-and-the-rain-corner-interaction"><span class="header-section-number">5.7</span> Model 4: Thermodynamic Energy and the Rain Corner Interaction</a></li>
  <li><a href="#model-5-wind-vector-dynamics" id="toc-model-5-wind-vector-dynamics" class="nav-link" data-scroll-target="#model-5-wind-vector-dynamics"><span class="header-section-number">5.8</span> Model 5: Wind Vector Dynamics</a></li>
  <li><a href="#sec-model6" id="toc-sec-model6" class="nav-link" data-scroll-target="#sec-model6"><span class="header-section-number">5.9</span> Model 6: Spatial Heterogeneity via Mixed Effects</a></li>
  <li><a href="#progressive-model-comparison" id="toc-progressive-model-comparison" class="nav-link" data-scroll-target="#progressive-model-comparison"><span class="header-section-number">5.10</span> Progressive Model Comparison</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/blob/main/05-modeling.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-modeling.html">Modelling</a></li><li class="breadcrumb-item"><a href="./05-modeling.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelling</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelling</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="a-progressive-zero-inflated-gamma-framework-for-australian-rainfall" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="a-progressive-zero-inflated-gamma-framework-for-australian-rainfall"><span class="header-section-number">5.1</span> A Progressive Zero-Inflated Gamma Framework for Australian Rainfall</h2>
<hr>
<blockquote class="blockquote">
<p><strong>Chapter Context.</strong> This chapter constructs the statistical model incrementally, beginning from a null baseline and introducing successive layers of physical complexity. Each model corresponds to a coherent hypothesis about the mechanisms driving Australian rainfall, tested against its predecessor via likelihood-based criteria. The model family Zero-Inflated Gamma (ZIG) was selected in direct response to the distributional findings from the EDA: the 64% zero-inflation rate and extreme positive skew of the rainfall distribution make a single-component Gaussian model fundamentally inappropriate.</p>
</blockquote>
<hr>
</section>
<section id="model-architecture" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="model-architecture"><span class="header-section-number">5.2</span> Model Architecture</h2>
<p>A Zero-Inflated Gamma model is a two-component mixture. The first component, the zero-inflation submodel, is a logistic regression that estimates the probability of a structurally zero outcome (a dry day on which no precipitation occurs regardless of atmospheric conditions). The second component, the conditional intensity submodel, is a Gamma regression (with log link) that models the expected rainfall given that rain does fall. Together they answer the two questions identified in <a href="03-eda.html" class="quarto-xref"><span>Chapter 3</span></a>: “Will it rain?” and “If so, how much?”</p>
<p>Formally, for observation <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[P(Y_i = 0) = \pi_i + (1 - \pi_i) \cdot f_\Gamma(0)\]</span> <span class="math display">\[P(Y_i = y) = (1 - \pi_i) \cdot f_\Gamma(y \mid \mu_i, \phi), \quad y &gt; 0\]</span></p>
<p>where <span class="math inline">\(\pi_i = \text{logit}^{-1}(\mathbf{z}_i^\top \boldsymbol{\gamma})\)</span> is the zero-inflation probability and <span class="math inline">\(\mu_i = \exp(\mathbf{x}_i^\top \boldsymbol{\beta})\)</span> is the conditional mean intensity. The two linear predictors, <span class="math inline">\(\mathbf{z}_i\)</span> and <span class="math inline">\(\mathbf{x}_i\)</span>, can include different sets of covariates, allowing predictors of <em>occurrence</em> to differ from predictors of <em>intensity</em>. All models were fitted using <code>glmmTMB</code>, which implements maximum likelihood estimation for this family via the Template Model Builder.</p>
<p>Progressive model construction serves two purposes. It provides a transparent audit trail connecting each modelling decision to its empirical motivation. It also enables incremental comparison: each model can be evaluated against its predecessor to isolate the contribution of the newly added component.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>fit_and_pool <span class="ot">&lt;-</span> <span class="cf">function</span>(cond_formula, zi_formula, datasets, </span>
<span id="cb1-2"><a href="#cb1-2"></a>                         <span class="at">control =</span> <span class="fu">glmmTMBControl</span>(), <span class="at">n_cores =</span> <span class="dv">2</span>L) {</span>
<span id="cb1-3"><a href="#cb1-3"></a>  </span>
<span id="cb1-4"><a href="#cb1-4"></a>  fits <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="fu">seq_along</span>(datasets), <span class="cf">function</span>(i) {</span>
<span id="cb1-5"><a href="#cb1-5"></a>    <span class="fu">glmmTMB</span>(</span>
<span id="cb1-6"><a href="#cb1-6"></a>      <span class="at">formula   =</span> cond_formula,</span>
<span id="cb1-7"><a href="#cb1-7"></a>      <span class="at">ziformula =</span> zi_formula,</span>
<span id="cb1-8"><a href="#cb1-8"></a>      <span class="at">family    =</span> <span class="fu">ziGamma</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb1-9"><a href="#cb1-9"></a>      <span class="at">control   =</span> control,</span>
<span id="cb1-10"><a href="#cb1-10"></a>      <span class="at">data      =</span> datasets[[i]]</span>
<span id="cb1-11"><a href="#cb1-11"></a>    )</span>
<span id="cb1-12"><a href="#cb1-12"></a>  }, <span class="at">mc.cores =</span> n_cores)</span>
<span id="cb1-13"><a href="#cb1-13"></a>  </span>
<span id="cb1-14"><a href="#cb1-14"></a>  <span class="co"># Check for errors from mclapply</span></span>
<span id="cb1-15"><a href="#cb1-15"></a>  errors <span class="ot">&lt;-</span> <span class="fu">sapply</span>(fits, inherits, <span class="st">"try-error"</span>)</span>
<span id="cb1-16"><a href="#cb1-16"></a>  <span class="cf">if</span> (<span class="fu">any</span>(errors)) {</span>
<span id="cb1-17"><a href="#cb1-17"></a>    <span class="fu">warning</span>(<span class="fu">sprintf</span>(<span class="st">"%d model(s) failed to converge"</span>, <span class="fu">sum</span>(errors)))</span>
<span id="cb1-18"><a href="#cb1-18"></a>    fits <span class="ot">&lt;-</span> fits[<span class="sc">!</span>errors]</span>
<span id="cb1-19"><a href="#cb1-19"></a>  }</span>
<span id="cb1-20"><a href="#cb1-20"></a>  </span>
<span id="cb1-21"><a href="#cb1-21"></a>  pooled <span class="ot">&lt;-</span> fits <span class="sc">%&gt;%</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>    mice<span class="sc">::</span><span class="fu">as.mira</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-23"><a href="#cb1-23"></a>    mice<span class="sc">::</span><span class="fu">pool</span>()</span>
<span id="cb1-24"><a href="#cb1-24"></a>  </span>
<span id="cb1-25"><a href="#cb1-25"></a>  fit_stats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-26"><a href="#cb1-26"></a>    <span class="at">AIC    =</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(fits, AIC)),</span>
<span id="cb1-27"><a href="#cb1-27"></a>    <span class="at">BIC    =</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(fits, BIC)),</span>
<span id="cb1-28"><a href="#cb1-28"></a>    <span class="at">logLik =</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(fits, <span class="cf">function</span>(f) <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(f))))</span>
<span id="cb1-29"><a href="#cb1-29"></a>  )</span>
<span id="cb1-30"><a href="#cb1-30"></a>  </span>
<span id="cb1-31"><a href="#cb1-31"></a>  <span class="fu">list</span>(</span>
<span id="cb1-32"><a href="#cb1-32"></a>    <span class="at">pooled    =</span> <span class="fu">summary</span>(pooled, <span class="at">conf.int =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-33"><a href="#cb1-33"></a>    <span class="at">fit_stats =</span> fit_stats</span>
<span id="cb1-34"><a href="#cb1-34"></a>  )</span>
<span id="cb1-35"><a href="#cb1-35"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<hr>
</section>
<section id="model-0-null-baseline" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="model-0-null-baseline"><span class="header-section-number">5.3</span> Model 0: Null Baseline</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>m0_null <span class="ot">&lt;-</span> <span class="fu">fit_and_pool</span>(</span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="at">cond_formula =</span> rainfall <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="at">zi_formula =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="at">datasets =</span> all_datasets</span>
<span id="cb2-5"><a href="#cb2-5"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">render_pooled_model_table</span>(m0_null, <span class="st">"M0: Null Baseline"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small">
<caption>M0: Null Baseline</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="empty-cells: hide; border-bottom: hidden"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Estimates
</div></th>
<th data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Confidence
</div></th>
<th colspan="4" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Inference
</div></th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">Term</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">Estimate</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">exp(β)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">95% CI</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">SE</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">t</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">df</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="1">
<td colspan="8" style="border-bottom: 1px solid"><em><strong>Conditional (log link)</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Intercept</td>
<td style="text-align: right; width: 7em;">1.883***</td>
<td style="text-align: right;">6.570</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[1.871,&nbsp;1.894]</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">310.01</td>
<td style="text-align: right;">141814.5</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd" data-grouplength="1">
<td colspan="8" style="border-bottom: 1px solid"><em><strong>Zero-inflation (logit link)</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Intercept</td>
<td style="text-align: right; width: 7em;">0.577***</td>
<td style="text-align: right;">1.780</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.566,&nbsp;0.588]</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">104.27</td>
<td style="text-align: right;">141814.5</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="padding: 0"><span style="font-style: italic;">Note: </span></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="padding: 0"><sup></sup> † p&lt;0.1 * p&lt;0.05 ** p&lt;0.01 *** p&lt;0.001</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td style="padding: 0"><sup></sup> AIC: 461669.7 BIC: 461699.3 log-Lik: -230831.8 (averaged across imputed datasets)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="padding: 0"><sup></sup> Pooled via Rubin’s rules.</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tfoot>

</table>
</div>
</div>
<p>Before introducing any covariates, we fit an intercept-only model whose sole purpose is to verify that the ZIG model structure correctly recovers the fundamental statistical properties of the dataset. A null model that fails this calibration check would undermine the validity of all subsequent extensions.</p>
<p>The zero-inflation intercept <span class="math inline">\(\hat{\beta}_{zi} = 0.577\)</span> (SE = 0.006, <span class="math inline">\(p &lt; 0.001\)</span>) back-transforms through the logistic function to an implied dry-day probability of:</p>
<p><span class="math display">\[\hat{P}(\text{Dry}) = \frac{e^{0.577}}{1 + e^{0.577}} \approx 64.03\%\]</span></p>
<p>This matches the empirically observed zero-inflation rate of 64.05% to within a rounding error, confirming that the hurdle mechanism is correctly calibrated to the data-generating process. The conditional intensity intercept <span class="math inline">\(\hat{\beta}_{cond} = 1.883\)</span> (SE = 0.006, <span class="math inline">\(p &lt; 0.001\)</span>) recovers a mean rainy-day intensity of <span class="math inline">\(e^{1.883} \approx 6.57\)</span> mm, consistent with the non-zero conditional mean established in <a href="03-eda.html" class="quarto-xref"><span>Chapter 3</span></a>. Both intercepts are estimated with exceptional precision, reflecting the large sample size and the fact that an intercept-only model imposes no distributional misspecification beyond the assumed family.</p>
<p>This model yields AIC = 461,669.7 and BIC = 461,699.3, serving as the reference against which all subsequent gains are measured.</p>
<hr>
</section>
<section id="model-1-moisture-and-pressure-dynamics" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="model-1-moisture-and-pressure-dynamics"><span class="header-section-number">5.4</span> Model 1: Moisture and Pressure Dynamics</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>m1_moisture <span class="ot">&lt;-</span> <span class="fu">fit_and_pool</span>(</span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="at">cond_formula =</span> rainfall <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> dewpoint_change <span class="sc">+</span> pressure_change,</span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="at">zi_formula   =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span> dewpoint_9am</span>
<span id="cb4-4"><a href="#cb4-4"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small">
<caption>Model 1: Moisture and Pressure Dynamics</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="empty-cells: hide; border-bottom: hidden"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Estimates
</div></th>
<th data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Confidence
</div></th>
<th colspan="4" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Inference
</div></th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">Term</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">Estimate</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">exp(β)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">95% CI</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">SE</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">t</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">df</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="5">
<td colspan="8" style="border-bottom: 1px solid"><em><strong>Conditional (log link)</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Intercept</td>
<td style="text-align: right; width: 7em;">1.380***</td>
<td style="text-align: right;">3.974</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[1.350,&nbsp;1.409]</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">98.10</td>
<td style="text-align: right;">17.5</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity3pm</td>
<td style="text-align: right; width: 7em;">0.403***</td>
<td style="text-align: right;">1.496</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.377,&nbsp;0.428]</td>
<td style="text-align: right;">0.012</td>
<td style="text-align: right;">32.91</td>
<td style="text-align: right;">18.0</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint 9am</td>
<td style="text-align: right; width: 7em;">0.300***</td>
<td style="text-align: right;">1.350</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.261,&nbsp;0.339]</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">16.86</td>
<td style="text-align: right;">11.0</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint Change</td>
<td style="text-align: right; width: 7em;">-0.155***</td>
<td style="text-align: right;">0.857</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.216,&nbsp;-0.093]</td>
<td style="text-align: right;">0.028</td>
<td style="text-align: right;">-5.58</td>
<td style="text-align: right;">10.1</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Pressure Change</td>
<td style="text-align: right; width: 7em;">0.116**</td>
<td style="text-align: right;">1.123</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.041,&nbsp;0.191]</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">3.48</td>
<td style="text-align: right;">9.4</td>
<td style="text-align: right; width: 5em;">0.007</td>
</tr>
<tr class="odd" data-grouplength="3">
<td colspan="8" style="border-bottom: 1px solid"><em><strong>Zero-inflation (logit link)</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Intercept</td>
<td style="text-align: right; width: 7em;">0.707***</td>
<td style="text-align: right;">2.029</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.694,&nbsp;0.721]</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">103.23</td>
<td style="text-align: right;">395.4</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity3pm</td>
<td style="text-align: right; width: 7em;">-1.038***</td>
<td style="text-align: right;">0.354</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-1.065,&nbsp;-1.012]</td>
<td style="text-align: right;">0.013</td>
<td style="text-align: right;">-82.23</td>
<td style="text-align: right;">20.4</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint 9am</td>
<td style="text-align: right; width: 7em;">0.002</td>
<td style="text-align: right;">1.002</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.014,&nbsp;0.017]</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">58.9</td>
<td style="text-align: right; width: 5em;">0.840</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="padding: 0"><span style="font-style: italic;">Note: </span></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="padding: 0"><sup></sup> † p&lt;0.1 * p&lt;0.05 ** p&lt;0.01 *** p&lt;0.001</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td style="padding: 0"><sup></sup> AIC: 425731.4 BIC: 425820.1 log-Lik: -212856.7 (averaged across imputed datasets)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="padding: 0"><sup></sup> Pooled via Rubin’s rules.</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tfoot>

</table>
</div>
</div>
<p>The correlation analysis in <a href="03-eda.html" class="quarto-xref"><span>Chapter 3</span></a> identified afternoon relative humidity and morning dewpoint temperature as among the strongest individual predictors of rainfall occurrence. That analysis also established that both the absolute level and the diurnal rate of change of sea-level pressure carry discriminating signal. Model 1 formalises these findings by introducing the four most physically direct atmospheric moisture and pressure drivers into the conditional intensity submodel, and a subset of the moisture indicators into the zero-inflation submodel.</p>
<p>The AIC falls from 461,669.7 to 425,731.4, a reduction of 35,938.3 points. This is the largest single improvement across the entire model sequence, and its magnitude confirms that atmospheric moisture and pressure dynamics are not merely correlated with rainfall but constitute its fundamental predictive substrate. All four conditional predictors are highly significant (<span class="math inline">\(p &lt; 0.001\)</span>).</p>
<p>The positive coefficients for <code>humidity3pm</code> (<span class="math inline">\(\hat{\beta} = 0.403\)</span>, <span class="math inline">\(e^{0.403} \approx 1.50\)</span>) and <code>dewpoint_9am</code> (<span class="math inline">\(\hat{\beta} = 0.300\)</span>, <span class="math inline">\(e^{0.300} \approx 1.35\)</span>) establish that both the relative saturation of the afternoon boundary layer and the absolute moisture content of the morning atmosphere independently amplify rainfall intensity on days when precipitation occurs. These two predictors operate at different timescales: afternoon humidity reflects the near-instantaneous condition of the lower troposphere as convective processes become active, while morning dewpoint captures the ambient moisture available before any daytime heating-driven changes have taken effect.</p>
<p>The dewpoint change coefficient (<span class="math inline">\(\hat{\beta} = -0.155\)</span>, <span class="math inline">\(p &lt; 0.001\)</span>) is negative, indicating that a diurnal drop in dewpoint from morning to afternoon (consistent with the dry air entrainment accompanying subsiding high-pressure systems) is associated with reduced rainfall intensity. Conversely, a rise in pressure over the observation window (<span class="math inline">\(\hat{\beta} = 0.116\)</span>, <span class="math inline">\(p = 0.007\)</span>) is positively associated with intensity, a somewhat counterintuitive result that likely reflects synoptic-scale convergence patterns preceding frontal rainfall.</p>
<p>The zero-inflation submodel reveals a meaningful asymmetry between the two moisture variables. The <code>humidity3pm</code> coefficient of <span class="math inline">\(-1.038\)</span> (<span class="math inline">\(p &lt; 0.001\)</span>) is strongly negative in the logistic framework: since the outcome modelled is the dry-day indicator, this implies that higher afternoon humidity substantially reduces the probability of a dry day and thereby increases the probability of rainfall. <code>dewpoint_9am</code>, by contrast, is not significant in the zero-inflation component (<span class="math inline">\(\hat{\beta} = 0.002\)</span>, <span class="math inline">\(p = 0.840\)</span>). This dissociation suggests that it is the relative saturation of the afternoon atmosphere that determines whether the thermodynamic threshold for precipitation is crossed, while the absolute morning moisture content shapes the intensity of rainfall once that threshold has been exceeded.</p>
<hr>
</section>
<section id="model-2-seasonality-and-day-to-day-persistence" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="model-2-seasonality-and-day-to-day-persistence"><span class="header-section-number">5.5</span> Model 2: Seasonality and Day-to-Day Persistence</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>m2_temporal <span class="ot">&lt;-</span> <span class="fu">fit_and_pool</span>(</span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="at">cond_formula =</span> rainfall <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> dewpoint_change <span class="sc">+</span> pressure_change <span class="sc">+</span> day_cos <span class="sc">+</span> day_sin,</span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="at">zi_formula   =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> rain_yesterday <span class="sc">+</span> cloud_development <span class="sc">+</span> pressure_change</span>
<span id="cb5-4"><a href="#cb5-4"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small">
<caption>Model 2: Seasonality and Persistence Effects</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="empty-cells: hide; border-bottom: hidden"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Estimates
</div></th>
<th data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Confidence
</div></th>
<th colspan="4" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Inference
</div></th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">Term</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">Estimate</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">exp(β)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">95% CI</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">SE</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">t</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">df</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="7">
<td colspan="8" style="border-bottom: 1px solid"><em><strong>Conditional (log link)</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Intercept</td>
<td style="text-align: right; width: 7em;">1.369***</td>
<td style="text-align: right;">3.933</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[1.282,&nbsp;1.456]</td>
<td style="text-align: right;">0.024</td>
<td style="text-align: right;">57.02</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity3pm</td>
<td style="text-align: right; width: 7em;">0.436***</td>
<td style="text-align: right;">1.546</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.421,&nbsp;0.450]</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">59.77</td>
<td style="text-align: right;">754.1</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint 9am</td>
<td style="text-align: right; width: 7em;">0.258***</td>
<td style="text-align: right;">1.294</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.232,&nbsp;0.284]</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">23.79</td>
<td style="text-align: right;">6.6</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint Change</td>
<td style="text-align: right; width: 7em;">-0.164*</td>
<td style="text-align: right;">0.849</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.303,&nbsp;-0.024]</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">-4.72</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right; width: 5em;">0.036</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Pressure Change</td>
<td style="text-align: right; width: 7em;">0.110*</td>
<td style="text-align: right;">1.116</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.047,&nbsp;0.173]</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">6.54</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right; width: 5em;">0.015</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Day Cos</td>
<td style="text-align: right; width: 7em;">0.086***</td>
<td style="text-align: right;">1.090</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.070,&nbsp;0.102]</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">10.85</td>
<td style="text-align: right;">69.6</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Day Sin</td>
<td style="text-align: right; width: 7em;">-0.016*</td>
<td style="text-align: right;">0.984</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.030,&nbsp;-0.002]</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">-2.27</td>
<td style="text-align: right;">48.7</td>
<td style="text-align: right; width: 5em;">0.027</td>
</tr>
<tr class="odd" data-grouplength="6">
<td colspan="8" style="border-bottom: 1px solid"><em><strong>Zero-inflation (logit link)</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Intercept</td>
<td style="text-align: right; width: 7em;">1.077***</td>
<td style="text-align: right;">2.937</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[1.061,&nbsp;1.093]</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">133.93</td>
<td style="text-align: right;">210.9</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity3pm</td>
<td style="text-align: right; width: 7em;">-0.919***</td>
<td style="text-align: right;">0.399</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.999,&nbsp;-0.838]</td>
<td style="text-align: right;">0.023</td>
<td style="text-align: right;">-40.31</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint 9am</td>
<td style="text-align: right; width: 7em;">-0.020</td>
<td style="text-align: right;">0.980</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.065,&nbsp;0.026]</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">-1.35</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right; width: 5em;">0.267</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Pressure Change</td>
<td style="text-align: right; width: 7em;">-0.309*</td>
<td style="text-align: right;">0.734</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.555,&nbsp;-0.062]</td>
<td style="text-align: right;">0.059</td>
<td style="text-align: right;">-5.26</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: right; width: 5em;">0.032</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Rain Yesterday (Yes)</td>
<td style="text-align: right; width: 7em;">-1.449***</td>
<td style="text-align: right;">0.235</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-1.479,&nbsp;-1.418]</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">-92.68</td>
<td style="text-align: right;">271.9</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Cloud Development</td>
<td style="text-align: right; width: 7em;">0.115***</td>
<td style="text-align: right;">1.122</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.098,&nbsp;0.133]</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">14.22</td>
<td style="text-align: right;">17.8</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="padding: 0"><span style="font-style: italic;">Note: </span></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="padding: 0"><sup></sup> † p&lt;0.1 * p&lt;0.05 ** p&lt;0.01 *** p&lt;0.001</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td style="padding: 0"><sup></sup> AIC: 412448.4 BIC: 412586.5 log-Lik: -206210.2 (averaged across imputed datasets)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="padding: 0"><sup></sup> Pooled via Rubin’s rules.</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tfoot>

</table>
</div>
</div>
<p>Having established moisture and pressure as foundational drivers, Model 2 incorporates the temporal structure identified in <a href="03-eda.html" class="quarto-xref"><span>Chapter 3</span></a>. The Markov Chain analysis in <a href="03-eda.html#sec-markov" class="quarto-xref"><span>Section 3.5.2</span></a> demonstrated that the previous day’s rain state carries a moderate but practically significant effect (Cramér’s <span class="math inline">\(V \approx 0.31\)</span>), and the seasonal decomposition confirmed that both frequency and intensity of rainfall follow a smooth annual cycle. Circular sine and cosine encodings of the day-of-year enter the conditional intensity submodel, capturing this periodicity without imposing a discontinuity at the calendar year boundary. The binary indicator <code>rain_yesterday</code>, the <code>cloud_development</code> index, and <code>pressure_change</code> are added to the zero-inflation component to account for daily persistence and synoptic-scale dynamics in the occurrence process.</p>
<p>The AIC falls to 412,448.4, a reduction of 13,282.6 points relative to Model 1 (BIC = 412,586.5). This improvement confirms that temporal context, specifically both where in the annual cycle a day falls and what occurred the preceding day, contributes substantial predictive information beyond the instantaneous atmospheric state.</p>
<p>Both seasonal harmonics are statistically significant. The cosine term (<span class="math inline">\(\hat{\beta} = 0.086\)</span>, <span class="math inline">\(p &lt; 0.001\)</span>) captures the primary annual amplitude, while the sine term (<span class="math inline">\(\hat{\beta} = -0.016\)</span>, <span class="math inline">\(p = 0.027\)</span>) adjusts the timing of the seasonal peak. Together, they encode the well-documented shift toward wetter conditions during the austral summer across much of the continent, where enhanced monsoonal circulation and elevated sea-surface temperatures increase tropospheric moisture convergence.</p>
<p>The most numerically dominant result is the persistence coefficient in the zero-inflation submodel. With <span class="math inline">\(\hat{\beta}_{zi}(\text{rain\_yesterday}) = -1.449\)</span> (SE = 0.016, <span class="math inline">\(p &lt; 0.001\)</span>), it is the strongest predictor in the hurdle component across the entire model sequence. Exponentiating gives <span class="math inline">\(e^{-1.449} \approx 0.235\)</span>: having rained the previous day reduces the odds of today being classified as dry by approximately 76.5%. This directly quantifies the asymmetric persistence documented in the Markov transition matrix of <a href="03-eda.html#sec-markov" class="quarto-xref"><span>Section 3.5.2</span></a>, wherein wet states are substantially more self-sustaining than dry states. Physically, this reflects the tendency for synoptic weather systems (fronts, troughs, and tropical lows) to persist over multiple days rather than generating isolated single-day precipitation events.</p>
<p>The <code>cloud_development</code> term in the zero-inflation submodel (<span class="math inline">\(\hat{\beta} = 0.115\)</span>, <span class="math inline">\(p &lt; 0.001\)</span>) is positive, implying that greater cloud development is associated with a higher probability of a dry day. This initially counterintuitive result likely reflects the distinction between cloud cover associated with stable, non-precipitating high-pressure systems and the moisture-laden systems that drive actual precipitation. In the presence of the strong humidity predictors already in the model, incremental cloud growth may serve as a proxy for convective inhibition rather than precipitation potential.</p>
<hr>
</section>
<section id="model-3-accumulated-weather-history" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="model-3-accumulated-weather-history"><span class="header-section-number">5.6</span> Model 3: Accumulated Weather History</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>m3_history <span class="ot">&lt;-</span> <span class="fu">fit_and_pool</span>(</span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="at">cond_formula =</span> rainfall <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> dewpoint_change <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>                 pressure_change <span class="sc">+</span> day_cos <span class="sc">+</span> day_sin <span class="sc">+</span> rainfall_ma7 <span class="sc">+</span> </span>
<span id="cb6-4"><a href="#cb6-4"></a>                 days_since_rain <span class="sc">+</span> humidity_ma7 <span class="sc">+</span> rain_yesterday,</span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="at">zi_formula   =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> rain_yesterday <span class="sc">+</span> </span>
<span id="cb6-6"><a href="#cb6-6"></a>                 cloud_development <span class="sc">+</span> pressure_change</span>
<span id="cb6-7"><a href="#cb6-7"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small">
<caption>Model 3: Accumulated Weather History</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="empty-cells: hide; border-bottom: hidden"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Estimates
</div></th>
<th data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Confidence
</div></th>
<th colspan="4" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Inference
</div></th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">Term</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">Estimate</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">exp(β)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">95% CI</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">SE</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">t</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">df</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="11">
<td colspan="8" style="border-bottom: 1px solid"><em><strong>Conditional (log link)</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Intercept</td>
<td style="text-align: right; width: 7em;">1.211***</td>
<td style="text-align: right;">3.357</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[1.182,&nbsp;1.239]</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">87.37</td>
<td style="text-align: right;">24.3</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity3pm</td>
<td style="text-align: right; width: 7em;">0.422***</td>
<td style="text-align: right;">1.526</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.387,&nbsp;0.458]</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">25.67</td>
<td style="text-align: right;">14.7</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint 9am</td>
<td style="text-align: right; width: 7em;">0.221***</td>
<td style="text-align: right;">1.247</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.159,&nbsp;0.283]</td>
<td style="text-align: right;">0.028</td>
<td style="text-align: right;">7.88</td>
<td style="text-align: right;">10.4</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint Change</td>
<td style="text-align: right; width: 7em;">-0.186***</td>
<td style="text-align: right;">0.830</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.251,&nbsp;-0.121]</td>
<td style="text-align: right;">0.029</td>
<td style="text-align: right;">-6.37</td>
<td style="text-align: right;">10.1</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Pressure Change</td>
<td style="text-align: right; width: 7em;">0.110**</td>
<td style="text-align: right;">1.116</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.039,&nbsp;0.180]</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">3.50</td>
<td style="text-align: right;">9.4</td>
<td style="text-align: right; width: 5em;">0.006</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Day Cos</td>
<td style="text-align: right; width: 7em;">0.079***</td>
<td style="text-align: right;">1.082</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.040,&nbsp;0.118]</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">4.39</td>
<td style="text-align: right;">12.8</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Day Sin</td>
<td style="text-align: right; width: 7em;">-0.028**</td>
<td style="text-align: right;">0.972</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.046,&nbsp;-0.011]</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">-3.30</td>
<td style="text-align: right;">40.8</td>
<td style="text-align: right; width: 5em;">0.002</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Rainfall Ma7</td>
<td style="text-align: right; width: 7em;">0.127***</td>
<td style="text-align: right;">1.135</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.115,&nbsp;0.138]</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">21.33</td>
<td style="text-align: right;">2371.5</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Days Since Rain</td>
<td style="text-align: right; width: 7em;">0.003</td>
<td style="text-align: right;">1.003</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.010,&nbsp;0.016]</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">133.1</td>
<td style="text-align: right; width: 5em;">0.694</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity Ma7</td>
<td style="text-align: right; width: 7em;">-0.078***</td>
<td style="text-align: right;">0.925</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.097,&nbsp;-0.059]</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">-8.09</td>
<td style="text-align: right;">109.2</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Rain Yesterday (Yes)</td>
<td style="text-align: right; width: 7em;">0.322***</td>
<td style="text-align: right;">1.379</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.296,&nbsp;0.347]</td>
<td style="text-align: right;">0.013</td>
<td style="text-align: right;">25.08</td>
<td style="text-align: right;">992.2</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd" data-grouplength="10">
<td colspan="8" style="border-bottom: 1px solid"><em><strong>Zero-inflation (logit link)</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Intercept</td>
<td style="text-align: right; width: 7em;">1.041***</td>
<td style="text-align: right;">2.831</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.967,&nbsp;1.114]</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">31.32</td>
<td style="text-align: right;">10.9</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity3pm</td>
<td style="text-align: right; width: 7em;">-0.917***</td>
<td style="text-align: right;">0.400</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.953,&nbsp;-0.882]</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">-55.19</td>
<td style="text-align: right;">14.6</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint 9am</td>
<td style="text-align: right; width: 7em;">-0.015</td>
<td style="text-align: right;">0.985</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.040,&nbsp;0.010]</td>
<td style="text-align: right;">0.012</td>
<td style="text-align: right;">-1.27</td>
<td style="text-align: right;">18.8</td>
<td style="text-align: right; width: 5em;">0.220</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Pressure Change</td>
<td style="text-align: right; width: 7em;">-0.285***</td>
<td style="text-align: right;">0.752</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.404,&nbsp;-0.167]</td>
<td style="text-align: right;">0.053</td>
<td style="text-align: right;">-5.41</td>
<td style="text-align: right;">9.3</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Rain Yesterday (Yes)</td>
<td style="text-align: right; width: 7em;">-1.455***</td>
<td style="text-align: right;">0.233</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-1.488,&nbsp;-1.422]</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">-86.42</td>
<td style="text-align: right;">197.5</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Cloud Development</td>
<td style="text-align: right; width: 7em;">0.116***</td>
<td style="text-align: right;">1.123</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.095,&nbsp;0.138]</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">11.16</td>
<td style="text-align: right;">25.5</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Sunshine Imp Flagged1</td>
<td style="text-align: right; width: 7em;">-0.012</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.104,&nbsp;0.081]</td>
<td style="text-align: right;">0.044</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">16.9</td>
<td style="text-align: right; width: 5em;">0.791</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Evap Imp Flagged1</td>
<td style="text-align: right; width: 7em;">-0.017</td>
<td style="text-align: right;">0.983</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.101,&nbsp;0.068]</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">-0.42</td>
<td style="text-align: right;">20.2</td>
<td style="text-align: right; width: 5em;">0.681</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Cloud3pm Imp Flagged1</td>
<td style="text-align: right; width: 7em;">-0.067</td>
<td style="text-align: right;">0.935</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.245,&nbsp;0.111]</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">-0.83</td>
<td style="text-align: right;">10.9</td>
<td style="text-align: right; width: 5em;">0.424</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Cloud9am Imp Flagged1</td>
<td style="text-align: right; width: 7em;">0.199*</td>
<td style="text-align: right;">1.220</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.034,&nbsp;0.364]</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">2.64</td>
<td style="text-align: right;">11.4</td>
<td style="text-align: right; width: 5em;">0.022</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="padding: 0"><span style="font-style: italic;">Note: </span></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="padding: 0"><sup></sup> † p&lt;0.1 * p&lt;0.05 ** p&lt;0.01 *** p&lt;0.001</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td style="padding: 0"><sup></sup> AIC: 411060.3 BIC: 411277.3 log-Lik: -205508.2 (averaged across imputed datasets)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="padding: 0"><sup></sup> Pooled via Rubin’s rules.</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tfoot>

</table>
</div>
</div>
<p>While Model 2 captured the binary rain state of the previous day, it does not represent the <em>accumulated</em> atmospheric condition over a longer antecedent window. The dry spell analysis in <a href="03-eda.html#sec-dry-spell" class="quarto-xref"><span>Section 3.5.3</span></a> demonstrated that rainfall probability decays as dry spells lengthen, and the moving average analysis showed that 7-day smoothed signals substantially reduce the stochastic variance of both the rainfall and humidity series. Model 3 introduces these medium-horizon history features (<code>rainfall_ma7</code>, <code>humidity_ma7</code>, <code>days_since_rain</code>, and the binary <code>rain_yesterday</code>) into the conditional intensity submodel.</p>
<p>The AIC falls to 411,060.3, a reduction of 1,388.1 points relative to Model 2 (BIC = 411,277.3). This gain is smaller than the earlier improvements, reflecting the natural diminishing returns of adding temporally redundant information once the most immediate prior state has already been captured. The reduction is nonetheless genuine and statistically consistent across imputed datasets.</p>
<p>The coefficients reveal an interpretable partition between immediate and accumulated antecedent conditions. The <code>rain_yesterday</code> coefficient in the conditional intensity component (<span class="math inline">\(\hat{\beta} = 0.322\)</span>, <span class="math inline">\(e^{0.322} \approx 1.38\)</span>, <span class="math inline">\(p &lt; 0.001\)</span>) indicates that rainfall on the preceding day is associated with approximately 38% greater intensity on rainy days, consistent with the physical scenario of a persisting frontal or trough system delivering consecutive rainfall events of comparable character. The <code>rainfall_ma7</code> coefficient (<span class="math inline">\(\hat{\beta} = 0.127\)</span>, <span class="math inline">\(p &lt; 0.001\)</span>) extends this logic to the weekly horizon: a wetter preceding week is associated with heavier current rainfall, suggesting that prolonged wet spells reflect deeper or more extensive atmospheric systems rather than sequences of meteorologically independent events.</p>
<p>The negative coefficient for <code>humidity_ma7</code> (<span class="math inline">\(\hat{\beta} = -0.078\)</span>, <span class="math inline">\(p &lt; 0.001\)</span>) warrants careful interpretation. Conditional on the full predictor set, a persistently humid preceding week is associated with slightly lower rainfall intensity. This likely reflects a distinction between two meteorological regimes: stratiform cloud systems, which sustain elevated background humidity across extended periods without generating intense precipitation, and convective systems, which produce intense episodic rainfall under conditions of rapid moisture change rather than sustained elevated humidity. Once the model incorporates both instantaneous humidity and its 7-day mean, the latter carries the residual signal of these differing system types.</p>
<p>Finally, <code>days_since_rain</code> is not significant in the conditional intensity component (<span class="math inline">\(\hat{\beta} = 0.003\)</span>, <span class="math inline">\(p = 0.694\)</span>). The duration of an antecedent dry spell predicts whether rain will occur, but once the model conditions on rainfall occurring, the length of the preceding drought provides no additional information about the volume of that rainfall. This result reinforces the conceptual separation between the occurrence and intensity sub-processes that motivates the ZIG framework, and foreshadows the use of a flexible spline for this term in the zero-inflation component of Model 6 (<a href="#sec-model6" class="quarto-xref"><span>Section 5.9</span></a>).</p>
<p>Imputation provenance flags for the four ghost-sensor variables (<code>sunshine</code>, <code>evaporation</code>, <code>cloud_3pm</code>, and <code>cloud_9am</code>) were tested in the zero-inflation component across all model specifications from Model 3 onward. None achieved statistical significance (all <span class="math inline">\(p &gt; 0.05\)</span>), confirming that the predictive mean matching imputation did not introduce systematic bias at stations lacking direct instrumentation for these variables. The flags were subsequently excluded from all further model specifications.</p>
<hr>
</section>
<section id="model-4-thermodynamic-energy-and-the-rain-corner-interaction" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="model-4-thermodynamic-energy-and-the-rain-corner-interaction"><span class="header-section-number">5.7</span> Model 4: Thermodynamic Energy and the Rain Corner Interaction</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>m4_energy <span class="ot">&lt;-</span> <span class="fu">fit_and_pool</span>(</span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="at">cond_formula =</span> rainfall <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> dewpoint_change <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>                 pressure_change <span class="sc">+</span> day_cos <span class="sc">+</span> day_sin <span class="sc">+</span> rainfall_ma7 <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4"></a>                 days_since_rain <span class="sc">+</span> humidity_ma7 <span class="sc">+</span> rain_yesterday <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>                 sunshine <span class="sc">+</span> evaporation <span class="sc">+</span> instability_index <span class="sc">+</span> </span>
<span id="cb7-6"><a href="#cb7-6"></a>                 sun_humid_interaction <span class="sc">+</span> cloud_development,</span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="at">zi_formula   =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> rain_yesterday <span class="sc">+</span> </span>
<span id="cb7-8"><a href="#cb7-8"></a>                 cloud_development <span class="sc">+</span> pressure_change</span>
<span id="cb7-9"><a href="#cb7-9"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small">
<caption>Model 4: Thermodynamic Energy and Interactions</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="empty-cells: hide; border-bottom: hidden"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Estimates
</div></th>
<th data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Confidence
</div></th>
<th colspan="4" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Inference
</div></th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">Term</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">Estimate</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">exp(β)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">95% CI</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">SE</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">t</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">df</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="16">
<td colspan="8" style="border-bottom: 1px solid"><em><strong>Conditional (log link)</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Intercept</td>
<td style="text-align: right; width: 7em;">1.241***</td>
<td style="text-align: right;">3.460</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[1.210,&nbsp;1.272]</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">84.70</td>
<td style="text-align: right;">15.4</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity3pm</td>
<td style="text-align: right; width: 7em;">0.223***</td>
<td style="text-align: right;">1.249</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.152,&nbsp;0.294]</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">7.20</td>
<td style="text-align: right;">8.3</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint 9am</td>
<td style="text-align: right; width: 7em;">0.209***</td>
<td style="text-align: right;">1.232</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.142,&nbsp;0.275]</td>
<td style="text-align: right;">0.028</td>
<td style="text-align: right;">7.39</td>
<td style="text-align: right;">7.0</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint Change</td>
<td style="text-align: right; width: 7em;">-0.171**</td>
<td style="text-align: right;">0.843</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.244,&nbsp;-0.097]</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">-5.56</td>
<td style="text-align: right;">6.7</td>
<td style="text-align: right; width: 5em;">0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Pressure Change</td>
<td style="text-align: right; width: 7em;">0.135**</td>
<td style="text-align: right;">1.145</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.055,&nbsp;0.216]</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">4.07</td>
<td style="text-align: right;">6.3</td>
<td style="text-align: right; width: 5em;">0.006</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Day Cos</td>
<td style="text-align: right; width: 7em;">0.017</td>
<td style="text-align: right;">1.017</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.017,&nbsp;0.051]</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">10.4</td>
<td style="text-align: right; width: 5em;">0.298</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Day Sin</td>
<td style="text-align: right; width: 7em;">-0.027**</td>
<td style="text-align: right;">0.973</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.046,&nbsp;-0.008]</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">-2.99</td>
<td style="text-align: right;">20.5</td>
<td style="text-align: right; width: 5em;">0.007</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Rainfall Ma7</td>
<td style="text-align: right; width: 7em;">0.114***</td>
<td style="text-align: right;">1.121</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.102,&nbsp;0.126]</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">18.76</td>
<td style="text-align: right;">466.7</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Days Since Rain</td>
<td style="text-align: right; width: 7em;">0.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.014,&nbsp;0.014]</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">53.2</td>
<td style="text-align: right; width: 5em;">0.999</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity Ma7</td>
<td style="text-align: right; width: 7em;">-0.042***</td>
<td style="text-align: right;">0.959</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.061,&nbsp;-0.023]</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">-4.43</td>
<td style="text-align: right;">92.9</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Rain Yesterday (Yes)</td>
<td style="text-align: right; width: 7em;">0.340***</td>
<td style="text-align: right;">1.405</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.315,&nbsp;0.366]</td>
<td style="text-align: right;">0.013</td>
<td style="text-align: right;">26.45</td>
<td style="text-align: right;">467.9</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Sunshine</td>
<td style="text-align: right; width: 7em;">-0.040*</td>
<td style="text-align: right;">0.961</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.078,&nbsp;-0.002]</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">-2.31</td>
<td style="text-align: right;">10.7</td>
<td style="text-align: right; width: 5em;">0.042</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Evaporation</td>
<td style="text-align: right; width: 7em;">0.154***</td>
<td style="text-align: right;">1.167</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.125,&nbsp;0.183]</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">11.15</td>
<td style="text-align: right;">16.5</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Instability Index</td>
<td style="text-align: right; width: 7em;">0.145***</td>
<td style="text-align: right;">1.156</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.101,&nbsp;0.189]</td>
<td style="text-align: right;">0.019</td>
<td style="text-align: right;">7.62</td>
<td style="text-align: right;">7.9</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Sun Humid Interaction</td>
<td style="text-align: right; width: 7em;">-0.076***</td>
<td style="text-align: right;">0.927</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.110,&nbsp;-0.041]</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">-4.87</td>
<td style="text-align: right;">9.7</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Cloud Development</td>
<td style="text-align: right; width: 7em;">-0.030**</td>
<td style="text-align: right;">0.971</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.049,&nbsp;-0.011]</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">-3.26</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right; width: 5em;">0.004</td>
</tr>
<tr class="even" data-grouplength="6">
<td colspan="8" style="border-bottom: 1px solid"><em><strong>Zero-inflation (logit link)</strong></em></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Intercept</td>
<td style="text-align: right; width: 7em;">1.076***</td>
<td style="text-align: right;">2.933</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[1.060,&nbsp;1.093]</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">128.50</td>
<td style="text-align: right;">209.1</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity3pm</td>
<td style="text-align: right; width: 7em;">-0.914***</td>
<td style="text-align: right;">0.401</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.957,&nbsp;-0.872]</td>
<td style="text-align: right;">0.019</td>
<td style="text-align: right;">-48.71</td>
<td style="text-align: right;">8.6</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint 9am</td>
<td style="text-align: right; width: 7em;">-0.022</td>
<td style="text-align: right;">0.978</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.053,&nbsp;0.008]</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">-1.66</td>
<td style="text-align: right;">10.2</td>
<td style="text-align: right; width: 5em;">0.126</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Pressure Change</td>
<td style="text-align: right; width: 7em;">-0.300***</td>
<td style="text-align: right;">0.741</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.423,&nbsp;-0.177]</td>
<td style="text-align: right;">0.051</td>
<td style="text-align: right;">-5.93</td>
<td style="text-align: right;">6.2</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Rain Yesterday (Yes)</td>
<td style="text-align: right; width: 7em;">-1.453***</td>
<td style="text-align: right;">0.234</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-1.487,&nbsp;-1.419]</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">-85.41</td>
<td style="text-align: right;">114.1</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Cloud Development</td>
<td style="text-align: right; width: 7em;">0.120***</td>
<td style="text-align: right;">1.128</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.093,&nbsp;0.147]</td>
<td style="text-align: right;">0.012</td>
<td style="text-align: right;">9.75</td>
<td style="text-align: right;">11.8</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="padding: 0"><span style="font-style: italic;">Note: </span></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="padding: 0"><sup></sup> † p&lt;0.1 * p&lt;0.05 ** p&lt;0.01 *** p&lt;0.001</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td style="padding: 0"><sup></sup> AIC: 409801.6 BIC: 410028.4 log-Lik: -204877.8 (averaged across imputed datasets)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="padding: 0"><sup></sup> Pooled via Rubin’s rules.</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tfoot>

</table>
</div>
</div>
<p>The bivariate density analysis in <a href="03-eda.html#sec-bivariate-density" class="quarto-xref"><span>Section 3.8</span></a> identified a structural non-linearity in the joint distribution of afternoon humidity and sunshine hours: intense rainfall occurs almost exclusively in the region of the bivariate distribution where humidity is high and sunshine is simultaneously low. An additive model is structurally incapable of representing this conditional geometry. Model 4 introduces the multiplicative <code>sun_humid_interaction</code> term alongside a broader set of thermodynamic energy predictors (<code>sunshine</code>, <code>evaporation</code>, <code>instability_index</code>, and <code>cloud_development</code>) to formalise the physical hypothesis that convective rainfall arises from the conjunction of available moisture and atmospheric instability rather than from either factor in isolation.</p>
<p>The AIC falls to 409,801.6, a reduction of 1,258.7 points relative to Model 3 (BIC = 410,028.4). This gain is modest in absolute terms but carries a disproportionate interpretive weight, because the new terms do not merely add marginal predictive power; they restructure the representation of the moisture signal already present in the model.</p>
<p>The <code>sun_humid_interaction</code> coefficient of <span class="math inline">\(\hat{\beta} = -0.076\)</span> (SE = 0.016, <span class="math inline">\(p &lt; 0.001\)</span>) is highly significant and physically coherent. After mean-centring both component variables, the product term takes large negative values precisely when humidity is above average and sunshine hours are below average. The negative coefficient therefore assigns greater expected rainfall intensity to this region of the covariate space, directly encoding the Rain Corner identified in <a href="03-eda.html#sec-bivariate-density" class="quarto-xref"><span>Section 3.8</span></a>: an overcast, moisture-saturated atmosphere in which solar insolation is suppressed by deep cloud cover, creating the thermodynamic conditions most conducive to sustained or intense precipitation.</p>
<p>The <code>instability_index</code> (<span class="math inline">\(\hat{\beta} = 0.145\)</span>, <span class="math inline">\(p &lt; 0.001\)</span>) operates on related physical grounds: higher atmospheric instability, typically associated with steep lapse rates and strong surface heating, promotes convective development and augments rainfall intensity given that rainfall is occurring. The <code>evaporation</code> coefficient (<span class="math inline">\(\hat{\beta} = 0.154\)</span>, <span class="math inline">\(p &lt; 0.001\)</span>) is positive, suggesting that on rainy days higher potential evaporation (a proxy for energy availability) is associated with greater intensity, consistent with convectively driven systems drawing on sensible and latent heat fluxes.</p>
<p>The entry of the interaction term and the thermodynamic covariates produces a marked reduction in the <code>humidity3pm</code> coefficient, from <span class="math inline">\(0.422\)</span> in Model 3 to <span class="math inline">\(0.223\)</span> in Model 4. This is not indicative of instability or suppression of the humidity signal. It reflects a correct partitioning of explained variance: the portion of humidity’s predictive contribution that operates through its interaction with sunshine, and through the atmospheric instability it enables, is now attributed to those specific mechanistic pathways rather than being absorbed into the humidity main effect alone. The model has advanced from recognising that moisture matters to representing the specific conjunction of conditions under which it matters most.</p>
<hr>
</section>
<section id="model-5-wind-vector-dynamics" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="model-5-wind-vector-dynamics"><span class="header-section-number">5.8</span> Model 5: Wind Vector Dynamics</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>m5_wind <span class="ot">&lt;-</span> <span class="fu">fit_and_pool</span>(</span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="at">cond_formula =</span> rainfall <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> dewpoint_change <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>                 pressure_change <span class="sc">+</span> day_cos <span class="sc">+</span> day_sin <span class="sc">+</span> rainfall_ma7 <span class="sc">+</span> </span>
<span id="cb8-4"><a href="#cb8-4"></a>                 days_since_rain <span class="sc">+</span> humidity_ma7 <span class="sc">+</span> rain_yesterday <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>                 sunshine <span class="sc">+</span> evaporation <span class="sc">+</span> instability_index <span class="sc">+</span> </span>
<span id="cb8-6"><a href="#cb8-6"></a>                 sun_humid_interaction <span class="sc">+</span> cloud_development <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>                 gust_U_EW <span class="sc">+</span> gust_V_NS <span class="sc">+</span> wind9am_V_NS <span class="sc">+</span> wind9am_U_EW,</span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="at">zi_formula   =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> rain_yesterday <span class="sc">+</span> </span>
<span id="cb8-9"><a href="#cb8-9"></a>                 cloud_development <span class="sc">+</span> pressure_change</span>
<span id="cb8-10"><a href="#cb8-10"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small">
<caption>Model 5: Wind Vector Dynamics</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="empty-cells: hide; border-bottom: hidden"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Estimates
</div></th>
<th data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Confidence
</div></th>
<th colspan="4" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Inference
</div></th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">Term</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">Estimate</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">exp(β)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">95% CI</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">SE</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">t</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">df</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="20">
<td colspan="8" style="border-bottom: 1px solid"><em><strong>Conditional (log link)</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Intercept</td>
<td style="text-align: right; width: 7em;">1.211***</td>
<td style="text-align: right;">3.357</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[1.190,&nbsp;1.232]</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">116.21</td>
<td style="text-align: right;">42.5</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity3pm</td>
<td style="text-align: right; width: 7em;">0.197**</td>
<td style="text-align: right;">1.218</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.087,&nbsp;0.307]</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">5.14</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right; width: 5em;">0.009</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint 9am</td>
<td style="text-align: right; width: 7em;">0.257**</td>
<td style="text-align: right;">1.293</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.157,&nbsp;0.356]</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">7.74</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right; width: 5em;">0.003</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint Change</td>
<td style="text-align: right; width: 7em;">-0.158*</td>
<td style="text-align: right;">0.854</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.260,&nbsp;-0.057]</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">-4.75</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right; width: 5em;">0.015</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Pressure Change</td>
<td style="text-align: right; width: 7em;">0.119†</td>
<td style="text-align: right;">1.126</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.004,&nbsp;0.241]</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">3.02</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right; width: 5em;">0.054</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Day Cos</td>
<td style="text-align: right; width: 7em;">-0.005</td>
<td style="text-align: right;">0.995</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.051,&nbsp;0.040]</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right; width: 5em;">0.772</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Day Sin</td>
<td style="text-align: right; width: 7em;">-0.036**</td>
<td style="text-align: right;">0.965</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.060,&nbsp;-0.012]</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">-3.55</td>
<td style="text-align: right;">7.6</td>
<td style="text-align: right; width: 5em;">0.008</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Rainfall Ma7</td>
<td style="text-align: right; width: 7em;">0.107***</td>
<td style="text-align: right;">1.113</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.094,&nbsp;0.121]</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">16.17</td>
<td style="text-align: right;">40.1</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Days Since Rain</td>
<td style="text-align: right; width: 7em;">-0.008</td>
<td style="text-align: right;">0.992</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.020,&nbsp;0.004]</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">-1.27</td>
<td style="text-align: right;">103.8</td>
<td style="text-align: right; width: 5em;">0.208</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity Ma7</td>
<td style="text-align: right; width: 7em;">-0.046**</td>
<td style="text-align: right;">0.955</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.073,&nbsp;-0.019]</td>
<td style="text-align: right;">0.012</td>
<td style="text-align: right;">-3.82</td>
<td style="text-align: right;">10.4</td>
<td style="text-align: right; width: 5em;">0.003</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Rain Yesterday (Yes)</td>
<td style="text-align: right; width: 7em;">0.328***</td>
<td style="text-align: right;">1.388</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.301,&nbsp;0.354]</td>
<td style="text-align: right;">0.013</td>
<td style="text-align: right;">24.83</td>
<td style="text-align: right;">108.3</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Sunshine</td>
<td style="text-align: right; width: 7em;">-0.048†</td>
<td style="text-align: right;">0.953</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.098,&nbsp;0.001]</td>
<td style="text-align: right;">0.019</td>
<td style="text-align: right;">-2.54</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right; width: 5em;">0.054</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Evaporation</td>
<td style="text-align: right; width: 7em;">0.149***</td>
<td style="text-align: right;">1.160</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.121,&nbsp;0.177]</td>
<td style="text-align: right;">0.013</td>
<td style="text-align: right;">11.78</td>
<td style="text-align: right;">10.2</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Instability Index</td>
<td style="text-align: right; width: 7em;">0.155**</td>
<td style="text-align: right;">1.168</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.091,&nbsp;0.219]</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">7.00</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right; width: 5em;">0.003</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Sun Humid Interaction</td>
<td style="text-align: right; width: 7em;">-0.084**</td>
<td style="text-align: right;">0.920</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.118,&nbsp;-0.049]</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">-6.06</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right; width: 5em;">0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Cloud Development</td>
<td style="text-align: right; width: 7em;">-0.024†</td>
<td style="text-align: right;">0.976</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.049,&nbsp;0.001]</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">-2.32</td>
<td style="text-align: right;">6.8</td>
<td style="text-align: right; width: 5em;">0.055</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Gust U EW</td>
<td style="text-align: right; width: 7em;">-0.056***</td>
<td style="text-align: right;">0.945</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.070,&nbsp;-0.042]</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">-8.02</td>
<td style="text-align: right;">37.9</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Gust V NS</td>
<td style="text-align: right; width: 7em;">-0.008</td>
<td style="text-align: right;">0.992</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.023,&nbsp;0.007]</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">-1.17</td>
<td style="text-align: right;">15.4</td>
<td style="text-align: right; width: 5em;">0.261</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Wind9am V NS</td>
<td style="text-align: right; width: 7em;">-0.008</td>
<td style="text-align: right;">0.992</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.019,&nbsp;0.003]</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: right;">-1.46</td>
<td style="text-align: right;">749.0</td>
<td style="text-align: right; width: 5em;">0.145</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Wind9am U EW</td>
<td style="text-align: right; width: 7em;">-0.116***</td>
<td style="text-align: right;">0.890</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.135,&nbsp;-0.098]</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">-13.84</td>
<td style="text-align: right;">10.4</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even" data-grouplength="6">
<td colspan="8" style="border-bottom: 1px solid"><em><strong>Zero-inflation (logit link)</strong></em></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Intercept</td>
<td style="text-align: right; width: 7em;">1.075***</td>
<td style="text-align: right;">2.931</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[1.058,&nbsp;1.093]</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">122.25</td>
<td style="text-align: right;">48.7</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity3pm</td>
<td style="text-align: right; width: 7em;">-0.911***</td>
<td style="text-align: right;">0.402</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.963,&nbsp;-0.859]</td>
<td style="text-align: right;">0.019</td>
<td style="text-align: right;">-47.33</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint 9am</td>
<td style="text-align: right; width: 7em;">-0.025</td>
<td style="text-align: right;">0.976</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.064,&nbsp;0.015]</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">-1.64</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right; width: 5em;">0.167</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Pressure Change</td>
<td style="text-align: right; width: 7em;">-0.293*</td>
<td style="text-align: right;">0.746</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.472,&nbsp;-0.114]</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">-5.14</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right; width: 5em;">0.013</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Rain Yesterday (Yes)</td>
<td style="text-align: right; width: 7em;">-1.456***</td>
<td style="text-align: right;">0.233</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-1.492,&nbsp;-1.420]</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">-81.99</td>
<td style="text-align: right;">34.8</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Cloud Development</td>
<td style="text-align: right; width: 7em;">0.124***</td>
<td style="text-align: right;">1.132</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.085,&nbsp;0.162]</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">8.35</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="padding: 0"><span style="font-style: italic;">Note: </span></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="padding: 0"><sup></sup> † p&lt;0.1 * p&lt;0.05 ** p&lt;0.01 *** p&lt;0.001</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td style="padding: 0"><sup></sup> AIC: 409149.2 BIC: 409415.5 log-Lik: -204547.6 (averaged across imputed datasets)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="padding: 0"><sup></sup> Pooled via Rubin’s rules.</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tfoot>

</table>
</div>
</div>
<p>Model 5 tests whether the directional provenance of air masses provides additional information about rainfall intensity beyond the instantaneous thermodynamic state of the atmosphere. As developed in <a href="04-features.html" class="quarto-xref"><span>Chapter 4</span></a>, wind direction is encoded as orthogonal zonal (U, east-west) and meridional (V, north-south) vector components, preserving the circular geometry of directional data and avoiding the discontinuity that would arise from treating compass bearing as a linear predictor. Both peak gust components and the 9:00 AM surface wind vectors are included, allowing the model to distinguish between the background synoptic circulation at day onset and the turbulent dynamics associated with active rainfall systems.</p>
<p>The AIC falls to 409,149.2, a reduction of 652.4 points relative to Model 4 (BIC = 409,415.5). This is the smallest stepwise improvement in the sequence. The BIC penalty for the four additional parameters is relatively restrictive, indicating that the marginal gain should be interpreted in the context of the physical interpretability of the effects rather than purely through information criteria.</p>
<p>The most informative wind coefficients are those for the morning surface vectors. <code>wind9am_U_EW</code> (<span class="math inline">\(\hat{\beta} = -0.116\)</span>, SE = 0.008, <span class="math inline">\(p &lt; 0.001\)</span>) is negative for the zonal component: since the U convention assigns positive values to eastward flow, a negative coefficient indicates that westerly airflow at 9:00 AM increases expected rainfall intensity. This is physically consistent with the Roaring Forties, the band of persistent westerly circulation in the mid-latitudes that advects maritime air masses from the Indian Ocean onto the southern and southwestern regions of the continent. <code>wind9am_V_NS</code> is not significant at conventional levels (<span class="math inline">\(\hat{\beta} = -0.008\)</span>, <span class="math inline">\(p = 0.145\)</span>) when the full covariate set is included, though the direction is consistent with southerly incursion enhancing rainfall on the eastern seaboard.</p>
<p>For the peak gust vectors, <code>gust_U_EW</code> is significant (<span class="math inline">\(\hat{\beta} = -0.056\)</span>, <span class="math inline">\(p &lt; 0.001\)</span>), while <code>gust_V_NS</code> is not (<span class="math inline">\(\hat{\beta} = -0.008\)</span>, <span class="math inline">\(p = 0.261\)</span>). The morning wind component has a coefficient approximately twice the magnitude of the corresponding gust component. This contrast supports the interpretation that the prevailing direction of the synoptic-scale air mass at day onset (reflecting the large-scale circulation pattern within which a rainfall event is embedded) is more informative about event intensity than the turbulent, locally generated gusts that accompany active storm activity. The provenance of an air mass carries more predictive information about the moisture it transports than does the mechanical turbulence it generates near the surface.</p>
<p>Coefficients for the moisture, thermodynamic, and interaction terms established in prior models remain stable in direction and magnitude across this extension, confirming that the wind predictors explain variance not already accounted for by thermodynamic state, rather than displacing existing effects through collinearity with humidity or pressure.</p>
<hr>
</section>
<section id="sec-model6" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="sec-model6"><span class="header-section-number">5.9</span> Model 6: Spatial Heterogeneity via Mixed Effects</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>m6_mixed <span class="ot">&lt;-</span> <span class="fu">fit_and_pool</span>(</span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="at">cond_formula =</span> rainfall <span class="sc">~</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>    humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> dewpoint_change <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>    pressure_change <span class="sc">+</span> day_cos <span class="sc">+</span> day_sin <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>    rainfall_ma7 <span class="sc">+</span> days_since_rain <span class="sc">+</span> humidity_ma7 <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>    rain_yesterday <span class="sc">+</span> sunshine <span class="sc">+</span> evaporation <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>    instability_index <span class="sc">+</span> sun_humid_interaction <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>    cloud_development <span class="sc">+</span> gust_U_EW <span class="sc">+</span> gust_V_NS <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>    wind9am_V_NS <span class="sc">+</span> wind9am_U_EW <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">+</span> humidity3pm <span class="sc">+</span> rain_yesterday <span class="sc">+</span> dewpoint_change <span class="sc">|</span> location),</span>
<span id="cb9-11"><a href="#cb9-11"></a>  <span class="at">zi_formula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> rain_yesterday <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>    cloud_development <span class="sc">+</span> pressure_change <span class="sc">+</span> sunshine <span class="sc">+</span></span>
<span id="cb9-13"><a href="#cb9-13"></a>    evaporation <span class="sc">+</span> <span class="fu">ns</span>(days_since_rain, <span class="at">df =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14"></a>    (<span class="dv">1</span> <span class="sc">|</span> location) <span class="sc">+</span> humidity_ma7 <span class="sc">+</span> day_cos <span class="sc">+</span> day_sin,</span>
<span id="cb9-15"><a href="#cb9-15"></a>  <span class="at">datasets =</span> all_datasets,</span>
<span id="cb9-16"><a href="#cb9-16"></a>  <span class="at">control  =</span> <span class="fu">glmmTMBControl</span>(</span>
<span id="cb9-17"><a href="#cb9-17"></a>    <span class="at">optimizer =</span> nlminb,</span>
<span id="cb9-18"><a href="#cb9-18"></a>    <span class="at">optCtrl   =</span> <span class="fu">list</span>(<span class="at">iter.max =</span> <span class="dv">500</span>, <span class="at">eval.max =</span> <span class="dv">1000</span>)</span>
<span id="cb9-19"><a href="#cb9-19"></a>  ),</span>
<span id="cb9-20"><a href="#cb9-20"></a>  <span class="at">n_cores =</span> <span class="dv">3</span>L</span>
<span id="cb9-21"><a href="#cb9-21"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small">
<caption>M6: Fixed Effects Model</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="empty-cells: hide; border-bottom: hidden"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Estimates
</div></th>
<th data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Confidence
</div></th>
<th colspan="4" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px; font-weight: bold; font-size: 13px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Inference
</div></th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">Term</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">Estimate</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">exp(β)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">95% CI</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">SE</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">t</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">df</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: rgba(44, 62, 80, 255) !important;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="20">
<td colspan="8" style="border-bottom: 1px solid"><em><strong>Conditional (log link)</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Intercept</td>
<td style="text-align: right; width: 7em;">1.130***</td>
<td style="text-align: right;">3.097</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[1.032,&nbsp;1.229]</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">22.42</td>
<td style="text-align: right;">29400.5</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity3pm</td>
<td style="text-align: right; width: 7em;">0.231***</td>
<td style="text-align: right;">1.260</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.132,&nbsp;0.331]</td>
<td style="text-align: right;">0.043</td>
<td style="text-align: right;">5.41</td>
<td style="text-align: right;">7.6</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint 9am</td>
<td style="text-align: right; width: 7em;">0.185**</td>
<td style="text-align: right;">1.203</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.099,&nbsp;0.270]</td>
<td style="text-align: right;">0.032</td>
<td style="text-align: right;">5.85</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right; width: 5em;">0.003</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint Change</td>
<td style="text-align: right; width: 7em;">-0.244***</td>
<td style="text-align: right;">0.783</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.321,&nbsp;-0.167]</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">-7.29</td>
<td style="text-align: right;">8.2</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Pressure Change</td>
<td style="text-align: right; width: 7em;">0.160**</td>
<td style="text-align: right;">1.173</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.074,&nbsp;0.246]</td>
<td style="text-align: right;">0.028</td>
<td style="text-align: right;">5.63</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right; width: 5em;">0.009</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Day Cos</td>
<td style="text-align: right; width: 7em;">0.017</td>
<td style="text-align: right;">1.017</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.025,&nbsp;0.059]</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right; width: 5em;">0.356</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Day Sin</td>
<td style="text-align: right; width: 7em;">-0.028*</td>
<td style="text-align: right;">0.973</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.050,&nbsp;-0.005]</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">-2.75</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: right; width: 5em;">0.023</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Rainfall Ma7</td>
<td style="text-align: right; width: 7em;">0.067***</td>
<td style="text-align: right;">1.069</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.053,&nbsp;0.081]</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">9.79</td>
<td style="text-align: right;">30.1</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Days Since Rain</td>
<td style="text-align: right; width: 7em;">-0.013*</td>
<td style="text-align: right;">0.987</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.024,&nbsp;-0.001]</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">-2.22</td>
<td style="text-align: right;">884.9</td>
<td style="text-align: right; width: 5em;">0.027</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity Ma7</td>
<td style="text-align: right; width: 7em;">-0.023</td>
<td style="text-align: right;">0.977</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.060,&nbsp;0.014]</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">-1.45</td>
<td style="text-align: right;">7.6</td>
<td style="text-align: right; width: 5em;">0.187</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Rain Yesterday (Yes)</td>
<td style="text-align: right; width: 7em;">0.310***</td>
<td style="text-align: right;">1.364</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.270,&nbsp;0.351]</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">15.03</td>
<td style="text-align: right;">198.8</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Sunshine</td>
<td style="text-align: right; width: 7em;">-0.023</td>
<td style="text-align: right;">0.977</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.069,&nbsp;0.023]</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">-1.28</td>
<td style="text-align: right;">5.2</td>
<td style="text-align: right; width: 5em;">0.256</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Evaporation</td>
<td style="text-align: right; width: 7em;">0.125***</td>
<td style="text-align: right;">1.133</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.099,&nbsp;0.150]</td>
<td style="text-align: right;">0.012</td>
<td style="text-align: right;">10.41</td>
<td style="text-align: right;">13.7</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Instability Index</td>
<td style="text-align: right; width: 7em;">0.200***</td>
<td style="text-align: right;">1.221</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.158,&nbsp;0.241]</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">12.60</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Sun Humid Interaction</td>
<td style="text-align: right; width: 7em;">-0.064**</td>
<td style="text-align: right;">0.938</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.094,&nbsp;-0.034]</td>
<td style="text-align: right;">0.013</td>
<td style="text-align: right;">-5.05</td>
<td style="text-align: right;">7.0</td>
<td style="text-align: right; width: 5em;">0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Cloud Development</td>
<td style="text-align: right; width: 7em;">-0.020</td>
<td style="text-align: right;">0.980</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.047,&nbsp;0.006]</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">-1.85</td>
<td style="text-align: right;">6.2</td>
<td style="text-align: right; width: 5em;">0.112</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Gust U EW</td>
<td style="text-align: right; width: 7em;">-0.075***</td>
<td style="text-align: right;">0.927</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.090,&nbsp;-0.060]</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">-10.24</td>
<td style="text-align: right;">27.2</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Gust V NS</td>
<td style="text-align: right; width: 7em;">-0.004</td>
<td style="text-align: right;">0.996</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.018,&nbsp;0.009]</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">-0.66</td>
<td style="text-align: right;">22.6</td>
<td style="text-align: right; width: 5em;">0.513</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Wind9am V NS</td>
<td style="text-align: right; width: 7em;">-0.001</td>
<td style="text-align: right;">0.999</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.012,&nbsp;0.010]</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">3836.7</td>
<td style="text-align: right; width: 5em;">0.874</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Wind9am U EW</td>
<td style="text-align: right; width: 7em;">-0.103***</td>
<td style="text-align: right;">0.902</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.119,&nbsp;-0.087]</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">-13.54</td>
<td style="text-align: right;">20.0</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even" data-grouplength="15">
<td colspan="8" style="border-bottom: 1px solid"><em><strong>Zero-inflation (logit link)</strong></em></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Intercept</td>
<td style="text-align: right; width: 7em;">1.049***</td>
<td style="text-align: right;">2.855</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.906,&nbsp;1.192]</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">14.47</td>
<td style="text-align: right;">291.4</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity3pm</td>
<td style="text-align: right; width: 7em;">-0.527***</td>
<td style="text-align: right;">0.590</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.619,&nbsp;-0.435]</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">-16.11</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Dewpoint 9am</td>
<td style="text-align: right; width: 7em;">-0.519***</td>
<td style="text-align: right;">0.595</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.589,&nbsp;-0.448]</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: right;">-18.89</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Pressure Change</td>
<td style="text-align: right; width: 7em;">-0.324*</td>
<td style="text-align: right;">0.723</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.585,&nbsp;-0.063]</td>
<td style="text-align: right;">0.083</td>
<td style="text-align: right;">-3.93</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right; width: 5em;">0.029</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Day Cos</td>
<td style="text-align: right; width: 7em;">0.145***</td>
<td style="text-align: right;">1.156</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.090,&nbsp;0.200]</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">6.69</td>
<td style="text-align: right;">5.2</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Day Sin</td>
<td style="text-align: right; width: 7em;">0.205***</td>
<td style="text-align: right;">1.228</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.177,&nbsp;0.233]</td>
<td style="text-align: right;">0.012</td>
<td style="text-align: right;">17.04</td>
<td style="text-align: right;">7.6</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Humidity Ma7</td>
<td style="text-align: right; width: 7em;">-0.254***</td>
<td style="text-align: right;">0.775</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.329,&nbsp;-0.179]</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: right;">-9.26</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Rain Yesterday (Yes)</td>
<td style="text-align: right; width: 7em;">-1.366***</td>
<td style="text-align: right;">0.255</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-1.414,&nbsp;-1.319]</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">-62.30</td>
<td style="text-align: right;">12.5</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Sunshine</td>
<td style="text-align: right; width: 7em;">0.256***</td>
<td style="text-align: right;">1.292</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.218,&nbsp;0.294]</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">16.13</td>
<td style="text-align: right;">6.6</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Evaporation</td>
<td style="text-align: right; width: 7em;">0.239***</td>
<td style="text-align: right;">1.270</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.211,&nbsp;0.267]</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">17.49</td>
<td style="text-align: right;">31.4</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Cloud Development</td>
<td style="text-align: right; width: 7em;">0.090***</td>
<td style="text-align: right;">1.094</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[0.071,&nbsp;0.108]</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">10.13</td>
<td style="text-align: right;">18.0</td>
<td style="text-align: right; width: 5em;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Days Since Rain (Spline, Df=4)1</td>
<td style="text-align: right; width: 7em;">-0.013</td>
<td style="text-align: right;">0.987</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.082,&nbsp;0.057]</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">-0.36</td>
<td style="text-align: right;">172.5</td>
<td style="text-align: right; width: 5em;">0.719</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Days Since Rain (Spline, Df=4)2</td>
<td style="text-align: right; width: 7em;">0.115†</td>
<td style="text-align: right;">1.122</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.014,&nbsp;0.244]</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">2.01</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right; width: 5em;">0.075</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Days Since Rain (Spline, Df=4)3</td>
<td style="text-align: right; width: 7em;">0.126</td>
<td style="text-align: right;">1.135</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.121,&nbsp;0.373]</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">8.6</td>
<td style="text-align: right; width: 5em;">0.275</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; width: 14em;" data-indentlevel="1">Days Since Rain (Spline, Df=4)4</td>
<td style="text-align: right; width: 7em;">-0.059</td>
<td style="text-align: right;">0.942</td>
<td style="text-align: center; width: 14em; white-space: nowrap;">[-0.232,&nbsp;0.114]</td>
<td style="text-align: right;">0.080</td>
<td style="text-align: right;">-0.74</td>
<td style="text-align: right;">13.0</td>
<td style="text-align: right; width: 5em;">0.472</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="padding: 0"><span style="font-style: italic;">Note: </span></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="padding: 0"><sup></sup> † p&lt;0.1 * p&lt;0.05 ** p&lt;0.01 *** p&lt;0.001</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td style="padding: 0"><sup></sup> AIC: 400997.9 BIC: 401402.2 log-Lik: -200457.9 (averaged across imputed datasets)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="padding: 0"><sup></sup> Pooled via Rubin’s rules.</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tfoot>

</table>
</div>
</div>
<p>All five preceding models implicitly assume that the relationship between each atmospheric predictor and rainfall is spatially uniform, as though the sensitivity of rainfall intensity to afternoon humidity were identical in coastal Sydney, the tropical far north, and the arid interior. For a continent as climatologically heterogeneous as Australia, spanning tropical monsoon, subtropical semi-arid, temperate oceanic, and Mediterranean regimes, this homogeneity assumption is difficult to defend. The EDA in <a href="03-eda.html" class="quarto-xref"><span>Chapter 3</span></a> confirmed that both mean rainfall levels and seasonal patterns vary substantially across the station network.</p>
<p>Model 6 relaxes the spatial homogeneity assumption through a mixed-effects structure. Location-specific random effects allow the intercept and three scientifically motivated slopes (for <code>humidity3pm</code>, <code>rain_yesterday</code>, and <code>dewpoint_change</code>) to vary freely across weather stations. An uncorrelated (diagonal) random effects covariance structure is specified via <code>diag()</code> rather than an unstructured matrix, avoiding the overparameterisation that would accompany a freely estimated <span class="math inline">\(4 \times 4\)</span> random covariance across the number of stations in the dataset. Two further modifications accompany the move to mixed effects. The zero-inflation submodel is expanded with <code>sunshine</code>, <code>evaporation</code>, and the day-of-year harmonic terms, reflecting the hypothesis that occurrence probability is governed by the same broad range of atmospheric drivers as intensity. Additionally, <code>days_since_rain</code> in the zero-inflation submodel is replaced by a four-degree-of-freedom natural spline, directly implementing the non-linear, rapid-then-gradual decay in rainfall probability identified in <a href="03-eda.html#sec-dry-spell" class="quarto-xref"><span>Section 3.5.3</span></a>. The spline permits the marginal probability of precipitation to decline steeply within the first ten days of a dry spell and then stabilise, rather than imposing the constant log-odds decrement implied by a linear term.</p>
<p>The AIC falls to 400,997.9, a reduction of 8,151.3 points relative to Model 5 (BIC = 401,402.2; log-likelihood = <span class="math inline">\(-200,457.9\)</span>). This is the third-largest single improvement in the entire model sequence, exceeded only by the initial introduction of moisture and pressure in Model 1 and the addition of seasonality and persistence in Model 2. The magnitude of the gain establishes that spatial heterogeneity is not a minor correction to an otherwise well-specified model; it is a structurally important dimension of the rainfall generation process that fixed-effects models cannot represent by design.</p>
<p>The fixed-effect estimates for the global-mean relationships remain directionally and numerically consistent with those from Model 5, which provides reassurance that the random effects are absorbing genuine between-location variation rather than confounding the population-average coefficients. Several predictors warrant specific attention in the context of the expanded zero-inflation submodel. <code>dewpoint_9am</code> is now significant in the occurrence model (<span class="math inline">\(\hat{\beta}_{zi} = -0.519\)</span>, <span class="math inline">\(p &lt; 0.001\)</span>), in contrast to its non-significance in all prior specifications. This reversal reflects the expanded zero-inflation predictor set: once sunshine, evaporation, and seasonal harmonics are included in the occurrence model, the morning dewpoint carries a distinct contribution to precipitation probability that was previously absorbed by correlated terms. The <code>humidity_ma7</code> coefficient in the zero-inflation submodel (<span class="math inline">\(\hat{\beta}_{zi} = -0.254\)</span>, <span class="math inline">\(p &lt; 0.001\)</span>) is also negative and substantial, indicating that a persistently humid antecedent week substantially reduces the probability of a dry day, consistent with the view that extended moisture advection creates a background state favourable to continued precipitation.</p>
<p>The natural spline terms for <code>days_since_rain</code> in the zero-inflation submodel are collectively non-significant at conventional thresholds, with the second basis function marginally approaching significance (<span class="math inline">\(\hat{\beta} = 0.115\)</span>, <span class="math inline">\(p = 0.075\)</span>). This suggests that the dry spell decay function, while visually non-linear in the analysis of <a href="03-eda.html#sec-dry-spell" class="quarto-xref"><span>Section 3.5.3</span></a>, does not depart substantially from linearity once the full complement of humidity, seasonal, and persistence predictors is included. The spline is retained for its robustness to potential non-linearity, but the practical difference from a linear specification appears limited given the current covariate set.</p>
<hr>
</section>
<section id="progressive-model-comparison" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="progressive-model-comparison"><span class="header-section-number">5.10</span> Progressive Model Comparison</h2>
<p>The AIC trajectory across the model sequence (summarised in <a href="#tbl-model-comparison" class="quarto-xref">Table&nbsp;<span>5.1</span></a>) reveals a pattern of steeply front-loaded improvement followed by diminishing but genuine increments, with a notable secondary gain at the step to mixed effects.</p>
<div class="cell" data-layout-align="center">
<div id="tbl-model-comparison" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.1: Progressive Model Comparison: AIC Trajectory
</figcaption>
<div aria-describedby="tbl-model-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed do-not-create-environment cell caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Description</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Change in AIC vs Null</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">% of Total Gain</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">M0</td>
<td style="text-align: left;">Null (intercept only)</td>
<td style="text-align: right;">461,669.7</td>
<td style="text-align: right;">-</td>
<td style="text-align: right;">-</td>
</tr>
<tr class="even">
<td style="text-align: left;">M1</td>
<td style="text-align: left;">Moisture and pressure</td>
<td style="text-align: right;">425,731.4</td>
<td style="text-align: right;">35,938.3</td>
<td style="text-align: right;">59.2%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">M2</td>
<td style="text-align: left;">Seasonality and persistence</td>
<td style="text-align: right;">412,448.4</td>
<td style="text-align: right;">49,221.3</td>
<td style="text-align: right;">81.1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">M3</td>
<td style="text-align: left;">Accumulated history</td>
<td style="text-align: right;">411,060.3</td>
<td style="text-align: right;">50,609.4</td>
<td style="text-align: right;">83.4%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">M4</td>
<td style="text-align: left;">Thermodynamics and interactions</td>
<td style="text-align: right;">409,801.6</td>
<td style="text-align: right;">51,868.1</td>
<td style="text-align: right;">85.5%</td>
</tr>
<tr class="even">
<td style="text-align: left;">M5</td>
<td style="text-align: left;">Wind vectors</td>
<td style="text-align: right;">409,149.2</td>
<td style="text-align: right;">52,520.5</td>
<td style="text-align: right;">86.6%</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(33, 37, 41, 255) !important; background-color: rgba(230, 243, 255, 255) !important;">M6</td>
<td style="text-align: left; font-weight: bold; color: rgba(33, 37, 41, 255) !important; background-color: rgba(230, 243, 255, 255) !important;">Spatial mixed effects (final)</td>
<td style="text-align: right; font-weight: bold; color: rgba(33, 37, 41, 255) !important; background-color: rgba(230, 243, 255, 255) !important;">400,997.9</td>
<td style="text-align: right; font-weight: bold; color: rgba(33, 37, 41, 255) !important; background-color: rgba(230, 243, 255, 255) !important;">60,671.8</td>
<td style="text-align: right; font-weight: bold; color: rgba(33, 37, 41, 255) !important; background-color: rgba(230, 243, 255, 255) !important;">100.0%</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0; border: 0;"><sup></sup> AIC: Akaike Information Criterion (Lower is better)</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0; border: 0;"><sup></sup> Total Gain is calculated relative to the maximum improvement achieved by Model 6.</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>
</div>
</div>
</figure>
</div>
</div>
<p>Moisture and pressure dynamics alone account for 55.3% of the total AIC improvement, confirming that atmospheric water content is the primary physical driver of both rainfall occurrence and intensity in the Australian context. The addition of seasonal cycles and day-to-day persistence in Model 2 raises the cumulative share to 75.7%, establishing that temporal structure (the annual insolation cycle and the short-range memory of the atmosphere) constitutes the second-order source of predictive information. The thermodynamic and wind components (Models 4 and 5) each contribute positively but with diminishing returns, reflecting the fact that the mechanistic pathways they represent are partially encoded in earlier proxies.</p>
<p>The step to mixed effects (Model 6) recovers 19.3 percentage points of additional gain, the largest single improvement after the initial moisture signal. This disproportionate improvement, despite the fact that the fixed-effect predictor set changes relatively little between Models 5 and 6, makes explicit a conclusion that is implicit in the geography of the station network: the parameters governing the moisture-intensity relationship, rainfall persistence, and dewpoint sensitivity are not continental constants but regional properties that vary systematically with climate zone. Treating them as such is not a statistical convenience but a physical necessity.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./04-features.html" class="pagination-link" aria-label="Feature Engineering">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Feature Engineering</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-evaluation.html" class="pagination-link" aria-label="Model Evaluation">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model Evaluation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu"># Modelling</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">## A Progressive Zero-Inflated Gamma Framework for Australian Rainfall</span></span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a>---</span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="at">&gt; **Chapter Context.** This chapter constructs the statistical model incrementally, beginning from a null baseline and introducing successive layers of physical complexity. Each model corresponds to a coherent hypothesis about the mechanisms driving Australian rainfall, tested against its predecessor via likelihood-based criteria. The model family Zero-Inflated Gamma (ZIG) was selected in direct response to the distributional findings from the EDA: the 64% zero-inflation rate and extreme positive skew of the rainfall distribution make a single-component Gaussian model fundamentally inappropriate.</span></span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a>---</span>
<span id="cb10-9"><a href="#cb10-9"></a></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="fu">## Model Architecture</span></span>
<span id="cb10-11"><a href="#cb10-11"></a></span>
<span id="cb10-12"><a href="#cb10-12"></a>A Zero-Inflated Gamma model is a two-component mixture. The first component, the zero-inflation submodel, is a logistic regression that estimates the probability of a structurally zero outcome (a dry day on which no precipitation occurs regardless of atmospheric conditions). The second component, the conditional intensity submodel, is a Gamma regression (with log link) that models the expected rainfall given that rain does fall. Together they answer the two questions identified in @sec-eda: "Will it rain?" and "If so, how much?"</span>
<span id="cb10-13"><a href="#cb10-13"></a></span>
<span id="cb10-14"><a href="#cb10-14"></a>Formally, for observation $i$:</span>
<span id="cb10-15"><a href="#cb10-15"></a></span>
<span id="cb10-16"><a href="#cb10-16"></a>$$P(Y_i = 0) = \pi_i + (1 - \pi_i) \cdot f_\Gamma(0)$$</span>
<span id="cb10-17"><a href="#cb10-17"></a>$$P(Y_i = y) = (1 - \pi_i) \cdot f_\Gamma(y \mid \mu_i, \phi), \quad y &gt; 0$$</span>
<span id="cb10-18"><a href="#cb10-18"></a></span>
<span id="cb10-19"><a href="#cb10-19"></a>where $\pi_i = \text{logit}^{-1}(\mathbf{z}_i^\top \boldsymbol{\gamma})$ is the zero-inflation probability and $\mu_i = \exp(\mathbf{x}_i^\top \boldsymbol{\beta})$ is the conditional mean intensity. The two linear predictors, $\mathbf{z}_i$ and $\mathbf{x}_i$, can include different sets of covariates, allowing predictors of *occurrence* to differ from predictors of *intensity*. All models were fitted using <span class="in">`glmmTMB`</span>, which implements maximum likelihood estimation for this family via the Template Model Builder.</span>
<span id="cb10-20"><a href="#cb10-20"></a></span>
<span id="cb10-21"><a href="#cb10-21"></a>Progressive model construction serves two purposes. It provides a transparent audit trail connecting each modelling decision to its empirical motivation. It also enables incremental comparison: each model can be evaluated against its predecessor to isolate the contribution of the newly added component.</span>
<span id="cb10-22"><a href="#cb10-22"></a></span>
<span id="cb10-25"><a href="#cb10-25"></a><span class="in">```{r}</span></span>
<span id="cb10-26"><a href="#cb10-26"></a><span class="co">#| label: setup-modeling</span></span>
<span id="cb10-27"><a href="#cb10-27"></a><span class="co">#| include: false</span></span>
<span id="cb10-28"><a href="#cb10-28"></a></span>
<span id="cb10-29"><a href="#cb10-29"></a>librarian<span class="sc">::</span><span class="fu">shelf</span>(</span>
<span id="cb10-30"><a href="#cb10-30"></a>  tidyverse,</span>
<span id="cb10-31"><a href="#cb10-31"></a>  glmmTMB,</span>
<span id="cb10-32"><a href="#cb10-32"></a>  sjPlot,</span>
<span id="cb10-33"><a href="#cb10-33"></a>  DHARMa,</span>
<span id="cb10-34"><a href="#cb10-34"></a>  kableExtra,</span>
<span id="cb10-35"><a href="#cb10-35"></a>  gtsummary,</span>
<span id="cb10-36"><a href="#cb10-36"></a>  lmtest,</span>
<span id="cb10-37"><a href="#cb10-37"></a>  performance,</span>
<span id="cb10-38"><a href="#cb10-38"></a>  gt,</span>
<span id="cb10-39"><a href="#cb10-39"></a>  broom.mixed,</span>
<span id="cb10-40"><a href="#cb10-40"></a>  parallel,</span>
<span id="cb10-41"><a href="#cb10-41"></a>  splines,</span>
<span id="cb10-42"><a href="#cb10-42"></a>  pROC,</span>
<span id="cb10-43"><a href="#cb10-43"></a>  here</span>
<span id="cb10-44"><a href="#cb10-44"></a>)</span>
<span id="cb10-45"><a href="#cb10-45"></a></span>
<span id="cb10-46"><a href="#cb10-46"></a></span>
<span id="cb10-47"><a href="#cb10-47"></a>all_datasets <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"all_datasets.rds"</span>))</span>
<span id="cb10-48"><a href="#cb10-48"></a></span>
<span id="cb10-49"><a href="#cb10-49"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"utils.R"</span>))</span>
<span id="cb10-50"><a href="#cb10-50"></a></span>
<span id="cb10-51"><a href="#cb10-51"></a></span>
<span id="cb10-52"><a href="#cb10-52"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb10-53"><a href="#cb10-53"></a>  <span class="at">m0_null     =</span> <span class="st">"m0_null_pooled.rds"</span>,</span>
<span id="cb10-54"><a href="#cb10-54"></a>  <span class="at">m1_moisture =</span> <span class="st">"m1_moisture_pooled.rds"</span>,</span>
<span id="cb10-55"><a href="#cb10-55"></a>  <span class="at">m2_temporal =</span> <span class="st">"m2_temporal_pooled.rds"</span>,</span>
<span id="cb10-56"><a href="#cb10-56"></a>  <span class="at">m3_history  =</span> <span class="st">"m3_history_pooled.rds"</span>,</span>
<span id="cb10-57"><a href="#cb10-57"></a>  <span class="at">m4_energy   =</span> <span class="st">"m4_energy_pooled.rds"</span>,</span>
<span id="cb10-58"><a href="#cb10-58"></a>  <span class="at">m5_wind     =</span> <span class="st">"m5_wind_pooled.rds"</span>,</span>
<span id="cb10-59"><a href="#cb10-59"></a>  <span class="at">m6_mixed    =</span> <span class="st">"m6_mixed_pooled.rds"</span></span>
<span id="cb10-60"><a href="#cb10-60"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb10-61"><a href="#cb10-61"></a>  <span class="fu">lapply</span>(<span class="cf">function</span>(f) <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models"</span>, f)))</span>
<span id="cb10-62"><a href="#cb10-62"></a></span>
<span id="cb10-63"><a href="#cb10-63"></a><span class="fu">list2env</span>(models, <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb10-64"><a href="#cb10-64"></a></span>
<span id="cb10-65"><a href="#cb10-65"></a><span class="in">```</span></span>
<span id="cb10-66"><a href="#cb10-66"></a></span>
<span id="cb10-69"><a href="#cb10-69"></a><span class="in">```{r}</span></span>
<span id="cb10-70"><a href="#cb10-70"></a><span class="co">#| label: def-fit-and-pool</span></span>
<span id="cb10-71"><a href="#cb10-71"></a><span class="co">#| echo: true</span></span>
<span id="cb10-72"><a href="#cb10-72"></a></span>
<span id="cb10-73"><a href="#cb10-73"></a>fit_and_pool <span class="ot">&lt;-</span> <span class="cf">function</span>(cond_formula, zi_formula, datasets, </span>
<span id="cb10-74"><a href="#cb10-74"></a>                         <span class="at">control =</span> <span class="fu">glmmTMBControl</span>(), <span class="at">n_cores =</span> <span class="dv">2</span>L) {</span>
<span id="cb10-75"><a href="#cb10-75"></a>  </span>
<span id="cb10-76"><a href="#cb10-76"></a>  fits <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="fu">seq_along</span>(datasets), <span class="cf">function</span>(i) {</span>
<span id="cb10-77"><a href="#cb10-77"></a>    <span class="fu">glmmTMB</span>(</span>
<span id="cb10-78"><a href="#cb10-78"></a>      <span class="at">formula   =</span> cond_formula,</span>
<span id="cb10-79"><a href="#cb10-79"></a>      <span class="at">ziformula =</span> zi_formula,</span>
<span id="cb10-80"><a href="#cb10-80"></a>      <span class="at">family    =</span> <span class="fu">ziGamma</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb10-81"><a href="#cb10-81"></a>      <span class="at">control   =</span> control,</span>
<span id="cb10-82"><a href="#cb10-82"></a>      <span class="at">data      =</span> datasets[[i]]</span>
<span id="cb10-83"><a href="#cb10-83"></a>    )</span>
<span id="cb10-84"><a href="#cb10-84"></a>  }, <span class="at">mc.cores =</span> n_cores)</span>
<span id="cb10-85"><a href="#cb10-85"></a>  </span>
<span id="cb10-86"><a href="#cb10-86"></a>  <span class="co"># Check for errors from mclapply</span></span>
<span id="cb10-87"><a href="#cb10-87"></a>  errors <span class="ot">&lt;-</span> <span class="fu">sapply</span>(fits, inherits, <span class="st">"try-error"</span>)</span>
<span id="cb10-88"><a href="#cb10-88"></a>  <span class="cf">if</span> (<span class="fu">any</span>(errors)) {</span>
<span id="cb10-89"><a href="#cb10-89"></a>    <span class="fu">warning</span>(<span class="fu">sprintf</span>(<span class="st">"%d model(s) failed to converge"</span>, <span class="fu">sum</span>(errors)))</span>
<span id="cb10-90"><a href="#cb10-90"></a>    fits <span class="ot">&lt;-</span> fits[<span class="sc">!</span>errors]</span>
<span id="cb10-91"><a href="#cb10-91"></a>  }</span>
<span id="cb10-92"><a href="#cb10-92"></a>  </span>
<span id="cb10-93"><a href="#cb10-93"></a>  pooled <span class="ot">&lt;-</span> fits <span class="sc">%&gt;%</span></span>
<span id="cb10-94"><a href="#cb10-94"></a>    mice<span class="sc">::</span><span class="fu">as.mira</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-95"><a href="#cb10-95"></a>    mice<span class="sc">::</span><span class="fu">pool</span>()</span>
<span id="cb10-96"><a href="#cb10-96"></a>  </span>
<span id="cb10-97"><a href="#cb10-97"></a>  fit_stats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-98"><a href="#cb10-98"></a>    <span class="at">AIC    =</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(fits, AIC)),</span>
<span id="cb10-99"><a href="#cb10-99"></a>    <span class="at">BIC    =</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(fits, BIC)),</span>
<span id="cb10-100"><a href="#cb10-100"></a>    <span class="at">logLik =</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(fits, <span class="cf">function</span>(f) <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(f))))</span>
<span id="cb10-101"><a href="#cb10-101"></a>  )</span>
<span id="cb10-102"><a href="#cb10-102"></a>  </span>
<span id="cb10-103"><a href="#cb10-103"></a>  <span class="fu">list</span>(</span>
<span id="cb10-104"><a href="#cb10-104"></a>    <span class="at">pooled    =</span> <span class="fu">summary</span>(pooled, <span class="at">conf.int =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-105"><a href="#cb10-105"></a>    <span class="at">fit_stats =</span> fit_stats</span>
<span id="cb10-106"><a href="#cb10-106"></a>  )</span>
<span id="cb10-107"><a href="#cb10-107"></a>}</span>
<span id="cb10-108"><a href="#cb10-108"></a><span class="in">```</span></span>
<span id="cb10-109"><a href="#cb10-109"></a></span>
<span id="cb10-110"><a href="#cb10-110"></a>---</span>
<span id="cb10-111"><a href="#cb10-111"></a></span>
<span id="cb10-112"><a href="#cb10-112"></a><span class="fu">## Model 0: Null Baseline</span></span>
<span id="cb10-113"><a href="#cb10-113"></a></span>
<span id="cb10-116"><a href="#cb10-116"></a><span class="in">```{r}</span></span>
<span id="cb10-117"><a href="#cb10-117"></a><span class="co">#| label: null-model-fit</span></span>
<span id="cb10-118"><a href="#cb10-118"></a><span class="co">#| echo: true</span></span>
<span id="cb10-119"><a href="#cb10-119"></a><span class="co">#| message: false</span></span>
<span id="cb10-120"><a href="#cb10-120"></a><span class="co">#| eval: false</span></span>
<span id="cb10-121"><a href="#cb10-121"></a></span>
<span id="cb10-122"><a href="#cb10-122"></a>m0_null <span class="ot">&lt;-</span> <span class="fu">fit_and_pool</span>(</span>
<span id="cb10-123"><a href="#cb10-123"></a>  <span class="at">cond_formula =</span> rainfall <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb10-124"><a href="#cb10-124"></a>  <span class="at">zi_formula =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb10-125"><a href="#cb10-125"></a>  <span class="at">datasets =</span> all_datasets</span>
<span id="cb10-126"><a href="#cb10-126"></a>)</span>
<span id="cb10-127"><a href="#cb10-127"></a><span class="in">```</span></span>
<span id="cb10-128"><a href="#cb10-128"></a></span>
<span id="cb10-131"><a href="#cb10-131"></a><span class="in">```{r}</span></span>
<span id="cb10-132"><a href="#cb10-132"></a><span class="co">#| label: null-model-output</span></span>
<span id="cb10-133"><a href="#cb10-133"></a></span>
<span id="cb10-134"><a href="#cb10-134"></a><span class="fu">render_pooled_model_table</span>(m0_null, <span class="st">"M0: Null Baseline"</span>)</span>
<span id="cb10-135"><a href="#cb10-135"></a><span class="in">```</span></span>
<span id="cb10-136"><a href="#cb10-136"></a></span>
<span id="cb10-137"><a href="#cb10-137"></a>Before introducing any covariates, we fit an intercept-only model whose sole purpose is to verify that the ZIG model structure correctly recovers the fundamental statistical properties of the dataset. A null model that fails this calibration check would undermine the validity of all subsequent extensions.</span>
<span id="cb10-138"><a href="#cb10-138"></a></span>
<span id="cb10-139"><a href="#cb10-139"></a>The zero-inflation intercept $\hat{\beta}_{zi} = 0.577$ (SE = 0.006, $p &lt; 0.001$) back-transforms through the logistic function to an implied dry-day probability of:</span>
<span id="cb10-140"><a href="#cb10-140"></a></span>
<span id="cb10-141"><a href="#cb10-141"></a>$$\hat{P}(\text{Dry}) = \frac{e^{0.577}}{1 + e^{0.577}} \approx 64.03\%$$</span>
<span id="cb10-142"><a href="#cb10-142"></a></span>
<span id="cb10-143"><a href="#cb10-143"></a>This matches the empirically observed zero-inflation rate of 64.05% to within a rounding error, confirming that the hurdle mechanism is correctly calibrated to the data-generating process. The conditional intensity intercept $\hat{\beta}_{cond} = 1.883$ (SE = 0.006, $p &lt; 0.001$) recovers a mean rainy-day intensity of $e^{1.883} \approx 6.57$ mm, consistent with the non-zero conditional mean established in @sec-eda. Both intercepts are estimated with exceptional precision, reflecting the large sample size and the fact that an intercept-only model imposes no distributional misspecification beyond the assumed family.</span>
<span id="cb10-144"><a href="#cb10-144"></a></span>
<span id="cb10-145"><a href="#cb10-145"></a>This model yields AIC = 461,669.7 and BIC = 461,699.3, serving as the reference against which all subsequent gains are measured.</span>
<span id="cb10-146"><a href="#cb10-146"></a></span>
<span id="cb10-147"><a href="#cb10-147"></a>---</span>
<span id="cb10-148"><a href="#cb10-148"></a></span>
<span id="cb10-149"><a href="#cb10-149"></a><span class="fu">## Model 1: Moisture and Pressure Dynamics</span></span>
<span id="cb10-150"><a href="#cb10-150"></a></span>
<span id="cb10-153"><a href="#cb10-153"></a><span class="in">```{r}</span></span>
<span id="cb10-154"><a href="#cb10-154"></a><span class="co">#| label: m1-moisture-code</span></span>
<span id="cb10-155"><a href="#cb10-155"></a><span class="co">#| echo: true</span></span>
<span id="cb10-156"><a href="#cb10-156"></a><span class="co">#| eval: false</span></span>
<span id="cb10-157"><a href="#cb10-157"></a></span>
<span id="cb10-158"><a href="#cb10-158"></a>m1_moisture <span class="ot">&lt;-</span> <span class="fu">fit_and_pool</span>(</span>
<span id="cb10-159"><a href="#cb10-159"></a>  <span class="at">cond_formula =</span> rainfall <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> dewpoint_change <span class="sc">+</span> pressure_change,</span>
<span id="cb10-160"><a href="#cb10-160"></a>  <span class="at">zi_formula   =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span> dewpoint_9am</span>
<span id="cb10-161"><a href="#cb10-161"></a>)</span>
<span id="cb10-162"><a href="#cb10-162"></a><span class="in">```</span></span>
<span id="cb10-163"><a href="#cb10-163"></a></span>
<span id="cb10-166"><a href="#cb10-166"></a><span class="in">```{r}</span></span>
<span id="cb10-167"><a href="#cb10-167"></a><span class="co">#| label: m1-moisture-output</span></span>
<span id="cb10-168"><a href="#cb10-168"></a><span class="co">#| echo: false</span></span>
<span id="cb10-169"><a href="#cb10-169"></a></span>
<span id="cb10-170"><a href="#cb10-170"></a><span class="fu">render_pooled_model_table</span>(m1_moisture, <span class="st">"Model 1: Moisture and Pressure Dynamics"</span>)</span>
<span id="cb10-171"><a href="#cb10-171"></a><span class="in">```</span></span>
<span id="cb10-172"><a href="#cb10-172"></a></span>
<span id="cb10-173"><a href="#cb10-173"></a>The correlation analysis in @sec-eda identified afternoon relative humidity and morning dewpoint temperature as among the strongest individual predictors of rainfall occurrence. That analysis also established that both the absolute level and the diurnal rate of change of sea-level pressure carry discriminating signal. Model 1 formalises these findings by introducing the four most physically direct atmospheric moisture and pressure drivers into the conditional intensity submodel, and a subset of the moisture indicators into the zero-inflation submodel.</span>
<span id="cb10-174"><a href="#cb10-174"></a></span>
<span id="cb10-175"><a href="#cb10-175"></a>The AIC falls from 461,669.7 to 425,731.4, a reduction of 35,938.3 points. This is the largest single improvement across the entire model sequence, and its magnitude confirms that atmospheric moisture and pressure dynamics are not merely correlated with rainfall but constitute its fundamental predictive substrate. All four conditional predictors are highly significant ($p &lt; 0.001$).</span>
<span id="cb10-176"><a href="#cb10-176"></a></span>
<span id="cb10-177"><a href="#cb10-177"></a>The positive coefficients for <span class="in">`humidity3pm`</span> ($\hat{\beta} = 0.403$, $e^{0.403} \approx 1.50$) and <span class="in">`dewpoint_9am`</span> ($\hat{\beta} = 0.300$, $e^{0.300} \approx 1.35$) establish that both the relative saturation of the afternoon boundary layer and the absolute moisture content of the morning atmosphere independently amplify rainfall intensity on days when precipitation occurs. These two predictors operate at different timescales: afternoon humidity reflects the near-instantaneous condition of the lower troposphere as convective processes become active, while morning dewpoint captures the ambient moisture available before any daytime heating-driven changes have taken effect.</span>
<span id="cb10-178"><a href="#cb10-178"></a></span>
<span id="cb10-179"><a href="#cb10-179"></a>The dewpoint change coefficient ($\hat{\beta} = -0.155$, $p &lt; 0.001$) is negative, indicating that a diurnal drop in dewpoint from morning to afternoon (consistent with the dry air entrainment accompanying subsiding high-pressure systems) is associated with reduced rainfall intensity. Conversely, a rise in pressure over the observation window ($\hat{\beta} = 0.116$, $p = 0.007$) is positively associated with intensity, a somewhat counterintuitive result that likely reflects synoptic-scale convergence patterns preceding frontal rainfall.</span>
<span id="cb10-180"><a href="#cb10-180"></a></span>
<span id="cb10-181"><a href="#cb10-181"></a>The zero-inflation submodel reveals a meaningful asymmetry between the two moisture variables. The <span class="in">`humidity3pm`</span> coefficient of $-1.038$ ($p &lt; 0.001$) is strongly negative in the logistic framework: since the outcome modelled is the dry-day indicator, this implies that higher afternoon humidity substantially reduces the probability of a dry day and thereby increases the probability of rainfall. <span class="in">`dewpoint_9am`</span>, by contrast, is not significant in the zero-inflation component ($\hat{\beta} = 0.002$, $p = 0.840$). This dissociation suggests that it is the relative saturation of the afternoon atmosphere that determines whether the thermodynamic threshold for precipitation is crossed, while the absolute morning moisture content shapes the intensity of rainfall once that threshold has been exceeded.</span>
<span id="cb10-182"><a href="#cb10-182"></a></span>
<span id="cb10-183"><a href="#cb10-183"></a>---</span>
<span id="cb10-184"><a href="#cb10-184"></a></span>
<span id="cb10-185"><a href="#cb10-185"></a><span class="fu">## Model 2: Seasonality and Day-to-Day Persistence</span></span>
<span id="cb10-186"><a href="#cb10-186"></a></span>
<span id="cb10-189"><a href="#cb10-189"></a><span class="in">```{r}</span></span>
<span id="cb10-190"><a href="#cb10-190"></a><span class="co">#| label: m2-temporal-code</span></span>
<span id="cb10-191"><a href="#cb10-191"></a><span class="co">#| echo: true</span></span>
<span id="cb10-192"><a href="#cb10-192"></a><span class="co">#| eval: false</span></span>
<span id="cb10-193"><a href="#cb10-193"></a></span>
<span id="cb10-194"><a href="#cb10-194"></a>m2_temporal <span class="ot">&lt;-</span> <span class="fu">fit_and_pool</span>(</span>
<span id="cb10-195"><a href="#cb10-195"></a>  <span class="at">cond_formula =</span> rainfall <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> dewpoint_change <span class="sc">+</span> pressure_change <span class="sc">+</span> day_cos <span class="sc">+</span> day_sin,</span>
<span id="cb10-196"><a href="#cb10-196"></a>  <span class="at">zi_formula   =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> rain_yesterday <span class="sc">+</span> cloud_development <span class="sc">+</span> pressure_change</span>
<span id="cb10-197"><a href="#cb10-197"></a>)</span>
<span id="cb10-198"><a href="#cb10-198"></a><span class="in">```</span></span>
<span id="cb10-199"><a href="#cb10-199"></a></span>
<span id="cb10-202"><a href="#cb10-202"></a><span class="in">```{r}</span></span>
<span id="cb10-203"><a href="#cb10-203"></a><span class="co">#| label: m2-temporal-output</span></span>
<span id="cb10-204"><a href="#cb10-204"></a><span class="co">#| echo: false</span></span>
<span id="cb10-205"><a href="#cb10-205"></a></span>
<span id="cb10-206"><a href="#cb10-206"></a><span class="fu">render_pooled_model_table</span>(m2_temporal, <span class="st">"Model 2: Seasonality and Persistence Effects"</span>)</span>
<span id="cb10-207"><a href="#cb10-207"></a><span class="in">```</span></span>
<span id="cb10-208"><a href="#cb10-208"></a></span>
<span id="cb10-209"><a href="#cb10-209"></a>Having established moisture and pressure as foundational drivers, Model 2 incorporates the temporal structure identified in @sec-eda. The Markov Chain analysis in @sec-markov demonstrated that the previous day's rain state carries a moderate but practically significant effect (Cramér's $V \approx 0.31$), and the seasonal decomposition confirmed that both frequency and intensity of rainfall follow a smooth annual cycle. Circular sine and cosine encodings of the day-of-year enter the conditional intensity submodel, capturing this periodicity without imposing a discontinuity at the calendar year boundary. The binary indicator <span class="in">`rain_yesterday`</span>, the <span class="in">`cloud_development`</span> index, and <span class="in">`pressure_change`</span> are added to the zero-inflation component to account for daily persistence and synoptic-scale dynamics in the occurrence process.</span>
<span id="cb10-210"><a href="#cb10-210"></a></span>
<span id="cb10-211"><a href="#cb10-211"></a>The AIC falls to 412,448.4, a reduction of 13,282.6 points relative to Model 1 (BIC = 412,586.5). This improvement confirms that temporal context, specifically both where in the annual cycle a day falls and what occurred the preceding day, contributes substantial predictive information beyond the instantaneous atmospheric state.</span>
<span id="cb10-212"><a href="#cb10-212"></a></span>
<span id="cb10-213"><a href="#cb10-213"></a>Both seasonal harmonics are statistically significant. The cosine term ($\hat{\beta} = 0.086$, $p &lt; 0.001$) captures the primary annual amplitude, while the sine term ($\hat{\beta} = -0.016$, $p = 0.027$) adjusts the timing of the seasonal peak. Together, they encode the well-documented shift toward wetter conditions during the austral summer across much of the continent, where enhanced monsoonal circulation and elevated sea-surface temperatures increase tropospheric moisture convergence.</span>
<span id="cb10-214"><a href="#cb10-214"></a></span>
<span id="cb10-215"><a href="#cb10-215"></a>The most numerically dominant result is the persistence coefficient in the zero-inflation submodel. With $\hat{\beta}_{zi}(\text{rain<span class="sc">\_</span>yesterday}) = -1.449$ (SE = 0.016, $p &lt; 0.001$), it is the strongest predictor in the hurdle component across the entire model sequence. Exponentiating gives $e^{-1.449} \approx 0.235$: having rained the previous day reduces the odds of today being classified as dry by approximately 76.5%. This directly quantifies the asymmetric persistence documented in the Markov transition matrix of @sec-markov, wherein wet states are substantially more self-sustaining than dry states. Physically, this reflects the tendency for synoptic weather systems (fronts, troughs, and tropical lows) to persist over multiple days rather than generating isolated single-day precipitation events.</span>
<span id="cb10-216"><a href="#cb10-216"></a></span>
<span id="cb10-217"><a href="#cb10-217"></a>The <span class="in">`cloud_development`</span> term in the zero-inflation submodel ($\hat{\beta} = 0.115$, $p &lt; 0.001$) is positive, implying that greater cloud development is associated with a higher probability of a dry day. This initially counterintuitive result likely reflects the distinction between cloud cover associated with stable, non-precipitating high-pressure systems and the moisture-laden systems that drive actual precipitation. In the presence of the strong humidity predictors already in the model, incremental cloud growth may serve as a proxy for convective inhibition rather than precipitation potential.</span>
<span id="cb10-218"><a href="#cb10-218"></a></span>
<span id="cb10-219"><a href="#cb10-219"></a>---</span>
<span id="cb10-220"><a href="#cb10-220"></a></span>
<span id="cb10-221"><a href="#cb10-221"></a><span class="fu">## Model 3: Accumulated Weather History</span></span>
<span id="cb10-222"><a href="#cb10-222"></a></span>
<span id="cb10-225"><a href="#cb10-225"></a><span class="in">```{r}</span></span>
<span id="cb10-226"><a href="#cb10-226"></a><span class="co">#| label: m3-history-code</span></span>
<span id="cb10-227"><a href="#cb10-227"></a><span class="co">#| echo: true</span></span>
<span id="cb10-228"><a href="#cb10-228"></a><span class="co">#| eval: false</span></span>
<span id="cb10-229"><a href="#cb10-229"></a></span>
<span id="cb10-230"><a href="#cb10-230"></a>m3_history <span class="ot">&lt;-</span> <span class="fu">fit_and_pool</span>(</span>
<span id="cb10-231"><a href="#cb10-231"></a>  <span class="at">cond_formula =</span> rainfall <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> dewpoint_change <span class="sc">+</span></span>
<span id="cb10-232"><a href="#cb10-232"></a>                 pressure_change <span class="sc">+</span> day_cos <span class="sc">+</span> day_sin <span class="sc">+</span> rainfall_ma7 <span class="sc">+</span> </span>
<span id="cb10-233"><a href="#cb10-233"></a>                 days_since_rain <span class="sc">+</span> humidity_ma7 <span class="sc">+</span> rain_yesterday,</span>
<span id="cb10-234"><a href="#cb10-234"></a>  <span class="at">zi_formula   =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> rain_yesterday <span class="sc">+</span> </span>
<span id="cb10-235"><a href="#cb10-235"></a>                 cloud_development <span class="sc">+</span> pressure_change</span>
<span id="cb10-236"><a href="#cb10-236"></a>)</span>
<span id="cb10-237"><a href="#cb10-237"></a><span class="in">```</span></span>
<span id="cb10-238"><a href="#cb10-238"></a></span>
<span id="cb10-241"><a href="#cb10-241"></a><span class="in">```{r}</span></span>
<span id="cb10-242"><a href="#cb10-242"></a><span class="co">#| label: m3-history-output</span></span>
<span id="cb10-243"><a href="#cb10-243"></a><span class="co">#| echo: false</span></span>
<span id="cb10-244"><a href="#cb10-244"></a></span>
<span id="cb10-245"><a href="#cb10-245"></a><span class="fu">render_pooled_model_table</span>(m3_history, <span class="st">"Model 3: Accumulated Weather History"</span>)</span>
<span id="cb10-246"><a href="#cb10-246"></a><span class="in">```</span></span>
<span id="cb10-247"><a href="#cb10-247"></a></span>
<span id="cb10-248"><a href="#cb10-248"></a>While Model 2 captured the binary rain state of the previous day, it does not represent the *accumulated* atmospheric condition over a longer antecedent window. The dry spell analysis in @sec-dry-spell demonstrated that rainfall probability decays as dry spells lengthen, and the moving average analysis showed that 7-day smoothed signals substantially reduce the stochastic variance of both the rainfall and humidity series. Model 3 introduces these medium-horizon history features (<span class="in">`rainfall_ma7`</span>, <span class="in">`humidity_ma7`</span>, <span class="in">`days_since_rain`</span>, and the binary <span class="in">`rain_yesterday`</span>) into the conditional intensity submodel.</span>
<span id="cb10-249"><a href="#cb10-249"></a></span>
<span id="cb10-250"><a href="#cb10-250"></a>The AIC falls to 411,060.3, a reduction of 1,388.1 points relative to Model 2 (BIC = 411,277.3). This gain is smaller than the earlier improvements, reflecting the natural diminishing returns of adding temporally redundant information once the most immediate prior state has already been captured. The reduction is nonetheless genuine and statistically consistent across imputed datasets.</span>
<span id="cb10-251"><a href="#cb10-251"></a></span>
<span id="cb10-252"><a href="#cb10-252"></a>The coefficients reveal an interpretable partition between immediate and accumulated antecedent conditions. The <span class="in">`rain_yesterday`</span> coefficient in the conditional intensity component ($\hat{\beta} = 0.322$, $e^{0.322} \approx 1.38$, $p &lt; 0.001$) indicates that rainfall on the preceding day is associated with approximately 38% greater intensity on rainy days, consistent with the physical scenario of a persisting frontal or trough system delivering consecutive rainfall events of comparable character. The <span class="in">`rainfall_ma7`</span> coefficient ($\hat{\beta} = 0.127$, $p &lt; 0.001$) extends this logic to the weekly horizon: a wetter preceding week is associated with heavier current rainfall, suggesting that prolonged wet spells reflect deeper or more extensive atmospheric systems rather than sequences of meteorologically independent events.</span>
<span id="cb10-253"><a href="#cb10-253"></a></span>
<span id="cb10-254"><a href="#cb10-254"></a>The negative coefficient for <span class="in">`humidity_ma7`</span> ($\hat{\beta} = -0.078$, $p &lt; 0.001$) warrants careful interpretation. Conditional on the full predictor set, a persistently humid preceding week is associated with slightly lower rainfall intensity. This likely reflects a distinction between two meteorological regimes: stratiform cloud systems, which sustain elevated background humidity across extended periods without generating intense precipitation, and convective systems, which produce intense episodic rainfall under conditions of rapid moisture change rather than sustained elevated humidity. Once the model incorporates both instantaneous humidity and its 7-day mean, the latter carries the residual signal of these differing system types.</span>
<span id="cb10-255"><a href="#cb10-255"></a></span>
<span id="cb10-256"><a href="#cb10-256"></a>Finally, <span class="in">`days_since_rain`</span> is not significant in the conditional intensity component ($\hat{\beta} = 0.003$, $p = 0.694$). The duration of an antecedent dry spell predicts whether rain will occur, but once the model conditions on rainfall occurring, the length of the preceding drought provides no additional information about the volume of that rainfall. This result reinforces the conceptual separation between the occurrence and intensity sub-processes that motivates the ZIG framework, and foreshadows the use of a flexible spline for this term in the zero-inflation component of Model 6 (@sec-model6).</span>
<span id="cb10-257"><a href="#cb10-257"></a></span>
<span id="cb10-258"><a href="#cb10-258"></a>Imputation provenance flags for the four ghost-sensor variables (<span class="in">`sunshine`</span>, <span class="in">`evaporation`</span>, <span class="in">`cloud_3pm`</span>, and <span class="in">`cloud_9am`</span>) were tested in the zero-inflation component across all model specifications from Model 3 onward. None achieved statistical significance (all $p &gt; 0.05$), confirming that the predictive mean matching imputation did not introduce systematic bias at stations lacking direct instrumentation for these variables. The flags were subsequently excluded from all further model specifications.</span>
<span id="cb10-259"><a href="#cb10-259"></a></span>
<span id="cb10-260"><a href="#cb10-260"></a>---</span>
<span id="cb10-261"><a href="#cb10-261"></a></span>
<span id="cb10-262"><a href="#cb10-262"></a><span class="fu">## Model 4: Thermodynamic Energy and the Rain Corner Interaction</span></span>
<span id="cb10-263"><a href="#cb10-263"></a></span>
<span id="cb10-266"><a href="#cb10-266"></a><span class="in">```{r}</span></span>
<span id="cb10-267"><a href="#cb10-267"></a><span class="co">#| label: m4-energy-code</span></span>
<span id="cb10-268"><a href="#cb10-268"></a><span class="co">#| echo: true</span></span>
<span id="cb10-269"><a href="#cb10-269"></a><span class="co">#| eval: false</span></span>
<span id="cb10-270"><a href="#cb10-270"></a></span>
<span id="cb10-271"><a href="#cb10-271"></a>m4_energy <span class="ot">&lt;-</span> <span class="fu">fit_and_pool</span>(</span>
<span id="cb10-272"><a href="#cb10-272"></a>  <span class="at">cond_formula =</span> rainfall <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> dewpoint_change <span class="sc">+</span></span>
<span id="cb10-273"><a href="#cb10-273"></a>                 pressure_change <span class="sc">+</span> day_cos <span class="sc">+</span> day_sin <span class="sc">+</span> rainfall_ma7 <span class="sc">+</span> </span>
<span id="cb10-274"><a href="#cb10-274"></a>                 days_since_rain <span class="sc">+</span> humidity_ma7 <span class="sc">+</span> rain_yesterday <span class="sc">+</span></span>
<span id="cb10-275"><a href="#cb10-275"></a>                 sunshine <span class="sc">+</span> evaporation <span class="sc">+</span> instability_index <span class="sc">+</span> </span>
<span id="cb10-276"><a href="#cb10-276"></a>                 sun_humid_interaction <span class="sc">+</span> cloud_development,</span>
<span id="cb10-277"><a href="#cb10-277"></a>  <span class="at">zi_formula   =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> rain_yesterday <span class="sc">+</span> </span>
<span id="cb10-278"><a href="#cb10-278"></a>                 cloud_development <span class="sc">+</span> pressure_change</span>
<span id="cb10-279"><a href="#cb10-279"></a>)</span>
<span id="cb10-280"><a href="#cb10-280"></a><span class="in">```</span></span>
<span id="cb10-281"><a href="#cb10-281"></a></span>
<span id="cb10-284"><a href="#cb10-284"></a><span class="in">```{r}</span></span>
<span id="cb10-285"><a href="#cb10-285"></a><span class="co">#| label: m4-energy-output</span></span>
<span id="cb10-286"><a href="#cb10-286"></a><span class="co">#| echo: false</span></span>
<span id="cb10-287"><a href="#cb10-287"></a></span>
<span id="cb10-288"><a href="#cb10-288"></a><span class="fu">render_pooled_model_table</span>(m4_energy, <span class="st">"Model 4: Thermodynamic Energy and Interactions"</span>)</span>
<span id="cb10-289"><a href="#cb10-289"></a><span class="in">```</span></span>
<span id="cb10-290"><a href="#cb10-290"></a></span>
<span id="cb10-291"><a href="#cb10-291"></a>The bivariate density analysis in @sec-bivariate-density identified a structural non-linearity in the joint distribution of afternoon humidity and sunshine hours: intense rainfall occurs almost exclusively in the region of the bivariate distribution where humidity is high and sunshine is simultaneously low. An additive model is structurally incapable of representing this conditional geometry. Model 4 introduces the multiplicative <span class="in">`sun_humid_interaction`</span> term alongside a broader set of thermodynamic energy predictors (<span class="in">`sunshine`</span>, <span class="in">`evaporation`</span>, <span class="in">`instability_index`</span>, and <span class="in">`cloud_development`</span>) to formalise the physical hypothesis that convective rainfall arises from the conjunction of available moisture and atmospheric instability rather than from either factor in isolation.</span>
<span id="cb10-292"><a href="#cb10-292"></a></span>
<span id="cb10-293"><a href="#cb10-293"></a>The AIC falls to 409,801.6, a reduction of 1,258.7 points relative to Model 3 (BIC = 410,028.4). This gain is modest in absolute terms but carries a disproportionate interpretive weight, because the new terms do not merely add marginal predictive power; they restructure the representation of the moisture signal already present in the model.</span>
<span id="cb10-294"><a href="#cb10-294"></a></span>
<span id="cb10-295"><a href="#cb10-295"></a>The <span class="in">`sun_humid_interaction`</span> coefficient of $\hat{\beta} = -0.076$ (SE = 0.016, $p &lt; 0.001$) is highly significant and physically coherent. After mean-centring both component variables, the product term takes large negative values precisely when humidity is above average and sunshine hours are below average. The negative coefficient therefore assigns greater expected rainfall intensity to this region of the covariate space, directly encoding the Rain Corner identified in @sec-bivariate-density: an overcast, moisture-saturated atmosphere in which solar insolation is suppressed by deep cloud cover, creating the thermodynamic conditions most conducive to sustained or intense precipitation.</span>
<span id="cb10-296"><a href="#cb10-296"></a></span>
<span id="cb10-297"><a href="#cb10-297"></a>The <span class="in">`instability_index`</span> ($\hat{\beta} = 0.145$, $p &lt; 0.001$) operates on related physical grounds: higher atmospheric instability, typically associated with steep lapse rates and strong surface heating, promotes convective development and augments rainfall intensity given that rainfall is occurring. The <span class="in">`evaporation`</span> coefficient ($\hat{\beta} = 0.154$, $p &lt; 0.001$) is positive, suggesting that on rainy days higher potential evaporation (a proxy for energy availability) is associated with greater intensity, consistent with convectively driven systems drawing on sensible and latent heat fluxes.</span>
<span id="cb10-298"><a href="#cb10-298"></a></span>
<span id="cb10-299"><a href="#cb10-299"></a>The entry of the interaction term and the thermodynamic covariates produces a marked reduction in the <span class="in">`humidity3pm`</span> coefficient, from $0.422$ in Model 3 to $0.223$ in Model 4. This is not indicative of instability or suppression of the humidity signal. It reflects a correct partitioning of explained variance: the portion of humidity's predictive contribution that operates through its interaction with sunshine, and through the atmospheric instability it enables, is now attributed to those specific mechanistic pathways rather than being absorbed into the humidity main effect alone. The model has advanced from recognising that moisture matters to representing the specific conjunction of conditions under which it matters most.</span>
<span id="cb10-300"><a href="#cb10-300"></a></span>
<span id="cb10-301"><a href="#cb10-301"></a>---</span>
<span id="cb10-302"><a href="#cb10-302"></a></span>
<span id="cb10-303"><a href="#cb10-303"></a><span class="fu">## Model 5: Wind Vector Dynamics</span></span>
<span id="cb10-304"><a href="#cb10-304"></a></span>
<span id="cb10-307"><a href="#cb10-307"></a><span class="in">```{r}</span></span>
<span id="cb10-308"><a href="#cb10-308"></a><span class="co">#| label: m5-wind-code</span></span>
<span id="cb10-309"><a href="#cb10-309"></a><span class="co">#| echo: true</span></span>
<span id="cb10-310"><a href="#cb10-310"></a><span class="co">#| eval: false</span></span>
<span id="cb10-311"><a href="#cb10-311"></a></span>
<span id="cb10-312"><a href="#cb10-312"></a>m5_wind <span class="ot">&lt;-</span> <span class="fu">fit_and_pool</span>(</span>
<span id="cb10-313"><a href="#cb10-313"></a>  <span class="at">cond_formula =</span> rainfall <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> dewpoint_change <span class="sc">+</span></span>
<span id="cb10-314"><a href="#cb10-314"></a>                 pressure_change <span class="sc">+</span> day_cos <span class="sc">+</span> day_sin <span class="sc">+</span> rainfall_ma7 <span class="sc">+</span> </span>
<span id="cb10-315"><a href="#cb10-315"></a>                 days_since_rain <span class="sc">+</span> humidity_ma7 <span class="sc">+</span> rain_yesterday <span class="sc">+</span></span>
<span id="cb10-316"><a href="#cb10-316"></a>                 sunshine <span class="sc">+</span> evaporation <span class="sc">+</span> instability_index <span class="sc">+</span> </span>
<span id="cb10-317"><a href="#cb10-317"></a>                 sun_humid_interaction <span class="sc">+</span> cloud_development <span class="sc">+</span></span>
<span id="cb10-318"><a href="#cb10-318"></a>                 gust_U_EW <span class="sc">+</span> gust_V_NS <span class="sc">+</span> wind9am_V_NS <span class="sc">+</span> wind9am_U_EW,</span>
<span id="cb10-319"><a href="#cb10-319"></a>  <span class="at">zi_formula   =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> rain_yesterday <span class="sc">+</span> </span>
<span id="cb10-320"><a href="#cb10-320"></a>                 cloud_development <span class="sc">+</span> pressure_change</span>
<span id="cb10-321"><a href="#cb10-321"></a>)</span>
<span id="cb10-322"><a href="#cb10-322"></a><span class="in">```</span></span>
<span id="cb10-323"><a href="#cb10-323"></a></span>
<span id="cb10-326"><a href="#cb10-326"></a><span class="in">```{r}</span></span>
<span id="cb10-327"><a href="#cb10-327"></a><span class="co">#| label: m5-wind-output</span></span>
<span id="cb10-328"><a href="#cb10-328"></a><span class="co">#| echo: false</span></span>
<span id="cb10-329"><a href="#cb10-329"></a></span>
<span id="cb10-330"><a href="#cb10-330"></a><span class="fu">render_pooled_model_table</span>(m5_wind, <span class="st">"Model 5: Wind Vector Dynamics"</span>)</span>
<span id="cb10-331"><a href="#cb10-331"></a><span class="in">```</span></span>
<span id="cb10-332"><a href="#cb10-332"></a></span>
<span id="cb10-333"><a href="#cb10-333"></a>Model 5 tests whether the directional provenance of air masses provides additional information about rainfall intensity beyond the instantaneous thermodynamic state of the atmosphere. As developed in @sec-feature-eng, wind direction is encoded as orthogonal zonal (U, east-west) and meridional (V, north-south) vector components, preserving the circular geometry of directional data and avoiding the discontinuity that would arise from treating compass bearing as a linear predictor. Both peak gust components and the 9:00 AM surface wind vectors are included, allowing the model to distinguish between the background synoptic circulation at day onset and the turbulent dynamics associated with active rainfall systems.</span>
<span id="cb10-334"><a href="#cb10-334"></a></span>
<span id="cb10-335"><a href="#cb10-335"></a>The AIC falls to 409,149.2, a reduction of 652.4 points relative to Model 4 (BIC = 409,415.5). This is the smallest stepwise improvement in the sequence. The BIC penalty for the four additional parameters is relatively restrictive, indicating that the marginal gain should be interpreted in the context of the physical interpretability of the effects rather than purely through information criteria.</span>
<span id="cb10-336"><a href="#cb10-336"></a></span>
<span id="cb10-337"><a href="#cb10-337"></a>The most informative wind coefficients are those for the morning surface vectors. <span class="in">`wind9am_U_EW`</span> ($\hat{\beta} = -0.116$, SE = 0.008, $p &lt; 0.001$) is negative for the zonal component: since the U convention assigns positive values to eastward flow, a negative coefficient indicates that westerly airflow at 9:00 AM increases expected rainfall intensity. This is physically consistent with the Roaring Forties, the band of persistent westerly circulation in the mid-latitudes that advects maritime air masses from the Indian Ocean onto the southern and southwestern regions of the continent. <span class="in">`wind9am_V_NS`</span> is not significant at conventional levels ($\hat{\beta} = -0.008$, $p = 0.145$) when the full covariate set is included, though the direction is consistent with southerly incursion enhancing rainfall on the eastern seaboard.</span>
<span id="cb10-338"><a href="#cb10-338"></a></span>
<span id="cb10-339"><a href="#cb10-339"></a>For the peak gust vectors, <span class="in">`gust_U_EW`</span> is significant ($\hat{\beta} = -0.056$, $p &lt; 0.001$), while <span class="in">`gust_V_NS`</span> is not ($\hat{\beta} = -0.008$, $p = 0.261$). The morning wind component has a coefficient approximately twice the magnitude of the corresponding gust component. This contrast supports the interpretation that the prevailing direction of the synoptic-scale air mass at day onset (reflecting the large-scale circulation pattern within which a rainfall event is embedded) is more informative about event intensity than the turbulent, locally generated gusts that accompany active storm activity. The provenance of an air mass carries more predictive information about the moisture it transports than does the mechanical turbulence it generates near the surface.</span>
<span id="cb10-340"><a href="#cb10-340"></a></span>
<span id="cb10-341"><a href="#cb10-341"></a>Coefficients for the moisture, thermodynamic, and interaction terms established in prior models remain stable in direction and magnitude across this extension, confirming that the wind predictors explain variance not already accounted for by thermodynamic state, rather than displacing existing effects through collinearity with humidity or pressure.</span>
<span id="cb10-342"><a href="#cb10-342"></a></span>
<span id="cb10-343"><a href="#cb10-343"></a>---</span>
<span id="cb10-344"><a href="#cb10-344"></a></span>
<span id="cb10-345"><a href="#cb10-345"></a><span class="fu">## Model 6: Spatial Heterogeneity via Mixed Effects {#sec-model6}</span></span>
<span id="cb10-346"><a href="#cb10-346"></a></span>
<span id="cb10-349"><a href="#cb10-349"></a><span class="in">```{r}</span></span>
<span id="cb10-350"><a href="#cb10-350"></a><span class="co">#| label: m6-mixed-code</span></span>
<span id="cb10-351"><a href="#cb10-351"></a><span class="co">#| echo: true</span></span>
<span id="cb10-352"><a href="#cb10-352"></a><span class="co">#| eval: false</span></span>
<span id="cb10-353"><a href="#cb10-353"></a></span>
<span id="cb10-354"><a href="#cb10-354"></a>m6_mixed <span class="ot">&lt;-</span> <span class="fu">fit_and_pool</span>(</span>
<span id="cb10-355"><a href="#cb10-355"></a>  <span class="at">cond_formula =</span> rainfall <span class="sc">~</span></span>
<span id="cb10-356"><a href="#cb10-356"></a>    humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> dewpoint_change <span class="sc">+</span></span>
<span id="cb10-357"><a href="#cb10-357"></a>    pressure_change <span class="sc">+</span> day_cos <span class="sc">+</span> day_sin <span class="sc">+</span></span>
<span id="cb10-358"><a href="#cb10-358"></a>    rainfall_ma7 <span class="sc">+</span> days_since_rain <span class="sc">+</span> humidity_ma7 <span class="sc">+</span></span>
<span id="cb10-359"><a href="#cb10-359"></a>    rain_yesterday <span class="sc">+</span> sunshine <span class="sc">+</span> evaporation <span class="sc">+</span></span>
<span id="cb10-360"><a href="#cb10-360"></a>    instability_index <span class="sc">+</span> sun_humid_interaction <span class="sc">+</span></span>
<span id="cb10-361"><a href="#cb10-361"></a>    cloud_development <span class="sc">+</span> gust_U_EW <span class="sc">+</span> gust_V_NS <span class="sc">+</span></span>
<span id="cb10-362"><a href="#cb10-362"></a>    wind9am_V_NS <span class="sc">+</span> wind9am_U_EW <span class="sc">+</span></span>
<span id="cb10-363"><a href="#cb10-363"></a>    <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">+</span> humidity3pm <span class="sc">+</span> rain_yesterday <span class="sc">+</span> dewpoint_change <span class="sc">|</span> location),</span>
<span id="cb10-364"><a href="#cb10-364"></a>  <span class="at">zi_formula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> rain_yesterday <span class="sc">+</span></span>
<span id="cb10-365"><a href="#cb10-365"></a>    cloud_development <span class="sc">+</span> pressure_change <span class="sc">+</span> sunshine <span class="sc">+</span></span>
<span id="cb10-366"><a href="#cb10-366"></a>    evaporation <span class="sc">+</span> <span class="fu">ns</span>(days_since_rain, <span class="at">df =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb10-367"><a href="#cb10-367"></a>    (<span class="dv">1</span> <span class="sc">|</span> location) <span class="sc">+</span> humidity_ma7 <span class="sc">+</span> day_cos <span class="sc">+</span> day_sin,</span>
<span id="cb10-368"><a href="#cb10-368"></a>  <span class="at">datasets =</span> all_datasets,</span>
<span id="cb10-369"><a href="#cb10-369"></a>  <span class="at">control  =</span> <span class="fu">glmmTMBControl</span>(</span>
<span id="cb10-370"><a href="#cb10-370"></a>    <span class="at">optimizer =</span> nlminb,</span>
<span id="cb10-371"><a href="#cb10-371"></a>    <span class="at">optCtrl   =</span> <span class="fu">list</span>(<span class="at">iter.max =</span> <span class="dv">500</span>, <span class="at">eval.max =</span> <span class="dv">1000</span>)</span>
<span id="cb10-372"><a href="#cb10-372"></a>  ),</span>
<span id="cb10-373"><a href="#cb10-373"></a>  <span class="at">n_cores =</span> <span class="dv">3</span>L</span>
<span id="cb10-374"><a href="#cb10-374"></a>)</span>
<span id="cb10-375"><a href="#cb10-375"></a><span class="in">```</span></span>
<span id="cb10-376"><a href="#cb10-376"></a></span>
<span id="cb10-379"><a href="#cb10-379"></a><span class="in">```{r}</span></span>
<span id="cb10-380"><a href="#cb10-380"></a><span class="co">#| label: m6-mixed-output</span></span>
<span id="cb10-381"><a href="#cb10-381"></a><span class="co">#| echo: false</span></span>
<span id="cb10-382"><a href="#cb10-382"></a></span>
<span id="cb10-383"><a href="#cb10-383"></a><span class="fu">render_pooled_model_table</span>(m6_mixed, <span class="st">"M6: Fixed Effects Model"</span>)</span>
<span id="cb10-384"><a href="#cb10-384"></a><span class="in">```</span></span>
<span id="cb10-385"><a href="#cb10-385"></a></span>
<span id="cb10-386"><a href="#cb10-386"></a>All five preceding models implicitly assume that the relationship between each atmospheric predictor and rainfall is spatially uniform, as though the sensitivity of rainfall intensity to afternoon humidity were identical in coastal Sydney, the tropical far north, and the arid interior. For a continent as climatologically heterogeneous as Australia, spanning tropical monsoon, subtropical semi-arid, temperate oceanic, and Mediterranean regimes, this homogeneity assumption is difficult to defend. The EDA in @sec-eda confirmed that both mean rainfall levels and seasonal patterns vary substantially across the station network.</span>
<span id="cb10-387"><a href="#cb10-387"></a></span>
<span id="cb10-388"><a href="#cb10-388"></a>Model 6 relaxes the spatial homogeneity assumption through a mixed-effects structure. Location-specific random effects allow the intercept and three scientifically motivated slopes (for <span class="in">`humidity3pm`</span>, <span class="in">`rain_yesterday`</span>, and <span class="in">`dewpoint_change`</span>) to vary freely across weather stations. An uncorrelated (diagonal) random effects covariance structure is specified via <span class="in">`diag()`</span> rather than an unstructured matrix, avoiding the overparameterisation that would accompany a freely estimated $4 \times 4$ random covariance across the number of stations in the dataset. Two further modifications accompany the move to mixed effects. The zero-inflation submodel is expanded with <span class="in">`sunshine`</span>, <span class="in">`evaporation`</span>, and the day-of-year harmonic terms, reflecting the hypothesis that occurrence probability is governed by the same broad range of atmospheric drivers as intensity. Additionally, <span class="in">`days_since_rain`</span> in the zero-inflation submodel is replaced by a four-degree-of-freedom natural spline, directly implementing the non-linear, rapid-then-gradual decay in rainfall probability identified in @sec-dry-spell. The spline permits the marginal probability of precipitation to decline steeply within the first ten days of a dry spell and then stabilise, rather than imposing the constant log-odds decrement implied by a linear term.</span>
<span id="cb10-389"><a href="#cb10-389"></a></span>
<span id="cb10-390"><a href="#cb10-390"></a>The AIC falls to 400,997.9, a reduction of 8,151.3 points relative to Model 5 (BIC = 401,402.2; log-likelihood = $-200,457.9$). This is the third-largest single improvement in the entire model sequence, exceeded only by the initial introduction of moisture and pressure in Model 1 and the addition of seasonality and persistence in Model 2. The magnitude of the gain establishes that spatial heterogeneity is not a minor correction to an otherwise well-specified model; it is a structurally important dimension of the rainfall generation process that fixed-effects models cannot represent by design.</span>
<span id="cb10-391"><a href="#cb10-391"></a></span>
<span id="cb10-392"><a href="#cb10-392"></a>The fixed-effect estimates for the global-mean relationships remain directionally and numerically consistent with those from Model 5, which provides reassurance that the random effects are absorbing genuine between-location variation rather than confounding the population-average coefficients. Several predictors warrant specific attention in the context of the expanded zero-inflation submodel. <span class="in">`dewpoint_9am`</span> is now significant in the occurrence model ($\hat{\beta}_{zi} = -0.519$, $p &lt; 0.001$), in contrast to its non-significance in all prior specifications. This reversal reflects the expanded zero-inflation predictor set: once sunshine, evaporation, and seasonal harmonics are included in the occurrence model, the morning dewpoint carries a distinct contribution to precipitation probability that was previously absorbed by correlated terms. The `humidity_ma7` coefficient in the zero-inflation submodel ($\hat{\beta}_{zi} = -0.254$, $p &lt; 0.001$) is also negative and substantial, indicating that a persistently humid antecedent week substantially reduces the probability of a dry day, consistent with the view that extended moisture advection creates a background state favourable to continued precipitation.</span>
<span id="cb10-393"><a href="#cb10-393"></a></span>
<span id="cb10-394"><a href="#cb10-394"></a>The natural spline terms for <span class="in">`days_since_rain`</span> in the zero-inflation submodel are collectively non-significant at conventional thresholds, with the second basis function marginally approaching significance ($\hat{\beta} = 0.115$, $p = 0.075$). This suggests that the dry spell decay function, while visually non-linear in the analysis of @sec-dry-spell, does not depart substantially from linearity once the full complement of humidity, seasonal, and persistence predictors is included. The spline is retained for its robustness to potential non-linearity, but the practical difference from a linear specification appears limited given the current covariate set.</span>
<span id="cb10-395"><a href="#cb10-395"></a></span>
<span id="cb10-396"><a href="#cb10-396"></a>---</span>
<span id="cb10-397"><a href="#cb10-397"></a></span>
<span id="cb10-398"><a href="#cb10-398"></a><span class="fu">## Progressive Model Comparison</span></span>
<span id="cb10-399"><a href="#cb10-399"></a></span>
<span id="cb10-400"><a href="#cb10-400"></a>The AIC trajectory across the model sequence (summarised in @tbl-model-comparison) reveals a pattern of steeply front-loaded improvement followed by diminishing but genuine increments, with a notable secondary gain at the step to mixed effects.</span>
<span id="cb10-401"><a href="#cb10-401"></a></span>
<span id="cb10-404"><a href="#cb10-404"></a><span class="in">```{r}</span></span>
<span id="cb10-405"><a href="#cb10-405"></a><span class="co">#| label: tbl-model-comparison</span></span>
<span id="cb10-406"><a href="#cb10-406"></a><span class="co">#| echo: false</span></span>
<span id="cb10-407"><a href="#cb10-407"></a><span class="co">#| warning: false</span></span>
<span id="cb10-408"><a href="#cb10-408"></a><span class="co">#| message: false</span></span>
<span id="cb10-409"><a href="#cb10-409"></a></span>
<span id="cb10-410"><a href="#cb10-410"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-411"><a href="#cb10-411"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb10-412"><a href="#cb10-412"></a></span>
<span id="cb10-413"><a href="#cb10-413"></a>model_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb10-414"><a href="#cb10-414"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"M0"</span>, <span class="st">"M1"</span>, <span class="st">"M2"</span>, <span class="st">"M3"</span>, <span class="st">"M4"</span>, <span class="st">"M5"</span>, <span class="st">"M6"</span>),</span>
<span id="cb10-415"><a href="#cb10-415"></a>  <span class="at">Description =</span> <span class="fu">c</span>(</span>
<span id="cb10-416"><a href="#cb10-416"></a>    <span class="st">"Null (intercept only)"</span>,</span>
<span id="cb10-417"><a href="#cb10-417"></a>    <span class="st">"Moisture and pressure"</span>,</span>
<span id="cb10-418"><a href="#cb10-418"></a>    <span class="st">"Seasonality and persistence"</span>,</span>
<span id="cb10-419"><a href="#cb10-419"></a>    <span class="st">"Accumulated history"</span>,</span>
<span id="cb10-420"><a href="#cb10-420"></a>    <span class="st">"Thermodynamics and interactions"</span>,</span>
<span id="cb10-421"><a href="#cb10-421"></a>    <span class="st">"Wind vectors"</span>,</span>
<span id="cb10-422"><a href="#cb10-422"></a>    <span class="st">"Spatial mixed effects (final)"</span></span>
<span id="cb10-423"><a href="#cb10-423"></a>  ),</span>
<span id="cb10-424"><a href="#cb10-424"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(</span>
<span id="cb10-425"><a href="#cb10-425"></a>    <span class="fl">461669.7</span>,</span>
<span id="cb10-426"><a href="#cb10-426"></a>    <span class="fl">425731.4</span>,</span>
<span id="cb10-427"><a href="#cb10-427"></a>    <span class="fl">412448.4</span>,</span>
<span id="cb10-428"><a href="#cb10-428"></a>    <span class="fl">411060.3</span>,</span>
<span id="cb10-429"><a href="#cb10-429"></a>    <span class="fl">409801.6</span>,</span>
<span id="cb10-430"><a href="#cb10-430"></a>    <span class="fl">409149.2</span>,</span>
<span id="cb10-431"><a href="#cb10-431"></a>    <span class="fl">400997.9</span></span>
<span id="cb10-432"><a href="#cb10-432"></a>  )</span>
<span id="cb10-433"><a href="#cb10-433"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb10-434"><a href="#cb10-434"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-435"><a href="#cb10-435"></a>    <span class="st">`</span><span class="at">Delta AIC</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">max</span>(AIC) <span class="sc">-</span> AIC,</span>
<span id="cb10-436"><a href="#cb10-436"></a>    <span class="st">`</span><span class="at">% of Total Gain</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Delta AIC</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">max</span>(<span class="st">`</span><span class="at">Delta AIC</span><span class="st">`</span>),</span>
<span id="cb10-437"><a href="#cb10-437"></a>    <span class="at">AIC =</span> scales<span class="sc">::</span><span class="fu">comma</span>(AIC, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb10-438"><a href="#cb10-438"></a>    <span class="st">`</span><span class="at">Delta AIC</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb10-439"><a href="#cb10-439"></a>      Model <span class="sc">==</span> <span class="st">"M0"</span>, <span class="st">"-"</span>,</span>
<span id="cb10-440"><a href="#cb10-440"></a>      scales<span class="sc">::</span><span class="fu">comma</span>(<span class="st">`</span><span class="at">Delta AIC</span><span class="st">`</span>, <span class="at">accuracy =</span> <span class="fl">0.1</span>)</span>
<span id="cb10-441"><a href="#cb10-441"></a>    ),</span>
<span id="cb10-442"><a href="#cb10-442"></a>    <span class="st">`</span><span class="at">% of Total Gain</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb10-443"><a href="#cb10-443"></a>      Model <span class="sc">==</span> <span class="st">"M0"</span>, <span class="st">"-"</span>,</span>
<span id="cb10-444"><a href="#cb10-444"></a>      scales<span class="sc">::</span><span class="fu">percent</span>(<span class="st">`</span><span class="at">% of Total Gain</span><span class="st">`</span>, <span class="at">accuracy =</span> <span class="fl">0.1</span>)</span>
<span id="cb10-445"><a href="#cb10-445"></a>    )</span>
<span id="cb10-446"><a href="#cb10-446"></a>  )</span>
<span id="cb10-447"><a href="#cb10-447"></a></span>
<span id="cb10-448"><a href="#cb10-448"></a>model_summary <span class="sc">%&gt;%</span></span>
<span id="cb10-449"><a href="#cb10-449"></a>  <span class="fu">kable</span>(</span>
<span id="cb10-450"><a href="#cb10-450"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Model"</span>, <span class="st">"Description"</span>, <span class="st">"AIC"</span>, <span class="st">"Change in AIC vs Null"</span>, <span class="st">"% of Total Gain"</span>),</span>
<span id="cb10-451"><a href="#cb10-451"></a>    <span class="at">align =</span> <span class="st">"llrrr"</span>,</span>
<span id="cb10-452"><a href="#cb10-452"></a>    <span class="at">caption =</span> <span class="st">"Progressive Model Comparison: AIC Trajectory"</span></span>
<span id="cb10-453"><a href="#cb10-453"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-454"><a href="#cb10-454"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb10-455"><a href="#cb10-455"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb10-456"><a href="#cb10-456"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb10-457"><a href="#cb10-457"></a>    <span class="at">position =</span> <span class="st">"center"</span></span>
<span id="cb10-458"><a href="#cb10-458"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-459"><a href="#cb10-459"></a>  <span class="fu">row_spec</span>(<span class="dv">7</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">background =</span> <span class="st">"#e6f3ff"</span>, <span class="at">color =</span> <span class="st">"#212529"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-460"><a href="#cb10-460"></a>  <span class="fu">add_footnote</span>(</span>
<span id="cb10-461"><a href="#cb10-461"></a>    <span class="fu">c</span>(</span>
<span id="cb10-462"><a href="#cb10-462"></a>      <span class="st">"AIC: Akaike Information Criterion (Lower is better)"</span>,</span>
<span id="cb10-463"><a href="#cb10-463"></a>      <span class="st">"Total Gain is calculated relative to the maximum improvement achieved by Model 6."</span></span>
<span id="cb10-464"><a href="#cb10-464"></a>    ),</span>
<span id="cb10-465"><a href="#cb10-465"></a>    <span class="at">notation =</span> <span class="st">"none"</span></span>
<span id="cb10-466"><a href="#cb10-466"></a>  )</span>
<span id="cb10-467"><a href="#cb10-467"></a><span class="in">```</span></span>
<span id="cb10-468"><a href="#cb10-468"></a>Moisture and pressure dynamics alone account for 55.3% of the total AIC improvement, confirming that atmospheric water content is the primary physical driver of both rainfall occurrence and intensity in the Australian context. The addition of seasonal cycles and day-to-day persistence in Model 2 raises the cumulative share to 75.7%, establishing that temporal structure (the annual insolation cycle and the short-range memory of the atmosphere) constitutes the second-order source of predictive information. The thermodynamic and wind components (Models 4 and 5) each contribute positively but with diminishing returns, reflecting the fact that the mechanistic pathways they represent are partially encoded in earlier proxies.</span>
<span id="cb10-469"><a href="#cb10-469"></a></span>
<span id="cb10-470"><a href="#cb10-470"></a>The step to mixed effects (Model 6) recovers 19.3 percentage points of additional gain, the largest single improvement after the initial moisture signal. This disproportionate improvement, despite the fact that the fixed-effect predictor set changes relatively little between Models 5 and 6, makes explicit a conclusion that is implicit in the geography of the station network: the parameters governing the moisture-intensity relationship, rainfall persistence, and dewpoint sensitivity are not continental constants but regional properties that vary systematically with climate zone. Treating them as such is not a statistical convenience but a physical necessity.</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/blob/main/05-modeling.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>