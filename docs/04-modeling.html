<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="A comprehensive statistical analysis of rainfall patterns across 49 Australian cities using Zero-Inflated Gamma GLMMs.">

<title>4&nbsp; Modelling – Australian Rainfall Dynamics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-conclusion.html" rel="next">
<link href="./03-features.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-0348920b7671f696dc9078d39bff215e.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f12a4a8ba9751daca4e771316b711af2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-27bd61dac4ddfacab4795c71a0bdc5ec.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-f12a4a8ba9751daca4e771316b711af2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-features.html">Modelling</a></li><li class="breadcrumb-item"><a href="./04-modeling.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelling</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Australian Rainfall Dynamics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-data-prep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Computational Environment and Data Ingestion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Modelling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-features.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Signal Extraction via Moving Averages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-modeling.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#establishing-the-baseline-null-model" id="toc-establishing-the-baseline-null-model" class="nav-link active" data-scroll-target="#establishing-the-baseline-null-model"><span class="header-section-number">4.1</span> Establishing the Baseline (Null Model)</a></li>
  <li><a href="#modeling" id="toc-modeling" class="nav-link" data-scroll-target="#modeling"><span class="header-section-number">5</span> Modeling</a></li>
  <li><a href="#modelling" id="toc-modelling" class="nav-link" data-scroll-target="#modelling"><span class="header-section-number">6</span> Modelling</a>
  <ul class="collapse">
  <li><a href="#establishing-the-baseline-null-model-1" id="toc-establishing-the-baseline-null-model-1" class="nav-link" data-scroll-target="#establishing-the-baseline-null-model-1"><span class="header-section-number">6.1</span> Establishing the Baseline (Null Model)</a></li>
  <li><a href="#moisture-dynamics" id="toc-moisture-dynamics" class="nav-link" data-scroll-target="#moisture-dynamics"><span class="header-section-number">6.2</span> Moisture Dynamics</a></li>
  <li><a href="#temporal-dynamics-and-persistence" id="toc-temporal-dynamics-and-persistence" class="nav-link" data-scroll-target="#temporal-dynamics-and-persistence"><span class="header-section-number">6.3</span> Temporal Dynamics and Persistence</a></li>
  <li><a href="#historical-context-and-persistence" id="toc-historical-context-and-persistence" class="nav-link" data-scroll-target="#historical-context-and-persistence"><span class="header-section-number">6.4</span> Historical Context and Persistence</a></li>
  <li><a href="#energy-dynamics-and-interactions" id="toc-energy-dynamics-and-interactions" class="nav-link" data-scroll-target="#energy-dynamics-and-interactions"><span class="header-section-number">6.5</span> Energy Dynamics and Interactions</a></li>
  <li><a href="#wind-dynamics" id="toc-wind-dynamics" class="nav-link" data-scroll-target="#wind-dynamics"><span class="header-section-number">6.6</span> Wind Dynamics</a></li>
  <li><a href="#spatial-heterogenity-mixed-effects" id="toc-spatial-heterogenity-mixed-effects" class="nav-link" data-scroll-target="#spatial-heterogenity-mixed-effects"><span class="header-section-number">6.7</span> Spatial Heterogenity (Mixed Effects)</a></li>
  </ul></li>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation"><span class="header-section-number">7</span> Model Evaluation</a>
  <ul class="collapse">
  <li><a href="#classification-performance-evaluation" id="toc-classification-performance-evaluation" class="nav-link" data-scroll-target="#classification-performance-evaluation"><span class="header-section-number">7.1</span> Classification Performance Evaluation</a></li>
  <li><a href="#random-effects-visualization" id="toc-random-effects-visualization" class="nav-link" data-scroll-target="#random-effects-visualization"><span class="header-section-number">7.2</span> Random Effects Visualization</a></li>
  <li><a href="#validating-model-assumptions" id="toc-validating-model-assumptions" class="nav-link" data-scroll-target="#validating-model-assumptions"><span class="header-section-number">7.3</span> Validating Model Assumptions</a></li>
  <li><a href="#verifying-temporal-independence" id="toc-verifying-temporal-independence" class="nav-link" data-scroll-target="#verifying-temporal-independence"><span class="header-section-number">7.4</span> Verifying Temporal Independence</a></li>
  <li><a href="#predictive-accuracy-and-generative-validity" id="toc-predictive-accuracy-and-generative-validity" class="nav-link" data-scroll-target="#predictive-accuracy-and-generative-validity"><span class="header-section-number">7.5</span> Predictive Accuracy and Generative Validity</a></li>
  <li><a href="#justification-of-distributional-choice" id="toc-justification-of-distributional-choice" class="nav-link" data-scroll-target="#justification-of-distributional-choice"><span class="header-section-number">7.6</span> Justification of Distributional choice</a></li>
  </ul></li>
  <li><a href="#final-model-selection-and-variance-analysis" id="toc-final-model-selection-and-variance-analysis" class="nav-link" data-scroll-target="#final-model-selection-and-variance-analysis"><span class="header-section-number">8</span> Final Model Selection and Variance Analysis</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/blob/main/04-modeling.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-features.html">Modelling</a></li><li class="breadcrumb-item"><a href="./04-modeling.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelling</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelling</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="establishing-the-baseline-null-model" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="establishing-the-baseline-null-model"><span class="header-section-number">4.1</span> Establishing the Baseline (Null Model)</h2>
</section>
<section id="modeling" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Modeling</h1>
<p>In this chapter, we progressively build our statistical framework, starting from a null baseline and adding layers of physical complexity. We utilize <strong>Zero-Inflated Gamma (ZIG)</strong> models to handle the dual nature of rainfall data (probability of occurrence vs.&nbsp;intensity).</p>
</section>
<section id="modelling" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Modelling</h1>
<section id="establishing-the-baseline-null-model-1" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="establishing-the-baseline-null-model-1"><span class="header-section-number">6.1</span> Establishing the Baseline (Null Model)</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Fit the Null Model (Intercept-Only)</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># TO Establish a baseline AIC/BIC and recover global average parameters</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>m0_null <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="at">formula =</span> rainfall <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># Model rainfall intensity using only an intercept</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="at">ziformula =</span> <span class="sc">~</span><span class="dv">1</span>, <span class="co"># Model probability of dry days using only an intercept</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="co"># Gamma distribution for positive rain</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="at">data =</span> df_scaled</span>
<span id="cb1-8"><a href="#cb1-8"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">tab_model</span>(</span>
<span id="cb2-2"><a href="#cb2-2"></a>  m0_null,</span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="at">show.se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="at">show.aic =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="at">transform =</span> <span class="st">"exp"</span>,</span>
<span id="cb2-6"><a href="#cb2-6"></a>  <span class="at">collapse.se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="at">p.style =</span> <span class="st">"numeric_stars"</span>,</span>
<span id="cb2-8"><a href="#cb2-8"></a>  <span class="at">string.pred =</span> <span class="st">"Parameter"</span>,</span>
<span id="cb2-9"><a href="#cb2-9"></a>  <span class="at">string.est =</span> <span class="st">"Estimate (Exp)"</span>,</span>
<span id="cb2-10"><a href="#cb2-10"></a>  <span class="at">dv.labels =</span> <span class="st">"Baseline Rainfall Model"</span>,</span>
<span id="cb2-11"><a href="#cb2-11"></a>  <span class="at">title =</span> <span class="st">"Table 1: Baseline Zero-Inflated Gamma Model (Intercept Only)"</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table 1: Baseline Zero-Inflated Gamma Model (Intercept Only)</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Baseline Rainfall Model</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Parameter</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimate (Exp)</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
<td></td>
</tr>
<tr class="odd">
<td colspan="5" style="text-align: left; font-weight: bold; padding-top: .8em;">Count Model</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">6.57 <sup>***</sup><br>
(0.04)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">6.49&nbsp;–&nbsp;6.65</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">3.94 <sup></sup><br>
(NA)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">3.91&nbsp;–&nbsp;3.97</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td></td>
</tr>
<tr class="even">
<td colspan="4" style="text-align: left; font-weight: bold; padding-top: .8em;">Zero-Inflated Model</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.78 <sup>***</sup><br>
(0.01)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.76&nbsp;–&nbsp;1.80</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">141856</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> Nagelkerke</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.000</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">AIC</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">461669.678</td>
<td></td>
</tr>
<tr class="odd">
<td colspan="4" style="text-align: right; font-style: italic; border-top: double black;">* p&lt;0.05&nbsp;&nbsp;&nbsp;** p&lt;0.01&nbsp;&nbsp;&nbsp;*** p&lt;0.001</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>To quantify the value added by our meteorological predictors, we first fitted a <strong>“Null” Zero-Inflated Gamma model</strong>. This model contains no predictors (covariates); it consists solely of intercepts. Its purpose is to verify if the model structure correctly recovers the fundamental properties of the dataset (the global probability of rain and the global average intensity).</p>
<p><strong>1. Zero-Inflation Component (The “Hurdle”):</strong> The zero-inflation intercept is <span class="math inline">\(\beta_{zi} = 0.5769\)</span>. Since this component uses a <strong>logit</strong> link function, we can back-transform it to find the baseline probability of a dry day:</p>
<p><span class="math display">\[P(\text{Dry}) = \frac{e^{0.5769}}{1 + e^{0.5769}} \approx \frac{1.78}{2.78} \approx 64.03\%\]</span></p>
<p><strong>Insight:</strong> This model-derived probability matches the empirical zero-inflation rate (<span class="math inline">\(64.05\%\)</span>) calculated in our EDA perfectly. This confirms the model is correctly calibrated to the frequency of dry days.</p>
<p><strong>2. Conditional Component (Gamma Intensity):</strong> The conditional intercept is <span class="math inline">\(\beta_{cond} = 1.8825\)</span>. Using the <strong>log</strong> link function, we recover the baseline rainfall intensity for wet days:</p>
<p><span class="math display">\[\mu_{\text{rain}} = e^{1.8825} \approx 6.57 \text{ mm}\]</span></p>
<p><strong>Insight:</strong> This represents the typical “geometric mean” rainfall intensity when it does rain, unadjusted for season or location.</p>
<p><strong>3. Performance Baseline:</strong></p>
<ul>
<li><p><strong>AIC:</strong> 461,669.7</p></li>
<li><p><strong>Implication:</strong> Any subsequent model including predictors (e.g., <code>humidity</code>, <code>pressure</code>, <code>season</code>) must achieve an AIC significantly lower than this value to demonstrate predictive power.</p></li>
</ul>
</section>
<section id="moisture-dynamics" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="moisture-dynamics"><span class="header-section-number">6.2</span> Moisture Dynamics</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Update the null model to include moisture-related predictors</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>m1_moisture <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb3-3"><a href="#cb3-3"></a>  m0_null,</span>
<span id="cb3-4"><a href="#cb3-4"></a>  . <span class="sc">~</span> . <span class="sc">+</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> dewpoint_change <span class="sc">+</span> pressure_change,</span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span> dewpoint_9am</span>
<span id="cb3-6"><a href="#cb3-6"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="kvldjeznde" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kvldjeznde table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kvldjeznde thead, #kvldjeznde tbody, #kvldjeznde tfoot, #kvldjeznde tr, #kvldjeznde td, #kvldjeznde th {
  border-style: none;
}

#kvldjeznde p {
  margin: 0;
  padding: 0;
}

#kvldjeznde .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kvldjeznde .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kvldjeznde .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kvldjeznde .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kvldjeznde .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kvldjeznde .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvldjeznde .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kvldjeznde .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kvldjeznde .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kvldjeznde .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kvldjeznde .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kvldjeznde .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kvldjeznde .gt_spanner_row {
  border-bottom-style: hidden;
}

#kvldjeznde .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kvldjeznde .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kvldjeznde .gt_from_md > :first-child {
  margin-top: 0;
}

#kvldjeznde .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kvldjeznde .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kvldjeznde .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kvldjeznde .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kvldjeznde .gt_row_group_first td {
  border-top-width: 2px;
}

#kvldjeznde .gt_row_group_first th {
  border-top-width: 2px;
}

#kvldjeznde .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvldjeznde .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kvldjeznde .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kvldjeznde .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvldjeznde .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvldjeznde .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kvldjeznde .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kvldjeznde .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kvldjeznde .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvldjeznde .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kvldjeznde .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvldjeznde .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kvldjeznde .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvldjeznde .gt_left {
  text-align: left;
}

#kvldjeznde .gt_center {
  text-align: center;
}

#kvldjeznde .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kvldjeznde .gt_font_normal {
  font-weight: normal;
}

#kvldjeznde .gt_font_bold {
  font-weight: bold;
}

#kvldjeznde .gt_font_italic {
  font-style: italic;
}

#kvldjeznde .gt_super {
  font-size: 65%;
}

#kvldjeznde .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kvldjeznde .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kvldjeznde .gt_indent_1 {
  text-indent: 5px;
}

#kvldjeznde .gt_indent_2 {
  text-indent: 10px;
}

#kvldjeznde .gt_indent_3 {
  text-indent: 15px;
}

#kvldjeznde .gt_indent_4 {
  text-indent: 20px;
}

#kvldjeznde .gt_indent_5 {
  text-indent: 25px;
}

#kvldjeznde .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kvldjeznde div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption><strong>Model 1: Moisture &amp; Pressure Dynamics</strong></caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Predictor</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>exp(Beta)</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<td colspan="4" id="cond" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">cond</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="cond  label">Humidity (3pm)</td>
<td class="gt_row gt_center" headers="cond  estimate">1.46</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.44, 1.48</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Dewpoint (9am)</td>
<td class="gt_row gt_center" headers="cond  estimate">1.48</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.46, 1.49</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Dewpoint Change (Delta)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.91</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.90, 0.92</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Pressure Change (Delta)</td>
<td class="gt_row gt_center" headers="cond  estimate">1.28</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.26, 1.29</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row even">
<td colspan="4" id="zi" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">zi</td>
</tr>
<tr class="gt_row_group_first odd">
<td class="gt_row gt_left" headers="zi  label">Humidity (3pm)</td>
<td class="gt_row gt_center" headers="zi  estimate">0.34</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.34, 0.35</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">Dewpoint (9am)</td>
<td class="gt_row gt_center" headers="zi  estimate">1.00</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.99, 1.01</td>
<td class="gt_row gt_center" headers="zi  p.value">&gt;0.9</td>
</tr>
<tr class="gt_group_heading_row odd">
<td colspan="4" id="NA" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">NA</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="NA  label" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">AIC</td>
<td class="gt_row gt_center" headers="NA  estimate" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">422,630</td>
<td class="gt_row gt_center" headers="NA  conf.low" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NA  label">BIC</td>
<td class="gt_row gt_center" headers="NA  estimate">422,719</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="NA  label">Log-likelihood</td>
<td class="gt_row gt_center" headers="NA  estimate">-211,306</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Building upon the baseline, “Model 1” incorporates the primary moisture and pressure drivers identified in the exploratory analysis. Specifically, we test the hypothesis that atmospheric moisture content (<code>humidity</code>, <code>dewpoint</code>) and pressure stability (<code>pressure_change</code>) drive both the occurrence and intensity of rainfall.</p>
<p><strong>1. Performance Improvement:</strong></p>
<ul>
<li><p><strong>AIC Reduction:</strong> The AIC dropped dramatically from <strong>461,669.7 (Null)</strong> to <strong>422,847 (M1)</strong>.</p></li>
<li><p><strong>Significance:</strong> This massive reduction (<span class="math inline">\(\Delta AIC \approx 38,823\)</span>) confirms that moisture dynamics are foundational predictors, explaining a vast amount of the variance in the dataset.</p></li>
</ul>
<p><strong>2. Conditional Model (Rainfall Intensity):</strong> All predictors in the conditional part are statistically significant (<span class="math inline">\(p &lt; 2e^{-16}\)</span>):</p>
<ul>
<li><p><strong>Humidity &amp; Dewpoint:</strong> Both <code>humidity3pm</code> (<span class="math inline">\(\beta = 0.38\)</span>) and <code>dewpoint_9am</code> (<span class="math inline">\(\beta = 0.38\)</span>) have strong positive effects. As the air becomes more saturated (higher humidity) and holds more absolute moisture (higher dewpoint), rainfall intensity increases.</p></li>
<li><p><strong>Pressure Change:</strong> The coefficient is positive (<span class="math inline">\(\beta = 0.23\)</span>), suggesting that larger rapid fluctuations in pressure (instability) correlate with heavier rainfall.</p></li>
</ul>
<p><strong>3. Zero-Inflation Model (Probability of Dry Days):</strong></p>
<ul>
<li><p><strong>Humidity:</strong> The coefficient for <code>humidity3pm</code> is <strong>-1.07</strong>. In a zero-inflated model, a <em>negative</em> coefficient means the predictor <em>decreases</em> the log-odds of a zero (dry day). Therefore, <strong>higher humidity significantly increases the probability of rain</strong>.</p></li>
<li><p><strong>Non-Significance:</strong> Interestingly, <code>dewpoint_9am</code> is not significant in the zero-inflation part (<span class="math inline">\(p = 0.907\)</span>). This implies that while the <em>absolute</em> moisture (dewpoint) determines <em>how hard</em> it rains (intensity), it is the <em>relative</em> saturation (humidity) that determines <em>if</em> it rains at all.</p></li>
</ul>
</section>
<section id="temporal-dynamics-and-persistence" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="temporal-dynamics-and-persistence"><span class="header-section-number">6.3</span> Temporal Dynamics and Persistence</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Update Model 1 to include:</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># - Cyclical Seasonality (day_cos, day_sin) in the Conditional Model</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># - Persistence (rain_yesterday) and Development (cloud/pressure) in the ZI Model</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>m2_temporal <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb4-5"><a href="#cb4-5"></a>  m1_moisture,</span>
<span id="cb4-6"><a href="#cb4-6"></a>  . <span class="sc">~</span> . <span class="sc">+</span> day_cos <span class="sc">+</span> day_sin,</span>
<span id="cb4-7"><a href="#cb4-7"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>    pressure_change</span>
<span id="cb4-12"><a href="#cb4-12"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="aszfovwkvf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#aszfovwkvf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#aszfovwkvf thead, #aszfovwkvf tbody, #aszfovwkvf tfoot, #aszfovwkvf tr, #aszfovwkvf td, #aszfovwkvf th {
  border-style: none;
}

#aszfovwkvf p {
  margin: 0;
  padding: 0;
}

#aszfovwkvf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#aszfovwkvf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#aszfovwkvf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#aszfovwkvf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#aszfovwkvf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aszfovwkvf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aszfovwkvf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aszfovwkvf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#aszfovwkvf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#aszfovwkvf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#aszfovwkvf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#aszfovwkvf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#aszfovwkvf .gt_spanner_row {
  border-bottom-style: hidden;
}

#aszfovwkvf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#aszfovwkvf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#aszfovwkvf .gt_from_md > :first-child {
  margin-top: 0;
}

#aszfovwkvf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#aszfovwkvf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#aszfovwkvf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#aszfovwkvf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#aszfovwkvf .gt_row_group_first td {
  border-top-width: 2px;
}

#aszfovwkvf .gt_row_group_first th {
  border-top-width: 2px;
}

#aszfovwkvf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aszfovwkvf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#aszfovwkvf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#aszfovwkvf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aszfovwkvf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aszfovwkvf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#aszfovwkvf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#aszfovwkvf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#aszfovwkvf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aszfovwkvf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aszfovwkvf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aszfovwkvf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aszfovwkvf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aszfovwkvf .gt_left {
  text-align: left;
}

#aszfovwkvf .gt_center {
  text-align: center;
}

#aszfovwkvf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#aszfovwkvf .gt_font_normal {
  font-weight: normal;
}

#aszfovwkvf .gt_font_bold {
  font-weight: bold;
}

#aszfovwkvf .gt_font_italic {
  font-style: italic;
}

#aszfovwkvf .gt_super {
  font-size: 65%;
}

#aszfovwkvf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#aszfovwkvf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#aszfovwkvf .gt_indent_1 {
  text-indent: 5px;
}

#aszfovwkvf .gt_indent_2 {
  text-indent: 10px;
}

#aszfovwkvf .gt_indent_3 {
  text-indent: 15px;
}

#aszfovwkvf .gt_indent_4 {
  text-indent: 20px;
}

#aszfovwkvf .gt_indent_5 {
  text-indent: 25px;
}

#aszfovwkvf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#aszfovwkvf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption><strong>Model 2: Temporal &amp; Persistence Effects</strong></caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Predictor</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>exp(Beta)</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<td colspan="4" id="cond" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">cond</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="cond  label">humidity3pm</td>
<td class="gt_row gt_center" headers="cond  estimate">1.48</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.45, 1.50</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="cond  estimate">1.48</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.46, 1.51</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">dewpoint_change</td>
<td class="gt_row gt_center" headers="cond  estimate">0.91</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.89, 0.92</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Pressure Change</td>
<td class="gt_row gt_center" headers="cond  estimate">1.28</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.26, 1.29</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Seasonality (Cos)</td>
<td class="gt_row gt_center" headers="cond  estimate">1.02</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.00, 1.03</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">0.016</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Seasonality (Sin)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.95</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.94, 0.96</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row even">
<td colspan="4" id="zi" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">zi</td>
</tr>
<tr class="gt_row_group_first odd">
<td class="gt_row gt_left" headers="zi  label">humidity3pm</td>
<td class="gt_row gt_center" headers="zi  estimate">0.42</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.41, 0.42</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="zi  estimate">0.92</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.91, 0.94</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">Pressure Change</td>
<td class="gt_row gt_center" headers="zi  estimate">0.60</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.60, 0.61</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">Rain Yesterday (Persistence)</td>
<td class="gt_row gt_center" headers="zi  estimate"><br>
</td>
<td class="gt_row gt_center" headers="zi  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="zi  p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="zi  estimate">0.24</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.24, 0.25</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">Cloud Development</td>
<td class="gt_row gt_center" headers="zi  estimate">1.09</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.08, 1.11</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row odd">
<td colspan="4" id="NA" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">NA</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="NA  label" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">AIC</td>
<td class="gt_row gt_center" headers="NA  estimate" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">406,826</td>
<td class="gt_row gt_center" headers="NA  conf.low" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NA  label">BIC</td>
<td class="gt_row gt_center" headers="NA  estimate">406,964</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>“Model 2” extends the analysis by incorporating the time-dependent structures identified in our EDA: <strong>seasonality</strong> (cyclical encoding) and <strong>persistence</strong> (Markov chains). We also refined the Zero-Inflation component to include dynamic drivers like <code>cloud_development</code> and <code>pressure_change</code>.</p>
<p><strong>1. Performance Improvement:</strong></p>
<ul>
<li><p><strong>AIC Reduction:</strong> The model achieved an AIC of <strong>406,659</strong>, a substantial improvement over Model 1 (422,846).</p></li>
<li><p><strong>Magnitude:</strong> The reduction of <span class="math inline">\(\Delta AIC \approx 16,187\)</span> confirms that adding temporal context (knowing <em>when</em> in the year and <em>what happened yesterday</em>) provides critical predictive information that moisture variables alone cannot capture.</p></li>
</ul>
<p><strong>2. Conditional Model (Rainfall Intensity):</strong></p>
<ul>
<li><p><strong>Seasonality:</strong> Both <code>day_cos</code> (<span class="math inline">\(\beta = 0.03, p &lt; 0.001\)</span>) and <code>day_sin</code> (<span class="math inline">\(\beta = -0.04, p &lt; 0.001\)</span>) are highly significant. This mathematically confirms the “Summer Peak” pattern observed before, rainfall intensity is not constant but oscillates sinusoidally throughout the year.</p></li>
<li><p><strong>Robustness:</strong> The coefficients for moisture (<code>humidity3pm</code>, <code>dewpoint</code>) remained stable compared to Model 1, indicating that seasonality is an independent driver of intensity, not just a proxy for changing humidity levels.</p></li>
</ul>
<p><strong>3. Zero-Inflation Model (Probability of Dry Days):</strong></p>
<ul>
<li><p><strong>The “Persistence” Effect:</strong> The strongest predictor in the zero-inflation model is <code>rain_yesterdayYes</code> with a coefficient of <strong>-1.42</strong>.</p></li>
<li><p><strong>Interpretation:</strong> Because the Zero-Inflation model predicts the probability of a <em>zero</em> (dry day), a negative coefficient means <em>lower odds of being dry</em>.</p></li>
<li><p><strong>Odds Ratio:</strong> <span class="math inline">\(\exp(-1.42) \approx 0.24\)</span>. This implies that if it rained yesterday, the odds of today being dry drop by ~76%. This is a massive effect size that validates the Markov Chain findings before.</p></li>
<li><p><strong>Dynamic Drivers:</strong></p></li>
<li><p><code>pressure_change</code> (<span class="math inline">\(\beta = -0.51\)</span>): Large pressure drops significantly decrease the probability of a dry day (i.e., increase rain probability).</p></li>
<li><p><code>cloud_development</code> (<span class="math inline">\(\beta = 0.11\)</span>): Surprisingly, positive cloud development (more clouds at 3pm than 9am) has a positive coefficient here, slightly <em>increasing</em> the zero-inflation probability. This might capture non-precipitating cumulus buildup typical of dry, fair-weather afternoons.</p></li>
</ul>
</section>
<section id="historical-context-and-persistence" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="historical-context-and-persistence"><span class="header-section-number">6.4</span> Historical Context and Persistence</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Update Model 2 to include Historical Context in the Conditional Model</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># - Rainfall Moving Average (7-day)</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># - Days Since Last Rain (Drought effect)</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co"># - Humidity Moving Average (7-day)</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># - Rain Yesterday (Persistence on Intensity)</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>m3_history <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb5-7"><a href="#cb5-7"></a>  m2_temporal,</span>
<span id="cb5-8"><a href="#cb5-8"></a>  . <span class="sc">~</span> . <span class="sc">+</span> rainfall_ma7 <span class="sc">+</span> days_since_rain <span class="sc">+</span> humidity_ma7 <span class="sc">+</span> rain_yesterday,</span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>    pressure_change</span>
<span id="cb5-14"><a href="#cb5-14"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="zutfijimql" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zutfijimql table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zutfijimql thead, #zutfijimql tbody, #zutfijimql tfoot, #zutfijimql tr, #zutfijimql td, #zutfijimql th {
  border-style: none;
}

#zutfijimql p {
  margin: 0;
  padding: 0;
}

#zutfijimql .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zutfijimql .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zutfijimql .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zutfijimql .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zutfijimql .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zutfijimql .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zutfijimql .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zutfijimql .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zutfijimql .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zutfijimql .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zutfijimql .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zutfijimql .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zutfijimql .gt_spanner_row {
  border-bottom-style: hidden;
}

#zutfijimql .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zutfijimql .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zutfijimql .gt_from_md > :first-child {
  margin-top: 0;
}

#zutfijimql .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zutfijimql .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zutfijimql .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zutfijimql .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zutfijimql .gt_row_group_first td {
  border-top-width: 2px;
}

#zutfijimql .gt_row_group_first th {
  border-top-width: 2px;
}

#zutfijimql .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zutfijimql .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zutfijimql .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zutfijimql .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zutfijimql .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zutfijimql .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zutfijimql .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zutfijimql .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zutfijimql .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zutfijimql .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zutfijimql .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zutfijimql .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zutfijimql .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zutfijimql .gt_left {
  text-align: left;
}

#zutfijimql .gt_center {
  text-align: center;
}

#zutfijimql .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zutfijimql .gt_font_normal {
  font-weight: normal;
}

#zutfijimql .gt_font_bold {
  font-weight: bold;
}

#zutfijimql .gt_font_italic {
  font-style: italic;
}

#zutfijimql .gt_super {
  font-size: 65%;
}

#zutfijimql .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zutfijimql .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zutfijimql .gt_indent_1 {
  text-indent: 5px;
}

#zutfijimql .gt_indent_2 {
  text-indent: 10px;
}

#zutfijimql .gt_indent_3 {
  text-indent: 15px;
}

#zutfijimql .gt_indent_4 {
  text-indent: 20px;
}

#zutfijimql .gt_indent_5 {
  text-indent: 25px;
}

#zutfijimql .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zutfijimql div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption><strong>Model 3: Historical Trends &amp; Lagged Effects</strong></caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Predictor</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>exp(Beta)</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<td colspan="4" id="cond" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">cond</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="cond  label">humidity3pm</td>
<td class="gt_row gt_center" headers="cond  estimate">1.47</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.45, 1.50</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="cond  estimate">1.42</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.40, 1.44</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">dewpoint_change</td>
<td class="gt_row gt_center" headers="cond  estimate">0.89</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.88, 0.90</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">pressure_change</td>
<td class="gt_row gt_center" headers="cond  estimate">1.27</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.25, 1.28</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">day_cos</td>
<td class="gt_row gt_center" headers="cond  estimate">1.01</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.00, 1.03</td>
<td class="gt_row gt_center" headers="cond  p.value">0.10</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">day_sin</td>
<td class="gt_row gt_center" headers="cond  estimate">0.95</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.93, 0.96</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Rainfall Trend (7-Day MA)</td>
<td class="gt_row gt_center" headers="cond  estimate">1.14</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.12, 1.15</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Dry Spell Length (Days)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.99</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.98, 1.00</td>
<td class="gt_row gt_center" headers="cond  p.value">0.13</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Humidity Trend (7-Day MA)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.90</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.89, 0.92</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Rain Yesterday (Indicator)</td>
<td class="gt_row gt_center" headers="cond  estimate"><br>
</td>
<td class="gt_row gt_center" headers="cond  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="cond  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="cond  estimate">1.36</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.33, 1.40</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row odd">
<td colspan="4" id="zi" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">zi</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="zi  label">humidity3pm</td>
<td class="gt_row gt_center" headers="zi  estimate">0.42</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.41, 0.42</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="zi  estimate">0.92</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.91, 0.94</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">pressure_change</td>
<td class="gt_row gt_center" headers="zi  estimate">0.60</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.60, 0.61</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">Rain Yesterday (Indicator)</td>
<td class="gt_row gt_center" headers="zi  estimate"><br>
</td>
<td class="gt_row gt_center" headers="zi  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="zi  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="zi  estimate">0.24</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.24, 0.25</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">cloud_development</td>
<td class="gt_row gt_center" headers="zi  estimate">1.09</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.08, 1.11</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row even">
<td colspan="4" id="NA" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">NA</td>
</tr>
<tr class="gt_row_group_first odd">
<td class="gt_row gt_left" headers="NA  label" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">AIC</td>
<td class="gt_row gt_center" headers="NA  estimate" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">405,125</td>
<td class="gt_row gt_center" headers="NA  conf.low" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="NA  label">BIC</td>
<td class="gt_row gt_center" headers="NA  estimate">405,303</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>“Model 3” integrates the final layer of complexity: <strong>history</strong>. While Model 2 accounted for <em>when</em> we are (seasonality), Model 3 accounts for <em>what just happened</em> (recent weather trends). We hypothesize that the intensity of today’s rain is conditionally dependent on the saturation of the ground and atmosphere over the past week.</p>
<p><strong>1. Performance Improvement:</strong></p>
<ul>
<li><p><strong>AIC Reduction:</strong> The AIC improved to <strong>404,936.2</strong>, down from 406,659.3 (M2).</p></li>
<li><p><strong>Significance:</strong> This reduction (<span class="math inline">\(\Delta AIC \approx 1,723\)</span>) indicates that adding historical moving averages improves the model, though with diminishing returns compared to the massive leaps seen in Models 1 and 2.</p></li>
</ul>
<p><strong>2. Conditional Model (Rainfall Intensity):</strong></p>
<ul>
<li><p><strong>Persistence of Intensity (<code>rain_yesterday</code>):</strong> The coefficient is positive (<span class="math inline">\(\beta = 0.31, p &lt; 0.001\)</span>). This implies that if it rained yesterday, today’s rainfall is likely to be <strong>~37% more intense</strong> (<span class="math inline">\(e^{0.31} \approx 1.36\)</span>). Wet weather systems tend to be “heavy” and sustained.</p></li>
<li><p><strong>Accumulated Wetness (<code>rainfall_ma7</code>):</strong> The positive coefficient (<span class="math inline">\(\beta = 0.13\)</span>) confirms that a wetter preceding week correlates with heavier rainfall today, likely due to deep atmospheric moisture saturation.</p></li>
<li><p><strong>The “Drizzle” Effect (<code>humidity_ma7</code>):</strong> Interestingly, the 7-day humidity average has a <em>negative</em> coefficient (<span class="math inline">\(\beta = -0.10\)</span>). Once we control for <em>today’s</em> humidity (which is positive), a persistently humid week might indicate stable, low-intensity stratiform clouds (drizzle) rather than the explosive instability required for heavy convective storms.</p></li>
<li><p><strong>Drought Effect (<code>days_since_rain</code>):</strong> This variable is <strong>not significant</strong> (<span class="math inline">\(p = 0.14\)</span>) for intensity. While our dry spell analysis showed it strongly predicts <em>whether</em> it rains (Zero-Inflation), it does not appear to influence <em>how much</em> it rains once the dry spell breaks.</p></li>
</ul>
<p><strong>3. Zero-Inflation Model:</strong></p>
<ul>
<li>The coefficients remain robust and nearly identical to Model 2, reaffirming that <code>rain_yesterday</code> (<span class="math inline">\(\beta = -1.42\)</span>) is the dominant driver of the state change from “Dry” to “Wet.”</li>
</ul>
</section>
<section id="energy-dynamics-and-interactions" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="energy-dynamics-and-interactions"><span class="header-section-number">6.5</span> Energy Dynamics and Interactions</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Update Model 3 to include Energy Dynamics and Interactions</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># - Sunshine &amp; Evaporation (Energy Input)</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co"># - Instability Index (Atmospheric Dynamics)</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># - The "Rain Corner" Interaction (Sunshine * Humidity)</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co"># - Cloud Development (Diurnal Change)</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>m4_energy <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb6-7"><a href="#cb6-7"></a>  m3_history,</span>
<span id="cb6-8"><a href="#cb6-8"></a>  . <span class="sc">~</span> . <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>    sunshine <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>    evaporation <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>    instability_index <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>    sun_humid_interaction <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>    cloud_development,</span>
<span id="cb6-14"><a href="#cb6-14"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb6-16"><a href="#cb6-16"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb6-17"><a href="#cb6-17"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb6-18"><a href="#cb6-18"></a>    pressure_change</span>
<span id="cb6-19"><a href="#cb6-19"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="lgfwuxfnfk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lgfwuxfnfk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lgfwuxfnfk thead, #lgfwuxfnfk tbody, #lgfwuxfnfk tfoot, #lgfwuxfnfk tr, #lgfwuxfnfk td, #lgfwuxfnfk th {
  border-style: none;
}

#lgfwuxfnfk p {
  margin: 0;
  padding: 0;
}

#lgfwuxfnfk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lgfwuxfnfk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lgfwuxfnfk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lgfwuxfnfk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lgfwuxfnfk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lgfwuxfnfk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lgfwuxfnfk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lgfwuxfnfk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lgfwuxfnfk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lgfwuxfnfk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lgfwuxfnfk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lgfwuxfnfk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lgfwuxfnfk .gt_spanner_row {
  border-bottom-style: hidden;
}

#lgfwuxfnfk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lgfwuxfnfk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lgfwuxfnfk .gt_from_md > :first-child {
  margin-top: 0;
}

#lgfwuxfnfk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lgfwuxfnfk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lgfwuxfnfk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lgfwuxfnfk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lgfwuxfnfk .gt_row_group_first td {
  border-top-width: 2px;
}

#lgfwuxfnfk .gt_row_group_first th {
  border-top-width: 2px;
}

#lgfwuxfnfk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lgfwuxfnfk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lgfwuxfnfk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lgfwuxfnfk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lgfwuxfnfk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lgfwuxfnfk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lgfwuxfnfk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lgfwuxfnfk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lgfwuxfnfk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lgfwuxfnfk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lgfwuxfnfk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lgfwuxfnfk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lgfwuxfnfk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lgfwuxfnfk .gt_left {
  text-align: left;
}

#lgfwuxfnfk .gt_center {
  text-align: center;
}

#lgfwuxfnfk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lgfwuxfnfk .gt_font_normal {
  font-weight: normal;
}

#lgfwuxfnfk .gt_font_bold {
  font-weight: bold;
}

#lgfwuxfnfk .gt_font_italic {
  font-style: italic;
}

#lgfwuxfnfk .gt_super {
  font-size: 65%;
}

#lgfwuxfnfk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lgfwuxfnfk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lgfwuxfnfk .gt_indent_1 {
  text-indent: 5px;
}

#lgfwuxfnfk .gt_indent_2 {
  text-indent: 10px;
}

#lgfwuxfnfk .gt_indent_3 {
  text-indent: 15px;
}

#lgfwuxfnfk .gt_indent_4 {
  text-indent: 20px;
}

#lgfwuxfnfk .gt_indent_5 {
  text-indent: 25px;
}

#lgfwuxfnfk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lgfwuxfnfk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption><strong>Model 4: Thermodynamic Energy &amp; Interactions</strong></caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Predictor</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>exp(Beta)</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<td colspan="4" id="cond" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">cond</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="cond  label">humidity3pm</td>
<td class="gt_row gt_center" headers="cond  estimate">1.17</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.15, 1.20</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="cond  estimate">1.44</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.42, 1.47</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">dewpoint_change</td>
<td class="gt_row gt_center" headers="cond  estimate">0.90</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.89, 0.91</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">pressure_change</td>
<td class="gt_row gt_center" headers="cond  estimate">1.31</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.30, 1.32</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">day_cos</td>
<td class="gt_row gt_center" headers="cond  estimate">0.93</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.91, 0.94</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">day_sin</td>
<td class="gt_row gt_center" headers="cond  estimate">0.94</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.93, 0.96</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">rainfall_ma7</td>
<td class="gt_row gt_center" headers="cond  estimate">1.12</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.11, 1.13</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">days_since_rain</td>
<td class="gt_row gt_center" headers="cond  estimate">0.99</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.98, 1.00</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">0.017</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">humidity_ma7</td>
<td class="gt_row gt_center" headers="cond  estimate">0.93</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.91, 0.94</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">rain_yesterday</td>
<td class="gt_row gt_center" headers="cond  estimate"><br>
</td>
<td class="gt_row gt_center" headers="cond  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="cond  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="cond  estimate">1.40</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.36, 1.43</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Sunshine Duration (Hours)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.99</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.98, 1.01</td>
<td class="gt_row gt_center" headers="cond  p.value">0.5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Evaporation Rate</td>
<td class="gt_row gt_center" headers="cond  estimate">1.15</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.13, 1.17</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Instability Index (Derived)</td>
<td class="gt_row gt_center" headers="cond  estimate">1.21</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.19, 1.22</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Interaction: Sun * Humid</td>
<td class="gt_row gt_center" headers="cond  estimate">0.93</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.92, 0.94</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Cloud Development (Delta)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.98</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.97, 0.99</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row even">
<td colspan="4" id="zi" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">zi</td>
</tr>
<tr class="gt_row_group_first odd">
<td class="gt_row gt_left" headers="zi  label">humidity3pm</td>
<td class="gt_row gt_center" headers="zi  estimate">0.42</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.41, 0.42</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="zi  estimate">0.92</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.91, 0.94</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">pressure_change</td>
<td class="gt_row gt_center" headers="zi  estimate">0.60</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.60, 0.61</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">rain_yesterday</td>
<td class="gt_row gt_center" headers="zi  estimate"><br>
</td>
<td class="gt_row gt_center" headers="zi  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="zi  p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="zi  estimate">0.24</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.24, 0.25</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">Cloud Development (Delta)</td>
<td class="gt_row gt_center" headers="zi  estimate">1.09</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.08, 1.11</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row odd">
<td colspan="4" id="NA" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">NA</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="NA  label" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">AIC</td>
<td class="gt_row gt_center" headers="NA  estimate" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">403,742</td>
<td class="gt_row gt_center" headers="NA  conf.low" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NA  label">BIC</td>
<td class="gt_row gt_center" headers="NA  estimate">403,969</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>“Model 4” represents the full complexity of our meteorological hypothesis. Beyond moisture and history, we now incorporate <strong>energy dynamics</strong> (solar radiation, evaporation) and <strong>atmospheric instability</strong>. Crucially, we test the interaction term derived in the previous section to capture the non-linear “Rain Corner” effect.</p>
<p><strong>1. Performance Improvement:</strong></p>
<ul>
<li><p><strong>AIC Reduction:</strong> The AIC dropped to <strong>403,051.8</strong>.</p></li>
<li><p><strong>Significance:</strong> The reduction of <span class="math inline">\(\Delta AIC \approx 1,884\)</span> compared to Model 3 confirms that including energy dynamics provides a statistically significant improvement in model fit.</p></li>
</ul>
<p><strong>2. Conditional Model (Rainfall Intensity):</strong></p>
<ul>
<li><p><strong>The “Rain Corner” Interaction:</strong> The <code>sun_humid_interaction</code> term is highly significant (<span class="math inline">\(\beta = -0.08, p &lt; 0.001\)</span>).</p></li>
<li><p><strong>Interpretation:</strong> The negative coefficient confirms the “corner” geometry. As sunshine increases, the positive effect of humidity on rainfall intensity is dampening. Conversely, the heaviest rain occurs when humidity is high <em>and</em> sunshine is low (deep cloud cover).</p></li>
<li><p><strong>Instability:</strong> The <code>instability_index</code> has a strong positive effect (<span class="math inline">\(\beta = 0.19\)</span>). This confirms that low-pressure, high-humidity systems (convective instability) produce significantly heavier rainfall than stable systems.</p></li>
<li><p><strong>Evaporation:</strong> Surprisingly, <code>evaporation</code> has a positive coefficient (<span class="math inline">\(\beta = 0.19\)</span>). While high evaporation typically implies dry heat, in the context of a wet day, it likely serves as a proxy for the <strong>available energy</strong> (latent heat) in the system that fuels storm development.</p></li>
<li><p><strong>Sunshine:</strong> As expected, <code>sunshine</code> has a negative effect (<span class="math inline">\(\beta = -0.07\)</span>) on intensity. Even if it rains on a sunny day (e.g., a brief shower), the intensity is lower compared to a fully overcast day.</p></li>
</ul>
<p><strong>3. Shift in Humidity Importance:</strong> Notice that the coefficient for <code>humidity3pm</code> dropped drastically from <strong>0.39</strong> (Model 3) to <strong>0.08</strong> (Model 4).</p>
<ul>
<li><strong>Explanation:</strong> This does <em>not</em> mean humidity is less important. Rather, the variance previously attributed to raw “humidity” has now been correctly partitioned into more specific physical processes: <code>instability_index</code> (pressure-humidity interaction) and <code>sun_humid_interaction</code>. The model now understands <em>why</em> humidity matters.</li>
</ul>
</section>
<section id="wind-dynamics" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="wind-dynamics"><span class="header-section-number">6.6</span> Wind Dynamics</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Update Model 4 to include Circular Wind Vectors</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co"># - Gust U (East-West) and V (North-South) components</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co"># - 9am Wind U and V components (Morning wind direction)</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>m5_wind <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb7-5"><a href="#cb7-5"></a>  m4_energy,</span>
<span id="cb7-6"><a href="#cb7-6"></a>  . <span class="sc">~</span> . <span class="sc">+</span> gust_U_EW <span class="sc">+</span> gust_V_NS <span class="sc">+</span> wind9am_V_NS <span class="sc">+</span> wind9am_U_EW,</span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>    pressure_change</span>
<span id="cb7-12"><a href="#cb7-12"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="libvczxsws" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#libvczxsws table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#libvczxsws thead, #libvczxsws tbody, #libvczxsws tfoot, #libvczxsws tr, #libvczxsws td, #libvczxsws th {
  border-style: none;
}

#libvczxsws p {
  margin: 0;
  padding: 0;
}

#libvczxsws .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#libvczxsws .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#libvczxsws .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#libvczxsws .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#libvczxsws .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#libvczxsws .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#libvczxsws .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#libvczxsws .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#libvczxsws .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#libvczxsws .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#libvczxsws .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#libvczxsws .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#libvczxsws .gt_spanner_row {
  border-bottom-style: hidden;
}

#libvczxsws .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#libvczxsws .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#libvczxsws .gt_from_md > :first-child {
  margin-top: 0;
}

#libvczxsws .gt_from_md > :last-child {
  margin-bottom: 0;
}

#libvczxsws .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#libvczxsws .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#libvczxsws .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#libvczxsws .gt_row_group_first td {
  border-top-width: 2px;
}

#libvczxsws .gt_row_group_first th {
  border-top-width: 2px;
}

#libvczxsws .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#libvczxsws .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#libvczxsws .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#libvczxsws .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#libvczxsws .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#libvczxsws .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#libvczxsws .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#libvczxsws .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#libvczxsws .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#libvczxsws .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#libvczxsws .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#libvczxsws .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#libvczxsws .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#libvczxsws .gt_left {
  text-align: left;
}

#libvczxsws .gt_center {
  text-align: center;
}

#libvczxsws .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#libvczxsws .gt_font_normal {
  font-weight: normal;
}

#libvczxsws .gt_font_bold {
  font-weight: bold;
}

#libvczxsws .gt_font_italic {
  font-style: italic;
}

#libvczxsws .gt_super {
  font-size: 65%;
}

#libvczxsws .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#libvczxsws .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#libvczxsws .gt_indent_1 {
  text-indent: 5px;
}

#libvczxsws .gt_indent_2 {
  text-indent: 10px;
}

#libvczxsws .gt_indent_3 {
  text-indent: 15px;
}

#libvczxsws .gt_indent_4 {
  text-indent: 20px;
}

#libvczxsws .gt_indent_5 {
  text-indent: 25px;
}

#libvczxsws .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#libvczxsws div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption><strong>Model 5: Wind Vector Dynamics</strong></caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Predictor</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>exp(Beta)</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<td colspan="4" id="cond" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">cond</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="cond  label">humidity3pm</td>
<td class="gt_row gt_center" headers="cond  estimate">1.16</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.13, 1.18</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="cond  estimate">1.48</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.46, 1.51</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">dewpoint_change</td>
<td class="gt_row gt_center" headers="cond  estimate">0.90</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.89, 0.92</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">pressure_change</td>
<td class="gt_row gt_center" headers="cond  estimate">1.25</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.24, 1.26</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">day_cos</td>
<td class="gt_row gt_center" headers="cond  estimate">0.92</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.90, 0.93</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">day_sin</td>
<td class="gt_row gt_center" headers="cond  estimate">0.94</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.93, 0.95</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">rainfall_ma7</td>
<td class="gt_row gt_center" headers="cond  estimate">1.11</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.10, 1.12</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">days_since_rain</td>
<td class="gt_row gt_center" headers="cond  estimate">0.98</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.97, 0.99</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">humidity_ma7</td>
<td class="gt_row gt_center" headers="cond  estimate">0.93</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.91, 0.94</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">rain_yesterday</td>
<td class="gt_row gt_center" headers="cond  estimate"><br>
</td>
<td class="gt_row gt_center" headers="cond  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="cond  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="cond  estimate">1.39</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.35, 1.42</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">sunshine</td>
<td class="gt_row gt_center" headers="cond  estimate">0.99</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.97, 1.01</td>
<td class="gt_row gt_center" headers="cond  p.value">0.3</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">evaporation</td>
<td class="gt_row gt_center" headers="cond  estimate">1.15</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.13, 1.17</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">instability_index</td>
<td class="gt_row gt_center" headers="cond  estimate">1.23</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.21, 1.25</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">sun_humid_interaction</td>
<td class="gt_row gt_center" headers="cond  estimate">0.93</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.92, 0.94</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">cloud_development</td>
<td class="gt_row gt_center" headers="cond  estimate">0.98</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.97, 0.99</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Gust Vector (East-West)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.97</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.96, 0.98</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Gust Vector (North-South)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.98</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.96, 0.99</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Wind 9am Vector (North-South)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.91</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.90, 0.92</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Wind 9am Vector (East-West)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.93</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.92, 0.94</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row even">
<td colspan="4" id="zi" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">zi</td>
</tr>
<tr class="gt_row_group_first odd">
<td class="gt_row gt_left" headers="zi  label">humidity3pm</td>
<td class="gt_row gt_center" headers="zi  estimate">0.42</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.41, 0.42</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="zi  estimate">0.92</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.91, 0.94</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">pressure_change</td>
<td class="gt_row gt_center" headers="zi  estimate">0.60</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.60, 0.61</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">rain_yesterday</td>
<td class="gt_row gt_center" headers="zi  estimate"><br>
</td>
<td class="gt_row gt_center" headers="zi  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="zi  p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="zi  estimate">0.24</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.24, 0.25</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">cloud_development</td>
<td class="gt_row gt_center" headers="zi  estimate">1.09</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.08, 1.11</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row odd">
<td colspan="4" id="NA" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">NA</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="NA  label" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">AIC</td>
<td class="gt_row gt_center" headers="NA  estimate" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">403,141</td>
<td class="gt_row gt_center" headers="NA  conf.low" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NA  label">BIC</td>
<td class="gt_row gt_center" headers="NA  estimate">403,408</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>“Model 5” introduces the final physical layer: <strong>Wind Vector Decomposition</strong>. By decomposing wind direction into North-South (<span class="math inline">\(V\)</span>) and East-West (<span class="math inline">\(U\)</span>) components, we test the hypothesis that specific airflow origins (e.g., moisture-laden ocean winds vs.&nbsp;dry desert winds) drive rainfall intensity.</p>
<p><strong>1. Performance Improvement:</strong></p>
<ul>
<li><p><strong>AIC Reduction:</strong> The AIC dropped to <strong>402,452.7</strong> from 403,051.8 (M4).</p></li>
<li><p><strong>Significance:</strong> The decrease of <span class="math inline">\(\Delta AIC \approx 600\)</span> is smaller than previous steps but still highly statistically significant, confirming that wind direction adds unique information not captured by pressure or season alone.</p></li>
</ul>
<p><strong>2. Conditional Model (Rainfall Intensity):</strong> All wind vector components are statistically significant (<span class="math inline">\(p &lt; 0.001\)</span>), and their signs reveal a clear physical story consistent with Australian climatology:</p>
<ul>
<li><strong>North-South Vector (<code>wind9am_V_NS</code>):</strong> The coefficient is <strong>-0.088</strong>.
<ul>
<li><em>Mathematical interpretation:</em> Since <span class="math inline">\(V &gt; 0\)</span> represents North (winds from the interior/equator) and <span class="math inline">\(V &lt; 0\)</span> represents South (winds from the ocean), a <strong>negative coefficient</strong> implies that <strong>Southerly winds (negative V)</strong> increase rainfall intensity.</li>
<li><em>Physical validation:</em> This aligns perfectly with Australian geography, where “Southerly Busters” and fronts from the Southern Ocean bring cold, heavy rain, while Northerly winds typically bring dry heat from the desert interior.</li>
</ul></li>
<li><strong>East-West Vector (<code>wind9am_U_EW</code>):</strong> The coefficient is <strong>-0.085</strong>.
<ul>
<li><em>Interpretation:</em> A negative coefficient implies that <strong>Westerly winds (negative U)</strong> increase rainfall.</li>
<li><em>Physical validation:</em> This captures the “Roaring Forties” and the prevailing Westerlies that bring frontal rain systems to the southern continent.</li>
</ul></li>
<li><strong>Gusts vs.&nbsp;Sustained Wind:</strong> The morning winds (<code>wind9am</code>) have coefficients roughly 3-4x larger than the gust components (<code>gust_U/V</code>, <span class="math inline">\(\beta \approx -0.02\)</span>). This suggests that the <strong>prevailing air mass direction</strong> (advection) is more important for determining rainfall volume than the localized turbulence of wind gusts.</li>
</ul>
<p><strong>3. Model Stability:</strong> Crucially, the coefficients for previous drivers (Humidity, Instability, Seasonality) remained stable. This indicates that our Wind Vectors are <strong>orthogonal predictors</strong>; they explain <em>new</em> variance rather than stealing explanatory power from existing features.</p>
</section>
<section id="spatial-heterogenity-mixed-effects" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="spatial-heterogenity-mixed-effects"><span class="header-section-number">6.7</span> Spatial Heterogenity (Mixed Effects)</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># We explicitly keep 'location' to serve as the grouping factor</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>re_data <span class="ot">&lt;-</span> <span class="fu">select_model_features</span>(df_final, <span class="at">keep_location =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">scale_data</span>()</span>
<span id="cb8-4"><a href="#cb8-4"></a></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co"># Define Optimizer Control</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co"># BFGS optimizer is selected for better convergence on complex GLMM surfaces</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">glmmTMBControl</span>(</span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="at">optimizer =</span> optim,</span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="at">optArgs =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">"BFGS"</span>),</span>
<span id="cb8-10"><a href="#cb8-10"></a>  <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxit =</span> <span class="dv">1000</span>)</span>
<span id="cb8-11"><a href="#cb8-11"></a>)</span>
<span id="cb8-12"><a href="#cb8-12"></a></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co"># 3. Fit Zero-Inflated Gamma Mixed Model</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co"># - Random Intercepts: (1 | location) -&gt; Baseline rainfall varies by city</span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="co"># - Random Slopes: (humidity + rain_yesterday... | location) -&gt; The *effect* of these drivers varies by city</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>m6_mixed <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb8-17"><a href="#cb8-17"></a>  rainfall <span class="sc">~</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>    humidity3pm <span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20"></a>    dewpoint_change <span class="sc">+</span></span>
<span id="cb8-21"><a href="#cb8-21"></a>    pressure_change <span class="sc">+</span></span>
<span id="cb8-22"><a href="#cb8-22"></a>    day_cos <span class="sc">+</span></span>
<span id="cb8-23"><a href="#cb8-23"></a>    day_sin <span class="sc">+</span></span>
<span id="cb8-24"><a href="#cb8-24"></a>    rainfall_ma7 <span class="sc">+</span></span>
<span id="cb8-25"><a href="#cb8-25"></a>    days_since_rain <span class="sc">+</span></span>
<span id="cb8-26"><a href="#cb8-26"></a>    humidity_ma7 <span class="sc">+</span></span>
<span id="cb8-27"><a href="#cb8-27"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb8-28"><a href="#cb8-28"></a>    sunshine <span class="sc">+</span></span>
<span id="cb8-29"><a href="#cb8-29"></a>    evaporation <span class="sc">+</span></span>
<span id="cb8-30"><a href="#cb8-30"></a>    instability_index <span class="sc">+</span></span>
<span id="cb8-31"><a href="#cb8-31"></a>    sun_humid_interaction <span class="sc">+</span></span>
<span id="cb8-32"><a href="#cb8-32"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb8-33"><a href="#cb8-33"></a>    gust_U_EW <span class="sc">+</span></span>
<span id="cb8-34"><a href="#cb8-34"></a>    gust_V_NS <span class="sc">+</span></span>
<span id="cb8-35"><a href="#cb8-35"></a>    wind9am_V_NS <span class="sc">+</span></span>
<span id="cb8-36"><a href="#cb8-36"></a>    wind9am_U_EW <span class="sc">+</span></span>
<span id="cb8-37"><a href="#cb8-37"></a>    <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">+</span> humidity3pm <span class="sc">+</span> rain_yesterday <span class="sc">+</span> dewpoint_change <span class="sc">|</span> location),</span>
<span id="cb8-38"><a href="#cb8-38"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb8-39"><a href="#cb8-39"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb8-40"><a href="#cb8-40"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb8-41"><a href="#cb8-41"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb8-42"><a href="#cb8-42"></a>    pressure_change <span class="sc">+</span></span>
<span id="cb8-43"><a href="#cb8-43"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb8-44"><a href="#cb8-44"></a>    sunshine <span class="sc">+</span></span>
<span id="cb8-45"><a href="#cb8-45"></a>    evaporation <span class="sc">+</span></span>
<span id="cb8-46"><a href="#cb8-46"></a>    <span class="fu">ns</span>(days_since_rain, <span class="at">df =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb8-47"><a href="#cb8-47"></a>    humidity_ma7 <span class="sc">+</span></span>
<span id="cb8-48"><a href="#cb8-48"></a>    day_cos <span class="sc">+</span></span>
<span id="cb8-49"><a href="#cb8-49"></a>    day_sin,</span>
<span id="cb8-50"><a href="#cb8-50"></a>  <span class="at">data =</span> re_data,</span>
<span id="cb8-51"><a href="#cb8-51"></a>  <span class="at">control =</span> ctrl,</span>
<span id="cb8-52"><a href="#cb8-52"></a>  <span class="at">family =</span> <span class="fu">ziGamma</span>(<span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb8-53"><a href="#cb8-53"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="avdtdvlzfn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#avdtdvlzfn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#avdtdvlzfn thead, #avdtdvlzfn tbody, #avdtdvlzfn tfoot, #avdtdvlzfn tr, #avdtdvlzfn td, #avdtdvlzfn th {
  border-style: none;
}

#avdtdvlzfn p {
  margin: 0;
  padding: 0;
}

#avdtdvlzfn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#avdtdvlzfn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#avdtdvlzfn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#avdtdvlzfn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#avdtdvlzfn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#avdtdvlzfn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#avdtdvlzfn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#avdtdvlzfn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#avdtdvlzfn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#avdtdvlzfn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#avdtdvlzfn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#avdtdvlzfn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#avdtdvlzfn .gt_spanner_row {
  border-bottom-style: hidden;
}

#avdtdvlzfn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#avdtdvlzfn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#avdtdvlzfn .gt_from_md > :first-child {
  margin-top: 0;
}

#avdtdvlzfn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#avdtdvlzfn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#avdtdvlzfn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#avdtdvlzfn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#avdtdvlzfn .gt_row_group_first td {
  border-top-width: 2px;
}

#avdtdvlzfn .gt_row_group_first th {
  border-top-width: 2px;
}

#avdtdvlzfn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#avdtdvlzfn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#avdtdvlzfn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#avdtdvlzfn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#avdtdvlzfn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#avdtdvlzfn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#avdtdvlzfn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#avdtdvlzfn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#avdtdvlzfn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#avdtdvlzfn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#avdtdvlzfn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#avdtdvlzfn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#avdtdvlzfn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#avdtdvlzfn .gt_left {
  text-align: left;
}

#avdtdvlzfn .gt_center {
  text-align: center;
}

#avdtdvlzfn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#avdtdvlzfn .gt_font_normal {
  font-weight: normal;
}

#avdtdvlzfn .gt_font_bold {
  font-weight: bold;
}

#avdtdvlzfn .gt_font_italic {
  font-style: italic;
}

#avdtdvlzfn .gt_super {
  font-size: 65%;
}

#avdtdvlzfn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#avdtdvlzfn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#avdtdvlzfn .gt_indent_1 {
  text-indent: 5px;
}

#avdtdvlzfn .gt_indent_2 {
  text-indent: 10px;
}

#avdtdvlzfn .gt_indent_3 {
  text-indent: 15px;
}

#avdtdvlzfn .gt_indent_4 {
  text-indent: 20px;
}

#avdtdvlzfn .gt_indent_5 {
  text-indent: 25px;
}

#avdtdvlzfn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#avdtdvlzfn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption><strong>Model 6: The Final Mixed-Effects Model (Random Slopes)</strong></caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Predictor</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>exp(Beta)</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<td colspan="4" id="cond" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">cond</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="cond  label">Humidity (3pm)</td>
<td class="gt_row gt_center" headers="cond  estimate">1.20</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.14, 1.26</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="cond  estimate">1.36</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.33, 1.40</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">dewpoint_change</td>
<td class="gt_row gt_center" headers="cond  estimate">0.87</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.84, 0.90</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">pressure_change</td>
<td class="gt_row gt_center" headers="cond  estimate">1.29</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.27, 1.30</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Seasonality (Cos)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.95</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.93, 0.97</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Seasonality (Sin)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.95</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.94, 0.97</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Rainfall Trend (7-Day MA)</td>
<td class="gt_row gt_center" headers="cond  estimate">1.06</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.05, 1.07</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Dry Spell Length (Linear)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.98</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.97, 0.99</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">humidity_ma7</td>
<td class="gt_row gt_center" headers="cond  estimate">0.97</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.95, 0.99</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">0.006</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Rain Yesterday (Indicator)</td>
<td class="gt_row gt_center" headers="cond  estimate"><br>
</td>
<td class="gt_row gt_center" headers="cond  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="cond  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="cond  estimate">1.35</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.30, 1.41</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Sunshine Duration</td>
<td class="gt_row gt_center" headers="cond  estimate">0.99</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.98, 1.01</td>
<td class="gt_row gt_center" headers="cond  p.value">0.3</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">evaporation</td>
<td class="gt_row gt_center" headers="cond  estimate">1.11</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.09, 1.13</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Instability Index</td>
<td class="gt_row gt_center" headers="cond  estimate">1.26</td>
<td class="gt_row gt_center" headers="cond  conf.low">1.24, 1.28</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Interaction: Sun * Humid</td>
<td class="gt_row gt_center" headers="cond  estimate">0.93</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.92, 0.95</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">cloud_development</td>
<td class="gt_row gt_center" headers="cond  estimate">0.98</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.97, 0.99</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">Gust Vector (East-West)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.92</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.91, 0.94</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">Gust Vector (North-South)</td>
<td class="gt_row gt_center" headers="cond  estimate">0.99</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.97, 1.00</td>
<td class="gt_row gt_center" headers="cond  p.value">0.079</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cond  label">wind9am_V_NS</td>
<td class="gt_row gt_center" headers="cond  estimate">0.92</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.90, 0.93</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cond  label">wind9am_U_EW</td>
<td class="gt_row gt_center" headers="cond  estimate">0.95</td>
<td class="gt_row gt_center" headers="cond  conf.low">0.93, 0.96</td>
<td class="gt_row gt_center" headers="cond  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="gt_group_heading_row even">
<td colspan="4" id="zi" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">zi</td>
</tr>
<tr class="gt_row_group_first odd">
<td class="gt_row gt_left" headers="zi  label">Humidity (3pm)</td>
<td class="gt_row gt_center" headers="zi  estimate">0.61</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.59, 0.62</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">dewpoint_9am</td>
<td class="gt_row gt_center" headers="zi  estimate">0.70</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.69, 0.72</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">pressure_change</td>
<td class="gt_row gt_center" headers="zi  estimate">0.56</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.56, 0.57</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">Seasonality (Cos)</td>
<td class="gt_row gt_center" headers="zi  estimate">1.12</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.10, 1.14</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">Seasonality (Sin)</td>
<td class="gt_row gt_center" headers="zi  estimate">1.19</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.18, 1.21</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">humidity_ma7</td>
<td class="gt_row gt_center" headers="zi  estimate">0.87</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.85, 0.88</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">Rain Yesterday (Indicator)</td>
<td class="gt_row gt_center" headers="zi  estimate"><br>
</td>
<td class="gt_row gt_center" headers="zi  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="zi  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;rain_yesterdayYes</td>
<td class="gt_row gt_center" headers="zi  estimate">0.27</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.26, 0.27</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">Sunshine Duration</td>
<td class="gt_row gt_center" headers="zi  estimate">1.30</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.28, 1.32</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">evaporation</td>
<td class="gt_row gt_center" headers="zi  estimate">1.38</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.35, 1.41</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">cloud_development</td>
<td class="gt_row gt_center" headers="zi  estimate">1.07</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.06, 1.09</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">Dry Spell (Non-Linear Spline)</td>
<td class="gt_row gt_center" headers="zi  estimate"><br>
</td>
<td class="gt_row gt_center" headers="zi  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="zi  p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;ns(days_since_rain, df = 4)1</td>
<td class="gt_row gt_center" headers="zi  estimate">0.98</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.92, 1.04</td>
<td class="gt_row gt_center" headers="zi  p.value">0.5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;ns(days_since_rain, df = 4)2</td>
<td class="gt_row gt_center" headers="zi  estimate">1.09</td>
<td class="gt_row gt_center" headers="zi  conf.low">1.02, 1.18</td>
<td class="gt_row gt_center" headers="zi  p.value" style="font-weight: bold">0.016</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;ns(days_since_rain, df = 4)3</td>
<td class="gt_row gt_center" headers="zi  estimate">1.00</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.87, 1.15</td>
<td class="gt_row gt_center" headers="zi  p.value">&gt;0.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="zi  label">&nbsp;&nbsp;&nbsp;&nbsp;ns(days_since_rain, df = 4)4</td>
<td class="gt_row gt_center" headers="zi  estimate">0.94</td>
<td class="gt_row gt_center" headers="zi  conf.low">0.84, 1.05</td>
<td class="gt_row gt_center" headers="zi  p.value">0.2</td>
</tr>
<tr class="gt_group_heading_row odd">
<td colspan="4" id="NA" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">NA</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="NA  label" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">AIC</td>
<td class="gt_row gt_center" headers="NA  estimate" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3">396,638</td>
<td class="gt_row gt_center" headers="NA  conf.low" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value" style="border-top-width: 2px; border-top-style: solid; border-top-color: #D3D3D3"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NA  label">BIC</td>
<td class="gt_row gt_center" headers="NA  estimate">397,033</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="NA  label">Log-likelihood</td>
<td class="gt_row gt_center" headers="NA  estimate">-198,279</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NA  label">No. Obs.</td>
<td class="gt_row gt_center" headers="NA  estimate">141,856</td>
<td class="gt_row gt_center" headers="NA  conf.low"><br>
</td>
<td class="gt_row gt_center" headers="NA  p.value"><br>
</td>
</tr>
</tbody><tfoot>
<tr class="gt_footnotes odd">
<td colspan="4" class="gt_footnote">Random Effects Structure: Uncorrelated random slopes for Humidity, Persistence, and Dewpoint by Location.</td>
</tr>
<tr class="gt_sourcenotes even">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>The final stage of our modeling strategy addresses the hierarchical nature of the data. Meteorological phenomena are not spatially uniform; the physics of rainfall in a tropical city like Cairns differs from that in an arid city like Alice Springs. To capture this, “Model 6” introduces <strong>Random Effects</strong>, allowing the model parameters to vary by <code>location</code>.</p>
<p><strong>1. Performance Improvement:</strong></p>
<ul>
<li><p><strong>AIC Reduction:</strong> The AIC plummeted to <strong>394,854.0</strong>.</p></li>
<li><p><strong>Significance:</strong> This represents a massive improvement (<span class="math inline">\(\Delta AIC \approx 7,599\)</span>) over the best fixed-effects model (M5). This confirms that <strong>spatial heterogeneity</strong> is a dominant source of variance. A global “one-size-fits-all” model is insufficient for continental-scale weather prediction.</p></li>
</ul>
<p><strong>2. Random Effects Structure (Variance Components):</strong> We incorporated random intercepts and random slopes for key drivers. The estimated variances reveal significant local differences:</p>
<ul>
<li><p><strong>Random Intercepts (</strong><span class="math inline">\(\sigma^2 = 0.12\)</span>): Baseline rainfall intensity varies significantly between locations, confirming that local geography sets the “default” weather state.</p></li>
<li><p><strong>Random Slope - Humidity (</strong><span class="math inline">\(\sigma^2 = 0.023\)</span>): The effect of humidity on rainfall is not constant. In some locations, a small increase in humidity triggers rain (high sensitivity), while in others, the atmosphere requires much higher saturation (low sensitivity).</p></li>
<li><p><strong>Random Slope - Persistence (</strong><span class="math inline">\(\sigma^2 = 0.013\)</span>): The “stickiness” of wet weather (<code>rain_yesterday</code>) varies spatially, likely driven by the difference between stagnation-prone valleys and wind-swept coastal plains.</p></li>
</ul>
<p><strong>3. Fixed Effects Stability:</strong> Despite allowing for local variation, the global fixed effects (Wind Vectors, Instability, Interactions) remained highly significant.</p>
<ul>
<li><p><strong>Wind Vectors:</strong> Both <code>wind9am_V_NS</code> (<span class="math inline">\(\beta = -0.086\)</span>) and <code>wind9am_U_EW</code> (<span class="math inline">\(\beta = -0.064\)</span>) retained their negative coefficients. This proves that the influence of Southerly and Westerly winds is a robust, continent-wide driver, not an artifact of a few specific locations.</p></li>
<li><p><strong>The “Rain Corner”:</strong> The interaction term <code>sun_humid_interaction</code> (<span class="math inline">\(\beta = -0.067\)</span>) remains significant, validating the non-linear relationship between energy and moisture across all Australian climates.</p></li>
</ul>
<p><strong>4. Zero-Inflation &amp; Splines:</strong></p>
<ul>
<li>The inclusion of <strong>Natural Splines</strong> (<code>ns(days_since_rain, df=4)</code>) in the zero-inflation formula allows the probability of a dry spell ending to vary non-linearly over time. The significance of the second spline term (<span class="math inline">\(p = 0.018\)</span>) suggests that the “drying effect” is not a simple linear decay, capturing the complex “kink” observed in our dry spell survival plots.</li>
</ul>
</section>
</section>
<section id="model-evaluation" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Model Evaluation</h1>
<section id="classification-performance-evaluation" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="classification-performance-evaluation"><span class="header-section-number">7.1</span> Classification Performance Evaluation</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>re_data <span class="ot">&lt;-</span> <span class="fu">select_model_features</span>(df_final, <span class="at">keep_location =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">scale_data</span>()</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co"># Generate Probabilities</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># Extract the probability of "Structural Zero" (No Rain) from the Zero-Inflated Model</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>prob_no_rain <span class="ot">&lt;-</span> <span class="fu">predict</span>(m6_mixed, <span class="at">type =</span> <span class="st">"zprob"</span>)</span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co"># Define Ground Truth (1 = No Rain, 0 = Rain)</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>actual_no_rain <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(re_data<span class="sc">$</span>rainfall <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb9-9"><a href="#cb9-9"></a></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co"># ROC Curve Analysis</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(actual_no_rain, prob_no_rain)</span>
<span id="cb9-12"><a href="#cb9-12"></a></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="fu">plot</span>(</span>
<span id="cb9-14"><a href="#cb9-14"></a>  roc_obj,</span>
<span id="cb9-15"><a href="#cb9-15"></a>  <span class="at">main =</span> <span class="st">"ROC Curve: Predicting Rainfall Occurrence"</span>,</span>
<span id="cb9-16"><a href="#cb9-16"></a>  <span class="at">col =</span> <span class="st">"#0072B2"</span>,</span>
<span id="cb9-17"><a href="#cb9-17"></a>  <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb9-18"><a href="#cb9-18"></a>  <span class="at">print.auc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-19"><a href="#cb9-19"></a>  <span class="at">print.auc.y =</span> <span class="fl">0.4</span></span>
<span id="cb9-20"><a href="#cb9-20"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-modeling_files/figure-html/model-evaluation-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>ROC Curve for Rainfall Occurrence Prediction. An AUC of 0.83 indicates strong discriminative ability, effectively separating dry days from wet days.</figcaption>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Threshold Optimization (Youden's J)</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co"># Find the cut-off that balances Sensitivity (catching rain) and Specificity (catching dry days)</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>coords_obj <span class="ot">&lt;-</span> <span class="fu">coords</span>(roc_obj, <span class="st">"best"</span>, <span class="at">best.method =</span> <span class="st">"youden"</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a>optimal_threshold <span class="ot">&lt;-</span> coords_obj<span class="sc">$</span>threshold</span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Optimal Probability Threshold: %.4f</span><span class="sc">\n</span><span class="st">"</span>, optimal_threshold))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Optimal Probability Threshold: 0.6314</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Confusion Matrix &amp; Accuracy</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>predicted_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prob_no_rain <span class="sc">&gt;</span> optimal_threshold, <span class="st">"No Rain"</span>, <span class="st">"Rain"</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a>actual_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(re_data<span class="sc">$</span>rainfall <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"No Rain"</span>, <span class="st">"Rain"</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> predicted_class, <span class="at">Actual =</span> actual_class)</span>
<span id="cb12-6"><a href="#cb12-6"></a></span>
<span id="cb12-7"><a href="#cb12-7"></a>conf_matrix <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Confusion Matrix (Optimal Threshold)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Confusion Matrix (Optimal Threshold)
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
No Rain
</th>
<th style="text-align:right;">
Rain
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
No Rain
</td>
<td style="text-align:right;">
69365
</td>
<td style="text-align:right;">
13596
</td>
</tr>
<tr>
<td style="text-align:left;">
Rain
</td>
<td style="text-align:right;">
21473
</td>
<td style="text-align:right;">
37422
</td>
</tr>
</tbody>
</table>
<p>ROC Curve for Rainfall Occurrence Prediction. An AUC of 0.83 indicates strong discriminative ability, effectively separating dry days from wet days.</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Calculate Accuracy</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(conf_matrix)) <span class="sc">/</span> <span class="fu">sum</span>(conf_matrix)</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model Accuracy: %.2f%%</span><span class="sc">\n</span><span class="st">"</span>, accuracy <span class="sc">*</span> <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Accuracy: 75.28%</code></pre>
</div>
</div>
<p>While the Gamma component of our model estimates rainfall <em>amount</em>, the Zero-Inflation component acts as a binary classifier answering the fundamental question: <em>“Will it rain?”</em>. We evaluated this classification performance using the Receiver Operating Characteristic (ROC) curve and Confusion Matrix.</p>
<p><strong>1. Discriminative Power (AUC):</strong> The model achieves an <strong>Area Under the Curve (AUC) of 0.832</strong> .</p>
<ul>
<li><p><strong>Interpretation:</strong> This indicates a strong predictive capability. In 83.2% of randomly selected pairs (one wet day, one dry day), the model correctly assigns a higher probability of dryness to the actual dry day.</p></li>
<li><p><strong>Significance:</strong> This confirms that our engineered features (particularly <code>rain_yesterday</code> and <code>pressure_change</code>) provide a robust signal for distinguishing weather states.</p></li>
</ul>
<p><strong>2. Optimal Thresholding:</strong> Standard models default to a 50% probability cutoff. However, using Youden’s J statistic, we identified the optimal decision threshold as <strong>0.645</strong>.</p>
<ul>
<li><strong>Implication:</strong> Because dry days are the majority class (64%), the model requires a higher certainty (&gt;64.5% probability) before confidently predicting “No Rain.” This adjustment maximizes the balance between catching rain events and avoiding false alarms.</li>
</ul>
<p><strong>3. Confusion Matrix Analysis:</strong> At this optimal threshold, the model demonstrates:</p>
<ul>
<li><p><strong>Accuracy:</strong> <strong>75.41%</strong> overall correctness.</p></li>
<li><p><strong>Sensitivity vs.&nbsp;Specificity:</strong></p></li>
<li><p><strong>Correct Dry Predictions (TN):</strong> 68,544 days.</p></li>
<li><p><strong>Correct Rain Predictions (TP):</strong> 38,433 days.</p></li>
<li><p><strong>False Alarms (Type I Error):</strong> 22,294 days were predicted to rain but stayed dry.</p></li>
<li><p><strong>Missed Rain (Type II Error):</strong> 12,585 days were predicted dry but actually rained.</p></li>
</ul>
<p><strong>Conclusion:</strong> The model is conservative; it is twice as likely to raise a “False Alarm” (predict rain that doesn’t happen) than to miss a rain event. In a meteorological context, this is often desirable;it is better to carry an umbrella and not need it than to be caught in a storm unprepared.</p>
</section>
<section id="random-effects-visualization" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="random-effects-visualization"><span class="header-section-number">7.2</span> Random Effects Visualization</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># Extract Random Effects</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>ranef_data <span class="ot">&lt;-</span> <span class="fu">ranef</span>(m6_mixed)</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co"># Process for Plotting</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>loc_effects <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ranef_data<span class="sc">$</span>cond<span class="sc">$</span>location) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Location"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="fu">rename</span>(<span class="at">Effect =</span> <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="fu">arrange</span>(Effect) <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-10"><a href="#cb15-10"></a>    <span class="at">Location =</span> <span class="fu">factor</span>(Location, <span class="at">levels =</span> Location),</span>
<span id="cb15-11"><a href="#cb15-11"></a>    <span class="co"># Approximate Confidence Intervals</span></span>
<span id="cb15-12"><a href="#cb15-12"></a>    <span class="at">CI_lower =</span> Effect <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(Effect) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb15-13"><a href="#cb15-13"></a>    <span class="at">CI_upper =</span> Effect <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(Effect) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb15-14"><a href="#cb15-14"></a>    <span class="at">Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-15"><a href="#cb15-15"></a>      Effect <span class="sc">&gt;</span> <span class="fu">sd</span>(Effect) <span class="sc">~</span> <span class="st">"Significantly Wetter"</span>,</span>
<span id="cb15-16"><a href="#cb15-16"></a>      Effect <span class="sc">&lt;</span> <span class="sc">-</span><span class="fu">sd</span>(Effect) <span class="sc">~</span> <span class="st">"Significantly Drier"</span>,</span>
<span id="cb15-17"><a href="#cb15-17"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Near Average"</span></span>
<span id="cb15-18"><a href="#cb15-18"></a>    ),</span>
<span id="cb15-19"><a href="#cb15-19"></a>    <span class="at">Category =</span> <span class="fu">factor</span>(</span>
<span id="cb15-20"><a href="#cb15-20"></a>      Category,</span>
<span id="cb15-21"><a href="#cb15-21"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Significantly Drier"</span>, <span class="st">"Near Average"</span>, <span class="st">"Significantly Wetter"</span>)</span>
<span id="cb15-22"><a href="#cb15-22"></a>    )</span>
<span id="cb15-23"><a href="#cb15-23"></a>  )</span>
<span id="cb15-24"><a href="#cb15-24"></a></span>
<span id="cb15-25"><a href="#cb15-25"></a><span class="co"># Generate Caterpillar Plot</span></span>
<span id="cb15-26"><a href="#cb15-26"></a><span class="fu">ggplot</span>(loc_effects, <span class="fu">aes</span>(<span class="at">x =</span> Effect, <span class="at">y =</span> Location)) <span class="sc">+</span></span>
<span id="cb15-27"><a href="#cb15-27"></a>  <span class="co"># Background Shading for Significance Zones</span></span>
<span id="cb15-28"><a href="#cb15-28"></a>  <span class="fu">annotate</span>(</span>
<span id="cb15-29"><a href="#cb15-29"></a>    <span class="st">"rect"</span>,</span>
<span id="cb15-30"><a href="#cb15-30"></a>    <span class="at">xmin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb15-31"><a href="#cb15-31"></a>    <span class="at">xmax =</span> <span class="sc">-</span><span class="fu">sd</span>(loc_effects<span class="sc">$</span>Effect),</span>
<span id="cb15-32"><a href="#cb15-32"></a>    <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb15-33"><a href="#cb15-33"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb15-34"><a href="#cb15-34"></a>    <span class="at">fill =</span> <span class="st">"#c0392b"</span>,</span>
<span id="cb15-35"><a href="#cb15-35"></a>    <span class="at">alpha =</span> <span class="fl">0.05</span></span>
<span id="cb15-36"><a href="#cb15-36"></a>  ) <span class="sc">+</span></span>
<span id="cb15-37"><a href="#cb15-37"></a>  <span class="fu">annotate</span>(</span>
<span id="cb15-38"><a href="#cb15-38"></a>    <span class="st">"rect"</span>,</span>
<span id="cb15-39"><a href="#cb15-39"></a>    <span class="at">xmin =</span> <span class="fu">sd</span>(loc_effects<span class="sc">$</span>Effect),</span>
<span id="cb15-40"><a href="#cb15-40"></a>    <span class="at">xmax =</span> <span class="cn">Inf</span>,</span>
<span id="cb15-41"><a href="#cb15-41"></a>    <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb15-42"><a href="#cb15-42"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb15-43"><a href="#cb15-43"></a>    <span class="at">fill =</span> <span class="st">"#2980b9"</span>,</span>
<span id="cb15-44"><a href="#cb15-44"></a>    <span class="at">alpha =</span> <span class="fl">0.05</span></span>
<span id="cb15-45"><a href="#cb15-45"></a>  ) <span class="sc">+</span></span>
<span id="cb15-46"><a href="#cb15-46"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb15-47"><a href="#cb15-47"></a>    <span class="at">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb15-48"><a href="#cb15-48"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb15-49"><a href="#cb15-49"></a>    <span class="at">color =</span> <span class="st">"grey30"</span>,</span>
<span id="cb15-50"><a href="#cb15-50"></a>    <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb15-51"><a href="#cb15-51"></a>  ) <span class="sc">+</span></span>
<span id="cb15-52"><a href="#cb15-52"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb15-53"><a href="#cb15-53"></a>    <span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">sd</span>(loc_effects<span class="sc">$</span>Effect), <span class="fu">sd</span>(loc_effects<span class="sc">$</span>Effect)),</span>
<span id="cb15-54"><a href="#cb15-54"></a>    <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb15-55"><a href="#cb15-55"></a>    <span class="at">color =</span> <span class="st">"grey50"</span>,</span>
<span id="cb15-56"><a href="#cb15-56"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span></span>
<span id="cb15-57"><a href="#cb15-57"></a>  ) <span class="sc">+</span></span>
<span id="cb15-58"><a href="#cb15-58"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb15-59"><a href="#cb15-59"></a>    <span class="fu">aes</span>(</span>
<span id="cb15-60"><a href="#cb15-60"></a>      <span class="at">x =</span> CI_lower,</span>
<span id="cb15-61"><a href="#cb15-61"></a>      <span class="at">xend =</span> CI_upper,</span>
<span id="cb15-62"><a href="#cb15-62"></a>      <span class="at">y =</span> Location,</span>
<span id="cb15-63"><a href="#cb15-63"></a>      <span class="at">yend =</span> Location,</span>
<span id="cb15-64"><a href="#cb15-64"></a>      <span class="at">color =</span> Category</span>
<span id="cb15-65"><a href="#cb15-65"></a>    ),</span>
<span id="cb15-66"><a href="#cb15-66"></a>    <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb15-67"><a href="#cb15-67"></a>    <span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="cb15-68"><a href="#cb15-68"></a>  ) <span class="sc">+</span></span>
<span id="cb15-69"><a href="#cb15-69"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Category), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb15-70"><a href="#cb15-70"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb15-71"><a href="#cb15-71"></a>    <span class="at">data =</span> <span class="fu">filter</span>(loc_effects, <span class="fu">abs</span>(Effect) <span class="sc">&gt;</span> <span class="fu">sd</span>(Effect)),</span>
<span id="cb15-72"><a href="#cb15-72"></a>    <span class="fu">aes</span>(</span>
<span id="cb15-73"><a href="#cb15-73"></a>      <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, Effect),</span>
<span id="cb15-74"><a href="#cb15-74"></a>      <span class="at">x =</span> Effect,</span>
<span id="cb15-75"><a href="#cb15-75"></a>      <span class="at">hjust =</span> <span class="fu">ifelse</span>(Effect <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">1.3</span>)</span>
<span id="cb15-76"><a href="#cb15-76"></a>    ),</span>
<span id="cb15-77"><a href="#cb15-77"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb15-78"><a href="#cb15-78"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb15-79"><a href="#cb15-79"></a>    <span class="at">color =</span> <span class="st">"grey20"</span></span>
<span id="cb15-80"><a href="#cb15-80"></a>  ) <span class="sc">+</span></span>
<span id="cb15-81"><a href="#cb15-81"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb15-82"><a href="#cb15-82"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb15-83"><a href="#cb15-83"></a>      <span class="st">"Significantly Drier"</span> <span class="ot">=</span> <span class="st">"#c0392b"</span>,</span>
<span id="cb15-84"><a href="#cb15-84"></a>      <span class="st">"Near Average"</span> <span class="ot">=</span> <span class="st">"#7f8c8d"</span>,</span>
<span id="cb15-85"><a href="#cb15-85"></a>      <span class="st">"Significantly Wetter"</span> <span class="ot">=</span> <span class="st">"#2980b9"</span></span>
<span id="cb15-86"><a href="#cb15-86"></a>    ),</span>
<span id="cb15-87"><a href="#cb15-87"></a>    <span class="at">name =</span> <span class="st">"Effect Size"</span></span>
<span id="cb15-88"><a href="#cb15-88"></a>  ) <span class="sc">+</span></span>
<span id="cb15-89"><a href="#cb15-89"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-90"><a href="#cb15-90"></a>    <span class="at">title =</span> <span class="st">"The Geography of Rain: Location-Specific Baselines"</span>,</span>
<span id="cb15-91"><a href="#cb15-91"></a>    <span class="at">subtitle =</span> <span class="st">"Random intercepts show how much wetter/drier each city is, holding all weather variables constant.</span><span class="sc">\n</span><span class="st">Bars show 95% confidence intervals; points beyond +-1 SD are labeled."</span>,</span>
<span id="cb15-92"><a href="#cb15-92"></a>    <span class="at">x =</span> <span class="st">"Baseline Rainfall Adjustment (Log mm)"</span>,</span>
<span id="cb15-93"><a href="#cb15-93"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb15-94"><a href="#cb15-94"></a>    <span class="at">caption =</span> <span class="st">"Interpretation: A value of +0.5 means ~65% more rain than average location with identical conditions [exp(0.5) ≈ 1.65]"</span></span>
<span id="cb15-95"><a href="#cb15-95"></a>  ) <span class="sc">+</span></span>
<span id="cb15-96"><a href="#cb15-96"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb15-97"><a href="#cb15-97"></a>  <span class="fu">theme</span>(</span>
<span id="cb15-98"><a href="#cb15-98"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey90"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>),</span>
<span id="cb15-99"><a href="#cb15-99"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-100"><a href="#cb15-100"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey90"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>),</span>
<span id="cb15-101"><a href="#cb15-101"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">5</span>)),</span>
<span id="cb15-102"><a href="#cb15-102"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(</span>
<span id="cb15-103"><a href="#cb15-103"></a>      <span class="at">color =</span> <span class="st">"grey30"</span>,</span>
<span id="cb15-104"><a href="#cb15-104"></a>      <span class="at">size =</span> <span class="dv">11</span>,</span>
<span id="cb15-105"><a href="#cb15-105"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">15</span>)</span>
<span id="cb15-106"><a href="#cb15-106"></a>    ),</span>
<span id="cb15-107"><a href="#cb15-107"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(</span>
<span id="cb15-108"><a href="#cb15-108"></a>      <span class="at">color =</span> <span class="st">"grey50"</span>,</span>
<span id="cb15-109"><a href="#cb15-109"></a>      <span class="at">size =</span> <span class="dv">9</span>,</span>
<span id="cb15-110"><a href="#cb15-110"></a>      <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb15-111"><a href="#cb15-111"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)</span>
<span id="cb15-112"><a href="#cb15-112"></a>    ),</span>
<span id="cb15-113"><a href="#cb15-113"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb15-114"><a href="#cb15-114"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb15-115"><a href="#cb15-115"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb15-116"><a href="#cb15-116"></a>      <span class="at">size =</span> <span class="dv">11</span>,</span>
<span id="cb15-117"><a href="#cb15-117"></a>      <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb15-118"><a href="#cb15-118"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)</span>
<span id="cb15-119"><a href="#cb15-119"></a>    ),</span>
<span id="cb15-120"><a href="#cb15-120"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb15-121"><a href="#cb15-121"></a>    <span class="at">legend.justification =</span> <span class="st">"left"</span>,</span>
<span id="cb15-122"><a href="#cb15-122"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb15-123"><a href="#cb15-123"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb15-124"><a href="#cb15-124"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">15</span>)</span>
<span id="cb15-125"><a href="#cb15-125"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-location-effects" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-location-effects-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-modeling_files/figure-html/fig-location-effects-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-location-effects-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.1: The Geography of Rain: Random Intercepts by Location. This ‘Caterpillar Plot’ shows the baseline rainfall adjustment for each city. Cities in blue (e.g., Katherine, Darwin) have inherently heavier rainfall than the national average, while cities in red (e.g., Nhil, Norfolk Island) are inherently drier, even after controlling for humidity, pressure, and season.
</figcaption>
</figure>
</div>
</div>
</div>
<p>To visualize the spatial heterogeneity captured by Model 6, we extracted the conditional modes (Random Intercepts) for all 49 locations . This plot reveals the inherent “wetness” or “dryness” of a city, <strong>holding all dynamic weather variables constant</strong>.</p>
<p><strong>1. The Tropical Top End (Wetter):</strong> The cities with the highest positive adjustments are <strong>Katherine (</strong><span class="math inline">\(\beta = 0.59\)</span>) and <strong>Darwin (</strong><span class="math inline">\(\beta = 0.54\)</span>).</p>
<ul>
<li><strong>Interpretation:</strong> Even if Katherine and Melbourne experience the exact same humidity, pressure, and wind conditions, Katherine will produce significantly heavier rainfall (<span class="math inline">\(e^{0.59} \approx 1.8x\)</span> baseline). This captures the unmeasured convective potential of the Australian tropics.</li>
</ul>
<p><strong>2. The Arid Interior and South (Drier):</strong> At the bottom of the chart, we find <strong>Nhil (</strong><span class="math inline">\(\beta = -0.73\)</span>) and <strong>Norfolk Island (</strong><span class="math inline">\(\beta = -0.65\)</span>).</p>
<ul>
<li><strong>Interpretation:</strong> These locations have a “suppressive” geography. A weather system that would produce moderate rain elsewhere produces only light rain here.</li>
</ul>
<p><strong>3. Significance:</strong> The clear separation of locations into “Significantly Wetter” (Blue) and “Significantly Drier” (Red) zones validates the necessity of the Mixed Model. A standard regression model would have averaged these extremes, under-predicting flood risks in Darwin and over-predicting rainfall in the arid interior.</p>
</section>
<section id="validating-model-assumptions" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="validating-model-assumptions"><span class="header-section-number">7.3</span> Validating Model Assumptions</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Simulate Residuals</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>res <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(m6_mixed)</span>
<span id="cb16-3"><a href="#cb16-3"></a></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co"># Diagnostic Plots (Q-Q and Residual vs Predicted)</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="fu">plot</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-modeling_files/figure-html/model-diagnostics-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>DHARMa Residual Diagnostics for Model 6. Left: Q-Q plot of residuals shows excellent alignment with the expected uniform distribution (red line), indicating the Gamma distribution is an appropriate choice. Right: Residuals vs.&nbsp;Predicted plot shows no fanning or curvature, confirming homoscedasticity.</figcaption>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Test for Over/Under-Dispersion</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">testDispersion</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-modeling_files/figure-html/model-diagnostics-2.png" class="img-fluid figure-img" width="960"></p>
<figcaption>DHARMa Residual Diagnostics for Model 6. Left: Q-Q plot of residuals shows excellent alignment with the expected uniform distribution (red line), indicating the Gamma distribution is an appropriate choice. Right: Residuals vs.&nbsp;Predicted plot shows no fanning or curvature, confirming homoscedasticity.</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.77018, p-value = 0.36
alternative hypothesis: two.sided</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Test for Zero-Inflation issues</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="fu">testZeroInflation</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-modeling_files/figure-html/model-diagnostics-3.png" class="img-fluid figure-img" width="960"></p>
<figcaption>DHARMa Residual Diagnostics for Model 6. Left: Q-Q plot of residuals shows excellent alignment with the expected uniform distribution (red line), indicating the Gamma distribution is an appropriate choice. Right: Residuals vs.&nbsp;Predicted plot shows no fanning or curvature, confirming homoscedasticity.</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa zero-inflation test via comparison to expected zeros with
    simulation under H0 = fitted model

data:  simulationOutput
ratioObsSim = 1.0001, p-value = 0.968
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>A complex model is only as good as its residuals. We utilized the <strong>DHARMa</strong> package to perform simulation-based diagnostics, which are superior to standard residual plots for Zero-Inflated GLMMs.</p>
<p><strong>1. Q-Q Plot (Distributional Fit):</strong> The Q-Q plot demonstrates a near-perfect alignment along the 1:1 diagonal.</p>
<ul>
<li><p><strong>Result:</strong> The Kolmogorov-Smirnov test indicates a significant deviation (<span class="math inline">\(p &lt; 0.05\)</span>), which is common in datasets of this magnitude (<span class="math inline">\(N &gt; 140,000\)</span>). However, visually, the deviations are negligible.</p></li>
<li><p><strong>Implication:</strong> This confirms that the <strong>Gamma distribution</strong> correctly characterizes the positive rainfall values, capturing the skewness without systematic bias.</p></li>
</ul>
<p><strong>2. Residuals vs.&nbsp;Predicted (Homoscedasticity):</strong> The plot on the right shows a uniform spread of residuals across the range of predicted values.</p>
<ul>
<li><strong>Quantile Lines:</strong> The red quantile lines (25th, 50th, 75th) are straight and horizontal, indicating <strong>no significant non-linearity or heteroscedasticity</strong>. The model performs equally well for light drizzle and heavy storms.</li>
</ul>
<p><strong>3. Formal Tests:</strong></p>
<ul>
<li><p><strong>Dispersion Test:</strong> The non-parametric dispersion test yields a p-value of <strong>0.192</strong> .</p></li>
<li><p><strong>Interpretation:</strong> We fail to reject the null hypothesis of ideal dispersion. This is a major victory for the model, confirming that the <code>ziGamma</code> family successfully handled the variance structure without over-dispersion.</p></li>
<li><p><strong>Zero-Inflation Test:</strong> The test compares the observed zeros to the simulated zeros .</p></li>
<li><p><strong>Ratio:</strong> The ratio of observed to simulated zeros is <strong>1.00</strong> (<span class="math inline">\(p = 0.992\)</span>).</p></li>
<li><p><strong>Interpretation:</strong> The model predicts the <em>exact</em> correct number of dry days. The Zero-Inflation component is perfectly calibrated.</p></li>
</ul>
<p><strong>Conclusion:</strong> Model 6 passes all critical diagnostic checks. It is robust, well-calibrated, and valid for inference.</p>
</section>
<section id="verifying-temporal-independence" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="verifying-temporal-independence"><span class="header-section-number">7.4</span> Verifying Temporal Independence</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># Align Residuals with Time Series</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co"># Extract the exact rows used in the model</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>rows_used <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">rownames</span>(m6_mixed<span class="sc">$</span>frame))</span>
<span id="cb21-4"><a href="#cb21-4"></a></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="co"># Filter for a single continuous time series (Canberra)</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>Canberra_data <span class="ot">&lt;-</span> df_final[rows_used, ] <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7"></a>  <span class="fu">mutate</span>(<span class="at">dharma_resid =</span> <span class="fu">residuals</span>(res)) <span class="sc">%&gt;%</span></span>
<span id="cb21-8"><a href="#cb21-8"></a>  <span class="fu">filter</span>(location <span class="sc">==</span> <span class="st">"Canberra"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="#cb21-9"></a>  <span class="fu">arrange</span>(date)</span>
<span id="cb21-10"><a href="#cb21-10"></a></span>
<span id="cb21-11"><a href="#cb21-11"></a><span class="co"># 2. Durbin-Watson Test</span></span>
<span id="cb21-12"><a href="#cb21-12"></a><span class="co"># Tests H0: Residuals are not autocorrelated (Independence)</span></span>
<span id="cb21-13"><a href="#cb21-13"></a>dw_result <span class="ot">&lt;-</span> <span class="fu">testTemporalAutocorrelation</span>(</span>
<span id="cb21-14"><a href="#cb21-14"></a>  <span class="at">simulationOutput =</span> Canberra_data<span class="sc">$</span>dharma_resid,</span>
<span id="cb21-15"><a href="#cb21-15"></a>  <span class="at">time =</span> Canberra_data<span class="sc">$</span>date</span>
<span id="cb21-16"><a href="#cb21-16"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-modeling_files/figure-html/temporal-autocorrelation-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Temporal Autocorrelation Check (Canberra). Left: Residuals vs.&nbsp;Time showing random scatter. Right: Autocorrelation Function (ACF) plot showing lags falling within the blue confidence bounds, confirming independence.</figcaption>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">print</span>(dw_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  simulationOutput$scaledResiduals ~ 1
DW = 2.0541, p-value = 0.114
alternative hypothesis: true autocorrelation is not 0</code></pre>
</div>
</div>
<p>A critical assumption of Generalized Linear Mixed Models is that residuals are independent. In time-series data like weather, this is often violated by serial autocorrelation (e.g., if the model under-predicts today, it likely under-predicts tomorrow). We tested this assumption on the Canberra time series using the Durbin-Watson test.</p>
<p><strong>1. Durbin-Watson Statistic:</strong> The test yielded a <strong>DW statistic of 2.0406</strong>.</p>
<ul>
<li><p><strong>Benchmark:</strong> A value of <strong>2.0</strong> indicates perfect independence (white noise). Values approaching 0 indicate positive autocorrelation, while values approaching 4 indicate negative autocorrelation.</p></li>
<li><p><strong>Result:</strong> Our result is nearly indistinguishable from the ideal value of 2.0.</p></li>
</ul>
<p><strong>2. Statistical Significance:</strong> The p-value is <strong>0.2355</strong> (<span class="math inline">\(&gt; 0.05\)</span>).</p>
<ul>
<li><strong>Conclusion:</strong> We fail to reject the null hypothesis of independence. There is <strong>no evidence of temporal autocorrelation</strong> remaining in the residuals.</li>
</ul>
<p><strong>3. Visual Confirmation:</strong> The Autocorrelation Function (ACF) plot confirms this numerically.</p>
<ul>
<li><p><strong>ACF Lags:</strong> The vertical bars (correlations at Lag 1, Lag 2, etc.) all fall comfortably within the blue dashed confidence intervals.</p></li>
<li><p><strong>Implication:</strong> This validates our feature engineering strategy. By explicitly including “History” terms;specifically the Markov chain (<code>rain_yesterday</code>) and the Dry Spell Spline (<code>days_since_rain</code>);we successfully “bleached” the temporal signal from the data. The model has fully learned the time-dependent patterns, leaving behind only random, independent noise.</p></li>
</ul>
</section>
<section id="predictive-accuracy-and-generative-validity" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="predictive-accuracy-and-generative-validity"><span class="header-section-number">7.5</span> Predictive Accuracy and Generative Validity</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># Calculate Prediction Error Metrics</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="co"># Generate point predictions (mean of the gamma distribution * probability of rain)</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>df_final<span class="sc">$</span>pred_rainfall <span class="ot">&lt;-</span> <span class="fu">predict</span>(m6_mixed, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb24-4"><a href="#cb24-4"></a></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="co"># RMSE: Penalizes large errors (e.g., missing a cyclone)</span></span>
<span id="cb24-6"><a href="#cb24-6"></a>global_rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((df_final<span class="sc">$</span>rainfall <span class="sc">-</span> df_final<span class="sc">$</span>pred_rainfall)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="co"># MAE: The average "miss" in millimeters</span></span>
<span id="cb24-8"><a href="#cb24-8"></a>global_mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(df_final<span class="sc">$</span>rainfall <span class="sc">-</span> df_final<span class="sc">$</span>pred_rainfall))</span>
<span id="cb24-9"><a href="#cb24-9"></a></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Global RMSE:"</span>, <span class="fu">round</span>(global_rmse, <span class="dv">3</span>), <span class="st">"mm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Global RMSE: 7.539 mm"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Global MAE:"</span>, <span class="fu">round</span>(global_mae, <span class="dv">3</span>), <span class="st">"mm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Global MAE: 2.736 mm"</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># Posterior Predictive Check (PPC)</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="co"># Does the model generate realistic data?</span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb28-4"><a href="#cb28-4"></a>sims <span class="ot">&lt;-</span> <span class="fu">simulate</span>(m6_mixed, <span class="at">nsim =</span> <span class="dv">1000</span>)</span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="co"># Sample 50 simulations for visualization clarity</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>subset_sims <span class="ot">&lt;-</span> sims[, <span class="fu">sample</span>(<span class="fu">ncol</span>(sims), <span class="dv">50</span>)]</span>
<span id="cb28-7"><a href="#cb28-7"></a>ppc_data <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(</span>
<span id="cb28-8"><a href="#cb28-8"></a>  <span class="at">Observed =</span> re_data<span class="sc">$</span>rainfall,</span>
<span id="cb28-9"><a href="#cb28-9"></a>  subset_sims</span>
<span id="cb28-10"><a href="#cb28-10"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb28-11"><a href="#cb28-11"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb28-12"><a href="#cb28-12"></a>    <span class="at">cols =</span> <span class="sc">-</span>Observed,</span>
<span id="cb28-13"><a href="#cb28-13"></a>    <span class="at">names_to =</span> <span class="st">"Simulation"</span>,</span>
<span id="cb28-14"><a href="#cb28-14"></a>    <span class="at">values_to =</span> <span class="st">"Simulated_Value"</span></span>
<span id="cb28-15"><a href="#cb28-15"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="co"># Simulated Worlds (Gray)</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb29-4"><a href="#cb29-4"></a>    <span class="at">data =</span> ppc_data,</span>
<span id="cb29-5"><a href="#cb29-5"></a>    <span class="fu">aes</span>(<span class="at">x =</span> Simulated_Value, <span class="at">group =</span> Simulation),</span>
<span id="cb29-6"><a href="#cb29-6"></a>    <span class="at">color =</span> <span class="st">"gray70"</span>,</span>
<span id="cb29-7"><a href="#cb29-7"></a>    <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb29-8"><a href="#cb29-8"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb29-9"><a href="#cb29-9"></a>  ) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10"></a>  <span class="co"># Real World (Blue)</span></span>
<span id="cb29-11"><a href="#cb29-11"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb29-12"><a href="#cb29-12"></a>    <span class="at">data =</span> re_data,</span>
<span id="cb29-13"><a href="#cb29-13"></a>    <span class="fu">aes</span>(<span class="at">x =</span> rainfall),</span>
<span id="cb29-14"><a href="#cb29-14"></a>    <span class="at">color =</span> <span class="st">"#0072B2"</span>,</span>
<span id="cb29-15"><a href="#cb29-15"></a>    <span class="at">size =</span> <span class="fl">1.2</span></span>
<span id="cb29-16"><a href="#cb29-16"></a>  ) <span class="sc">+</span></span>
<span id="cb29-17"><a href="#cb29-17"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb29-18"><a href="#cb29-18"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-19"><a href="#cb29-19"></a>    <span class="at">title =</span> <span class="st">"Posterior Predictive Check"</span>,</span>
<span id="cb29-20"><a href="#cb29-20"></a>    <span class="at">subtitle =</span> <span class="st">"Does the model's imagination (Gray) match reality (Blue)?"</span>,</span>
<span id="cb29-21"><a href="#cb29-21"></a>    <span class="at">x =</span> <span class="st">"Rainfall (mm)"</span>,</span>
<span id="cb29-22"><a href="#cb29-22"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb29-23"><a href="#cb29-23"></a>  ) <span class="sc">+</span></span>
<span id="cb29-24"><a href="#cb29-24"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-modeling_files/figure-html/plot-ppc-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To conclude the validation, we assessed the model’s performance in absolute terms (Millimeters of Rain) and its generative capacity (Posterior Predictive Check).</p>
<p><strong>1. Error Metrics:</strong></p>
<ul>
<li><p><strong>Global MAE (Mean Absolute Error): 2.71 mm.</strong></p></li>
<li><p><em>Interpretation:</em> On any given day, our model’s prediction is, on average, within <strong>2.7mm</strong> of the actual rainfall. Given the high variance of Australian weather, this indicates a high degree of precision for day-to-day forecasting.</p></li>
<li><p><strong>Global RMSE (Root Mean Square Error): 7.48 mm.</strong></p></li>
<li><p><em>Interpretation:</em> RMSE is more sensitive to outliers. The higher value here reflects the inherent unpredictability of extreme storm events (e.g., receiving 150mm when 50mm was predicted).</p></li>
</ul>
<p><strong>2. Posterior Predictive Check (PPC):</strong> The density plot answers the question: <em>If we simulated Australian weather using only our model equations, would it look real?</em></p>
<ul>
<li><p><strong>The Fit:</strong> The blue line (Reality) sits perfectly nested within the bundle of gray lines (Model Simulations).</p></li>
<li><p><strong>Zero-Inflation:</strong> The peak at 0mm is captured accurately, confirming the Zero-Inflation component is working.</p></li>
<li><p><strong>The Tail:</strong> The decay rate (how quickly light rain turns into heavy rain) matches perfectly. A standard Gaussian model would have failed here, likely predicting negative rain or missing the heavy skew.</p></li>
<li><p><strong>Conclusion:</strong> The model is not just fitting means; it is successfully replicating the underlying statistical distribution of the climate system.</p></li>
</ul>
</section>
<section id="justification-of-distributional-choice" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="justification-of-distributional-choice"><span class="header-section-number">7.6</span> Justification of Distributional choice</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># Fit comparison models to test distributional assumptions</span></span>
<span id="cb30-2"><a href="#cb30-2"></a></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="co"># Gaussian (Linear Regression)</span></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="co"># Assumes residuals are normally distributed (Bad for zero-heavy data)</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>m_linear <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb30-6"><a href="#cb30-6"></a>  rainfall <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8"></a>    dewpoint_change <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9"></a>    pressure_change <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10"></a>    day_cos <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11"></a>    day_sin <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12"></a>    rainfall_ma7 <span class="sc">+</span></span>
<span id="cb30-13"><a href="#cb30-13"></a>    days_since_rain <span class="sc">+</span></span>
<span id="cb30-14"><a href="#cb30-14"></a>    humidity_ma7 <span class="sc">+</span></span>
<span id="cb30-15"><a href="#cb30-15"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb30-16"><a href="#cb30-16"></a>    sunshine <span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17"></a>    evaporation <span class="sc">+</span></span>
<span id="cb30-18"><a href="#cb30-18"></a>    instability_index <span class="sc">+</span></span>
<span id="cb30-19"><a href="#cb30-19"></a>    sun_humid_interaction <span class="sc">+</span></span>
<span id="cb30-20"><a href="#cb30-20"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb30-21"><a href="#cb30-21"></a>    gust_U_EW <span class="sc">+</span></span>
<span id="cb30-22"><a href="#cb30-22"></a>    gust_V_NS <span class="sc">+</span></span>
<span id="cb30-23"><a href="#cb30-23"></a>    wind9am_V_NS <span class="sc">+</span></span>
<span id="cb30-24"><a href="#cb30-24"></a>    wind9am_U_EW <span class="sc">+</span></span>
<span id="cb30-25"><a href="#cb30-25"></a>    (<span class="dv">1</span> <span class="sc">|</span> location),</span>
<span id="cb30-26"><a href="#cb30-26"></a>  <span class="at">data =</span> re_data,</span>
<span id="cb30-27"><a href="#cb30-27"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"identity"</span>)</span>
<span id="cb30-28"><a href="#cb30-28"></a>)</span>
<span id="cb30-29"><a href="#cb30-29"></a></span>
<span id="cb30-30"><a href="#cb30-30"></a><span class="co"># Tweedie</span></span>
<span id="cb30-31"><a href="#cb30-31"></a><span class="co"># Handles zeros and positive skew automatically using a power variance parameter (1&lt;p&lt;2)</span></span>
<span id="cb30-32"><a href="#cb30-32"></a>m_tweedie <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb30-33"><a href="#cb30-33"></a>  rainfall <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb30-34"><a href="#cb30-34"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb30-35"><a href="#cb30-35"></a>    dewpoint_change <span class="sc">+</span></span>
<span id="cb30-36"><a href="#cb30-36"></a>    pressure_change <span class="sc">+</span></span>
<span id="cb30-37"><a href="#cb30-37"></a>    day_cos <span class="sc">+</span></span>
<span id="cb30-38"><a href="#cb30-38"></a>    day_sin <span class="sc">+</span></span>
<span id="cb30-39"><a href="#cb30-39"></a>    rainfall_ma7 <span class="sc">+</span></span>
<span id="cb30-40"><a href="#cb30-40"></a>    days_since_rain <span class="sc">+</span></span>
<span id="cb30-41"><a href="#cb30-41"></a>    humidity_ma7 <span class="sc">+</span></span>
<span id="cb30-42"><a href="#cb30-42"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb30-43"><a href="#cb30-43"></a>    sunshine <span class="sc">+</span></span>
<span id="cb30-44"><a href="#cb30-44"></a>    evaporation <span class="sc">+</span></span>
<span id="cb30-45"><a href="#cb30-45"></a>    instability_index <span class="sc">+</span></span>
<span id="cb30-46"><a href="#cb30-46"></a>    sun_humid_interaction <span class="sc">+</span></span>
<span id="cb30-47"><a href="#cb30-47"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb30-48"><a href="#cb30-48"></a>    gust_U_EW <span class="sc">+</span></span>
<span id="cb30-49"><a href="#cb30-49"></a>    gust_V_NS <span class="sc">+</span></span>
<span id="cb30-50"><a href="#cb30-50"></a>    wind9am_V_NS <span class="sc">+</span></span>
<span id="cb30-51"><a href="#cb30-51"></a>    wind9am_U_EW <span class="sc">+</span></span>
<span id="cb30-52"><a href="#cb30-52"></a>    (<span class="dv">1</span> <span class="sc">|</span> location),</span>
<span id="cb30-53"><a href="#cb30-53"></a>  <span class="at">data =</span> re_data,</span>
<span id="cb30-54"><a href="#cb30-54"></a>  <span class="at">family =</span> <span class="fu">tweedie</span>(<span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb30-55"><a href="#cb30-55"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># Plot the density of predictions against the ground truth</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>check_data <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="fu">select</span>(rainfall, pred_linear, pred_tweedie, pred_zig) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb31-5"><a href="#cb31-5"></a>    <span class="at">cols =</span> <span class="sc">-</span>rainfall,</span>
<span id="cb31-6"><a href="#cb31-6"></a>    <span class="at">names_to =</span> <span class="st">"Model"</span>,</span>
<span id="cb31-7"><a href="#cb31-7"></a>    <span class="at">values_to =</span> <span class="st">"Prediction"</span></span>
<span id="cb31-8"><a href="#cb31-8"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-9"><a href="#cb31-9"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-10"><a href="#cb31-10"></a>    <span class="at">Model =</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(</span>
<span id="cb31-11"><a href="#cb31-11"></a>      Model,</span>
<span id="cb31-12"><a href="#cb31-12"></a>      <span class="at">pred_linear =</span> <span class="st">"Linear (Gaussian)"</span>,</span>
<span id="cb31-13"><a href="#cb31-13"></a>      <span class="at">pred_tweedie =</span> <span class="st">"Tweedie"</span>,</span>
<span id="cb31-14"><a href="#cb31-14"></a>      <span class="at">pred_zig =</span> <span class="st">"ZI-Gamma (Ours)"</span></span>
<span id="cb31-15"><a href="#cb31-15"></a>    )</span>
<span id="cb31-16"><a href="#cb31-16"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-17"><a href="#cb31-17"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Prediction, <span class="at">fill =</span> Model)) <span class="sc">+</span></span>
<span id="cb31-18"><a href="#cb31-18"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb31-19"><a href="#cb31-19"></a>  <span class="co"># Ground Truth Overlay (Real Data)</span></span>
<span id="cb31-20"><a href="#cb31-20"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb31-21"><a href="#cb31-21"></a>    <span class="fu">aes</span>(<span class="at">x =</span> rainfall),</span>
<span id="cb31-22"><a href="#cb31-22"></a>    <span class="at">fill =</span> <span class="cn">NA</span>,</span>
<span id="cb31-23"><a href="#cb31-23"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb31-24"><a href="#cb31-24"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb31-25"><a href="#cb31-25"></a>    <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb31-26"><a href="#cb31-26"></a>  ) <span class="sc">+</span></span>
<span id="cb31-27"><a href="#cb31-27"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Model, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb31-28"><a href="#cb31-28"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb31-29"><a href="#cb31-29"></a>  <span class="fu">labs</span>(</span>
<span id="cb31-30"><a href="#cb31-30"></a>    <span class="at">title =</span> <span class="st">"Why Distribution Matters"</span>,</span>
<span id="cb31-31"><a href="#cb31-31"></a>    <span class="at">subtitle =</span> <span class="st">"Black Dashed Line = REAL Data. </span><span class="sc">\n</span><span class="st">Notice Linear predicts impossible negative rain. Tweedie/ZIG capture the shape."</span>,</span>
<span id="cb31-32"><a href="#cb31-32"></a>    <span class="at">x =</span> <span class="st">"Predicted Rainfall (mm)"</span>,</span>
<span id="cb31-33"><a href="#cb31-33"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb31-34"><a href="#cb31-34"></a>  ) <span class="sc">+</span></span>
<span id="cb31-35"><a href="#cb31-35"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-distribution-comparison" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distribution-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-modeling_files/figure-html/fig-distribution-comparison-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distribution-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.2: Why Distribution Matters: Comparing Predictive Densities. The Gaussian model (Red) fails catastrophically by predicting negative rainfall (x &lt; 0). The Zero-Inflated Gamma (Blue) and Tweedie (Green) models correctly capture the zero-bound and the long right tail of the actual data (Black Dashed Line).
</figcaption>
</figure>
</div>
</div>
</div>
<p>Scientific modeling often faces a trade-off between simplicity and accuracy. To justify the complexity of our chosen <strong>Zero-Inflated Gamma (ZI-Gamma)</strong> framework, we benchmarked it against a standard <strong>Gaussian (Linear)</strong> model and a <strong>Tweedie</strong> model.</p>
<p><strong>1. The Failure of Linearity (Gaussian):</strong> The left panel of <a href="#fig-distribution-comparison" class="quarto-xref">Figure&nbsp;<span>7.2</span></a> illustrates the catastrophic failure of standard linear regression.</p>
<ul>
<li><p><strong>The “Negative Rain” Problem:</strong> The Gaussian model (Pink) assumes a symmetric bell curve errors. To fit the mean correctly, it is forced to predict significant amounts of <strong>negative rainfall</strong> (values <span class="math inline">\(&lt; 0\)</span>), which is physically impossible.</p></li>
<li><p><strong>Poor Tail Fit:</strong> It completely fails to capture the long right tail of extreme storm events, under-predicting flood risks.</p></li>
</ul>
<p><strong>2. Tweedie vs.&nbsp;Zero-Inflated Gamma:</strong> Both the Tweedie (Green) and our ZI-Gamma (Blue) models successfully respect the physical boundary of zero rainfall. They both align closely with the black dashed line (Real Data).</p>
<ul>
<li><p><strong>Why ZI-Gamma?</strong> While Tweedie is efficient, it uses a single process to model both the <em>probability</em> of rain and the <em>intensity</em>. Our analysis in (Markov Chains Analysis) proved that the drivers of rain <em>occurrence</em> (e.g., <code>pressure_change</code>) differ slightly from the drivers of <em>intensity</em> (e.g., <code>wind_vectors</code>).</p></li>
<li><p><strong>Conclusion:</strong> The <strong>Zero-Inflated Gamma</strong> was the superior choice because it allowed us to model these two distinct meteorological processes separately;using a Logit model for the “Zero” state and a Gamma model for the “Wet” state;resulting in the highly accurate, physically interpretable predictions seen in the final panel.</p></li>
</ul>
</section>
</section>
<section id="final-model-selection-and-variance-analysis" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Final Model Selection and Variance Analysis</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># Likelihood Ratio Tests (LRT)</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="co"># Test each progressive addition to ensure it adds significant explanatory power</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>lrt_1v0 <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">lrtest</span>(m0_null, m1_moisture)</span>
<span id="cb32-4"><a href="#cb32-4"></a>lrt_2v1 <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">lrtest</span>(m1_moisture, m2_temporal)</span>
<span id="cb32-5"><a href="#cb32-5"></a>lrt_3v2 <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">lrtest</span>(m2_temporal, m3_history)</span>
<span id="cb32-6"><a href="#cb32-6"></a>lrt_4v3 <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">lrtest</span>(m3_history, m4_energy)</span>
<span id="cb32-7"><a href="#cb32-7"></a>lrt_5v4 <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">lrtest</span>(m4_energy, m5_wind)</span>
<span id="cb32-8"><a href="#cb32-8"></a>lrt_6v5 <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">lrtest</span>(m5_wind, m6_mixed)</span>
<span id="cb32-9"><a href="#cb32-9"></a></span>
<span id="cb32-10"><a href="#cb32-10"></a><span class="co"># Compile Results Table</span></span>
<span id="cb32-11"><a href="#cb32-11"></a>lrt_results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb32-12"><a href="#cb32-12"></a>  <span class="at">Comparison =</span> <span class="fu">c</span>(</span>
<span id="cb32-13"><a href="#cb32-13"></a>    <span class="st">"Null vs Moisture"</span>,</span>
<span id="cb32-14"><a href="#cb32-14"></a>    <span class="st">"Moisture vs Temporal"</span>,</span>
<span id="cb32-15"><a href="#cb32-15"></a>    <span class="st">"Temporal vs History"</span>,</span>
<span id="cb32-16"><a href="#cb32-16"></a>    <span class="st">"History vs Energy"</span>,</span>
<span id="cb32-17"><a href="#cb32-17"></a>    <span class="st">"Energy vs Wind"</span>,</span>
<span id="cb32-18"><a href="#cb32-18"></a>    <span class="st">"Wind vs Mixed Effects"</span></span>
<span id="cb32-19"><a href="#cb32-19"></a>  ),</span>
<span id="cb32-20"><a href="#cb32-20"></a>  <span class="at">Chi_square =</span> <span class="fu">c</span>(</span>
<span id="cb32-21"><a href="#cb32-21"></a>    lrt_1v0<span class="sc">$</span>Chisq[<span class="dv">2</span>],</span>
<span id="cb32-22"><a href="#cb32-22"></a>    lrt_2v1<span class="sc">$</span>Chisq[<span class="dv">2</span>],</span>
<span id="cb32-23"><a href="#cb32-23"></a>    lrt_3v2<span class="sc">$</span>Chisq[<span class="dv">2</span>],</span>
<span id="cb32-24"><a href="#cb32-24"></a>    lrt_4v3<span class="sc">$</span>Chisq[<span class="dv">2</span>],</span>
<span id="cb32-25"><a href="#cb32-25"></a>    lrt_5v4<span class="sc">$</span>Chisq[<span class="dv">2</span>],</span>
<span id="cb32-26"><a href="#cb32-26"></a>    lrt_6v5<span class="sc">$</span>Chisq[<span class="dv">2</span>]</span>
<span id="cb32-27"><a href="#cb32-27"></a>  ),</span>
<span id="cb32-28"><a href="#cb32-28"></a>  <span class="at">df =</span> <span class="fu">c</span>(</span>
<span id="cb32-29"><a href="#cb32-29"></a>    lrt_1v0<span class="sc">$</span>Df[<span class="dv">2</span>],</span>
<span id="cb32-30"><a href="#cb32-30"></a>    lrt_2v1<span class="sc">$</span>Df[<span class="dv">2</span>],</span>
<span id="cb32-31"><a href="#cb32-31"></a>    lrt_3v2<span class="sc">$</span>Df[<span class="dv">2</span>],</span>
<span id="cb32-32"><a href="#cb32-32"></a>    lrt_4v3<span class="sc">$</span>Df[<span class="dv">2</span>],</span>
<span id="cb32-33"><a href="#cb32-33"></a>    lrt_5v4<span class="sc">$</span>Df[<span class="dv">2</span>],</span>
<span id="cb32-34"><a href="#cb32-34"></a>    lrt_6v5<span class="sc">$</span>Df[<span class="dv">2</span>]</span>
<span id="cb32-35"><a href="#cb32-35"></a>  ),</span>
<span id="cb32-36"><a href="#cb32-36"></a>  <span class="at">raw_p =</span> <span class="fu">c</span>(</span>
<span id="cb32-37"><a href="#cb32-37"></a>    lrt_1v0<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chisq)</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb32-38"><a href="#cb32-38"></a>    lrt_2v1<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chisq)</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb32-39"><a href="#cb32-39"></a>    lrt_3v2<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chisq)</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb32-40"><a href="#cb32-40"></a>    lrt_4v3<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chisq)</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb32-41"><a href="#cb32-41"></a>    lrt_5v4<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chisq)</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb32-42"><a href="#cb32-42"></a>    lrt_6v5<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chisq)</span><span class="st">`</span>[<span class="dv">2</span>]</span>
<span id="cb32-43"><a href="#cb32-43"></a>  )</span>
<span id="cb32-44"><a href="#cb32-44"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb32-45"><a href="#cb32-45"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-46"><a href="#cb32-46"></a>    <span class="at">adj_p_value =</span> <span class="fu">p.adjust</span>(raw_p, <span class="at">method =</span> <span class="st">"holm"</span>),</span>
<span id="cb32-47"><a href="#cb32-47"></a>    <span class="at">Significant =</span> <span class="fu">ifelse</span>(</span>
<span id="cb32-48"><a href="#cb32-48"></a>      adj_p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>,</span>
<span id="cb32-49"><a href="#cb32-49"></a>      <span class="st">"***"</span>,</span>
<span id="cb32-50"><a href="#cb32-50"></a>      <span class="fu">ifelse</span>(adj_p_value <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="st">"**"</span>, <span class="fu">ifelse</span>(adj_p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"*"</span>, <span class="st">"ns"</span>))</span>
<span id="cb32-51"><a href="#cb32-51"></a>    ),</span>
<span id="cb32-52"><a href="#cb32-52"></a>    <span class="at">AIC_improvement =</span> <span class="fu">c</span>(</span>
<span id="cb32-53"><a href="#cb32-53"></a>      <span class="fu">AIC</span>(m0_null) <span class="sc">-</span> <span class="fu">AIC</span>(m1_moisture),</span>
<span id="cb32-54"><a href="#cb32-54"></a>      <span class="fu">AIC</span>(m1_moisture) <span class="sc">-</span> <span class="fu">AIC</span>(m2_temporal),</span>
<span id="cb32-55"><a href="#cb32-55"></a>      <span class="fu">AIC</span>(m2_temporal) <span class="sc">-</span> <span class="fu">AIC</span>(m3_history),</span>
<span id="cb32-56"><a href="#cb32-56"></a>      <span class="fu">AIC</span>(m3_history) <span class="sc">-</span> <span class="fu">AIC</span>(m4_energy),</span>
<span id="cb32-57"><a href="#cb32-57"></a>      <span class="fu">AIC</span>(m4_energy) <span class="sc">-</span> <span class="fu">AIC</span>(m5_wind),</span>
<span id="cb32-58"><a href="#cb32-58"></a>      <span class="fu">AIC</span>(m5_wind) <span class="sc">-</span> <span class="fu">AIC</span>(m6_mixed)</span>
<span id="cb32-59"><a href="#cb32-59"></a>    )</span>
<span id="cb32-60"><a href="#cb32-60"></a>  )</span>
<span id="cb32-61"><a href="#cb32-61"></a></span>
<span id="cb32-62"><a href="#cb32-62"></a>lrt_results <span class="sc">%&gt;%</span></span>
<span id="cb32-63"><a href="#cb32-63"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-64"><a href="#cb32-64"></a>    <span class="at">Chi_square =</span> <span class="fu">round</span>(Chi_square, <span class="dv">2</span>),</span>
<span id="cb32-65"><a href="#cb32-65"></a>    <span class="at">AIC_improvement =</span> <span class="fu">round</span>(AIC_improvement, <span class="dv">1</span>)</span>
<span id="cb32-66"><a href="#cb32-66"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-67"><a href="#cb32-67"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Likelihood Ratio Tests: Progressive Model Building"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-68"><a href="#cb32-68"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<caption>Likelihood Ratio Tests: Progressive Model Building</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Comparison</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Chi_square</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">raw_p</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">adj_p_value</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Significant</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC_improvement</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Null vs Moisture</td>
<td style="text-align: right;">39051.88</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">***</td>
<td style="text-align: right;">39039.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Moisture vs Temporal</td>
<td style="text-align: right;">15813.45</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">***</td>
<td style="text-align: right;">15803.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Temporal vs History</td>
<td style="text-align: right;">1708.85</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">***</td>
<td style="text-align: right;">1700.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">History vs Energy</td>
<td style="text-align: right;">1393.61</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">***</td>
<td style="text-align: right;">1383.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Energy vs Wind</td>
<td style="text-align: right;">608.53</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">***</td>
<td style="text-align: right;">600.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wind vs Mixed Effects</td>
<td style="text-align: right;">6529.12</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">***</td>
<td style="text-align: right;">6503.1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>model_selection <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="at">Model =</span> <span class="fu">c</span>(</span>
<span id="cb33-3"><a href="#cb33-3"></a>    <span class="st">"m0_null"</span>,</span>
<span id="cb33-4"><a href="#cb33-4"></a>    <span class="st">"m1_moisture"</span>,</span>
<span id="cb33-5"><a href="#cb33-5"></a>    <span class="st">"m2_temporal"</span>,</span>
<span id="cb33-6"><a href="#cb33-6"></a>    <span class="st">"m3_history"</span>,</span>
<span id="cb33-7"><a href="#cb33-7"></a>    <span class="st">"m4_energy"</span>,</span>
<span id="cb33-8"><a href="#cb33-8"></a>    <span class="st">"m5_wind"</span>,</span>
<span id="cb33-9"><a href="#cb33-9"></a>    <span class="st">"m6_mixed"</span></span>
<span id="cb33-10"><a href="#cb33-10"></a>  ),</span>
<span id="cb33-11"><a href="#cb33-11"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(</span>
<span id="cb33-12"><a href="#cb33-12"></a>    <span class="fu">AIC</span>(m0_null),</span>
<span id="cb33-13"><a href="#cb33-13"></a>    <span class="fu">AIC</span>(m1_moisture),</span>
<span id="cb33-14"><a href="#cb33-14"></a>    <span class="fu">AIC</span>(m2_temporal),</span>
<span id="cb33-15"><a href="#cb33-15"></a>    <span class="fu">AIC</span>(m3_history),</span>
<span id="cb33-16"><a href="#cb33-16"></a>    <span class="fu">AIC</span>(m4_energy),</span>
<span id="cb33-17"><a href="#cb33-17"></a>    <span class="fu">AIC</span>(m5_wind),</span>
<span id="cb33-18"><a href="#cb33-18"></a>    <span class="fu">AIC</span>(m6_mixed)</span>
<span id="cb33-19"><a href="#cb33-19"></a>  ),</span>
<span id="cb33-20"><a href="#cb33-20"></a>  <span class="at">BIC =</span> <span class="fu">c</span>(</span>
<span id="cb33-21"><a href="#cb33-21"></a>    <span class="fu">BIC</span>(m0_null),</span>
<span id="cb33-22"><a href="#cb33-22"></a>    <span class="fu">BIC</span>(m1_moisture),</span>
<span id="cb33-23"><a href="#cb33-23"></a>    <span class="fu">BIC</span>(m2_temporal),</span>
<span id="cb33-24"><a href="#cb33-24"></a>    <span class="fu">BIC</span>(m3_history),</span>
<span id="cb33-25"><a href="#cb33-25"></a>    <span class="fu">BIC</span>(m4_energy),</span>
<span id="cb33-26"><a href="#cb33-26"></a>    <span class="fu">BIC</span>(m5_wind),</span>
<span id="cb33-27"><a href="#cb33-27"></a>    <span class="fu">BIC</span>(m6_mixed)</span>
<span id="cb33-28"><a href="#cb33-28"></a>  )</span>
<span id="cb33-29"><a href="#cb33-29"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb33-30"><a href="#cb33-30"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-31"><a href="#cb33-31"></a>    <span class="at">Delta_AIC =</span> AIC <span class="sc">-</span> <span class="fu">min</span>(AIC),</span>
<span id="cb33-32"><a href="#cb33-32"></a>    <span class="at">AIC_weight =</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> Delta_AIC) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> Delta_AIC))</span>
<span id="cb33-33"><a href="#cb33-33"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-34"><a href="#cb33-34"></a>  <span class="fu">arrange</span>(AIC)</span>
<span id="cb33-35"><a href="#cb33-35"></a></span>
<span id="cb33-36"><a href="#cb33-36"></a>model_selection <span class="sc">%&gt;%</span></span>
<span id="cb33-37"><a href="#cb33-37"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(., <span class="dv">2</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb33-38"><a href="#cb33-38"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Model Selection Table"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-39"><a href="#cb33-39"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-model-selection" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-selection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8.1: Model Selection Table
</figcaption>
<div aria-describedby="tbl-model-selection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped do-not-create-environment cell caption-top table-sm small" data-quarto-postprocess="true">
<caption>Model Selection Table</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Delta_AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC_weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">m6_mixed</td>
<td style="text-align: right;">396638.2</td>
<td style="text-align: right;">397032.7</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">m5_wind</td>
<td style="text-align: right;">403141.3</td>
<td style="text-align: right;">403407.6</td>
<td style="text-align: right;">6503.12</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">m4_energy</td>
<td style="text-align: right;">403741.9</td>
<td style="text-align: right;">403968.7</td>
<td style="text-align: right;">7103.65</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">m3_history</td>
<td style="text-align: right;">405125.5</td>
<td style="text-align: right;">405303.0</td>
<td style="text-align: right;">8487.27</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">m2_temporal</td>
<td style="text-align: right;">406826.3</td>
<td style="text-align: right;">406964.4</td>
<td style="text-align: right;">10188.11</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">m1_moisture</td>
<td style="text-align: right;">422629.8</td>
<td style="text-align: right;">422718.6</td>
<td style="text-align: right;">25991.56</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">m0_null</td>
<td style="text-align: right;">461669.7</td>
<td style="text-align: right;">461699.3</td>
<td style="text-align: right;">65031.45</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb34-2"><a href="#cb34-2"></a>  model_selection,</span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">aes</span>(</span>
<span id="cb34-4"><a href="#cb34-4"></a>    <span class="at">x =</span> <span class="fu">factor</span>(</span>
<span id="cb34-5"><a href="#cb34-5"></a>      Model,</span>
<span id="cb34-6"><a href="#cb34-6"></a>      <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb34-7"><a href="#cb34-7"></a>        <span class="st">"m6_mixed"</span>,</span>
<span id="cb34-8"><a href="#cb34-8"></a>        <span class="st">"m5_wind"</span>,</span>
<span id="cb34-9"><a href="#cb34-9"></a>        <span class="st">"m4_energy"</span>,</span>
<span id="cb34-10"><a href="#cb34-10"></a>        <span class="st">"m3_history"</span>,</span>
<span id="cb34-11"><a href="#cb34-11"></a>        <span class="st">"m2_temporal"</span>,</span>
<span id="cb34-12"><a href="#cb34-12"></a>        <span class="st">"m1_moisture"</span>,</span>
<span id="cb34-13"><a href="#cb34-13"></a>        <span class="st">"m0_null"</span></span>
<span id="cb34-14"><a href="#cb34-14"></a>      )</span>
<span id="cb34-15"><a href="#cb34-15"></a>    ),</span>
<span id="cb34-16"><a href="#cb34-16"></a>    <span class="at">y =</span> AIC</span>
<span id="cb34-17"><a href="#cb34-17"></a>  )</span>
<span id="cb34-18"><a href="#cb34-18"></a>) <span class="sc">+</span></span>
<span id="cb34-19"><a href="#cb34-19"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span></span>
<span id="cb34-20"><a href="#cb34-20"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb34-21"><a href="#cb34-21"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb34-22"><a href="#cb34-22"></a>    <span class="at">yintercept =</span> <span class="fu">min</span>(model_selection<span class="sc">$</span>AIC),</span>
<span id="cb34-23"><a href="#cb34-23"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb34-24"><a href="#cb34-24"></a>    <span class="at">color =</span> <span class="st">"red"</span></span>
<span id="cb34-25"><a href="#cb34-25"></a>  ) <span class="sc">+</span></span>
<span id="cb34-26"><a href="#cb34-26"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb34-27"><a href="#cb34-27"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"delta=%.0f"</span>, Delta_AIC)),</span>
<span id="cb34-28"><a href="#cb34-28"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb34-29"><a href="#cb34-29"></a>    <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb34-30"><a href="#cb34-30"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span></span>
<span id="cb34-31"><a href="#cb34-31"></a>  ) <span class="sc">+</span></span>
<span id="cb34-32"><a href="#cb34-32"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-33"><a href="#cb34-33"></a>    <span class="at">title =</span> <span class="st">"Model Selection: Progressive Improvement"</span>,</span>
<span id="cb34-34"><a href="#cb34-34"></a>    <span class="at">subtitle =</span> <span class="st">"Each step significantly improves fit (LRT p &lt; 0.001 for all comparisons)"</span>,</span>
<span id="cb34-35"><a href="#cb34-35"></a>    <span class="at">x =</span> <span class="st">"Model (Ordered by Complexity)"</span>,</span>
<span id="cb34-36"><a href="#cb34-36"></a>    <span class="at">y =</span> <span class="st">"AIC (Lower is Better)"</span>,</span>
<span id="cb34-37"><a href="#cb34-37"></a>    <span class="at">caption =</span> <span class="st">"Red line = Best Model (M6 Mixed)"</span></span>
<span id="cb34-38"><a href="#cb34-38"></a>  ) <span class="sc">+</span></span>
<span id="cb34-39"><a href="#cb34-39"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-40"><a href="#cb34-40"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-41"><a href="#cb34-41"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb34-42"><a href="#cb34-42"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb34-43"><a href="#cb34-43"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-model-selection" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-selection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-modeling_files/figure-html/fig-model-selection-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-selection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.1: Model Selection: Progressive Improvement. The AIC drops significantly at every stage, confirming that no step was redundant. The largest jump occurs when adding basic moisture variables, but the addition of Spatial Mixed Effects (M6) also provides a massive improvement over the Wind model (M5).
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># Random Effects Necessity Test (LRT M5 vs M6)</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>re_test <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">lrtest</span>(m5_wind, m6_mixed)</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="fu">print</span>(re_test)</span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="do">## Likelihood ratio test</span></span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="do">## </span></span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="do">## Model 1: rainfall ~ humidity3pm + dewpoint_9am + dewpoint_change + pressure_change + </span></span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="do">##     day_cos + day_sin + rainfall_ma7 + days_since_rain + humidity_ma7 + </span></span>
<span id="cb35-8"><a href="#cb35-8"></a><span class="do">##     rain_yesterday + sunshine + evaporation + instability_index + </span></span>
<span id="cb35-9"><a href="#cb35-9"></a><span class="do">##     sun_humid_interaction + cloud_development + gust_U_EW + gust_V_NS + </span></span>
<span id="cb35-10"><a href="#cb35-10"></a><span class="do">##     wind9am_V_NS + wind9am_U_EW</span></span>
<span id="cb35-11"><a href="#cb35-11"></a><span class="do">## Model 2: rainfall ~ humidity3pm + dewpoint_9am + dewpoint_change + pressure_change + </span></span>
<span id="cb35-12"><a href="#cb35-12"></a><span class="do">##     day_cos + day_sin + rainfall_ma7 + days_since_rain + humidity_ma7 + </span></span>
<span id="cb35-13"><a href="#cb35-13"></a><span class="do">##     rain_yesterday + sunshine + evaporation + instability_index + </span></span>
<span id="cb35-14"><a href="#cb35-14"></a><span class="do">##     sun_humid_interaction + cloud_development + gust_U_EW + gust_V_NS + </span></span>
<span id="cb35-15"><a href="#cb35-15"></a><span class="do">##     wind9am_V_NS + wind9am_U_EW + diag(1 + humidity3pm + rain_yesterday + </span></span>
<span id="cb35-16"><a href="#cb35-16"></a><span class="do">##     dewpoint_change | location)</span></span>
<span id="cb35-17"><a href="#cb35-17"></a><span class="do">##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    </span></span>
<span id="cb35-18"><a href="#cb35-18"></a><span class="do">## 1  27 -201544                         </span></span>
<span id="cb35-19"><a href="#cb35-19"></a><span class="do">## 2  40 -198279 13 6529.1  &lt; 2.2e-16 ***</span></span>
<span id="cb35-20"><a href="#cb35-20"></a><span class="do">## ---</span></span>
<span id="cb35-21"><a href="#cb35-21"></a><span class="do">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb35-22"><a href="#cb35-22"></a></span>
<span id="cb35-23"><a href="#cb35-23"></a><span class="co"># Nakagawa's R-Squared</span></span>
<span id="cb35-24"><a href="#cb35-24"></a><span class="co"># Decomposes variance into Fixed Effects (Marginal) vs. Random Effects (Conditional)</span></span>
<span id="cb35-25"><a href="#cb35-25"></a>r2_vals <span class="ot">&lt;-</span> performance<span class="sc">::</span><span class="fu">r2_nakagawa</span>(m6_mixed)</span>
<span id="cb35-26"><a href="#cb35-26"></a></span>
<span id="cb35-27"><a href="#cb35-27"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Marginal R2 (Fixed Effects only): %.4f</span><span class="sc">\n</span><span class="st">"</span>, r2_vals<span class="sc">$</span>R2_marginal))</span>
<span id="cb35-28"><a href="#cb35-28"></a><span class="do">## </span></span>
<span id="cb35-29"><a href="#cb35-29"></a><span class="do">## Marginal R2 (Fixed Effects only): 0.3498</span></span>
<span id="cb35-30"><a href="#cb35-30"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(</span>
<span id="cb35-31"><a href="#cb35-31"></a>  <span class="st">"Conditional R2 (Fixed + Random Effects): %.4f</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb35-32"><a href="#cb35-32"></a>  r2_vals<span class="sc">$</span>R2_conditional</span>
<span id="cb35-33"><a href="#cb35-33"></a>))</span>
<span id="cb35-34"><a href="#cb35-34"></a><span class="do">## Conditional R2 (Fixed + Random Effects): 0.4464</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We employed a strict forward-selection strategy, verifying that each additional layer of complexity provided statistically significant information gain.</p>
<p><strong>1. Progressive Improvement:</strong> As shown in <a href="#fig-model-selection" class="quarto-xref">Figure&nbsp;<span>8.1</span></a> , the AIC decreased monotonically with every model update.</p>
<ul>
<li><p><strong>Largest Gain:</strong> The shift from Null to M1 (Moisture) reduced AIC by ~38,000, confirming that humidity is the primary driver.</p></li>
<li><p><strong>Final Gain:</strong> The shift from M5 (Wind) to M6 (Mixed) reduced AIC by ~7,600. This is a massive improvement for a late-stage addition, proving that <strong>spatial heterogeneity</strong> is not a minor nuisance but a fundamental component of the Australian climate system.</p></li>
</ul>
<p><strong>2. Likelihood Ratio Tests:</strong> The formal LRT table confirms that every comparison yielded a p-value <span class="math inline">\(&lt; 0.001\)</span>. Even the smallest step (Wind Vectors, M5) improved the model significantly (<span class="math inline">\(\chi^2 = 607, df=4\)</span>), justifying the inclusion of compass-based predictors.</p>
<p><strong>3. Variance Explained (</strong><span class="math inline">\(R^2\)</span>): Using Nakagawa’s method for Generalized Linear Mixed Models:</p>
<ul>
<li><p><strong>Marginal</strong> <span class="math inline">\(R^2 = 0.345\)</span>: Our fixed meteorological predictors (Humidity, Wind, Pressure, etc.) explain <strong>34.5%</strong> of the variance in rainfall intensity.</p></li>
<li><p><strong>Conditional</strong> <span class="math inline">\(R^2 = 0.441\)</span>: When we include the location-specific random effects, the explanatory power jumps to <strong>44.1%</strong>.</p></li>
<li><p><strong>Insight:</strong> Roughly <strong>10% of the explainable variance</strong> in Australian rainfall is purely geographic;attributable to the specific location of the city (e.g., coastal vs.&nbsp;inland) rather than dynamic weather variables.</p></li>
</ul>
<p><strong>Conclusion:</strong> Model 6 (Mixed Effects Zero-Inflated Gamma) is the statistically superior model. It maximizes likelihood, minimizes information loss (AIC/BIC), and captures significant spatial variance that fixed-effects models miss.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-features.html" class="pagination-link" aria-label="Signal Extraction via Moving Averages">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Signal Extraction via Moving Averages</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-conclusion.html" class="pagination-link" aria-label="Conclusion">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Conclusion</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb36" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu"># Modelling</span></span>
<span id="cb36-2"><a href="#cb36-2"></a></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="fu">## Establishing the Baseline (Null Model)</span></span>
<span id="cb36-4"><a href="#cb36-4"></a></span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="fu"># Modeling</span></span>
<span id="cb36-6"><a href="#cb36-6"></a></span>
<span id="cb36-7"><a href="#cb36-7"></a>In this chapter, we progressively build our statistical framework, starting from a null baseline and adding layers of physical complexity. We utilize **Zero-Inflated Gamma (ZIG)** models to handle the dual nature of rainfall data (probability of occurrence vs. intensity).</span>
<span id="cb36-8"><a href="#cb36-8"></a></span>
<span id="cb36-11"><a href="#cb36-11"></a><span class="in">```{r}</span></span>
<span id="cb36-12"><a href="#cb36-12"></a><span class="co">#| label: setup-modeling</span></span>
<span id="cb36-13"><a href="#cb36-13"></a><span class="co">#| include: false</span></span>
<span id="cb36-14"><a href="#cb36-14"></a></span>
<span id="cb36-15"><a href="#cb36-15"></a>librarian<span class="sc">::</span><span class="fu">shelf</span>(</span>
<span id="cb36-16"><a href="#cb36-16"></a>  tidyverse,</span>
<span id="cb36-17"><a href="#cb36-17"></a>  glmmTMB,</span>
<span id="cb36-18"><a href="#cb36-18"></a>  sjPlot,</span>
<span id="cb36-19"><a href="#cb36-19"></a>  DHARMa,</span>
<span id="cb36-20"><a href="#cb36-20"></a>  kableExtra,</span>
<span id="cb36-21"><a href="#cb36-21"></a>  gtsummary,</span>
<span id="cb36-22"><a href="#cb36-22"></a>  lmtest,</span>
<span id="cb36-23"><a href="#cb36-23"></a>  performance,</span>
<span id="cb36-24"><a href="#cb36-24"></a>  gt,</span>
<span id="cb36-25"><a href="#cb36-25"></a>  splines,</span>
<span id="cb36-26"><a href="#cb36-26"></a>  pROC,</span>
<span id="cb36-27"><a href="#cb36-27"></a>  here</span>
<span id="cb36-28"><a href="#cb36-28"></a>)</span>
<span id="cb36-29"><a href="#cb36-29"></a></span>
<span id="cb36-30"><a href="#cb36-30"></a>df_scaled <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"df_scaled.csv"</span>))</span>
<span id="cb36-31"><a href="#cb36-31"></a>df_final <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"df_engineered.csv"</span>))</span>
<span id="cb36-32"><a href="#cb36-32"></a></span>
<span id="cb36-33"><a href="#cb36-33"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"utils.R"</span>))</span>
<span id="cb36-34"><a href="#cb36-34"></a></span>
<span id="cb36-35"><a href="#cb36-35"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models/all_models_bundle.RData"</span>))) {</span>
<span id="cb36-36"><a href="#cb36-36"></a>  <span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models/all_models_bundle.RData"</span>))</span>
<span id="cb36-37"><a href="#cb36-37"></a>}</span>
<span id="cb36-38"><a href="#cb36-38"></a><span class="in">```</span></span>
<span id="cb36-39"><a href="#cb36-39"></a></span>
<span id="cb36-40"><a href="#cb36-40"></a><span class="fu"># Modelling</span></span>
<span id="cb36-41"><a href="#cb36-41"></a></span>
<span id="cb36-42"><a href="#cb36-42"></a><span class="fu">## Establishing the Baseline (Null Model)</span></span>
<span id="cb36-43"><a href="#cb36-43"></a></span>
<span id="cb36-46"><a href="#cb36-46"></a><span class="in">```{r}</span></span>
<span id="cb36-47"><a href="#cb36-47"></a><span class="co">#| label: null-model-fit</span></span>
<span id="cb36-48"><a href="#cb36-48"></a><span class="co">#| echo: true</span></span>
<span id="cb36-49"><a href="#cb36-49"></a><span class="co">#| message: false</span></span>
<span id="cb36-50"><a href="#cb36-50"></a><span class="co">#| eval: false</span></span>
<span id="cb36-51"><a href="#cb36-51"></a></span>
<span id="cb36-52"><a href="#cb36-52"></a><span class="co"># Fit the Null Model (Intercept-Only)</span></span>
<span id="cb36-53"><a href="#cb36-53"></a><span class="co"># TO Establish a baseline AIC/BIC and recover global average parameters</span></span>
<span id="cb36-54"><a href="#cb36-54"></a>m0_null <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb36-55"><a href="#cb36-55"></a>  <span class="at">formula =</span> rainfall <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># Model rainfall intensity using only an intercept</span></span>
<span id="cb36-56"><a href="#cb36-56"></a>  <span class="at">ziformula =</span> <span class="sc">~</span><span class="dv">1</span>, <span class="co"># Model probability of dry days using only an intercept</span></span>
<span id="cb36-57"><a href="#cb36-57"></a>  <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="co"># Gamma distribution for positive rain</span></span>
<span id="cb36-58"><a href="#cb36-58"></a>  <span class="at">data =</span> df_scaled</span>
<span id="cb36-59"><a href="#cb36-59"></a>)</span>
<span id="cb36-60"><a href="#cb36-60"></a><span class="in">```</span></span>
<span id="cb36-61"><a href="#cb36-61"></a></span>
<span id="cb36-64"><a href="#cb36-64"></a><span class="in">```{r}</span></span>
<span id="cb36-65"><a href="#cb36-65"></a><span class="co">#| label: null-model-output</span></span>
<span id="cb36-66"><a href="#cb36-66"></a></span>
<span id="cb36-67"><a href="#cb36-67"></a><span class="fu">tab_model</span>(</span>
<span id="cb36-68"><a href="#cb36-68"></a>  m0_null,</span>
<span id="cb36-69"><a href="#cb36-69"></a>  <span class="at">show.se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-70"><a href="#cb36-70"></a>  <span class="at">show.aic =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-71"><a href="#cb36-71"></a>  <span class="at">transform =</span> <span class="st">"exp"</span>,</span>
<span id="cb36-72"><a href="#cb36-72"></a>  <span class="at">collapse.se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-73"><a href="#cb36-73"></a>  <span class="at">p.style =</span> <span class="st">"numeric_stars"</span>,</span>
<span id="cb36-74"><a href="#cb36-74"></a>  <span class="at">string.pred =</span> <span class="st">"Parameter"</span>,</span>
<span id="cb36-75"><a href="#cb36-75"></a>  <span class="at">string.est =</span> <span class="st">"Estimate (Exp)"</span>,</span>
<span id="cb36-76"><a href="#cb36-76"></a>  <span class="at">dv.labels =</span> <span class="st">"Baseline Rainfall Model"</span>,</span>
<span id="cb36-77"><a href="#cb36-77"></a>  <span class="at">title =</span> <span class="st">"Table 1: Baseline Zero-Inflated Gamma Model (Intercept Only)"</span></span>
<span id="cb36-78"><a href="#cb36-78"></a>)</span>
<span id="cb36-79"><a href="#cb36-79"></a><span class="in">```</span></span>
<span id="cb36-80"><a href="#cb36-80"></a></span>
<span id="cb36-81"><a href="#cb36-81"></a>To quantify the value added by our meteorological predictors, we first fitted a **"Null" Zero-Inflated Gamma model**. This model contains no predictors (covariates); it consists solely of intercepts. Its purpose is to verify if the model structure correctly recovers the fundamental properties of the dataset (the global probability of rain and the global average intensity).</span>
<span id="cb36-82"><a href="#cb36-82"></a></span>
<span id="cb36-83"><a href="#cb36-83"></a>**1. Zero-Inflation Component (The "Hurdle"):** The zero-inflation intercept is $\beta_{zi} = 0.5769$. Since this component uses a **logit** link function, we can back-transform it to find the baseline probability of a dry day:</span>
<span id="cb36-84"><a href="#cb36-84"></a></span>
<span id="cb36-85"><a href="#cb36-85"></a>$$P(\text{Dry}) = \frac{e^{0.5769}}{1 + e^{0.5769}} \approx \frac{1.78}{2.78} \approx 64.03\%$$</span>
<span id="cb36-86"><a href="#cb36-86"></a></span>
<span id="cb36-87"><a href="#cb36-87"></a>**Insight:** This model-derived probability matches the empirical zero-inflation rate ($64.05\%$) calculated in our EDA perfectly. This confirms the model is correctly calibrated to the frequency of dry days.</span>
<span id="cb36-88"><a href="#cb36-88"></a></span>
<span id="cb36-89"><a href="#cb36-89"></a>**2. Conditional Component (Gamma Intensity):** The conditional intercept is $\beta_{cond} = 1.8825$. Using the **log** link function, we recover the baseline rainfall intensity for wet days:</span>
<span id="cb36-90"><a href="#cb36-90"></a></span>
<span id="cb36-91"><a href="#cb36-91"></a>$$\mu_{\text{rain}} = e^{1.8825} \approx 6.57 \text{ mm}$$</span>
<span id="cb36-92"><a href="#cb36-92"></a></span>
<span id="cb36-93"><a href="#cb36-93"></a>**Insight:** This represents the typical "geometric mean" rainfall intensity when it does rain, unadjusted for season or location.</span>
<span id="cb36-94"><a href="#cb36-94"></a></span>
<span id="cb36-95"><a href="#cb36-95"></a>**3. Performance Baseline:**</span>
<span id="cb36-96"><a href="#cb36-96"></a></span>
<span id="cb36-97"><a href="#cb36-97"></a><span class="ss">-   </span>**AIC:** 461,669.7</span>
<span id="cb36-98"><a href="#cb36-98"></a></span>
<span id="cb36-99"><a href="#cb36-99"></a><span class="ss">-   </span>**Implication:** Any subsequent model including predictors (e.g., <span class="in">`humidity`</span>, <span class="in">`pressure`</span>, <span class="in">`season`</span>) must achieve an AIC significantly lower than this value to demonstrate predictive power.</span>
<span id="cb36-100"><a href="#cb36-100"></a></span>
<span id="cb36-101"><a href="#cb36-101"></a><span class="fu">## Moisture Dynamics</span></span>
<span id="cb36-102"><a href="#cb36-102"></a></span>
<span id="cb36-105"><a href="#cb36-105"></a><span class="in">```{r}</span></span>
<span id="cb36-106"><a href="#cb36-106"></a><span class="co">#| label: m1-moisture-code</span></span>
<span id="cb36-107"><a href="#cb36-107"></a><span class="co">#| echo: true</span></span>
<span id="cb36-108"><a href="#cb36-108"></a><span class="co">#| eval: false</span></span>
<span id="cb36-109"><a href="#cb36-109"></a></span>
<span id="cb36-110"><a href="#cb36-110"></a><span class="co"># Update the null model to include moisture-related predictors</span></span>
<span id="cb36-111"><a href="#cb36-111"></a>m1_moisture <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb36-112"><a href="#cb36-112"></a>  m0_null,</span>
<span id="cb36-113"><a href="#cb36-113"></a>  . <span class="sc">~</span> . <span class="sc">+</span> humidity3pm <span class="sc">+</span> dewpoint_9am <span class="sc">+</span> dewpoint_change <span class="sc">+</span> pressure_change,</span>
<span id="cb36-114"><a href="#cb36-114"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span> dewpoint_9am</span>
<span id="cb36-115"><a href="#cb36-115"></a>)</span>
<span id="cb36-116"><a href="#cb36-116"></a><span class="in">```</span></span>
<span id="cb36-117"><a href="#cb36-117"></a></span>
<span id="cb36-120"><a href="#cb36-120"></a><span class="in">```{r}</span></span>
<span id="cb36-121"><a href="#cb36-121"></a><span class="co">#| label: m1-moisture-output</span></span>
<span id="cb36-122"><a href="#cb36-122"></a><span class="co">#| echo: false</span></span>
<span id="cb36-123"><a href="#cb36-123"></a></span>
<span id="cb36-124"><a href="#cb36-124"></a>m1_moisture <span class="sc">%&gt;%</span></span>
<span id="cb36-125"><a href="#cb36-125"></a>  <span class="fu">tbl_regression</span>(</span>
<span id="cb36-126"><a href="#cb36-126"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-127"><a href="#cb36-127"></a>    <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb36-128"><a href="#cb36-128"></a>      humidity3pm <span class="sc">~</span> <span class="st">"Humidity (3pm)"</span>,</span>
<span id="cb36-129"><a href="#cb36-129"></a>      dewpoint_9am <span class="sc">~</span> <span class="st">"Dewpoint (9am)"</span>,</span>
<span id="cb36-130"><a href="#cb36-130"></a>      dewpoint_change <span class="sc">~</span> <span class="st">"Dewpoint Change (Delta)"</span>,</span>
<span id="cb36-131"><a href="#cb36-131"></a>      pressure_change <span class="sc">~</span> <span class="st">"Pressure Change (Delta)"</span></span>
<span id="cb36-132"><a href="#cb36-132"></a>    )</span>
<span id="cb36-133"><a href="#cb36-133"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-134"><a href="#cb36-134"></a>  <span class="fu">bold_p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-135"><a href="#cb36-135"></a>  <span class="fu">add_glance_table</span>(<span class="at">include =</span> <span class="fu">c</span>(<span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"logLik"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-136"><a href="#cb36-136"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Predictor**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-137"><a href="#cb36-137"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Model 1: Moisture &amp; Pressure Dynamics**"</span>)</span>
<span id="cb36-138"><a href="#cb36-138"></a><span class="in">```</span></span>
<span id="cb36-139"><a href="#cb36-139"></a></span>
<span id="cb36-140"><a href="#cb36-140"></a>Building upon the baseline, "Model 1" incorporates the primary moisture and pressure drivers identified in the exploratory analysis. Specifically, we test the hypothesis that atmospheric moisture content (<span class="in">`humidity`</span>, <span class="in">`dewpoint`</span>) and pressure stability (<span class="in">`pressure_change`</span>) drive both the occurrence and intensity of rainfall.</span>
<span id="cb36-141"><a href="#cb36-141"></a></span>
<span id="cb36-142"><a href="#cb36-142"></a>**1. Performance Improvement:**</span>
<span id="cb36-143"><a href="#cb36-143"></a></span>
<span id="cb36-144"><a href="#cb36-144"></a><span class="ss">-   </span>**AIC Reduction:** The AIC dropped dramatically from **461,669.7 (Null)** to **422,847 (M1)**.</span>
<span id="cb36-145"><a href="#cb36-145"></a></span>
<span id="cb36-146"><a href="#cb36-146"></a><span class="ss">-   </span>**Significance:** This massive reduction ($\Delta AIC \approx 38,823$) confirms that moisture dynamics are foundational predictors, explaining a vast amount of the variance in the dataset.</span>
<span id="cb36-147"><a href="#cb36-147"></a></span>
<span id="cb36-148"><a href="#cb36-148"></a>**2. Conditional Model (Rainfall Intensity):** All predictors in the conditional part are statistically significant ($p &lt; 2e^{-16}$):</span>
<span id="cb36-149"><a href="#cb36-149"></a></span>
<span id="cb36-150"><a href="#cb36-150"></a><span class="ss">-   </span>**Humidity &amp; Dewpoint:** Both <span class="in">`humidity3pm`</span> ($\beta = 0.38$) and <span class="in">`dewpoint_9am`</span> ($\beta = 0.38$) have strong positive effects. As the air becomes more saturated (higher humidity) and holds more absolute moisture (higher dewpoint), rainfall intensity increases.</span>
<span id="cb36-151"><a href="#cb36-151"></a></span>
<span id="cb36-152"><a href="#cb36-152"></a><span class="ss">-   </span>**Pressure Change:** The coefficient is positive ($\beta = 0.23$), suggesting that larger rapid fluctuations in pressure (instability) correlate with heavier rainfall.</span>
<span id="cb36-153"><a href="#cb36-153"></a></span>
<span id="cb36-154"><a href="#cb36-154"></a>**3. Zero-Inflation Model (Probability of Dry Days):**</span>
<span id="cb36-155"><a href="#cb36-155"></a></span>
<span id="cb36-156"><a href="#cb36-156"></a><span class="ss">-   </span>**Humidity:** The coefficient for `humidity3pm` is **-1.07**. In a zero-inflated model, a *negative* coefficient means the predictor *decreases* the log-odds of a zero (dry day). Therefore, **higher humidity significantly increases the probability of rain**.</span>
<span id="cb36-157"><a href="#cb36-157"></a></span>
<span id="cb36-158"><a href="#cb36-158"></a><span class="ss">-   </span>**Non-Significance:** Interestingly, <span class="in">`dewpoint_9am`</span> is not significant in the zero-inflation part ($p = 0.907$). This implies that while the *absolute* moisture (dewpoint) determines *how hard* it rains (intensity), it is the *relative* saturation (humidity) that determines *if* it rains at all.</span>
<span id="cb36-159"><a href="#cb36-159"></a></span>
<span id="cb36-160"><a href="#cb36-160"></a><span class="fu">## Temporal Dynamics and Persistence</span></span>
<span id="cb36-161"><a href="#cb36-161"></a></span>
<span id="cb36-164"><a href="#cb36-164"></a><span class="in">```{r}</span></span>
<span id="cb36-165"><a href="#cb36-165"></a><span class="co">#| label: m2-temporal-code</span></span>
<span id="cb36-166"><a href="#cb36-166"></a><span class="co">#| echo: true</span></span>
<span id="cb36-167"><a href="#cb36-167"></a><span class="co">#| eval: false</span></span>
<span id="cb36-168"><a href="#cb36-168"></a></span>
<span id="cb36-169"><a href="#cb36-169"></a><span class="co"># Update Model 1 to include:</span></span>
<span id="cb36-170"><a href="#cb36-170"></a><span class="co"># - Cyclical Seasonality (day_cos, day_sin) in the Conditional Model</span></span>
<span id="cb36-171"><a href="#cb36-171"></a><span class="co"># - Persistence (rain_yesterday) and Development (cloud/pressure) in the ZI Model</span></span>
<span id="cb36-172"><a href="#cb36-172"></a>m2_temporal <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb36-173"><a href="#cb36-173"></a>  m1_moisture,</span>
<span id="cb36-174"><a href="#cb36-174"></a>  . <span class="sc">~</span> . <span class="sc">+</span> day_cos <span class="sc">+</span> day_sin,</span>
<span id="cb36-175"><a href="#cb36-175"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb36-176"><a href="#cb36-176"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb36-177"><a href="#cb36-177"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb36-178"><a href="#cb36-178"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb36-179"><a href="#cb36-179"></a>    pressure_change</span>
<span id="cb36-180"><a href="#cb36-180"></a>)</span>
<span id="cb36-181"><a href="#cb36-181"></a></span>
<span id="cb36-182"><a href="#cb36-182"></a><span class="in">```</span></span>
<span id="cb36-183"><a href="#cb36-183"></a></span>
<span id="cb36-186"><a href="#cb36-186"></a><span class="in">```{r}</span></span>
<span id="cb36-187"><a href="#cb36-187"></a><span class="co">#| label: m2-temporal-output</span></span>
<span id="cb36-188"><a href="#cb36-188"></a><span class="co">#| echo: false</span></span>
<span id="cb36-189"><a href="#cb36-189"></a></span>
<span id="cb36-190"><a href="#cb36-190"></a>m2_temporal <span class="sc">%&gt;%</span></span>
<span id="cb36-191"><a href="#cb36-191"></a>  <span class="fu">tbl_regression</span>(</span>
<span id="cb36-192"><a href="#cb36-192"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-193"><a href="#cb36-193"></a>    <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb36-194"><a href="#cb36-194"></a>      day_cos <span class="sc">~</span> <span class="st">"Seasonality (Cos)"</span>,</span>
<span id="cb36-195"><a href="#cb36-195"></a>      day_sin <span class="sc">~</span> <span class="st">"Seasonality (Sin)"</span>,</span>
<span id="cb36-196"><a href="#cb36-196"></a>      rain_yesterday <span class="sc">~</span> <span class="st">"Rain Yesterday (Persistence)"</span>,</span>
<span id="cb36-197"><a href="#cb36-197"></a>      cloud_development <span class="sc">~</span> <span class="st">"Cloud Development"</span>,</span>
<span id="cb36-198"><a href="#cb36-198"></a>      pressure_change <span class="sc">~</span> <span class="st">"Pressure Change"</span></span>
<span id="cb36-199"><a href="#cb36-199"></a>    )</span>
<span id="cb36-200"><a href="#cb36-200"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-201"><a href="#cb36-201"></a>  <span class="fu">bold_p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-202"><a href="#cb36-202"></a>  <span class="fu">add_glance_table</span>(<span class="at">include =</span> <span class="fu">c</span>(<span class="st">"AIC"</span>, <span class="st">"BIC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-203"><a href="#cb36-203"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Predictor**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-204"><a href="#cb36-204"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Model 2: Temporal &amp; Persistence Effects**"</span>)</span>
<span id="cb36-205"><a href="#cb36-205"></a><span class="in">```</span></span>
<span id="cb36-206"><a href="#cb36-206"></a></span>
<span id="cb36-207"><a href="#cb36-207"></a>"Model 2" extends the analysis by incorporating the time-dependent structures identified in our EDA: **seasonality** (cyclical encoding) and **persistence** (Markov chains). We also refined the Zero-Inflation component to include dynamic drivers like <span class="in">`cloud_development`</span> and <span class="in">`pressure_change`</span>.</span>
<span id="cb36-208"><a href="#cb36-208"></a></span>
<span id="cb36-209"><a href="#cb36-209"></a>**1. Performance Improvement:**</span>
<span id="cb36-210"><a href="#cb36-210"></a></span>
<span id="cb36-211"><a href="#cb36-211"></a><span class="ss">-   </span>**AIC Reduction:** The model achieved an AIC of **406,659**, a substantial improvement over Model 1 (422,846).</span>
<span id="cb36-212"><a href="#cb36-212"></a></span>
<span id="cb36-213"><a href="#cb36-213"></a><span class="ss">-   </span>**Magnitude:** The reduction of $\Delta AIC \approx 16,187$ confirms that adding temporal context (knowing *when* in the year and *what happened yesterday*) provides critical predictive information that moisture variables alone cannot capture.</span>
<span id="cb36-214"><a href="#cb36-214"></a></span>
<span id="cb36-215"><a href="#cb36-215"></a>**2. Conditional Model (Rainfall Intensity):**</span>
<span id="cb36-216"><a href="#cb36-216"></a></span>
<span id="cb36-217"><a href="#cb36-217"></a><span class="ss">-   </span>**Seasonality:** Both <span class="in">`day_cos`</span> ($\beta = 0.03, p &lt; 0.001$) and <span class="in">`day_sin`</span> ($\beta = -0.04, p &lt; 0.001$) are highly significant. This mathematically confirms the "Summer Peak" pattern observed before, rainfall intensity is not constant but oscillates sinusoidally throughout the year.</span>
<span id="cb36-218"><a href="#cb36-218"></a></span>
<span id="cb36-219"><a href="#cb36-219"></a><span class="ss">-   </span>**Robustness:** The coefficients for moisture (<span class="in">`humidity3pm`</span>, <span class="in">`dewpoint`</span>) remained stable compared to Model 1, indicating that seasonality is an independent driver of intensity, not just a proxy for changing humidity levels.</span>
<span id="cb36-220"><a href="#cb36-220"></a></span>
<span id="cb36-221"><a href="#cb36-221"></a>**3. Zero-Inflation Model (Probability of Dry Days):**</span>
<span id="cb36-222"><a href="#cb36-222"></a></span>
<span id="cb36-223"><a href="#cb36-223"></a><span class="ss">-   </span>**The "Persistence" Effect:** The strongest predictor in the zero-inflation model is `rain_yesterdayYes` with a coefficient of **-1.42**.</span>
<span id="cb36-224"><a href="#cb36-224"></a></span>
<span id="cb36-225"><a href="#cb36-225"></a><span class="ss">-   </span>**Interpretation:** Because the Zero-Inflation model predicts the probability of a *zero* (dry day), a negative coefficient means *lower odds of being dry*.</span>
<span id="cb36-226"><a href="#cb36-226"></a></span>
<span id="cb36-227"><a href="#cb36-227"></a><span class="ss">-   </span>**Odds Ratio:** $\exp(-1.42) \approx 0.24$. This implies that if it rained yesterday, the odds of today being dry drop by \~76%. This is a massive effect size that validates the Markov Chain findings before.</span>
<span id="cb36-228"><a href="#cb36-228"></a></span>
<span id="cb36-229"><a href="#cb36-229"></a><span class="ss">-   </span>**Dynamic Drivers:**</span>
<span id="cb36-230"><a href="#cb36-230"></a></span>
<span id="cb36-231"><a href="#cb36-231"></a><span class="ss">-   </span><span class="in">`pressure_change`</span> ($\beta = -0.51$): Large pressure drops significantly decrease the probability of a dry day (i.e., increase rain probability).</span>
<span id="cb36-232"><a href="#cb36-232"></a></span>
<span id="cb36-233"><a href="#cb36-233"></a><span class="ss">-   </span><span class="in">`cloud_development`</span> ($\beta = 0.11$): Surprisingly, positive cloud development (more clouds at 3pm than 9am) has a positive coefficient here, slightly *increasing* the zero-inflation probability. This might capture non-precipitating cumulus buildup typical of dry, fair-weather afternoons.</span>
<span id="cb36-234"><a href="#cb36-234"></a></span>
<span id="cb36-235"><a href="#cb36-235"></a><span class="fu">## Historical Context and Persistence</span></span>
<span id="cb36-236"><a href="#cb36-236"></a></span>
<span id="cb36-239"><a href="#cb36-239"></a><span class="in">```{r}</span></span>
<span id="cb36-240"><a href="#cb36-240"></a><span class="co">#| label: m3-history-code</span></span>
<span id="cb36-241"><a href="#cb36-241"></a><span class="co">#| echo: true</span></span>
<span id="cb36-242"><a href="#cb36-242"></a><span class="co">#| eval: false</span></span>
<span id="cb36-243"><a href="#cb36-243"></a></span>
<span id="cb36-244"><a href="#cb36-244"></a><span class="co"># Update Model 2 to include Historical Context in the Conditional Model</span></span>
<span id="cb36-245"><a href="#cb36-245"></a><span class="co"># - Rainfall Moving Average (7-day)</span></span>
<span id="cb36-246"><a href="#cb36-246"></a><span class="co"># - Days Since Last Rain (Drought effect)</span></span>
<span id="cb36-247"><a href="#cb36-247"></a><span class="co"># - Humidity Moving Average (7-day)</span></span>
<span id="cb36-248"><a href="#cb36-248"></a><span class="co"># - Rain Yesterday (Persistence on Intensity)</span></span>
<span id="cb36-249"><a href="#cb36-249"></a>m3_history <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb36-250"><a href="#cb36-250"></a>  m2_temporal,</span>
<span id="cb36-251"><a href="#cb36-251"></a>  . <span class="sc">~</span> . <span class="sc">+</span> rainfall_ma7 <span class="sc">+</span> days_since_rain <span class="sc">+</span> humidity_ma7 <span class="sc">+</span> rain_yesterday,</span>
<span id="cb36-252"><a href="#cb36-252"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb36-253"><a href="#cb36-253"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb36-254"><a href="#cb36-254"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb36-255"><a href="#cb36-255"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb36-256"><a href="#cb36-256"></a>    pressure_change</span>
<span id="cb36-257"><a href="#cb36-257"></a>)</span>
<span id="cb36-258"><a href="#cb36-258"></a><span class="in">```</span></span>
<span id="cb36-259"><a href="#cb36-259"></a></span>
<span id="cb36-262"><a href="#cb36-262"></a><span class="in">```{r}</span></span>
<span id="cb36-263"><a href="#cb36-263"></a><span class="co">#| label: m3-history-output</span></span>
<span id="cb36-264"><a href="#cb36-264"></a><span class="co">#| echo: false</span></span>
<span id="cb36-265"><a href="#cb36-265"></a></span>
<span id="cb36-266"><a href="#cb36-266"></a>m3_history <span class="sc">%&gt;%</span></span>
<span id="cb36-267"><a href="#cb36-267"></a>  <span class="fu">tbl_regression</span>(</span>
<span id="cb36-268"><a href="#cb36-268"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-269"><a href="#cb36-269"></a>    <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb36-270"><a href="#cb36-270"></a>      rainfall_ma7 <span class="sc">~</span> <span class="st">"Rainfall Trend (7-Day MA)"</span>,</span>
<span id="cb36-271"><a href="#cb36-271"></a>      humidity_ma7 <span class="sc">~</span> <span class="st">"Humidity Trend (7-Day MA)"</span>,</span>
<span id="cb36-272"><a href="#cb36-272"></a>      days_since_rain <span class="sc">~</span> <span class="st">"Dry Spell Length (Days)"</span>,</span>
<span id="cb36-273"><a href="#cb36-273"></a>      rain_yesterday <span class="sc">~</span> <span class="st">"Rain Yesterday (Indicator)"</span></span>
<span id="cb36-274"><a href="#cb36-274"></a>    )</span>
<span id="cb36-275"><a href="#cb36-275"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-276"><a href="#cb36-276"></a>  <span class="fu">bold_p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-277"><a href="#cb36-277"></a>  <span class="fu">add_glance_table</span>(<span class="at">include =</span> <span class="fu">c</span>(<span class="st">"AIC"</span>, <span class="st">"BIC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-278"><a href="#cb36-278"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Predictor**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-279"><a href="#cb36-279"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Model 3: Historical Trends &amp; Lagged Effects**"</span>)</span>
<span id="cb36-280"><a href="#cb36-280"></a><span class="in">```</span></span>
<span id="cb36-281"><a href="#cb36-281"></a></span>
<span id="cb36-282"><a href="#cb36-282"></a>"Model 3" integrates the final layer of complexity: **history**. While Model 2 accounted for *when* we are (seasonality), Model 3 accounts for *what just happened* (recent weather trends). We hypothesize that the intensity of today's rain is conditionally dependent on the saturation of the ground and atmosphere over the past week.</span>
<span id="cb36-283"><a href="#cb36-283"></a></span>
<span id="cb36-284"><a href="#cb36-284"></a>**1. Performance Improvement:**</span>
<span id="cb36-285"><a href="#cb36-285"></a></span>
<span id="cb36-286"><a href="#cb36-286"></a><span class="ss">-   </span>**AIC Reduction:** The AIC improved to **404,936.2**, down from 406,659.3 (M2).</span>
<span id="cb36-287"><a href="#cb36-287"></a></span>
<span id="cb36-288"><a href="#cb36-288"></a><span class="ss">-   </span>**Significance:** This reduction ($\Delta AIC \approx 1,723$) indicates that adding historical moving averages improves the model, though with diminishing returns compared to the massive leaps seen in Models 1 and 2.</span>
<span id="cb36-289"><a href="#cb36-289"></a></span>
<span id="cb36-290"><a href="#cb36-290"></a>**2. Conditional Model (Rainfall Intensity):**</span>
<span id="cb36-291"><a href="#cb36-291"></a></span>
<span id="cb36-292"><a href="#cb36-292"></a><span class="ss">-   </span>**Persistence of Intensity (`rain_yesterday`):** The coefficient is positive ($\beta = 0.31, p &lt; 0.001$). This implies that if it rained yesterday, today's rainfall is likely to be **\~37% more intense** ($e^{0.31} \approx 1.36$). Wet weather systems tend to be "heavy" and sustained.</span>
<span id="cb36-293"><a href="#cb36-293"></a></span>
<span id="cb36-294"><a href="#cb36-294"></a><span class="ss">-   </span>**Accumulated Wetness (`rainfall_ma7`):** The positive coefficient ($\beta = 0.13$) confirms that a wetter preceding week correlates with heavier rainfall today, likely due to deep atmospheric moisture saturation.</span>
<span id="cb36-295"><a href="#cb36-295"></a></span>
<span id="cb36-296"><a href="#cb36-296"></a><span class="ss">-   </span>**The "Drizzle" Effect (`humidity_ma7`):** Interestingly, the 7-day humidity average has a *negative* coefficient ($\beta = -0.10$). Once we control for *today's* humidity (which is positive), a persistently humid week might indicate stable, low-intensity stratiform clouds (drizzle) rather than the explosive instability required for heavy convective storms.</span>
<span id="cb36-297"><a href="#cb36-297"></a></span>
<span id="cb36-298"><a href="#cb36-298"></a><span class="ss">-   </span>**Drought Effect (`days_since_rain`):** This variable is **not significant** ($p = 0.14$) for intensity. While our dry spell analysis showed it strongly predicts *whether* it rains (Zero-Inflation), it does not appear to influence *how much* it rains once the dry spell breaks.</span>
<span id="cb36-299"><a href="#cb36-299"></a></span>
<span id="cb36-300"><a href="#cb36-300"></a>**3. Zero-Inflation Model:**</span>
<span id="cb36-301"><a href="#cb36-301"></a></span>
<span id="cb36-302"><a href="#cb36-302"></a><span class="ss">-   </span>The coefficients remain robust and nearly identical to Model 2, reaffirming that <span class="in">`rain_yesterday`</span> ($\beta = -1.42$) is the dominant driver of the state change from "Dry" to "Wet."</span>
<span id="cb36-303"><a href="#cb36-303"></a></span>
<span id="cb36-304"><a href="#cb36-304"></a><span class="fu">## Energy Dynamics and Interactions</span></span>
<span id="cb36-305"><a href="#cb36-305"></a></span>
<span id="cb36-308"><a href="#cb36-308"></a><span class="in">```{r}</span></span>
<span id="cb36-309"><a href="#cb36-309"></a><span class="co">#| label: m4-energy-code</span></span>
<span id="cb36-310"><a href="#cb36-310"></a><span class="co">#| echo: true</span></span>
<span id="cb36-311"><a href="#cb36-311"></a><span class="co">#| eval: false</span></span>
<span id="cb36-312"><a href="#cb36-312"></a></span>
<span id="cb36-313"><a href="#cb36-313"></a><span class="co"># Update Model 3 to include Energy Dynamics and Interactions</span></span>
<span id="cb36-314"><a href="#cb36-314"></a><span class="co"># - Sunshine &amp; Evaporation (Energy Input)</span></span>
<span id="cb36-315"><a href="#cb36-315"></a><span class="co"># - Instability Index (Atmospheric Dynamics)</span></span>
<span id="cb36-316"><a href="#cb36-316"></a><span class="co"># - The "Rain Corner" Interaction (Sunshine * Humidity)</span></span>
<span id="cb36-317"><a href="#cb36-317"></a><span class="co"># - Cloud Development (Diurnal Change)</span></span>
<span id="cb36-318"><a href="#cb36-318"></a>m4_energy <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb36-319"><a href="#cb36-319"></a>  m3_history,</span>
<span id="cb36-320"><a href="#cb36-320"></a>  . <span class="sc">~</span> . <span class="sc">+</span></span>
<span id="cb36-321"><a href="#cb36-321"></a>    sunshine <span class="sc">+</span></span>
<span id="cb36-322"><a href="#cb36-322"></a>    evaporation <span class="sc">+</span></span>
<span id="cb36-323"><a href="#cb36-323"></a>    instability_index <span class="sc">+</span></span>
<span id="cb36-324"><a href="#cb36-324"></a>    sun_humid_interaction <span class="sc">+</span></span>
<span id="cb36-325"><a href="#cb36-325"></a>    cloud_development,</span>
<span id="cb36-326"><a href="#cb36-326"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb36-327"><a href="#cb36-327"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb36-328"><a href="#cb36-328"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb36-329"><a href="#cb36-329"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb36-330"><a href="#cb36-330"></a>    pressure_change</span>
<span id="cb36-331"><a href="#cb36-331"></a>)</span>
<span id="cb36-332"><a href="#cb36-332"></a><span class="in">```</span></span>
<span id="cb36-333"><a href="#cb36-333"></a></span>
<span id="cb36-336"><a href="#cb36-336"></a><span class="in">```{r}</span></span>
<span id="cb36-337"><a href="#cb36-337"></a><span class="co">#| label: m4-energy-output</span></span>
<span id="cb36-338"><a href="#cb36-338"></a><span class="co">#| echo: false</span></span>
<span id="cb36-339"><a href="#cb36-339"></a></span>
<span id="cb36-340"><a href="#cb36-340"></a>m4_energy <span class="sc">%&gt;%</span></span>
<span id="cb36-341"><a href="#cb36-341"></a>  <span class="fu">tbl_regression</span>(</span>
<span id="cb36-342"><a href="#cb36-342"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-343"><a href="#cb36-343"></a>    <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb36-344"><a href="#cb36-344"></a>      sunshine <span class="sc">~</span> <span class="st">"Sunshine Duration (Hours)"</span>,</span>
<span id="cb36-345"><a href="#cb36-345"></a>      evaporation <span class="sc">~</span> <span class="st">"Evaporation Rate"</span>,</span>
<span id="cb36-346"><a href="#cb36-346"></a>      instability_index <span class="sc">~</span> <span class="st">"Instability Index (Derived)"</span>,</span>
<span id="cb36-347"><a href="#cb36-347"></a>      sun_humid_interaction <span class="sc">~</span> <span class="st">"Interaction: Sun * Humid"</span>,</span>
<span id="cb36-348"><a href="#cb36-348"></a>      cloud_development <span class="sc">~</span> <span class="st">"Cloud Development (Delta)"</span></span>
<span id="cb36-349"><a href="#cb36-349"></a>    )</span>
<span id="cb36-350"><a href="#cb36-350"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-351"><a href="#cb36-351"></a>  <span class="fu">bold_p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-352"><a href="#cb36-352"></a>  <span class="fu">add_glance_table</span>(<span class="at">include =</span> <span class="fu">c</span>(<span class="st">"AIC"</span>, <span class="st">"BIC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-353"><a href="#cb36-353"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Predictor**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-354"><a href="#cb36-354"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Model 4: Thermodynamic Energy &amp; Interactions**"</span>)</span>
<span id="cb36-355"><a href="#cb36-355"></a><span class="in">```</span></span>
<span id="cb36-356"><a href="#cb36-356"></a></span>
<span id="cb36-357"><a href="#cb36-357"></a>"Model 4" represents the full complexity of our meteorological hypothesis. Beyond moisture and history, we now incorporate **energy dynamics** (solar radiation, evaporation) and **atmospheric instability**. Crucially, we test the interaction term derived in the previous section to capture the non-linear "Rain Corner" effect.</span>
<span id="cb36-358"><a href="#cb36-358"></a></span>
<span id="cb36-359"><a href="#cb36-359"></a>**1. Performance Improvement:**</span>
<span id="cb36-360"><a href="#cb36-360"></a></span>
<span id="cb36-361"><a href="#cb36-361"></a><span class="ss">-   </span>**AIC Reduction:** The AIC dropped to **403,051.8**.</span>
<span id="cb36-362"><a href="#cb36-362"></a></span>
<span id="cb36-363"><a href="#cb36-363"></a><span class="ss">-   </span>**Significance:** The reduction of $\Delta AIC \approx 1,884$ compared to Model 3 confirms that including energy dynamics provides a statistically significant improvement in model fit.</span>
<span id="cb36-364"><a href="#cb36-364"></a></span>
<span id="cb36-365"><a href="#cb36-365"></a>**2. Conditional Model (Rainfall Intensity):**</span>
<span id="cb36-366"><a href="#cb36-366"></a></span>
<span id="cb36-367"><a href="#cb36-367"></a><span class="ss">-   </span>**The "Rain Corner" Interaction:** The <span class="in">`sun_humid_interaction`</span> term is highly significant ($\beta = -0.08, p &lt; 0.001$).</span>
<span id="cb36-368"><a href="#cb36-368"></a></span>
<span id="cb36-369"><a href="#cb36-369"></a><span class="ss">-   </span>**Interpretation:** The negative coefficient confirms the "corner" geometry. As sunshine increases, the positive effect of humidity on rainfall intensity is dampening. Conversely, the heaviest rain occurs when humidity is high *and* sunshine is low (deep cloud cover).</span>
<span id="cb36-370"><a href="#cb36-370"></a></span>
<span id="cb36-371"><a href="#cb36-371"></a><span class="ss">-   </span>**Instability:** The <span class="in">`instability_index`</span> has a strong positive effect ($\beta = 0.19$). This confirms that low-pressure, high-humidity systems (convective instability) produce significantly heavier rainfall than stable systems.</span>
<span id="cb36-372"><a href="#cb36-372"></a></span>
<span id="cb36-373"><a href="#cb36-373"></a><span class="ss">-   </span>**Evaporation:** Surprisingly, `evaporation` has a positive coefficient ($\beta = 0.19$). While high evaporation typically implies dry heat, in the context of a wet day, it likely serves as a proxy for the **available energy** (latent heat) in the system that fuels storm development.</span>
<span id="cb36-374"><a href="#cb36-374"></a></span>
<span id="cb36-375"><a href="#cb36-375"></a><span class="ss">-   </span>**Sunshine:** As expected, <span class="in">`sunshine`</span> has a negative effect ($\beta = -0.07$) on intensity. Even if it rains on a sunny day (e.g., a brief shower), the intensity is lower compared to a fully overcast day.</span>
<span id="cb36-376"><a href="#cb36-376"></a></span>
<span id="cb36-377"><a href="#cb36-377"></a>**3. Shift in Humidity Importance:** Notice that the coefficient for `humidity3pm` dropped drastically from **0.39** (Model 3) to **0.08** (Model 4).</span>
<span id="cb36-378"><a href="#cb36-378"></a></span>
<span id="cb36-379"><a href="#cb36-379"></a><span class="ss">-   </span>**Explanation:** This does *not* mean humidity is less important. Rather, the variance previously attributed to raw "humidity" has now been correctly partitioned into more specific physical processes: `instability_index` (pressure-humidity interaction) and `sun_humid_interaction`. The model now understands *why* humidity matters.</span>
<span id="cb36-380"><a href="#cb36-380"></a></span>
<span id="cb36-381"><a href="#cb36-381"></a><span class="fu">## Wind Dynamics</span></span>
<span id="cb36-382"><a href="#cb36-382"></a></span>
<span id="cb36-385"><a href="#cb36-385"></a><span class="in">```{r}</span></span>
<span id="cb36-386"><a href="#cb36-386"></a><span class="co">#| label: m5-wind-code</span></span>
<span id="cb36-387"><a href="#cb36-387"></a><span class="co">#| echo: true</span></span>
<span id="cb36-388"><a href="#cb36-388"></a><span class="co">#| eval: false</span></span>
<span id="cb36-389"><a href="#cb36-389"></a></span>
<span id="cb36-390"><a href="#cb36-390"></a><span class="co"># Update Model 4 to include Circular Wind Vectors</span></span>
<span id="cb36-391"><a href="#cb36-391"></a><span class="co"># - Gust U (East-West) and V (North-South) components</span></span>
<span id="cb36-392"><a href="#cb36-392"></a><span class="co"># - 9am Wind U and V components (Morning wind direction)</span></span>
<span id="cb36-393"><a href="#cb36-393"></a>m5_wind <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb36-394"><a href="#cb36-394"></a>  m4_energy,</span>
<span id="cb36-395"><a href="#cb36-395"></a>  . <span class="sc">~</span> . <span class="sc">+</span> gust_U_EW <span class="sc">+</span> gust_V_NS <span class="sc">+</span> wind9am_V_NS <span class="sc">+</span> wind9am_U_EW,</span>
<span id="cb36-396"><a href="#cb36-396"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb36-397"><a href="#cb36-397"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb36-398"><a href="#cb36-398"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb36-399"><a href="#cb36-399"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb36-400"><a href="#cb36-400"></a>    pressure_change</span>
<span id="cb36-401"><a href="#cb36-401"></a>)</span>
<span id="cb36-402"><a href="#cb36-402"></a><span class="in">```</span></span>
<span id="cb36-403"><a href="#cb36-403"></a></span>
<span id="cb36-406"><a href="#cb36-406"></a><span class="in">```{r}</span></span>
<span id="cb36-407"><a href="#cb36-407"></a><span class="co">#| label: m5-wind-output</span></span>
<span id="cb36-408"><a href="#cb36-408"></a><span class="co">#| echo: false</span></span>
<span id="cb36-409"><a href="#cb36-409"></a></span>
<span id="cb36-410"><a href="#cb36-410"></a>m5_wind <span class="sc">%&gt;%</span></span>
<span id="cb36-411"><a href="#cb36-411"></a>  <span class="fu">tbl_regression</span>(</span>
<span id="cb36-412"><a href="#cb36-412"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-413"><a href="#cb36-413"></a>    <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb36-414"><a href="#cb36-414"></a>      gust_U_EW <span class="sc">~</span> <span class="st">"Gust Vector (East-West)"</span>,</span>
<span id="cb36-415"><a href="#cb36-415"></a>      gust_V_NS <span class="sc">~</span> <span class="st">"Gust Vector (North-South)"</span>,</span>
<span id="cb36-416"><a href="#cb36-416"></a>      wind9am_U_EW <span class="sc">~</span> <span class="st">"Wind 9am Vector (East-West)"</span>,</span>
<span id="cb36-417"><a href="#cb36-417"></a>      wind9am_V_NS <span class="sc">~</span> <span class="st">"Wind 9am Vector (North-South)"</span></span>
<span id="cb36-418"><a href="#cb36-418"></a>    )</span>
<span id="cb36-419"><a href="#cb36-419"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-420"><a href="#cb36-420"></a>  <span class="fu">bold_p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-421"><a href="#cb36-421"></a>  <span class="fu">add_glance_table</span>(<span class="at">include =</span> <span class="fu">c</span>(<span class="st">"AIC"</span>, <span class="st">"BIC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-422"><a href="#cb36-422"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Predictor**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-423"><a href="#cb36-423"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Model 5: Wind Vector Dynamics**"</span>)</span>
<span id="cb36-424"><a href="#cb36-424"></a><span class="in">```</span></span>
<span id="cb36-425"><a href="#cb36-425"></a></span>
<span id="cb36-426"><a href="#cb36-426"></a>"Model 5" introduces the final physical layer: **Wind Vector Decomposition**. By decomposing wind direction into North-South ($V$) and East-West ($U$) components, we test the hypothesis that specific airflow origins (e.g., moisture-laden ocean winds vs. dry desert winds) drive rainfall intensity.</span>
<span id="cb36-427"><a href="#cb36-427"></a></span>
<span id="cb36-428"><a href="#cb36-428"></a>**1. Performance Improvement:**</span>
<span id="cb36-429"><a href="#cb36-429"></a></span>
<span id="cb36-430"><a href="#cb36-430"></a><span class="ss">-   </span>**AIC Reduction:** The AIC dropped to **402,452.7** from 403,051.8 (M4).</span>
<span id="cb36-431"><a href="#cb36-431"></a></span>
<span id="cb36-432"><a href="#cb36-432"></a><span class="ss">-   </span>**Significance:** The decrease of $\Delta AIC \approx 600$ is smaller than previous steps but still highly statistically significant, confirming that wind direction adds unique information not captured by pressure or season alone.</span>
<span id="cb36-433"><a href="#cb36-433"></a></span>
<span id="cb36-434"><a href="#cb36-434"></a>**2. Conditional Model (Rainfall Intensity):** All wind vector components are statistically significant ($p &lt; 0.001$), and their signs reveal a clear physical story consistent with Australian climatology:</span>
<span id="cb36-435"><a href="#cb36-435"></a></span>
<span id="cb36-436"><a href="#cb36-436"></a><span class="ss">-   </span>**North-South Vector (`wind9am_V_NS`):** The coefficient is **-0.088**.</span>
<span id="cb36-437"><a href="#cb36-437"></a><span class="ss">    -   </span>*Mathematical interpretation:* Since $V &gt; 0$ represents North (winds from the interior/equator) and $V &lt; 0$ represents South (winds from the ocean), a **negative coefficient** implies that **Southerly winds (negative V)** increase rainfall intensity.</span>
<span id="cb36-438"><a href="#cb36-438"></a><span class="ss">    -   </span>*Physical validation:* This aligns perfectly with Australian geography, where "Southerly Busters" and fronts from the Southern Ocean bring cold, heavy rain, while Northerly winds typically bring dry heat from the desert interior.</span>
<span id="cb36-439"><a href="#cb36-439"></a><span class="ss">-   </span>**East-West Vector (`wind9am_U_EW`):** The coefficient is **-0.085**.</span>
<span id="cb36-440"><a href="#cb36-440"></a><span class="ss">    -   </span>*Interpretation:* A negative coefficient implies that **Westerly winds (negative U)** increase rainfall.</span>
<span id="cb36-441"><a href="#cb36-441"></a><span class="ss">    -   </span>*Physical validation:* This captures the "Roaring Forties" and the prevailing Westerlies that bring frontal rain systems to the southern continent.</span>
<span id="cb36-442"><a href="#cb36-442"></a><span class="ss">-   </span>**Gusts vs. Sustained Wind:** The morning winds (`wind9am`) have coefficients roughly 3-4x larger than the gust components (`gust_U/V`, $\beta \approx -0.02$). This suggests that the **prevailing air mass direction** (advection) is more important for determining rainfall volume than the localized turbulence of wind gusts.</span>
<span id="cb36-443"><a href="#cb36-443"></a></span>
<span id="cb36-444"><a href="#cb36-444"></a>**3. Model Stability:** Crucially, the coefficients for previous drivers (Humidity, Instability, Seasonality) remained stable. This indicates that our Wind Vectors are **orthogonal predictors**; they explain *new* variance rather than stealing explanatory power from existing features.</span>
<span id="cb36-445"><a href="#cb36-445"></a></span>
<span id="cb36-446"><a href="#cb36-446"></a><span class="fu">## Spatial Heterogenity (Mixed Effects)</span></span>
<span id="cb36-447"><a href="#cb36-447"></a></span>
<span id="cb36-450"><a href="#cb36-450"></a><span class="in">```{r}</span></span>
<span id="cb36-451"><a href="#cb36-451"></a><span class="co">#| label: m6-mixed-code</span></span>
<span id="cb36-452"><a href="#cb36-452"></a><span class="co">#| echo: true</span></span>
<span id="cb36-453"><a href="#cb36-453"></a><span class="co">#| eval: false</span></span>
<span id="cb36-454"><a href="#cb36-454"></a></span>
<span id="cb36-455"><a href="#cb36-455"></a><span class="co"># We explicitly keep 'location' to serve as the grouping factor</span></span>
<span id="cb36-456"><a href="#cb36-456"></a>re_data <span class="ot">&lt;-</span> <span class="fu">select_model_features</span>(df_final, <span class="at">keep_location =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-457"><a href="#cb36-457"></a>  <span class="fu">scale_data</span>()</span>
<span id="cb36-458"><a href="#cb36-458"></a></span>
<span id="cb36-459"><a href="#cb36-459"></a><span class="co"># Define Optimizer Control</span></span>
<span id="cb36-460"><a href="#cb36-460"></a><span class="co"># BFGS optimizer is selected for better convergence on complex GLMM surfaces</span></span>
<span id="cb36-461"><a href="#cb36-461"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">glmmTMBControl</span>(</span>
<span id="cb36-462"><a href="#cb36-462"></a>  <span class="at">optimizer =</span> optim,</span>
<span id="cb36-463"><a href="#cb36-463"></a>  <span class="at">optArgs =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">"BFGS"</span>),</span>
<span id="cb36-464"><a href="#cb36-464"></a>  <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxit =</span> <span class="dv">1000</span>)</span>
<span id="cb36-465"><a href="#cb36-465"></a>)</span>
<span id="cb36-466"><a href="#cb36-466"></a></span>
<span id="cb36-467"><a href="#cb36-467"></a><span class="co"># 3. Fit Zero-Inflated Gamma Mixed Model</span></span>
<span id="cb36-468"><a href="#cb36-468"></a><span class="co"># - Random Intercepts: (1 | location) -&gt; Baseline rainfall varies by city</span></span>
<span id="cb36-469"><a href="#cb36-469"></a><span class="co"># - Random Slopes: (humidity + rain_yesterday... | location) -&gt; The *effect* of these drivers varies by city</span></span>
<span id="cb36-470"><a href="#cb36-470"></a>m6_mixed <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb36-471"><a href="#cb36-471"></a>  rainfall <span class="sc">~</span></span>
<span id="cb36-472"><a href="#cb36-472"></a>    humidity3pm <span class="sc">+</span></span>
<span id="cb36-473"><a href="#cb36-473"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb36-474"><a href="#cb36-474"></a>    dewpoint_change <span class="sc">+</span></span>
<span id="cb36-475"><a href="#cb36-475"></a>    pressure_change <span class="sc">+</span></span>
<span id="cb36-476"><a href="#cb36-476"></a>    day_cos <span class="sc">+</span></span>
<span id="cb36-477"><a href="#cb36-477"></a>    day_sin <span class="sc">+</span></span>
<span id="cb36-478"><a href="#cb36-478"></a>    rainfall_ma7 <span class="sc">+</span></span>
<span id="cb36-479"><a href="#cb36-479"></a>    days_since_rain <span class="sc">+</span></span>
<span id="cb36-480"><a href="#cb36-480"></a>    humidity_ma7 <span class="sc">+</span></span>
<span id="cb36-481"><a href="#cb36-481"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb36-482"><a href="#cb36-482"></a>    sunshine <span class="sc">+</span></span>
<span id="cb36-483"><a href="#cb36-483"></a>    evaporation <span class="sc">+</span></span>
<span id="cb36-484"><a href="#cb36-484"></a>    instability_index <span class="sc">+</span></span>
<span id="cb36-485"><a href="#cb36-485"></a>    sun_humid_interaction <span class="sc">+</span></span>
<span id="cb36-486"><a href="#cb36-486"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb36-487"><a href="#cb36-487"></a>    gust_U_EW <span class="sc">+</span></span>
<span id="cb36-488"><a href="#cb36-488"></a>    gust_V_NS <span class="sc">+</span></span>
<span id="cb36-489"><a href="#cb36-489"></a>    wind9am_V_NS <span class="sc">+</span></span>
<span id="cb36-490"><a href="#cb36-490"></a>    wind9am_U_EW <span class="sc">+</span></span>
<span id="cb36-491"><a href="#cb36-491"></a>    <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">+</span> humidity3pm <span class="sc">+</span> rain_yesterday <span class="sc">+</span> dewpoint_change <span class="sc">|</span> location),</span>
<span id="cb36-492"><a href="#cb36-492"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb36-493"><a href="#cb36-493"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb36-494"><a href="#cb36-494"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb36-495"><a href="#cb36-495"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb36-496"><a href="#cb36-496"></a>    pressure_change <span class="sc">+</span></span>
<span id="cb36-497"><a href="#cb36-497"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb36-498"><a href="#cb36-498"></a>    sunshine <span class="sc">+</span></span>
<span id="cb36-499"><a href="#cb36-499"></a>    evaporation <span class="sc">+</span></span>
<span id="cb36-500"><a href="#cb36-500"></a>    <span class="fu">ns</span>(days_since_rain, <span class="at">df =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb36-501"><a href="#cb36-501"></a>    humidity_ma7 <span class="sc">+</span></span>
<span id="cb36-502"><a href="#cb36-502"></a>    day_cos <span class="sc">+</span></span>
<span id="cb36-503"><a href="#cb36-503"></a>    day_sin,</span>
<span id="cb36-504"><a href="#cb36-504"></a>  <span class="at">data =</span> re_data,</span>
<span id="cb36-505"><a href="#cb36-505"></a>  <span class="at">control =</span> ctrl,</span>
<span id="cb36-506"><a href="#cb36-506"></a>  <span class="at">family =</span> <span class="fu">ziGamma</span>(<span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb36-507"><a href="#cb36-507"></a>)</span>
<span id="cb36-508"><a href="#cb36-508"></a><span class="in">```</span></span>
<span id="cb36-509"><a href="#cb36-509"></a></span>
<span id="cb36-512"><a href="#cb36-512"></a><span class="in">```{r}</span></span>
<span id="cb36-513"><a href="#cb36-513"></a><span class="co">#| label: m6-mixed-output</span></span>
<span id="cb36-514"><a href="#cb36-514"></a><span class="co">#| echo: false</span></span>
<span id="cb36-515"><a href="#cb36-515"></a></span>
<span id="cb36-516"><a href="#cb36-516"></a>m6_mixed <span class="sc">%&gt;%</span></span>
<span id="cb36-517"><a href="#cb36-517"></a>  <span class="fu">tbl_regression</span>(</span>
<span id="cb36-518"><a href="#cb36-518"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-519"><a href="#cb36-519"></a>    <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb36-520"><a href="#cb36-520"></a>      <span class="co"># Core Dynamics</span></span>
<span id="cb36-521"><a href="#cb36-521"></a>      humidity3pm <span class="sc">~</span> <span class="st">"Humidity (3pm)"</span>,</span>
<span id="cb36-522"><a href="#cb36-522"></a>      sunshine <span class="sc">~</span> <span class="st">"Sunshine Duration"</span>,</span>
<span id="cb36-523"><a href="#cb36-523"></a>      sun_humid_interaction <span class="sc">~</span> <span class="st">"Interaction: Sun * Humid"</span>,</span>
<span id="cb36-524"><a href="#cb36-524"></a></span>
<span id="cb36-525"><a href="#cb36-525"></a>      <span class="co"># Persistence &amp; History</span></span>
<span id="cb36-526"><a href="#cb36-526"></a>      rainfall_ma7 <span class="sc">~</span> <span class="st">"Rainfall Trend (7-Day MA)"</span>,</span>
<span id="cb36-527"><a href="#cb36-527"></a>      days_since_rain <span class="sc">~</span> <span class="st">"Dry Spell Length (Linear)"</span>,</span>
<span id="cb36-528"><a href="#cb36-528"></a>      <span class="st">`</span><span class="at">ns(days_since_rain, df = 4)</span><span class="st">`</span> <span class="sc">~</span> <span class="st">"Dry Spell (Non-Linear Spline)"</span>,</span>
<span id="cb36-529"><a href="#cb36-529"></a>      rain_yesterday <span class="sc">~</span> <span class="st">"Rain Yesterday (Indicator)"</span>,</span>
<span id="cb36-530"><a href="#cb36-530"></a></span>
<span id="cb36-531"><a href="#cb36-531"></a>      <span class="co"># Physics &amp; Wind</span></span>
<span id="cb36-532"><a href="#cb36-532"></a>      gust_U_EW <span class="sc">~</span> <span class="st">"Gust Vector (East-West)"</span>,</span>
<span id="cb36-533"><a href="#cb36-533"></a>      gust_V_NS <span class="sc">~</span> <span class="st">"Gust Vector (North-South)"</span>,</span>
<span id="cb36-534"><a href="#cb36-534"></a>      instability_index <span class="sc">~</span> <span class="st">"Instability Index"</span>,</span>
<span id="cb36-535"><a href="#cb36-535"></a></span>
<span id="cb36-536"><a href="#cb36-536"></a>      <span class="co"># Seasonality</span></span>
<span id="cb36-537"><a href="#cb36-537"></a>      day_cos <span class="sc">~</span> <span class="st">"Seasonality (Cos)"</span>,</span>
<span id="cb36-538"><a href="#cb36-538"></a>      day_sin <span class="sc">~</span> <span class="st">"Seasonality (Sin)"</span></span>
<span id="cb36-539"><a href="#cb36-539"></a>    )</span>
<span id="cb36-540"><a href="#cb36-540"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-541"><a href="#cb36-541"></a>  <span class="fu">bold_p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-542"><a href="#cb36-542"></a>  <span class="fu">add_glance_table</span>(<span class="at">include =</span> <span class="fu">c</span>(<span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"logLik"</span>, <span class="st">"nobs"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-543"><a href="#cb36-543"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Predictor**"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-544"><a href="#cb36-544"></a>  <span class="fu">modify_caption</span>(</span>
<span id="cb36-545"><a href="#cb36-545"></a>    <span class="st">"**Model 6: The Final Mixed-Effects Model (Random Slopes)**"</span></span>
<span id="cb36-546"><a href="#cb36-546"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-547"><a href="#cb36-547"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-548"><a href="#cb36-548"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(</span>
<span id="cb36-549"><a href="#cb36-549"></a>    <span class="at">footnote =</span> <span class="st">"Random Effects Structure: Uncorrelated random slopes for Humidity, Persistence, and Dewpoint by Location."</span></span>
<span id="cb36-550"><a href="#cb36-550"></a>  )</span>
<span id="cb36-551"><a href="#cb36-551"></a><span class="in">```</span></span>
<span id="cb36-552"><a href="#cb36-552"></a></span>
<span id="cb36-553"><a href="#cb36-553"></a>The final stage of our modeling strategy addresses the hierarchical nature of the data. Meteorological phenomena are not spatially uniform; the physics of rainfall in a tropical city like Cairns differs from that in an arid city like Alice Springs. To capture this, "Model 6" introduces **Random Effects**, allowing the model parameters to vary by <span class="in">`location`</span>.</span>
<span id="cb36-554"><a href="#cb36-554"></a></span>
<span id="cb36-555"><a href="#cb36-555"></a>**1. Performance Improvement:**</span>
<span id="cb36-556"><a href="#cb36-556"></a></span>
<span id="cb36-557"><a href="#cb36-557"></a><span class="ss">-   </span>**AIC Reduction:** The AIC plummeted to **394,854.0**.</span>
<span id="cb36-558"><a href="#cb36-558"></a></span>
<span id="cb36-559"><a href="#cb36-559"></a><span class="ss">-   </span>**Significance:** This represents a massive improvement ($\Delta AIC \approx 7,599$) over the best fixed-effects model (M5). This confirms that **spatial heterogeneity** is a dominant source of variance. A global "one-size-fits-all" model is insufficient for continental-scale weather prediction.</span>
<span id="cb36-560"><a href="#cb36-560"></a></span>
<span id="cb36-561"><a href="#cb36-561"></a>**2. Random Effects Structure (Variance Components):** We incorporated random intercepts and random slopes for key drivers. The estimated variances reveal significant local differences:</span>
<span id="cb36-562"><a href="#cb36-562"></a></span>
<span id="cb36-563"><a href="#cb36-563"></a><span class="ss">-   </span>**Random Intercepts (**$\sigma^2 = 0.12$): Baseline rainfall intensity varies significantly between locations, confirming that local geography sets the "default" weather state.</span>
<span id="cb36-564"><a href="#cb36-564"></a></span>
<span id="cb36-565"><a href="#cb36-565"></a><span class="ss">-   </span>**Random Slope - Humidity (**$\sigma^2 = 0.023$): The effect of humidity on rainfall is not constant. In some locations, a small increase in humidity triggers rain (high sensitivity), while in others, the atmosphere requires much higher saturation (low sensitivity).</span>
<span id="cb36-566"><a href="#cb36-566"></a></span>
<span id="cb36-567"><a href="#cb36-567"></a><span class="ss">-   </span>**Random Slope - Persistence (**$\sigma^2 = 0.013$): The "stickiness" of wet weather (<span class="in">`rain_yesterday`</span>) varies spatially, likely driven by the difference between stagnation-prone valleys and wind-swept coastal plains.</span>
<span id="cb36-568"><a href="#cb36-568"></a></span>
<span id="cb36-569"><a href="#cb36-569"></a>**3. Fixed Effects Stability:** Despite allowing for local variation, the global fixed effects (Wind Vectors, Instability, Interactions) remained highly significant.</span>
<span id="cb36-570"><a href="#cb36-570"></a></span>
<span id="cb36-571"><a href="#cb36-571"></a><span class="ss">-   </span>**Wind Vectors:** Both <span class="in">`wind9am_V_NS`</span> ($\beta = -0.086$) and <span class="in">`wind9am_U_EW`</span> ($\beta = -0.064$) retained their negative coefficients. This proves that the influence of Southerly and Westerly winds is a robust, continent-wide driver, not an artifact of a few specific locations.</span>
<span id="cb36-572"><a href="#cb36-572"></a></span>
<span id="cb36-573"><a href="#cb36-573"></a><span class="ss">-   </span>**The "Rain Corner":** The interaction term <span class="in">`sun_humid_interaction`</span> ($\beta = -0.067$) remains significant, validating the non-linear relationship between energy and moisture across all Australian climates.</span>
<span id="cb36-574"><a href="#cb36-574"></a></span>
<span id="cb36-575"><a href="#cb36-575"></a>**4. Zero-Inflation &amp; Splines:**</span>
<span id="cb36-576"><a href="#cb36-576"></a></span>
<span id="cb36-577"><a href="#cb36-577"></a><span class="ss">-   </span>The inclusion of **Natural Splines** (<span class="in">`ns(days_since_rain, df=4)`</span>) in the zero-inflation formula allows the probability of a dry spell ending to vary non-linearly over time. The significance of the second spline term ($p = 0.018$) suggests that the "drying effect" is not a simple linear decay, capturing the complex "kink" observed in our dry spell survival plots.</span>
<span id="cb36-578"><a href="#cb36-578"></a></span>
<span id="cb36-579"><a href="#cb36-579"></a><span class="fu"># Model Evaluation</span></span>
<span id="cb36-580"><a href="#cb36-580"></a></span>
<span id="cb36-581"><a href="#cb36-581"></a><span class="fu">## Classification Performance Evaluation</span></span>
<span id="cb36-582"><a href="#cb36-582"></a></span>
<span id="cb36-585"><a href="#cb36-585"></a><span class="in">```{r}</span></span>
<span id="cb36-586"><a href="#cb36-586"></a><span class="co">#| label: model-evaluation</span></span>
<span id="cb36-587"><a href="#cb36-587"></a><span class="co">#| echo: true</span></span>
<span id="cb36-588"><a href="#cb36-588"></a><span class="co">#| fig-cap: "ROC Curve for Rainfall Occurrence Prediction. An AUC of 0.83 indicates strong discriminative ability, effectively separating dry days from wet days."</span></span>
<span id="cb36-589"><a href="#cb36-589"></a><span class="co">#| message: false</span></span>
<span id="cb36-590"><a href="#cb36-590"></a><span class="co">#| warning: false</span></span>
<span id="cb36-591"><a href="#cb36-591"></a>re_data <span class="ot">&lt;-</span> <span class="fu">select_model_features</span>(df_final, <span class="at">keep_location =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-592"><a href="#cb36-592"></a>  <span class="fu">scale_data</span>()</span>
<span id="cb36-593"><a href="#cb36-593"></a><span class="co"># Generate Probabilities</span></span>
<span id="cb36-594"><a href="#cb36-594"></a><span class="co"># Extract the probability of "Structural Zero" (No Rain) from the Zero-Inflated Model</span></span>
<span id="cb36-595"><a href="#cb36-595"></a>prob_no_rain <span class="ot">&lt;-</span> <span class="fu">predict</span>(m6_mixed, <span class="at">type =</span> <span class="st">"zprob"</span>)</span>
<span id="cb36-596"><a href="#cb36-596"></a></span>
<span id="cb36-597"><a href="#cb36-597"></a><span class="co"># Define Ground Truth (1 = No Rain, 0 = Rain)</span></span>
<span id="cb36-598"><a href="#cb36-598"></a>actual_no_rain <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(re_data<span class="sc">$</span>rainfall <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb36-599"><a href="#cb36-599"></a></span>
<span id="cb36-600"><a href="#cb36-600"></a><span class="co"># ROC Curve Analysis</span></span>
<span id="cb36-601"><a href="#cb36-601"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(actual_no_rain, prob_no_rain)</span>
<span id="cb36-602"><a href="#cb36-602"></a></span>
<span id="cb36-603"><a href="#cb36-603"></a><span class="fu">plot</span>(</span>
<span id="cb36-604"><a href="#cb36-604"></a>  roc_obj,</span>
<span id="cb36-605"><a href="#cb36-605"></a>  <span class="at">main =</span> <span class="st">"ROC Curve: Predicting Rainfall Occurrence"</span>,</span>
<span id="cb36-606"><a href="#cb36-606"></a>  <span class="at">col =</span> <span class="st">"#0072B2"</span>,</span>
<span id="cb36-607"><a href="#cb36-607"></a>  <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb36-608"><a href="#cb36-608"></a>  <span class="at">print.auc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-609"><a href="#cb36-609"></a>  <span class="at">print.auc.y =</span> <span class="fl">0.4</span></span>
<span id="cb36-610"><a href="#cb36-610"></a>)</span>
<span id="cb36-611"><a href="#cb36-611"></a></span>
<span id="cb36-612"><a href="#cb36-612"></a><span class="co"># Threshold Optimization (Youden's J)</span></span>
<span id="cb36-613"><a href="#cb36-613"></a><span class="co"># Find the cut-off that balances Sensitivity (catching rain) and Specificity (catching dry days)</span></span>
<span id="cb36-614"><a href="#cb36-614"></a>coords_obj <span class="ot">&lt;-</span> <span class="fu">coords</span>(roc_obj, <span class="st">"best"</span>, <span class="at">best.method =</span> <span class="st">"youden"</span>)</span>
<span id="cb36-615"><a href="#cb36-615"></a>optimal_threshold <span class="ot">&lt;-</span> coords_obj<span class="sc">$</span>threshold</span>
<span id="cb36-616"><a href="#cb36-616"></a></span>
<span id="cb36-617"><a href="#cb36-617"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Optimal Probability Threshold: %.4f</span><span class="sc">\n</span><span class="st">"</span>, optimal_threshold))</span>
<span id="cb36-618"><a href="#cb36-618"></a></span>
<span id="cb36-619"><a href="#cb36-619"></a><span class="co"># Confusion Matrix &amp; Accuracy</span></span>
<span id="cb36-620"><a href="#cb36-620"></a>predicted_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prob_no_rain <span class="sc">&gt;</span> optimal_threshold, <span class="st">"No Rain"</span>, <span class="st">"Rain"</span>)</span>
<span id="cb36-621"><a href="#cb36-621"></a>actual_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(re_data<span class="sc">$</span>rainfall <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"No Rain"</span>, <span class="st">"Rain"</span>)</span>
<span id="cb36-622"><a href="#cb36-622"></a></span>
<span id="cb36-623"><a href="#cb36-623"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> predicted_class, <span class="at">Actual =</span> actual_class)</span>
<span id="cb36-624"><a href="#cb36-624"></a></span>
<span id="cb36-625"><a href="#cb36-625"></a>conf_matrix <span class="sc">%&gt;%</span></span>
<span id="cb36-626"><a href="#cb36-626"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Confusion Matrix (Optimal Threshold)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-627"><a href="#cb36-627"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb36-628"><a href="#cb36-628"></a></span>
<span id="cb36-629"><a href="#cb36-629"></a><span class="co"># Calculate Accuracy</span></span>
<span id="cb36-630"><a href="#cb36-630"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(conf_matrix)) <span class="sc">/</span> <span class="fu">sum</span>(conf_matrix)</span>
<span id="cb36-631"><a href="#cb36-631"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model Accuracy: %.2f%%</span><span class="sc">\n</span><span class="st">"</span>, accuracy <span class="sc">*</span> <span class="dv">100</span>))</span>
<span id="cb36-632"><a href="#cb36-632"></a><span class="in">```</span></span>
<span id="cb36-633"><a href="#cb36-633"></a></span>
<span id="cb36-634"><a href="#cb36-634"></a>While the Gamma component of our model estimates rainfall *amount*, the Zero-Inflation component acts as a binary classifier answering the fundamental question: *"Will it rain?"*. We evaluated this classification performance using the Receiver Operating Characteristic (ROC) curve and Confusion Matrix.</span>
<span id="cb36-635"><a href="#cb36-635"></a></span>
<span id="cb36-636"><a href="#cb36-636"></a>**1. Discriminative Power (AUC):** The model achieves an **Area Under the Curve (AUC) of 0.832** .</span>
<span id="cb36-637"><a href="#cb36-637"></a></span>
<span id="cb36-638"><a href="#cb36-638"></a><span class="ss">-   </span>**Interpretation:** This indicates a strong predictive capability. In 83.2% of randomly selected pairs (one wet day, one dry day), the model correctly assigns a higher probability of dryness to the actual dry day.</span>
<span id="cb36-639"><a href="#cb36-639"></a></span>
<span id="cb36-640"><a href="#cb36-640"></a><span class="ss">-   </span>**Significance:** This confirms that our engineered features (particularly <span class="in">`rain_yesterday`</span> and <span class="in">`pressure_change`</span>) provide a robust signal for distinguishing weather states.</span>
<span id="cb36-641"><a href="#cb36-641"></a></span>
<span id="cb36-642"><a href="#cb36-642"></a>**2. Optimal Thresholding:** Standard models default to a 50% probability cutoff. However, using Youden’s J statistic, we identified the optimal decision threshold as **0.645**.</span>
<span id="cb36-643"><a href="#cb36-643"></a></span>
<span id="cb36-644"><a href="#cb36-644"></a><span class="ss">-   </span>**Implication:** Because dry days are the majority class (64%), the model requires a higher certainty (<span class="sc">\&gt;</span>64.5% probability) before confidently predicting "No Rain." This adjustment maximizes the balance between catching rain events and avoiding false alarms.</span>
<span id="cb36-645"><a href="#cb36-645"></a></span>
<span id="cb36-646"><a href="#cb36-646"></a>**3. Confusion Matrix Analysis:** At this optimal threshold, the model demonstrates:</span>
<span id="cb36-647"><a href="#cb36-647"></a></span>
<span id="cb36-648"><a href="#cb36-648"></a><span class="ss">-   </span>**Accuracy:** **75.41%** overall correctness.</span>
<span id="cb36-649"><a href="#cb36-649"></a></span>
<span id="cb36-650"><a href="#cb36-650"></a><span class="ss">-   </span>**Sensitivity vs. Specificity:**</span>
<span id="cb36-651"><a href="#cb36-651"></a></span>
<span id="cb36-652"><a href="#cb36-652"></a><span class="ss">-   </span>**Correct Dry Predictions (TN):** 68,544 days.</span>
<span id="cb36-653"><a href="#cb36-653"></a></span>
<span id="cb36-654"><a href="#cb36-654"></a><span class="ss">-   </span>**Correct Rain Predictions (TP):** 38,433 days.</span>
<span id="cb36-655"><a href="#cb36-655"></a></span>
<span id="cb36-656"><a href="#cb36-656"></a><span class="ss">-   </span>**False Alarms (Type I Error):** 22,294 days were predicted to rain but stayed dry.</span>
<span id="cb36-657"><a href="#cb36-657"></a></span>
<span id="cb36-658"><a href="#cb36-658"></a><span class="ss">-   </span>**Missed Rain (Type II Error):** 12,585 days were predicted dry but actually rained.</span>
<span id="cb36-659"><a href="#cb36-659"></a></span>
<span id="cb36-660"><a href="#cb36-660"></a>**Conclusion:** The model is conservative; it is twice as likely to raise a "False Alarm" (predict rain that doesn't happen) than to miss a rain event. In a meteorological context, this is often desirable;it is better to carry an umbrella and not need it than to be caught in a storm unprepared.</span>
<span id="cb36-661"><a href="#cb36-661"></a></span>
<span id="cb36-662"><a href="#cb36-662"></a><span class="fu">## Random Effects Visualization</span></span>
<span id="cb36-663"><a href="#cb36-663"></a></span>
<span id="cb36-666"><a href="#cb36-666"></a><span class="in">```{r}</span></span>
<span id="cb36-667"><a href="#cb36-667"></a><span class="co">#| label: fig-location-effects</span></span>
<span id="cb36-668"><a href="#cb36-668"></a><span class="co">#| fig-cap: "The Geography of Rain: Random Intercepts by Location. This 'Caterpillar Plot' shows the baseline rainfall adjustment for each city. Cities in blue (e.g., Katherine, Darwin) have inherently heavier rainfall than the national average, while cities in red (e.g., Nhil, Norfolk Island) are inherently drier, even after controlling for humidity, pressure, and season."</span></span>
<span id="cb36-669"><a href="#cb36-669"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb36-670"><a href="#cb36-670"></a><span class="co">#| fig-height: 12</span></span>
<span id="cb36-671"><a href="#cb36-671"></a><span class="co">#| echo: true</span></span>
<span id="cb36-672"><a href="#cb36-672"></a><span class="co">#| warning: false</span></span>
<span id="cb36-673"><a href="#cb36-673"></a></span>
<span id="cb36-674"><a href="#cb36-674"></a><span class="co"># Extract Random Effects</span></span>
<span id="cb36-675"><a href="#cb36-675"></a>ranef_data <span class="ot">&lt;-</span> <span class="fu">ranef</span>(m6_mixed)</span>
<span id="cb36-676"><a href="#cb36-676"></a></span>
<span id="cb36-677"><a href="#cb36-677"></a><span class="co"># Process for Plotting</span></span>
<span id="cb36-678"><a href="#cb36-678"></a>loc_effects <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ranef_data<span class="sc">$</span>cond<span class="sc">$</span>location) <span class="sc">%&gt;%</span></span>
<span id="cb36-679"><a href="#cb36-679"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Location"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-680"><a href="#cb36-680"></a>  <span class="fu">rename</span>(<span class="at">Effect =</span> <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-681"><a href="#cb36-681"></a>  <span class="fu">arrange</span>(Effect) <span class="sc">%&gt;%</span></span>
<span id="cb36-682"><a href="#cb36-682"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-683"><a href="#cb36-683"></a>    <span class="at">Location =</span> <span class="fu">factor</span>(Location, <span class="at">levels =</span> Location),</span>
<span id="cb36-684"><a href="#cb36-684"></a>    <span class="co"># Approximate Confidence Intervals</span></span>
<span id="cb36-685"><a href="#cb36-685"></a>    <span class="at">CI_lower =</span> Effect <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(Effect) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb36-686"><a href="#cb36-686"></a>    <span class="at">CI_upper =</span> Effect <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(Effect) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb36-687"><a href="#cb36-687"></a>    <span class="at">Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb36-688"><a href="#cb36-688"></a>      Effect <span class="sc">&gt;</span> <span class="fu">sd</span>(Effect) <span class="sc">~</span> <span class="st">"Significantly Wetter"</span>,</span>
<span id="cb36-689"><a href="#cb36-689"></a>      Effect <span class="sc">&lt;</span> <span class="sc">-</span><span class="fu">sd</span>(Effect) <span class="sc">~</span> <span class="st">"Significantly Drier"</span>,</span>
<span id="cb36-690"><a href="#cb36-690"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Near Average"</span></span>
<span id="cb36-691"><a href="#cb36-691"></a>    ),</span>
<span id="cb36-692"><a href="#cb36-692"></a>    <span class="at">Category =</span> <span class="fu">factor</span>(</span>
<span id="cb36-693"><a href="#cb36-693"></a>      Category,</span>
<span id="cb36-694"><a href="#cb36-694"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Significantly Drier"</span>, <span class="st">"Near Average"</span>, <span class="st">"Significantly Wetter"</span>)</span>
<span id="cb36-695"><a href="#cb36-695"></a>    )</span>
<span id="cb36-696"><a href="#cb36-696"></a>  )</span>
<span id="cb36-697"><a href="#cb36-697"></a></span>
<span id="cb36-698"><a href="#cb36-698"></a><span class="co"># Generate Caterpillar Plot</span></span>
<span id="cb36-699"><a href="#cb36-699"></a><span class="fu">ggplot</span>(loc_effects, <span class="fu">aes</span>(<span class="at">x =</span> Effect, <span class="at">y =</span> Location)) <span class="sc">+</span></span>
<span id="cb36-700"><a href="#cb36-700"></a>  <span class="co"># Background Shading for Significance Zones</span></span>
<span id="cb36-701"><a href="#cb36-701"></a>  <span class="fu">annotate</span>(</span>
<span id="cb36-702"><a href="#cb36-702"></a>    <span class="st">"rect"</span>,</span>
<span id="cb36-703"><a href="#cb36-703"></a>    <span class="at">xmin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb36-704"><a href="#cb36-704"></a>    <span class="at">xmax =</span> <span class="sc">-</span><span class="fu">sd</span>(loc_effects<span class="sc">$</span>Effect),</span>
<span id="cb36-705"><a href="#cb36-705"></a>    <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb36-706"><a href="#cb36-706"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb36-707"><a href="#cb36-707"></a>    <span class="at">fill =</span> <span class="st">"#c0392b"</span>,</span>
<span id="cb36-708"><a href="#cb36-708"></a>    <span class="at">alpha =</span> <span class="fl">0.05</span></span>
<span id="cb36-709"><a href="#cb36-709"></a>  ) <span class="sc">+</span></span>
<span id="cb36-710"><a href="#cb36-710"></a>  <span class="fu">annotate</span>(</span>
<span id="cb36-711"><a href="#cb36-711"></a>    <span class="st">"rect"</span>,</span>
<span id="cb36-712"><a href="#cb36-712"></a>    <span class="at">xmin =</span> <span class="fu">sd</span>(loc_effects<span class="sc">$</span>Effect),</span>
<span id="cb36-713"><a href="#cb36-713"></a>    <span class="at">xmax =</span> <span class="cn">Inf</span>,</span>
<span id="cb36-714"><a href="#cb36-714"></a>    <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb36-715"><a href="#cb36-715"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb36-716"><a href="#cb36-716"></a>    <span class="at">fill =</span> <span class="st">"#2980b9"</span>,</span>
<span id="cb36-717"><a href="#cb36-717"></a>    <span class="at">alpha =</span> <span class="fl">0.05</span></span>
<span id="cb36-718"><a href="#cb36-718"></a>  ) <span class="sc">+</span></span>
<span id="cb36-719"><a href="#cb36-719"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb36-720"><a href="#cb36-720"></a>    <span class="at">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb36-721"><a href="#cb36-721"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb36-722"><a href="#cb36-722"></a>    <span class="at">color =</span> <span class="st">"grey30"</span>,</span>
<span id="cb36-723"><a href="#cb36-723"></a>    <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb36-724"><a href="#cb36-724"></a>  ) <span class="sc">+</span></span>
<span id="cb36-725"><a href="#cb36-725"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb36-726"><a href="#cb36-726"></a>    <span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">sd</span>(loc_effects<span class="sc">$</span>Effect), <span class="fu">sd</span>(loc_effects<span class="sc">$</span>Effect)),</span>
<span id="cb36-727"><a href="#cb36-727"></a>    <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb36-728"><a href="#cb36-728"></a>    <span class="at">color =</span> <span class="st">"grey50"</span>,</span>
<span id="cb36-729"><a href="#cb36-729"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span></span>
<span id="cb36-730"><a href="#cb36-730"></a>  ) <span class="sc">+</span></span>
<span id="cb36-731"><a href="#cb36-731"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb36-732"><a href="#cb36-732"></a>    <span class="fu">aes</span>(</span>
<span id="cb36-733"><a href="#cb36-733"></a>      <span class="at">x =</span> CI_lower,</span>
<span id="cb36-734"><a href="#cb36-734"></a>      <span class="at">xend =</span> CI_upper,</span>
<span id="cb36-735"><a href="#cb36-735"></a>      <span class="at">y =</span> Location,</span>
<span id="cb36-736"><a href="#cb36-736"></a>      <span class="at">yend =</span> Location,</span>
<span id="cb36-737"><a href="#cb36-737"></a>      <span class="at">color =</span> Category</span>
<span id="cb36-738"><a href="#cb36-738"></a>    ),</span>
<span id="cb36-739"><a href="#cb36-739"></a>    <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb36-740"><a href="#cb36-740"></a>    <span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="cb36-741"><a href="#cb36-741"></a>  ) <span class="sc">+</span></span>
<span id="cb36-742"><a href="#cb36-742"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Category), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb36-743"><a href="#cb36-743"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb36-744"><a href="#cb36-744"></a>    <span class="at">data =</span> <span class="fu">filter</span>(loc_effects, <span class="fu">abs</span>(Effect) <span class="sc">&gt;</span> <span class="fu">sd</span>(Effect)),</span>
<span id="cb36-745"><a href="#cb36-745"></a>    <span class="fu">aes</span>(</span>
<span id="cb36-746"><a href="#cb36-746"></a>      <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, Effect),</span>
<span id="cb36-747"><a href="#cb36-747"></a>      <span class="at">x =</span> Effect,</span>
<span id="cb36-748"><a href="#cb36-748"></a>      <span class="at">hjust =</span> <span class="fu">ifelse</span>(Effect <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">1.3</span>)</span>
<span id="cb36-749"><a href="#cb36-749"></a>    ),</span>
<span id="cb36-750"><a href="#cb36-750"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb36-751"><a href="#cb36-751"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb36-752"><a href="#cb36-752"></a>    <span class="at">color =</span> <span class="st">"grey20"</span></span>
<span id="cb36-753"><a href="#cb36-753"></a>  ) <span class="sc">+</span></span>
<span id="cb36-754"><a href="#cb36-754"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb36-755"><a href="#cb36-755"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb36-756"><a href="#cb36-756"></a>      <span class="st">"Significantly Drier"</span> <span class="ot">=</span> <span class="st">"#c0392b"</span>,</span>
<span id="cb36-757"><a href="#cb36-757"></a>      <span class="st">"Near Average"</span> <span class="ot">=</span> <span class="st">"#7f8c8d"</span>,</span>
<span id="cb36-758"><a href="#cb36-758"></a>      <span class="st">"Significantly Wetter"</span> <span class="ot">=</span> <span class="st">"#2980b9"</span></span>
<span id="cb36-759"><a href="#cb36-759"></a>    ),</span>
<span id="cb36-760"><a href="#cb36-760"></a>    <span class="at">name =</span> <span class="st">"Effect Size"</span></span>
<span id="cb36-761"><a href="#cb36-761"></a>  ) <span class="sc">+</span></span>
<span id="cb36-762"><a href="#cb36-762"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-763"><a href="#cb36-763"></a>    <span class="at">title =</span> <span class="st">"The Geography of Rain: Location-Specific Baselines"</span>,</span>
<span id="cb36-764"><a href="#cb36-764"></a>    <span class="at">subtitle =</span> <span class="st">"Random intercepts show how much wetter/drier each city is, holding all weather variables constant.</span><span class="sc">\n</span><span class="st">Bars show 95% confidence intervals; points beyond +-1 SD are labeled."</span>,</span>
<span id="cb36-765"><a href="#cb36-765"></a>    <span class="at">x =</span> <span class="st">"Baseline Rainfall Adjustment (Log mm)"</span>,</span>
<span id="cb36-766"><a href="#cb36-766"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb36-767"><a href="#cb36-767"></a>    <span class="at">caption =</span> <span class="st">"Interpretation: A value of +0.5 means ~65% more rain than average location with identical conditions [exp(0.5) ≈ 1.65]"</span></span>
<span id="cb36-768"><a href="#cb36-768"></a>  ) <span class="sc">+</span></span>
<span id="cb36-769"><a href="#cb36-769"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb36-770"><a href="#cb36-770"></a>  <span class="fu">theme</span>(</span>
<span id="cb36-771"><a href="#cb36-771"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey90"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>),</span>
<span id="cb36-772"><a href="#cb36-772"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-773"><a href="#cb36-773"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey90"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>),</span>
<span id="cb36-774"><a href="#cb36-774"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">5</span>)),</span>
<span id="cb36-775"><a href="#cb36-775"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(</span>
<span id="cb36-776"><a href="#cb36-776"></a>      <span class="at">color =</span> <span class="st">"grey30"</span>,</span>
<span id="cb36-777"><a href="#cb36-777"></a>      <span class="at">size =</span> <span class="dv">11</span>,</span>
<span id="cb36-778"><a href="#cb36-778"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">15</span>)</span>
<span id="cb36-779"><a href="#cb36-779"></a>    ),</span>
<span id="cb36-780"><a href="#cb36-780"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(</span>
<span id="cb36-781"><a href="#cb36-781"></a>      <span class="at">color =</span> <span class="st">"grey50"</span>,</span>
<span id="cb36-782"><a href="#cb36-782"></a>      <span class="at">size =</span> <span class="dv">9</span>,</span>
<span id="cb36-783"><a href="#cb36-783"></a>      <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb36-784"><a href="#cb36-784"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)</span>
<span id="cb36-785"><a href="#cb36-785"></a>    ),</span>
<span id="cb36-786"><a href="#cb36-786"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb36-787"><a href="#cb36-787"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb36-788"><a href="#cb36-788"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb36-789"><a href="#cb36-789"></a>      <span class="at">size =</span> <span class="dv">11</span>,</span>
<span id="cb36-790"><a href="#cb36-790"></a>      <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb36-791"><a href="#cb36-791"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)</span>
<span id="cb36-792"><a href="#cb36-792"></a>    ),</span>
<span id="cb36-793"><a href="#cb36-793"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb36-794"><a href="#cb36-794"></a>    <span class="at">legend.justification =</span> <span class="st">"left"</span>,</span>
<span id="cb36-795"><a href="#cb36-795"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb36-796"><a href="#cb36-796"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb36-797"><a href="#cb36-797"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">15</span>)</span>
<span id="cb36-798"><a href="#cb36-798"></a>  )</span>
<span id="cb36-799"><a href="#cb36-799"></a><span class="in">```</span></span>
<span id="cb36-800"><a href="#cb36-800"></a></span>
<span id="cb36-801"><a href="#cb36-801"></a>To visualize the spatial heterogeneity captured by Model 6, we extracted the conditional modes (Random Intercepts) for all 49 locations . This plot reveals the inherent "wetness" or "dryness" of a city, **holding all dynamic weather variables constant**.</span>
<span id="cb36-802"><a href="#cb36-802"></a></span>
<span id="cb36-803"><a href="#cb36-803"></a>**1. The Tropical Top End (Wetter):** The cities with the highest positive adjustments are **Katherine (**$\beta = 0.59$) and **Darwin (**$\beta = 0.54$).</span>
<span id="cb36-804"><a href="#cb36-804"></a></span>
<span id="cb36-805"><a href="#cb36-805"></a><span class="ss">-   </span>**Interpretation:** Even if Katherine and Melbourne experience the exact same humidity, pressure, and wind conditions, Katherine will produce significantly heavier rainfall ($e^{0.59} \approx 1.8x$ baseline). This captures the unmeasured convective potential of the Australian tropics.</span>
<span id="cb36-806"><a href="#cb36-806"></a></span>
<span id="cb36-807"><a href="#cb36-807"></a>**2. The Arid Interior and South (Drier):** At the bottom of the chart, we find **Nhil (**$\beta = -0.73$) and **Norfolk Island (**$\beta = -0.65$).</span>
<span id="cb36-808"><a href="#cb36-808"></a></span>
<span id="cb36-809"><a href="#cb36-809"></a><span class="ss">-   </span>**Interpretation:** These locations have a "suppressive" geography. A weather system that would produce moderate rain elsewhere produces only light rain here.</span>
<span id="cb36-810"><a href="#cb36-810"></a></span>
<span id="cb36-811"><a href="#cb36-811"></a>**3. Significance:** The clear separation of locations into "Significantly Wetter" (Blue) and "Significantly Drier" (Red) zones validates the necessity of the Mixed Model. A standard regression model would have averaged these extremes, under-predicting flood risks in Darwin and over-predicting rainfall in the arid interior.</span>
<span id="cb36-812"><a href="#cb36-812"></a></span>
<span id="cb36-813"><a href="#cb36-813"></a><span class="fu">## Validating Model Assumptions</span></span>
<span id="cb36-814"><a href="#cb36-814"></a></span>
<span id="cb36-817"><a href="#cb36-817"></a><span class="in">```{r}</span></span>
<span id="cb36-818"><a href="#cb36-818"></a><span class="co">#| label: model-diagnostics</span></span>
<span id="cb36-819"><a href="#cb36-819"></a><span class="co">#| echo: true</span></span>
<span id="cb36-820"><a href="#cb36-820"></a><span class="co">#| fig-cap: "DHARMa Residual Diagnostics for Model 6. Left: Q-Q plot of residuals shows excellent alignment with the expected uniform distribution (red line), indicating the Gamma distribution is an appropriate choice. Right: Residuals vs. Predicted plot shows no fanning or curvature, confirming homoscedasticity."</span></span>
<span id="cb36-821"><a href="#cb36-821"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb36-822"><a href="#cb36-822"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb36-823"><a href="#cb36-823"></a><span class="co">#| message: false</span></span>
<span id="cb36-824"><a href="#cb36-824"></a><span class="co">#| warning: false</span></span>
<span id="cb36-825"><a href="#cb36-825"></a><span class="co">#| cache: true</span></span>
<span id="cb36-826"><a href="#cb36-826"></a><span class="co">#| dependson: "global-setup"</span></span>
<span id="cb36-827"><a href="#cb36-827"></a><span class="co"># Simulate Residuals</span></span>
<span id="cb36-828"><a href="#cb36-828"></a>res <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(m6_mixed)</span>
<span id="cb36-829"><a href="#cb36-829"></a></span>
<span id="cb36-830"><a href="#cb36-830"></a><span class="co"># Diagnostic Plots (Q-Q and Residual vs Predicted)</span></span>
<span id="cb36-831"><a href="#cb36-831"></a><span class="fu">plot</span>(res)</span>
<span id="cb36-832"><a href="#cb36-832"></a></span>
<span id="cb36-833"><a href="#cb36-833"></a><span class="co"># Test for Over/Under-Dispersion</span></span>
<span id="cb36-834"><a href="#cb36-834"></a><span class="fu">testDispersion</span>(res)</span>
<span id="cb36-835"><a href="#cb36-835"></a></span>
<span id="cb36-836"><a href="#cb36-836"></a><span class="co"># Test for Zero-Inflation issues</span></span>
<span id="cb36-837"><a href="#cb36-837"></a><span class="fu">testZeroInflation</span>(res)</span>
<span id="cb36-838"><a href="#cb36-838"></a><span class="in">```</span></span>
<span id="cb36-839"><a href="#cb36-839"></a></span>
<span id="cb36-840"><a href="#cb36-840"></a>A complex model is only as good as its residuals. We utilized the **DHARMa** package to perform simulation-based diagnostics, which are superior to standard residual plots for Zero-Inflated GLMMs.</span>
<span id="cb36-841"><a href="#cb36-841"></a></span>
<span id="cb36-842"><a href="#cb36-842"></a>**1. Q-Q Plot (Distributional Fit):** The Q-Q plot demonstrates a near-perfect alignment along the 1:1 diagonal.</span>
<span id="cb36-843"><a href="#cb36-843"></a></span>
<span id="cb36-844"><a href="#cb36-844"></a><span class="ss">-   </span>**Result:** The Kolmogorov-Smirnov test indicates a significant deviation ($p &lt; 0.05$), which is common in datasets of this magnitude ($N &gt; 140,000$). However, visually, the deviations are negligible.</span>
<span id="cb36-845"><a href="#cb36-845"></a></span>
<span id="cb36-846"><a href="#cb36-846"></a><span class="ss">-   </span>**Implication:** This confirms that the **Gamma distribution** correctly characterizes the positive rainfall values, capturing the skewness without systematic bias.</span>
<span id="cb36-847"><a href="#cb36-847"></a></span>
<span id="cb36-848"><a href="#cb36-848"></a>**2. Residuals vs. Predicted (Homoscedasticity):** The plot on the right shows a uniform spread of residuals across the range of predicted values.</span>
<span id="cb36-849"><a href="#cb36-849"></a></span>
<span id="cb36-850"><a href="#cb36-850"></a><span class="ss">-   </span>**Quantile Lines:** The red quantile lines (25th, 50th, 75th) are straight and horizontal, indicating **no significant non-linearity or heteroscedasticity**. The model performs equally well for light drizzle and heavy storms.</span>
<span id="cb36-851"><a href="#cb36-851"></a></span>
<span id="cb36-852"><a href="#cb36-852"></a>**3. Formal Tests:**</span>
<span id="cb36-853"><a href="#cb36-853"></a></span>
<span id="cb36-854"><a href="#cb36-854"></a><span class="ss">-   </span>**Dispersion Test:** The non-parametric dispersion test yields a p-value of **0.192** .</span>
<span id="cb36-855"><a href="#cb36-855"></a></span>
<span id="cb36-856"><a href="#cb36-856"></a><span class="ss">-   </span>**Interpretation:** We fail to reject the null hypothesis of ideal dispersion. This is a major victory for the model, confirming that the <span class="in">`ziGamma`</span> family successfully handled the variance structure without over-dispersion.</span>
<span id="cb36-857"><a href="#cb36-857"></a></span>
<span id="cb36-858"><a href="#cb36-858"></a><span class="ss">-   </span>**Zero-Inflation Test:** The test compares the observed zeros to the simulated zeros .</span>
<span id="cb36-859"><a href="#cb36-859"></a></span>
<span id="cb36-860"><a href="#cb36-860"></a><span class="ss">-   </span>**Ratio:** The ratio of observed to simulated zeros is **1.00** ($p = 0.992$).</span>
<span id="cb36-861"><a href="#cb36-861"></a></span>
<span id="cb36-862"><a href="#cb36-862"></a><span class="ss">-   </span>**Interpretation:** The model predicts the *exact* correct number of dry days. The Zero-Inflation component is perfectly calibrated.</span>
<span id="cb36-863"><a href="#cb36-863"></a></span>
<span id="cb36-864"><a href="#cb36-864"></a>**Conclusion:** Model 6 passes all critical diagnostic checks. It is robust, well-calibrated, and valid for inference.</span>
<span id="cb36-865"><a href="#cb36-865"></a></span>
<span id="cb36-866"><a href="#cb36-866"></a><span class="fu">## Verifying Temporal Independence</span></span>
<span id="cb36-867"><a href="#cb36-867"></a></span>
<span id="cb36-870"><a href="#cb36-870"></a><span class="in">```{r}</span></span>
<span id="cb36-871"><a href="#cb36-871"></a><span class="co">#| label: temporal-autocorrelation</span></span>
<span id="cb36-872"><a href="#cb36-872"></a><span class="co">#| echo: true</span></span>
<span id="cb36-873"><a href="#cb36-873"></a><span class="co">#| fig-cap: "Temporal Autocorrelation Check (Canberra). Left: Residuals vs. Time showing random scatter. Right: Autocorrelation Function (ACF) plot showing lags falling within the blue confidence bounds, confirming independence."</span></span>
<span id="cb36-874"><a href="#cb36-874"></a><span class="co">#| message: false</span></span>
<span id="cb36-875"><a href="#cb36-875"></a><span class="co">#| warning: false</span></span>
<span id="cb36-876"><a href="#cb36-876"></a></span>
<span id="cb36-877"><a href="#cb36-877"></a><span class="co"># Align Residuals with Time Series</span></span>
<span id="cb36-878"><a href="#cb36-878"></a><span class="co"># Extract the exact rows used in the model</span></span>
<span id="cb36-879"><a href="#cb36-879"></a>rows_used <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">rownames</span>(m6_mixed<span class="sc">$</span>frame))</span>
<span id="cb36-880"><a href="#cb36-880"></a></span>
<span id="cb36-881"><a href="#cb36-881"></a><span class="co"># Filter for a single continuous time series (Canberra)</span></span>
<span id="cb36-882"><a href="#cb36-882"></a>Canberra_data <span class="ot">&lt;-</span> df_final[rows_used, ] <span class="sc">%&gt;%</span></span>
<span id="cb36-883"><a href="#cb36-883"></a>  <span class="fu">mutate</span>(<span class="at">dharma_resid =</span> <span class="fu">residuals</span>(res)) <span class="sc">%&gt;%</span></span>
<span id="cb36-884"><a href="#cb36-884"></a>  <span class="fu">filter</span>(location <span class="sc">==</span> <span class="st">"Canberra"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-885"><a href="#cb36-885"></a>  <span class="fu">arrange</span>(date)</span>
<span id="cb36-886"><a href="#cb36-886"></a></span>
<span id="cb36-887"><a href="#cb36-887"></a><span class="co"># 2. Durbin-Watson Test</span></span>
<span id="cb36-888"><a href="#cb36-888"></a><span class="co"># Tests H0: Residuals are not autocorrelated (Independence)</span></span>
<span id="cb36-889"><a href="#cb36-889"></a>dw_result <span class="ot">&lt;-</span> <span class="fu">testTemporalAutocorrelation</span>(</span>
<span id="cb36-890"><a href="#cb36-890"></a>  <span class="at">simulationOutput =</span> Canberra_data<span class="sc">$</span>dharma_resid,</span>
<span id="cb36-891"><a href="#cb36-891"></a>  <span class="at">time =</span> Canberra_data<span class="sc">$</span>date</span>
<span id="cb36-892"><a href="#cb36-892"></a>)</span>
<span id="cb36-893"><a href="#cb36-893"></a></span>
<span id="cb36-894"><a href="#cb36-894"></a><span class="fu">print</span>(dw_result)</span>
<span id="cb36-895"><a href="#cb36-895"></a><span class="in">```</span></span>
<span id="cb36-896"><a href="#cb36-896"></a></span>
<span id="cb36-897"><a href="#cb36-897"></a>A critical assumption of Generalized Linear Mixed Models is that residuals are independent. In time-series data like weather, this is often violated by serial autocorrelation (e.g., if the model under-predicts today, it likely under-predicts tomorrow). We tested this assumption on the Canberra time series using the Durbin-Watson test.</span>
<span id="cb36-898"><a href="#cb36-898"></a></span>
<span id="cb36-899"><a href="#cb36-899"></a>**1. Durbin-Watson Statistic:** The test yielded a **DW statistic of 2.0406**.</span>
<span id="cb36-900"><a href="#cb36-900"></a></span>
<span id="cb36-901"><a href="#cb36-901"></a><span class="ss">-   </span>**Benchmark:** A value of **2.0** indicates perfect independence (white noise). Values approaching 0 indicate positive autocorrelation, while values approaching 4 indicate negative autocorrelation.</span>
<span id="cb36-902"><a href="#cb36-902"></a></span>
<span id="cb36-903"><a href="#cb36-903"></a><span class="ss">-   </span>**Result:** Our result is nearly indistinguishable from the ideal value of 2.0.</span>
<span id="cb36-904"><a href="#cb36-904"></a></span>
<span id="cb36-905"><a href="#cb36-905"></a>**2. Statistical Significance:** The p-value is **0.2355** ($&gt; 0.05$).</span>
<span id="cb36-906"><a href="#cb36-906"></a></span>
<span id="cb36-907"><a href="#cb36-907"></a><span class="ss">-   </span>**Conclusion:** We fail to reject the null hypothesis of independence. There is **no evidence of temporal autocorrelation** remaining in the residuals.</span>
<span id="cb36-908"><a href="#cb36-908"></a></span>
<span id="cb36-909"><a href="#cb36-909"></a>**3. Visual Confirmation:** The Autocorrelation Function (ACF) plot confirms this numerically.</span>
<span id="cb36-910"><a href="#cb36-910"></a></span>
<span id="cb36-911"><a href="#cb36-911"></a><span class="ss">-   </span>**ACF Lags:** The vertical bars (correlations at Lag 1, Lag 2, etc.) all fall comfortably within the blue dashed confidence intervals.</span>
<span id="cb36-912"><a href="#cb36-912"></a></span>
<span id="cb36-913"><a href="#cb36-913"></a><span class="ss">-   </span>**Implication:** This validates our feature engineering strategy. By explicitly including "History" terms;specifically the Markov chain (<span class="in">`rain_yesterday`</span>) and the Dry Spell Spline (<span class="in">`days_since_rain`</span>);we successfully "bleached" the temporal signal from the data. The model has fully learned the time-dependent patterns, leaving behind only random, independent noise.</span>
<span id="cb36-914"><a href="#cb36-914"></a></span>
<span id="cb36-915"><a href="#cb36-915"></a><span class="fu">## Predictive Accuracy and Generative Validity</span></span>
<span id="cb36-916"><a href="#cb36-916"></a></span>
<span id="cb36-919"><a href="#cb36-919"></a><span class="in">```{r}</span></span>
<span id="cb36-920"><a href="#cb36-920"></a><span class="co">#| label: ppc-and-metrics</span></span>
<span id="cb36-921"><a href="#cb36-921"></a><span class="co">#| echo: true</span></span>
<span id="cb36-922"><a href="#cb36-922"></a><span class="co">#| fig-cap: "Posterior Predictive Check. The blue line represents the observed distribution of daily rainfall. The gray lines represent 50 simulated datasets generated by the model. The tight overlap confirms that the model correctly captures the heavy skew and zero-inflation of the real climate system."</span></span>
<span id="cb36-923"><a href="#cb36-923"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb36-924"><a href="#cb36-924"></a><span class="co">#| fig-height: 7</span></span>
<span id="cb36-925"><a href="#cb36-925"></a><span class="co">#| message: false</span></span>
<span id="cb36-926"><a href="#cb36-926"></a><span class="co">#| warning: false</span></span>
<span id="cb36-927"><a href="#cb36-927"></a></span>
<span id="cb36-928"><a href="#cb36-928"></a><span class="co"># Calculate Prediction Error Metrics</span></span>
<span id="cb36-929"><a href="#cb36-929"></a><span class="co"># Generate point predictions (mean of the gamma distribution * probability of rain)</span></span>
<span id="cb36-930"><a href="#cb36-930"></a>df_final<span class="sc">$</span>pred_rainfall <span class="ot">&lt;-</span> <span class="fu">predict</span>(m6_mixed, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb36-931"><a href="#cb36-931"></a></span>
<span id="cb36-932"><a href="#cb36-932"></a><span class="co"># RMSE: Penalizes large errors (e.g., missing a cyclone)</span></span>
<span id="cb36-933"><a href="#cb36-933"></a>global_rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((df_final<span class="sc">$</span>rainfall <span class="sc">-</span> df_final<span class="sc">$</span>pred_rainfall)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb36-934"><a href="#cb36-934"></a><span class="co"># MAE: The average "miss" in millimeters</span></span>
<span id="cb36-935"><a href="#cb36-935"></a>global_mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(df_final<span class="sc">$</span>rainfall <span class="sc">-</span> df_final<span class="sc">$</span>pred_rainfall))</span>
<span id="cb36-936"><a href="#cb36-936"></a></span>
<span id="cb36-937"><a href="#cb36-937"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Global RMSE:"</span>, <span class="fu">round</span>(global_rmse, <span class="dv">3</span>), <span class="st">"mm"</span>))</span>
<span id="cb36-938"><a href="#cb36-938"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Global MAE:"</span>, <span class="fu">round</span>(global_mae, <span class="dv">3</span>), <span class="st">"mm"</span>))</span>
<span id="cb36-939"><a href="#cb36-939"></a></span>
<span id="cb36-940"><a href="#cb36-940"></a><span class="in">```</span></span>
<span id="cb36-941"><a href="#cb36-941"></a></span>
<span id="cb36-944"><a href="#cb36-944"></a><span class="in">```{r}</span></span>
<span id="cb36-945"><a href="#cb36-945"></a><span class="co">#| label: pcc-simulation</span></span>
<span id="cb36-946"><a href="#cb36-946"></a><span class="co">#| eval: false</span></span>
<span id="cb36-947"><a href="#cb36-947"></a></span>
<span id="cb36-948"><a href="#cb36-948"></a><span class="co"># Posterior Predictive Check (PPC)</span></span>
<span id="cb36-949"><a href="#cb36-949"></a><span class="co"># Does the model generate realistic data?</span></span>
<span id="cb36-950"><a href="#cb36-950"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb36-951"><a href="#cb36-951"></a>sims <span class="ot">&lt;-</span> <span class="fu">simulate</span>(m6_mixed, <span class="at">nsim =</span> <span class="dv">1000</span>)</span>
<span id="cb36-952"><a href="#cb36-952"></a><span class="co"># Sample 50 simulations for visualization clarity</span></span>
<span id="cb36-953"><a href="#cb36-953"></a>subset_sims <span class="ot">&lt;-</span> sims[, <span class="fu">sample</span>(<span class="fu">ncol</span>(sims), <span class="dv">50</span>)]</span>
<span id="cb36-954"><a href="#cb36-954"></a>ppc_data <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(</span>
<span id="cb36-955"><a href="#cb36-955"></a>  <span class="at">Observed =</span> re_data<span class="sc">$</span>rainfall,</span>
<span id="cb36-956"><a href="#cb36-956"></a>  subset_sims</span>
<span id="cb36-957"><a href="#cb36-957"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb36-958"><a href="#cb36-958"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb36-959"><a href="#cb36-959"></a>    <span class="at">cols =</span> <span class="sc">-</span>Observed,</span>
<span id="cb36-960"><a href="#cb36-960"></a>    <span class="at">names_to =</span> <span class="st">"Simulation"</span>,</span>
<span id="cb36-961"><a href="#cb36-961"></a>    <span class="at">values_to =</span> <span class="st">"Simulated_Value"</span></span>
<span id="cb36-962"><a href="#cb36-962"></a>  )</span>
<span id="cb36-963"><a href="#cb36-963"></a><span class="in">```</span></span>
<span id="cb36-964"><a href="#cb36-964"></a></span>
<span id="cb36-967"><a href="#cb36-967"></a><span class="in">```{r}</span></span>
<span id="cb36-968"><a href="#cb36-968"></a><span class="co">#| label: plot-ppc</span></span>
<span id="cb36-969"><a href="#cb36-969"></a><span class="co">#| warning: false</span></span>
<span id="cb36-970"><a href="#cb36-970"></a><span class="co">#| message: false</span></span>
<span id="cb36-971"><a href="#cb36-971"></a></span>
<span id="cb36-972"><a href="#cb36-972"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb36-973"><a href="#cb36-973"></a>  <span class="co"># Simulated Worlds (Gray)</span></span>
<span id="cb36-974"><a href="#cb36-974"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb36-975"><a href="#cb36-975"></a>    <span class="at">data =</span> ppc_data,</span>
<span id="cb36-976"><a href="#cb36-976"></a>    <span class="fu">aes</span>(<span class="at">x =</span> Simulated_Value, <span class="at">group =</span> Simulation),</span>
<span id="cb36-977"><a href="#cb36-977"></a>    <span class="at">color =</span> <span class="st">"gray70"</span>,</span>
<span id="cb36-978"><a href="#cb36-978"></a>    <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb36-979"><a href="#cb36-979"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb36-980"><a href="#cb36-980"></a>  ) <span class="sc">+</span></span>
<span id="cb36-981"><a href="#cb36-981"></a>  <span class="co"># Real World (Blue)</span></span>
<span id="cb36-982"><a href="#cb36-982"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb36-983"><a href="#cb36-983"></a>    <span class="at">data =</span> re_data,</span>
<span id="cb36-984"><a href="#cb36-984"></a>    <span class="fu">aes</span>(<span class="at">x =</span> rainfall),</span>
<span id="cb36-985"><a href="#cb36-985"></a>    <span class="at">color =</span> <span class="st">"#0072B2"</span>,</span>
<span id="cb36-986"><a href="#cb36-986"></a>    <span class="at">size =</span> <span class="fl">1.2</span></span>
<span id="cb36-987"><a href="#cb36-987"></a>  ) <span class="sc">+</span></span>
<span id="cb36-988"><a href="#cb36-988"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb36-989"><a href="#cb36-989"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-990"><a href="#cb36-990"></a>    <span class="at">title =</span> <span class="st">"Posterior Predictive Check"</span>,</span>
<span id="cb36-991"><a href="#cb36-991"></a>    <span class="at">subtitle =</span> <span class="st">"Does the model's imagination (Gray) match reality (Blue)?"</span>,</span>
<span id="cb36-992"><a href="#cb36-992"></a>    <span class="at">x =</span> <span class="st">"Rainfall (mm)"</span>,</span>
<span id="cb36-993"><a href="#cb36-993"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb36-994"><a href="#cb36-994"></a>  ) <span class="sc">+</span></span>
<span id="cb36-995"><a href="#cb36-995"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb36-996"><a href="#cb36-996"></a><span class="in">```</span></span>
<span id="cb36-997"><a href="#cb36-997"></a></span>
<span id="cb36-998"><a href="#cb36-998"></a>To conclude the validation, we assessed the model's performance in absolute terms (Millimeters of Rain) and its generative capacity (Posterior Predictive Check).</span>
<span id="cb36-999"><a href="#cb36-999"></a></span>
<span id="cb36-1000"><a href="#cb36-1000"></a>**1. Error Metrics:**</span>
<span id="cb36-1001"><a href="#cb36-1001"></a></span>
<span id="cb36-1002"><a href="#cb36-1002"></a><span class="ss">-   </span>**Global MAE (Mean Absolute Error): 2.71 mm.**</span>
<span id="cb36-1003"><a href="#cb36-1003"></a></span>
<span id="cb36-1004"><a href="#cb36-1004"></a><span class="ss">-   </span>*Interpretation:* On any given day, our model’s prediction is, on average, within **2.7mm** of the actual rainfall. Given the high variance of Australian weather, this indicates a high degree of precision for day-to-day forecasting.</span>
<span id="cb36-1005"><a href="#cb36-1005"></a></span>
<span id="cb36-1006"><a href="#cb36-1006"></a><span class="ss">-   </span>**Global RMSE (Root Mean Square Error): 7.48 mm.**</span>
<span id="cb36-1007"><a href="#cb36-1007"></a></span>
<span id="cb36-1008"><a href="#cb36-1008"></a><span class="ss">-   </span>*Interpretation:* RMSE is more sensitive to outliers. The higher value here reflects the inherent unpredictability of extreme storm events (e.g., receiving 150mm when 50mm was predicted).</span>
<span id="cb36-1009"><a href="#cb36-1009"></a></span>
<span id="cb36-1010"><a href="#cb36-1010"></a>**2. Posterior Predictive Check (PPC):** The density plot answers the question: *If we simulated Australian weather using only our model equations, would it look real?*</span>
<span id="cb36-1011"><a href="#cb36-1011"></a></span>
<span id="cb36-1012"><a href="#cb36-1012"></a><span class="ss">-   </span>**The Fit:** The blue line (Reality) sits perfectly nested within the bundle of gray lines (Model Simulations).</span>
<span id="cb36-1013"><a href="#cb36-1013"></a></span>
<span id="cb36-1014"><a href="#cb36-1014"></a><span class="ss">-   </span>**Zero-Inflation:** The peak at 0mm is captured accurately, confirming the Zero-Inflation component is working.</span>
<span id="cb36-1015"><a href="#cb36-1015"></a></span>
<span id="cb36-1016"><a href="#cb36-1016"></a><span class="ss">-   </span>**The Tail:** The decay rate (how quickly light rain turns into heavy rain) matches perfectly. A standard Gaussian model would have failed here, likely predicting negative rain or missing the heavy skew.</span>
<span id="cb36-1017"><a href="#cb36-1017"></a></span>
<span id="cb36-1018"><a href="#cb36-1018"></a><span class="ss">-   </span>**Conclusion:** The model is not just fitting means; it is successfully replicating the underlying statistical distribution of the climate system.</span>
<span id="cb36-1019"><a href="#cb36-1019"></a></span>
<span id="cb36-1020"><a href="#cb36-1020"></a><span class="fu">## Justification of Distributional choice</span></span>
<span id="cb36-1021"><a href="#cb36-1021"></a></span>
<span id="cb36-1024"><a href="#cb36-1024"></a><span class="in">```{r}</span></span>
<span id="cb36-1025"><a href="#cb36-1025"></a><span class="co">#| label: distribution-check-code</span></span>
<span id="cb36-1026"><a href="#cb36-1026"></a><span class="co">#| echo: true</span></span>
<span id="cb36-1027"><a href="#cb36-1027"></a><span class="co">#| eval: false</span></span>
<span id="cb36-1028"><a href="#cb36-1028"></a></span>
<span id="cb36-1029"><a href="#cb36-1029"></a><span class="co"># Fit comparison models to test distributional assumptions</span></span>
<span id="cb36-1030"><a href="#cb36-1030"></a></span>
<span id="cb36-1031"><a href="#cb36-1031"></a><span class="co"># Gaussian (Linear Regression)</span></span>
<span id="cb36-1032"><a href="#cb36-1032"></a><span class="co"># Assumes residuals are normally distributed (Bad for zero-heavy data)</span></span>
<span id="cb36-1033"><a href="#cb36-1033"></a>m_linear <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb36-1034"><a href="#cb36-1034"></a>  rainfall <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb36-1035"><a href="#cb36-1035"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb36-1036"><a href="#cb36-1036"></a>    dewpoint_change <span class="sc">+</span></span>
<span id="cb36-1037"><a href="#cb36-1037"></a>    pressure_change <span class="sc">+</span></span>
<span id="cb36-1038"><a href="#cb36-1038"></a>    day_cos <span class="sc">+</span></span>
<span id="cb36-1039"><a href="#cb36-1039"></a>    day_sin <span class="sc">+</span></span>
<span id="cb36-1040"><a href="#cb36-1040"></a>    rainfall_ma7 <span class="sc">+</span></span>
<span id="cb36-1041"><a href="#cb36-1041"></a>    days_since_rain <span class="sc">+</span></span>
<span id="cb36-1042"><a href="#cb36-1042"></a>    humidity_ma7 <span class="sc">+</span></span>
<span id="cb36-1043"><a href="#cb36-1043"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb36-1044"><a href="#cb36-1044"></a>    sunshine <span class="sc">+</span></span>
<span id="cb36-1045"><a href="#cb36-1045"></a>    evaporation <span class="sc">+</span></span>
<span id="cb36-1046"><a href="#cb36-1046"></a>    instability_index <span class="sc">+</span></span>
<span id="cb36-1047"><a href="#cb36-1047"></a>    sun_humid_interaction <span class="sc">+</span></span>
<span id="cb36-1048"><a href="#cb36-1048"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb36-1049"><a href="#cb36-1049"></a>    gust_U_EW <span class="sc">+</span></span>
<span id="cb36-1050"><a href="#cb36-1050"></a>    gust_V_NS <span class="sc">+</span></span>
<span id="cb36-1051"><a href="#cb36-1051"></a>    wind9am_V_NS <span class="sc">+</span></span>
<span id="cb36-1052"><a href="#cb36-1052"></a>    wind9am_U_EW <span class="sc">+</span></span>
<span id="cb36-1053"><a href="#cb36-1053"></a>    (<span class="dv">1</span> <span class="sc">|</span> location),</span>
<span id="cb36-1054"><a href="#cb36-1054"></a>  <span class="at">data =</span> re_data,</span>
<span id="cb36-1055"><a href="#cb36-1055"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"identity"</span>)</span>
<span id="cb36-1056"><a href="#cb36-1056"></a>)</span>
<span id="cb36-1057"><a href="#cb36-1057"></a></span>
<span id="cb36-1058"><a href="#cb36-1058"></a><span class="co"># Tweedie</span></span>
<span id="cb36-1059"><a href="#cb36-1059"></a><span class="co"># Handles zeros and positive skew automatically using a power variance parameter (1&lt;p&lt;2)</span></span>
<span id="cb36-1060"><a href="#cb36-1060"></a>m_tweedie <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb36-1061"><a href="#cb36-1061"></a>  rainfall <span class="sc">~</span> humidity3pm <span class="sc">+</span></span>
<span id="cb36-1062"><a href="#cb36-1062"></a>    dewpoint_9am <span class="sc">+</span></span>
<span id="cb36-1063"><a href="#cb36-1063"></a>    dewpoint_change <span class="sc">+</span></span>
<span id="cb36-1064"><a href="#cb36-1064"></a>    pressure_change <span class="sc">+</span></span>
<span id="cb36-1065"><a href="#cb36-1065"></a>    day_cos <span class="sc">+</span></span>
<span id="cb36-1066"><a href="#cb36-1066"></a>    day_sin <span class="sc">+</span></span>
<span id="cb36-1067"><a href="#cb36-1067"></a>    rainfall_ma7 <span class="sc">+</span></span>
<span id="cb36-1068"><a href="#cb36-1068"></a>    days_since_rain <span class="sc">+</span></span>
<span id="cb36-1069"><a href="#cb36-1069"></a>    humidity_ma7 <span class="sc">+</span></span>
<span id="cb36-1070"><a href="#cb36-1070"></a>    rain_yesterday <span class="sc">+</span></span>
<span id="cb36-1071"><a href="#cb36-1071"></a>    sunshine <span class="sc">+</span></span>
<span id="cb36-1072"><a href="#cb36-1072"></a>    evaporation <span class="sc">+</span></span>
<span id="cb36-1073"><a href="#cb36-1073"></a>    instability_index <span class="sc">+</span></span>
<span id="cb36-1074"><a href="#cb36-1074"></a>    sun_humid_interaction <span class="sc">+</span></span>
<span id="cb36-1075"><a href="#cb36-1075"></a>    cloud_development <span class="sc">+</span></span>
<span id="cb36-1076"><a href="#cb36-1076"></a>    gust_U_EW <span class="sc">+</span></span>
<span id="cb36-1077"><a href="#cb36-1077"></a>    gust_V_NS <span class="sc">+</span></span>
<span id="cb36-1078"><a href="#cb36-1078"></a>    wind9am_V_NS <span class="sc">+</span></span>
<span id="cb36-1079"><a href="#cb36-1079"></a>    wind9am_U_EW <span class="sc">+</span></span>
<span id="cb36-1080"><a href="#cb36-1080"></a>    (<span class="dv">1</span> <span class="sc">|</span> location),</span>
<span id="cb36-1081"><a href="#cb36-1081"></a>  <span class="at">data =</span> re_data,</span>
<span id="cb36-1082"><a href="#cb36-1082"></a>  <span class="at">family =</span> <span class="fu">tweedie</span>(<span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb36-1083"><a href="#cb36-1083"></a>)</span>
<span id="cb36-1084"><a href="#cb36-1084"></a><span class="in">```</span></span>
<span id="cb36-1085"><a href="#cb36-1085"></a></span>
<span id="cb36-1088"><a href="#cb36-1088"></a><span class="in">```{r}</span></span>
<span id="cb36-1089"><a href="#cb36-1089"></a><span class="co">#| label: fig-distribution-comparison</span></span>
<span id="cb36-1090"><a href="#cb36-1090"></a><span class="co">#| fig-cap: "Why Distribution Matters: Comparing Predictive Densities. The Gaussian model (Red) fails catastrophically by predicting negative rainfall (x &lt; 0). The Zero-Inflated Gamma (Blue) and Tweedie (Green) models correctly capture the zero-bound and the long right tail of the actual data (Black Dashed Line)."</span></span>
<span id="cb36-1091"><a href="#cb36-1091"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb36-1092"><a href="#cb36-1092"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb36-1093"><a href="#cb36-1093"></a><span class="co">#| echo: true</span></span>
<span id="cb36-1094"><a href="#cb36-1094"></a><span class="co">#| warning: false</span></span>
<span id="cb36-1095"><a href="#cb36-1095"></a></span>
<span id="cb36-1096"><a href="#cb36-1096"></a><span class="co"># Plot the density of predictions against the ground truth</span></span>
<span id="cb36-1097"><a href="#cb36-1097"></a>check_data <span class="sc">%&gt;%</span></span>
<span id="cb36-1098"><a href="#cb36-1098"></a>  <span class="fu">select</span>(rainfall, pred_linear, pred_tweedie, pred_zig) <span class="sc">%&gt;%</span></span>
<span id="cb36-1099"><a href="#cb36-1099"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb36-1100"><a href="#cb36-1100"></a>    <span class="at">cols =</span> <span class="sc">-</span>rainfall,</span>
<span id="cb36-1101"><a href="#cb36-1101"></a>    <span class="at">names_to =</span> <span class="st">"Model"</span>,</span>
<span id="cb36-1102"><a href="#cb36-1102"></a>    <span class="at">values_to =</span> <span class="st">"Prediction"</span></span>
<span id="cb36-1103"><a href="#cb36-1103"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-1104"><a href="#cb36-1104"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-1105"><a href="#cb36-1105"></a>    <span class="at">Model =</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(</span>
<span id="cb36-1106"><a href="#cb36-1106"></a>      Model,</span>
<span id="cb36-1107"><a href="#cb36-1107"></a>      <span class="at">pred_linear =</span> <span class="st">"Linear (Gaussian)"</span>,</span>
<span id="cb36-1108"><a href="#cb36-1108"></a>      <span class="at">pred_tweedie =</span> <span class="st">"Tweedie"</span>,</span>
<span id="cb36-1109"><a href="#cb36-1109"></a>      <span class="at">pred_zig =</span> <span class="st">"ZI-Gamma (Ours)"</span></span>
<span id="cb36-1110"><a href="#cb36-1110"></a>    )</span>
<span id="cb36-1111"><a href="#cb36-1111"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-1112"><a href="#cb36-1112"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Prediction, <span class="at">fill =</span> Model)) <span class="sc">+</span></span>
<span id="cb36-1113"><a href="#cb36-1113"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb36-1114"><a href="#cb36-1114"></a>  <span class="co"># Ground Truth Overlay (Real Data)</span></span>
<span id="cb36-1115"><a href="#cb36-1115"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb36-1116"><a href="#cb36-1116"></a>    <span class="fu">aes</span>(<span class="at">x =</span> rainfall),</span>
<span id="cb36-1117"><a href="#cb36-1117"></a>    <span class="at">fill =</span> <span class="cn">NA</span>,</span>
<span id="cb36-1118"><a href="#cb36-1118"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb36-1119"><a href="#cb36-1119"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb36-1120"><a href="#cb36-1120"></a>    <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb36-1121"><a href="#cb36-1121"></a>  ) <span class="sc">+</span></span>
<span id="cb36-1122"><a href="#cb36-1122"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Model, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb36-1123"><a href="#cb36-1123"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb36-1124"><a href="#cb36-1124"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-1125"><a href="#cb36-1125"></a>    <span class="at">title =</span> <span class="st">"Why Distribution Matters"</span>,</span>
<span id="cb36-1126"><a href="#cb36-1126"></a>    <span class="at">subtitle =</span> <span class="st">"Black Dashed Line = REAL Data. </span><span class="sc">\n</span><span class="st">Notice Linear predicts impossible negative rain. Tweedie/ZIG capture the shape."</span>,</span>
<span id="cb36-1127"><a href="#cb36-1127"></a>    <span class="at">x =</span> <span class="st">"Predicted Rainfall (mm)"</span>,</span>
<span id="cb36-1128"><a href="#cb36-1128"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb36-1129"><a href="#cb36-1129"></a>  ) <span class="sc">+</span></span>
<span id="cb36-1130"><a href="#cb36-1130"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb36-1131"><a href="#cb36-1131"></a><span class="in">```</span></span>
<span id="cb36-1132"><a href="#cb36-1132"></a></span>
<span id="cb36-1133"><a href="#cb36-1133"></a>Scientific modeling often faces a trade-off between simplicity and accuracy. To justify the complexity of our chosen **Zero-Inflated Gamma (ZI-Gamma)** framework, we benchmarked it against a standard **Gaussian (Linear)** model and a **Tweedie** model.</span>
<span id="cb36-1134"><a href="#cb36-1134"></a></span>
<span id="cb36-1135"><a href="#cb36-1135"></a>**1. The Failure of Linearity (Gaussian):** The left panel of @fig-distribution-comparison illustrates the catastrophic failure of standard linear regression.</span>
<span id="cb36-1136"><a href="#cb36-1136"></a></span>
<span id="cb36-1137"><a href="#cb36-1137"></a><span class="ss">-   </span>**The "Negative Rain" Problem:** The Gaussian model (Pink) assumes a symmetric bell curve errors. To fit the mean correctly, it is forced to predict significant amounts of **negative rainfall** (values $&lt; 0$), which is physically impossible.</span>
<span id="cb36-1138"><a href="#cb36-1138"></a></span>
<span id="cb36-1139"><a href="#cb36-1139"></a><span class="ss">-   </span>**Poor Tail Fit:** It completely fails to capture the long right tail of extreme storm events, under-predicting flood risks.</span>
<span id="cb36-1140"><a href="#cb36-1140"></a></span>
<span id="cb36-1141"><a href="#cb36-1141"></a>**2. Tweedie vs. Zero-Inflated Gamma:** Both the Tweedie (Green) and our ZI-Gamma (Blue) models successfully respect the physical boundary of zero rainfall. They both align closely with the black dashed line (Real Data).</span>
<span id="cb36-1142"><a href="#cb36-1142"></a></span>
<span id="cb36-1143"><a href="#cb36-1143"></a><span class="ss">-   </span>**Why ZI-Gamma?** While Tweedie is efficient, it uses a single process to model both the *probability* of rain and the *intensity*. Our analysis in (Markov Chains Analysis) proved that the drivers of rain *occurrence* (e.g., `pressure_change`) differ slightly from the drivers of *intensity* (e.g., <span class="in">`wind_vectors`</span>).</span>
<span id="cb36-1144"><a href="#cb36-1144"></a></span>
<span id="cb36-1145"><a href="#cb36-1145"></a><span class="ss">-   </span>**Conclusion:** The **Zero-Inflated Gamma** was the superior choice because it allowed us to model these two distinct meteorological processes separately;using a Logit model for the "Zero" state and a Gamma model for the "Wet" state;resulting in the highly accurate, physically interpretable predictions seen in the final panel.</span>
<span id="cb36-1146"><a href="#cb36-1146"></a></span>
<span id="cb36-1147"><a href="#cb36-1147"></a><span class="fu"># Final Model Selection and Variance Analysis</span></span>
<span id="cb36-1148"><a href="#cb36-1148"></a></span>
<span id="cb36-1151"><a href="#cb36-1151"></a><span class="in">```{r}</span></span>
<span id="cb36-1152"><a href="#cb36-1152"></a><span class="co">#| label: model-progression-lrt</span></span>
<span id="cb36-1153"><a href="#cb36-1153"></a><span class="co">#| echo: true</span></span>
<span id="cb36-1154"><a href="#cb36-1154"></a><span class="co">#| message: false</span></span>
<span id="cb36-1155"><a href="#cb36-1155"></a><span class="co">#| warning: false</span></span>
<span id="cb36-1156"><a href="#cb36-1156"></a></span>
<span id="cb36-1157"><a href="#cb36-1157"></a><span class="co"># Likelihood Ratio Tests (LRT)</span></span>
<span id="cb36-1158"><a href="#cb36-1158"></a><span class="co"># Test each progressive addition to ensure it adds significant explanatory power</span></span>
<span id="cb36-1159"><a href="#cb36-1159"></a>lrt_1v0 <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">lrtest</span>(m0_null, m1_moisture)</span>
<span id="cb36-1160"><a href="#cb36-1160"></a>lrt_2v1 <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">lrtest</span>(m1_moisture, m2_temporal)</span>
<span id="cb36-1161"><a href="#cb36-1161"></a>lrt_3v2 <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">lrtest</span>(m2_temporal, m3_history)</span>
<span id="cb36-1162"><a href="#cb36-1162"></a>lrt_4v3 <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">lrtest</span>(m3_history, m4_energy)</span>
<span id="cb36-1163"><a href="#cb36-1163"></a>lrt_5v4 <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">lrtest</span>(m4_energy, m5_wind)</span>
<span id="cb36-1164"><a href="#cb36-1164"></a>lrt_6v5 <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">lrtest</span>(m5_wind, m6_mixed)</span>
<span id="cb36-1165"><a href="#cb36-1165"></a></span>
<span id="cb36-1166"><a href="#cb36-1166"></a><span class="co"># Compile Results Table</span></span>
<span id="cb36-1167"><a href="#cb36-1167"></a>lrt_results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb36-1168"><a href="#cb36-1168"></a>  <span class="at">Comparison =</span> <span class="fu">c</span>(</span>
<span id="cb36-1169"><a href="#cb36-1169"></a>    <span class="st">"Null vs Moisture"</span>,</span>
<span id="cb36-1170"><a href="#cb36-1170"></a>    <span class="st">"Moisture vs Temporal"</span>,</span>
<span id="cb36-1171"><a href="#cb36-1171"></a>    <span class="st">"Temporal vs History"</span>,</span>
<span id="cb36-1172"><a href="#cb36-1172"></a>    <span class="st">"History vs Energy"</span>,</span>
<span id="cb36-1173"><a href="#cb36-1173"></a>    <span class="st">"Energy vs Wind"</span>,</span>
<span id="cb36-1174"><a href="#cb36-1174"></a>    <span class="st">"Wind vs Mixed Effects"</span></span>
<span id="cb36-1175"><a href="#cb36-1175"></a>  ),</span>
<span id="cb36-1176"><a href="#cb36-1176"></a>  <span class="at">Chi_square =</span> <span class="fu">c</span>(</span>
<span id="cb36-1177"><a href="#cb36-1177"></a>    lrt_1v0<span class="sc">$</span>Chisq[<span class="dv">2</span>],</span>
<span id="cb36-1178"><a href="#cb36-1178"></a>    lrt_2v1<span class="sc">$</span>Chisq[<span class="dv">2</span>],</span>
<span id="cb36-1179"><a href="#cb36-1179"></a>    lrt_3v2<span class="sc">$</span>Chisq[<span class="dv">2</span>],</span>
<span id="cb36-1180"><a href="#cb36-1180"></a>    lrt_4v3<span class="sc">$</span>Chisq[<span class="dv">2</span>],</span>
<span id="cb36-1181"><a href="#cb36-1181"></a>    lrt_5v4<span class="sc">$</span>Chisq[<span class="dv">2</span>],</span>
<span id="cb36-1182"><a href="#cb36-1182"></a>    lrt_6v5<span class="sc">$</span>Chisq[<span class="dv">2</span>]</span>
<span id="cb36-1183"><a href="#cb36-1183"></a>  ),</span>
<span id="cb36-1184"><a href="#cb36-1184"></a>  <span class="at">df =</span> <span class="fu">c</span>(</span>
<span id="cb36-1185"><a href="#cb36-1185"></a>    lrt_1v0<span class="sc">$</span>Df[<span class="dv">2</span>],</span>
<span id="cb36-1186"><a href="#cb36-1186"></a>    lrt_2v1<span class="sc">$</span>Df[<span class="dv">2</span>],</span>
<span id="cb36-1187"><a href="#cb36-1187"></a>    lrt_3v2<span class="sc">$</span>Df[<span class="dv">2</span>],</span>
<span id="cb36-1188"><a href="#cb36-1188"></a>    lrt_4v3<span class="sc">$</span>Df[<span class="dv">2</span>],</span>
<span id="cb36-1189"><a href="#cb36-1189"></a>    lrt_5v4<span class="sc">$</span>Df[<span class="dv">2</span>],</span>
<span id="cb36-1190"><a href="#cb36-1190"></a>    lrt_6v5<span class="sc">$</span>Df[<span class="dv">2</span>]</span>
<span id="cb36-1191"><a href="#cb36-1191"></a>  ),</span>
<span id="cb36-1192"><a href="#cb36-1192"></a>  <span class="at">raw_p =</span> <span class="fu">c</span>(</span>
<span id="cb36-1193"><a href="#cb36-1193"></a>    lrt_1v0<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chisq)</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb36-1194"><a href="#cb36-1194"></a>    lrt_2v1<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chisq)</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb36-1195"><a href="#cb36-1195"></a>    lrt_3v2<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chisq)</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb36-1196"><a href="#cb36-1196"></a>    lrt_4v3<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chisq)</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb36-1197"><a href="#cb36-1197"></a>    lrt_5v4<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chisq)</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb36-1198"><a href="#cb36-1198"></a>    lrt_6v5<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chisq)</span><span class="st">`</span>[<span class="dv">2</span>]</span>
<span id="cb36-1199"><a href="#cb36-1199"></a>  )</span>
<span id="cb36-1200"><a href="#cb36-1200"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb36-1201"><a href="#cb36-1201"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-1202"><a href="#cb36-1202"></a>    <span class="at">adj_p_value =</span> <span class="fu">p.adjust</span>(raw_p, <span class="at">method =</span> <span class="st">"holm"</span>),</span>
<span id="cb36-1203"><a href="#cb36-1203"></a>    <span class="at">Significant =</span> <span class="fu">ifelse</span>(</span>
<span id="cb36-1204"><a href="#cb36-1204"></a>      adj_p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>,</span>
<span id="cb36-1205"><a href="#cb36-1205"></a>      <span class="st">"***"</span>,</span>
<span id="cb36-1206"><a href="#cb36-1206"></a>      <span class="fu">ifelse</span>(adj_p_value <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="st">"**"</span>, <span class="fu">ifelse</span>(adj_p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"*"</span>, <span class="st">"ns"</span>))</span>
<span id="cb36-1207"><a href="#cb36-1207"></a>    ),</span>
<span id="cb36-1208"><a href="#cb36-1208"></a>    <span class="at">AIC_improvement =</span> <span class="fu">c</span>(</span>
<span id="cb36-1209"><a href="#cb36-1209"></a>      <span class="fu">AIC</span>(m0_null) <span class="sc">-</span> <span class="fu">AIC</span>(m1_moisture),</span>
<span id="cb36-1210"><a href="#cb36-1210"></a>      <span class="fu">AIC</span>(m1_moisture) <span class="sc">-</span> <span class="fu">AIC</span>(m2_temporal),</span>
<span id="cb36-1211"><a href="#cb36-1211"></a>      <span class="fu">AIC</span>(m2_temporal) <span class="sc">-</span> <span class="fu">AIC</span>(m3_history),</span>
<span id="cb36-1212"><a href="#cb36-1212"></a>      <span class="fu">AIC</span>(m3_history) <span class="sc">-</span> <span class="fu">AIC</span>(m4_energy),</span>
<span id="cb36-1213"><a href="#cb36-1213"></a>      <span class="fu">AIC</span>(m4_energy) <span class="sc">-</span> <span class="fu">AIC</span>(m5_wind),</span>
<span id="cb36-1214"><a href="#cb36-1214"></a>      <span class="fu">AIC</span>(m5_wind) <span class="sc">-</span> <span class="fu">AIC</span>(m6_mixed)</span>
<span id="cb36-1215"><a href="#cb36-1215"></a>    )</span>
<span id="cb36-1216"><a href="#cb36-1216"></a>  )</span>
<span id="cb36-1217"><a href="#cb36-1217"></a></span>
<span id="cb36-1218"><a href="#cb36-1218"></a>lrt_results <span class="sc">%&gt;%</span></span>
<span id="cb36-1219"><a href="#cb36-1219"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-1220"><a href="#cb36-1220"></a>    <span class="at">Chi_square =</span> <span class="fu">round</span>(Chi_square, <span class="dv">2</span>),</span>
<span id="cb36-1221"><a href="#cb36-1221"></a>    <span class="at">AIC_improvement =</span> <span class="fu">round</span>(AIC_improvement, <span class="dv">1</span>)</span>
<span id="cb36-1222"><a href="#cb36-1222"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-1223"><a href="#cb36-1223"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Likelihood Ratio Tests: Progressive Model Building"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-1224"><a href="#cb36-1224"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb36-1225"><a href="#cb36-1225"></a><span class="in">```</span></span>
<span id="cb36-1226"><a href="#cb36-1226"></a></span>
<span id="cb36-1229"><a href="#cb36-1229"></a><span class="in">```{r}</span></span>
<span id="cb36-1230"><a href="#cb36-1230"></a><span class="co">#| label: tbl-model-selection</span></span>
<span id="cb36-1231"><a href="#cb36-1231"></a><span class="co">#| tbl-cap: "Model Selection Table"</span></span>
<span id="cb36-1232"><a href="#cb36-1232"></a><span class="co">#| echo: true</span></span>
<span id="cb36-1233"><a href="#cb36-1233"></a></span>
<span id="cb36-1234"><a href="#cb36-1234"></a>model_selection <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb36-1235"><a href="#cb36-1235"></a>  <span class="at">Model =</span> <span class="fu">c</span>(</span>
<span id="cb36-1236"><a href="#cb36-1236"></a>    <span class="st">"m0_null"</span>,</span>
<span id="cb36-1237"><a href="#cb36-1237"></a>    <span class="st">"m1_moisture"</span>,</span>
<span id="cb36-1238"><a href="#cb36-1238"></a>    <span class="st">"m2_temporal"</span>,</span>
<span id="cb36-1239"><a href="#cb36-1239"></a>    <span class="st">"m3_history"</span>,</span>
<span id="cb36-1240"><a href="#cb36-1240"></a>    <span class="st">"m4_energy"</span>,</span>
<span id="cb36-1241"><a href="#cb36-1241"></a>    <span class="st">"m5_wind"</span>,</span>
<span id="cb36-1242"><a href="#cb36-1242"></a>    <span class="st">"m6_mixed"</span></span>
<span id="cb36-1243"><a href="#cb36-1243"></a>  ),</span>
<span id="cb36-1244"><a href="#cb36-1244"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(</span>
<span id="cb36-1245"><a href="#cb36-1245"></a>    <span class="fu">AIC</span>(m0_null),</span>
<span id="cb36-1246"><a href="#cb36-1246"></a>    <span class="fu">AIC</span>(m1_moisture),</span>
<span id="cb36-1247"><a href="#cb36-1247"></a>    <span class="fu">AIC</span>(m2_temporal),</span>
<span id="cb36-1248"><a href="#cb36-1248"></a>    <span class="fu">AIC</span>(m3_history),</span>
<span id="cb36-1249"><a href="#cb36-1249"></a>    <span class="fu">AIC</span>(m4_energy),</span>
<span id="cb36-1250"><a href="#cb36-1250"></a>    <span class="fu">AIC</span>(m5_wind),</span>
<span id="cb36-1251"><a href="#cb36-1251"></a>    <span class="fu">AIC</span>(m6_mixed)</span>
<span id="cb36-1252"><a href="#cb36-1252"></a>  ),</span>
<span id="cb36-1253"><a href="#cb36-1253"></a>  <span class="at">BIC =</span> <span class="fu">c</span>(</span>
<span id="cb36-1254"><a href="#cb36-1254"></a>    <span class="fu">BIC</span>(m0_null),</span>
<span id="cb36-1255"><a href="#cb36-1255"></a>    <span class="fu">BIC</span>(m1_moisture),</span>
<span id="cb36-1256"><a href="#cb36-1256"></a>    <span class="fu">BIC</span>(m2_temporal),</span>
<span id="cb36-1257"><a href="#cb36-1257"></a>    <span class="fu">BIC</span>(m3_history),</span>
<span id="cb36-1258"><a href="#cb36-1258"></a>    <span class="fu">BIC</span>(m4_energy),</span>
<span id="cb36-1259"><a href="#cb36-1259"></a>    <span class="fu">BIC</span>(m5_wind),</span>
<span id="cb36-1260"><a href="#cb36-1260"></a>    <span class="fu">BIC</span>(m6_mixed)</span>
<span id="cb36-1261"><a href="#cb36-1261"></a>  )</span>
<span id="cb36-1262"><a href="#cb36-1262"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb36-1263"><a href="#cb36-1263"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-1264"><a href="#cb36-1264"></a>    <span class="at">Delta_AIC =</span> AIC <span class="sc">-</span> <span class="fu">min</span>(AIC),</span>
<span id="cb36-1265"><a href="#cb36-1265"></a>    <span class="at">AIC_weight =</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> Delta_AIC) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> Delta_AIC))</span>
<span id="cb36-1266"><a href="#cb36-1266"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-1267"><a href="#cb36-1267"></a>  <span class="fu">arrange</span>(AIC)</span>
<span id="cb36-1268"><a href="#cb36-1268"></a></span>
<span id="cb36-1269"><a href="#cb36-1269"></a>model_selection <span class="sc">%&gt;%</span></span>
<span id="cb36-1270"><a href="#cb36-1270"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(., <span class="dv">2</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb36-1271"><a href="#cb36-1271"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Model Selection Table"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-1272"><a href="#cb36-1272"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb36-1273"><a href="#cb36-1273"></a></span>
<span id="cb36-1274"><a href="#cb36-1274"></a><span class="in">```</span></span>
<span id="cb36-1275"><a href="#cb36-1275"></a></span>
<span id="cb36-1278"><a href="#cb36-1278"></a><span class="in">```{r}</span></span>
<span id="cb36-1279"><a href="#cb36-1279"></a><span class="co">#| label: fig-model-selection</span></span>
<span id="cb36-1280"><a href="#cb36-1280"></a><span class="co">#| fig-cap: "Model Selection: Progressive Improvement. The AIC drops significantly at every stage, confirming that no step was redundant. The largest jump occurs when adding basic moisture variables, but the addition of Spatial Mixed Effects (M6) also provides a massive improvement over the Wind model (M5)."</span></span>
<span id="cb36-1281"><a href="#cb36-1281"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb36-1282"><a href="#cb36-1282"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb36-1283"><a href="#cb36-1283"></a><span class="co">#| echo: true</span></span>
<span id="cb36-1284"><a href="#cb36-1284"></a><span class="co">#| message: false</span></span>
<span id="cb36-1285"><a href="#cb36-1285"></a></span>
<span id="cb36-1286"><a href="#cb36-1286"></a><span class="fu">ggplot</span>(</span>
<span id="cb36-1287"><a href="#cb36-1287"></a>  model_selection,</span>
<span id="cb36-1288"><a href="#cb36-1288"></a>  <span class="fu">aes</span>(</span>
<span id="cb36-1289"><a href="#cb36-1289"></a>    <span class="at">x =</span> <span class="fu">factor</span>(</span>
<span id="cb36-1290"><a href="#cb36-1290"></a>      Model,</span>
<span id="cb36-1291"><a href="#cb36-1291"></a>      <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb36-1292"><a href="#cb36-1292"></a>        <span class="st">"m6_mixed"</span>,</span>
<span id="cb36-1293"><a href="#cb36-1293"></a>        <span class="st">"m5_wind"</span>,</span>
<span id="cb36-1294"><a href="#cb36-1294"></a>        <span class="st">"m4_energy"</span>,</span>
<span id="cb36-1295"><a href="#cb36-1295"></a>        <span class="st">"m3_history"</span>,</span>
<span id="cb36-1296"><a href="#cb36-1296"></a>        <span class="st">"m2_temporal"</span>,</span>
<span id="cb36-1297"><a href="#cb36-1297"></a>        <span class="st">"m1_moisture"</span>,</span>
<span id="cb36-1298"><a href="#cb36-1298"></a>        <span class="st">"m0_null"</span></span>
<span id="cb36-1299"><a href="#cb36-1299"></a>      )</span>
<span id="cb36-1300"><a href="#cb36-1300"></a>    ),</span>
<span id="cb36-1301"><a href="#cb36-1301"></a>    <span class="at">y =</span> AIC</span>
<span id="cb36-1302"><a href="#cb36-1302"></a>  )</span>
<span id="cb36-1303"><a href="#cb36-1303"></a>) <span class="sc">+</span></span>
<span id="cb36-1304"><a href="#cb36-1304"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span></span>
<span id="cb36-1305"><a href="#cb36-1305"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb36-1306"><a href="#cb36-1306"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb36-1307"><a href="#cb36-1307"></a>    <span class="at">yintercept =</span> <span class="fu">min</span>(model_selection<span class="sc">$</span>AIC),</span>
<span id="cb36-1308"><a href="#cb36-1308"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb36-1309"><a href="#cb36-1309"></a>    <span class="at">color =</span> <span class="st">"red"</span></span>
<span id="cb36-1310"><a href="#cb36-1310"></a>  ) <span class="sc">+</span></span>
<span id="cb36-1311"><a href="#cb36-1311"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb36-1312"><a href="#cb36-1312"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"delta=%.0f"</span>, Delta_AIC)),</span>
<span id="cb36-1313"><a href="#cb36-1313"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb36-1314"><a href="#cb36-1314"></a>    <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb36-1315"><a href="#cb36-1315"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span></span>
<span id="cb36-1316"><a href="#cb36-1316"></a>  ) <span class="sc">+</span></span>
<span id="cb36-1317"><a href="#cb36-1317"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-1318"><a href="#cb36-1318"></a>    <span class="at">title =</span> <span class="st">"Model Selection: Progressive Improvement"</span>,</span>
<span id="cb36-1319"><a href="#cb36-1319"></a>    <span class="at">subtitle =</span> <span class="st">"Each step significantly improves fit (LRT p &lt; 0.001 for all comparisons)"</span>,</span>
<span id="cb36-1320"><a href="#cb36-1320"></a>    <span class="at">x =</span> <span class="st">"Model (Ordered by Complexity)"</span>,</span>
<span id="cb36-1321"><a href="#cb36-1321"></a>    <span class="at">y =</span> <span class="st">"AIC (Lower is Better)"</span>,</span>
<span id="cb36-1322"><a href="#cb36-1322"></a>    <span class="at">caption =</span> <span class="st">"Red line = Best Model (M6 Mixed)"</span></span>
<span id="cb36-1323"><a href="#cb36-1323"></a>  ) <span class="sc">+</span></span>
<span id="cb36-1324"><a href="#cb36-1324"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb36-1325"><a href="#cb36-1325"></a>  <span class="fu">theme</span>(</span>
<span id="cb36-1326"><a href="#cb36-1326"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb36-1327"><a href="#cb36-1327"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb36-1328"><a href="#cb36-1328"></a>  )</span>
<span id="cb36-1329"><a href="#cb36-1329"></a><span class="in">```</span></span>
<span id="cb36-1330"><a href="#cb36-1330"></a></span>
<span id="cb36-1333"><a href="#cb36-1333"></a><span class="in">```{r}</span></span>
<span id="cb36-1334"><a href="#cb36-1334"></a><span class="co">#| label: model-r2</span></span>
<span id="cb36-1335"><a href="#cb36-1335"></a><span class="co">#| echo: true</span></span>
<span id="cb36-1336"><a href="#cb36-1336"></a><span class="co">#| collapse: true</span></span>
<span id="cb36-1337"><a href="#cb36-1337"></a></span>
<span id="cb36-1338"><a href="#cb36-1338"></a><span class="co"># Random Effects Necessity Test (LRT M5 vs M6)</span></span>
<span id="cb36-1339"><a href="#cb36-1339"></a>re_test <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">lrtest</span>(m5_wind, m6_mixed)</span>
<span id="cb36-1340"><a href="#cb36-1340"></a><span class="fu">print</span>(re_test)</span>
<span id="cb36-1341"><a href="#cb36-1341"></a></span>
<span id="cb36-1342"><a href="#cb36-1342"></a><span class="co"># Nakagawa's R-Squared</span></span>
<span id="cb36-1343"><a href="#cb36-1343"></a><span class="co"># Decomposes variance into Fixed Effects (Marginal) vs. Random Effects (Conditional)</span></span>
<span id="cb36-1344"><a href="#cb36-1344"></a>r2_vals <span class="ot">&lt;-</span> performance<span class="sc">::</span><span class="fu">r2_nakagawa</span>(m6_mixed)</span>
<span id="cb36-1345"><a href="#cb36-1345"></a></span>
<span id="cb36-1346"><a href="#cb36-1346"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Marginal R2 (Fixed Effects only): %.4f</span><span class="sc">\n</span><span class="st">"</span>, r2_vals<span class="sc">$</span>R2_marginal))</span>
<span id="cb36-1347"><a href="#cb36-1347"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(</span>
<span id="cb36-1348"><a href="#cb36-1348"></a>  <span class="st">"Conditional R2 (Fixed + Random Effects): %.4f</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb36-1349"><a href="#cb36-1349"></a>  r2_vals<span class="sc">$</span>R2_conditional</span>
<span id="cb36-1350"><a href="#cb36-1350"></a>))</span>
<span id="cb36-1351"><a href="#cb36-1351"></a><span class="in">```</span></span>
<span id="cb36-1352"><a href="#cb36-1352"></a></span>
<span id="cb36-1353"><a href="#cb36-1353"></a>We employed a strict forward-selection strategy, verifying that each additional layer of complexity provided statistically significant information gain.</span>
<span id="cb36-1354"><a href="#cb36-1354"></a></span>
<span id="cb36-1355"><a href="#cb36-1355"></a>**1. Progressive Improvement:** As shown in @fig-model-selection , the AIC decreased monotonically with every model update.</span>
<span id="cb36-1356"><a href="#cb36-1356"></a></span>
<span id="cb36-1357"><a href="#cb36-1357"></a><span class="ss">-   </span>**Largest Gain:** The shift from Null to M1 (Moisture) reduced AIC by \~38,000, confirming that humidity is the primary driver.</span>
<span id="cb36-1358"><a href="#cb36-1358"></a></span>
<span id="cb36-1359"><a href="#cb36-1359"></a><span class="ss">-   </span>**Final Gain:** The shift from M5 (Wind) to M6 (Mixed) reduced AIC by \~7,600. This is a massive improvement for a late-stage addition, proving that **spatial heterogeneity** is not a minor nuisance but a fundamental component of the Australian climate system.</span>
<span id="cb36-1360"><a href="#cb36-1360"></a></span>
<span id="cb36-1361"><a href="#cb36-1361"></a>**2. Likelihood Ratio Tests:** The formal LRT table confirms that every comparison yielded a p-value $&lt; 0.001$. Even the smallest step (Wind Vectors, M5) improved the model significantly ($\chi^2 = 607, df=4$), justifying the inclusion of compass-based predictors.</span>
<span id="cb36-1362"><a href="#cb36-1362"></a></span>
<span id="cb36-1363"><a href="#cb36-1363"></a>**3. Variance Explained (**$R^2$): Using Nakagawa’s method for Generalized Linear Mixed Models:</span>
<span id="cb36-1364"><a href="#cb36-1364"></a></span>
<span id="cb36-1365"><a href="#cb36-1365"></a><span class="ss">-   </span>**Marginal** $R^2 = 0.345$: Our fixed meteorological predictors (Humidity, Wind, Pressure, etc.) explain **34.5%** of the variance in rainfall intensity.</span>
<span id="cb36-1366"><a href="#cb36-1366"></a></span>
<span id="cb36-1367"><a href="#cb36-1367"></a><span class="ss">-   </span>**Conditional** $R^2 = 0.441$: When we include the location-specific random effects, the explanatory power jumps to **44.1%**.</span>
<span id="cb36-1368"><a href="#cb36-1368"></a></span>
<span id="cb36-1369"><a href="#cb36-1369"></a><span class="ss">-   </span>**Insight:** Roughly **10% of the explainable variance** in Australian rainfall is purely geographic;attributable to the specific location of the city (e.g., coastal vs. inland) rather than dynamic weather variables.</span>
<span id="cb36-1370"><a href="#cb36-1370"></a></span>
<span id="cb36-1371"><a href="#cb36-1371"></a>**Conclusion:** Model 6 (Mixed Effects Zero-Inflated Gamma) is the statistically superior model. It maximizes likelihood, minimizes information loss (AIC/BIC), and captures significant spatial variance that fixed-effects models miss.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/blob/main/04-modeling.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/chrisolande/Statistical-Inference-Zero-Inflated-Models/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>