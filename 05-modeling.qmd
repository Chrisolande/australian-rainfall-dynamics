# Modelling
## A Progressive Zero-Inflated Gamma Framework for Australian Rainfall

---

> **Chapter Context.** This chapter constructs the statistical model incrementally, beginning from a null baseline and introducing successive layers of physical complexity. Each model corresponds to a coherent hypothesis about the mechanisms driving Australian rainfall, tested against its predecessor via likelihood-based criteria. The model family Zero-Inflated Gamma (ZIG) was selected in direct response to the distributional findings from the EDA: the 64% zero-inflation rate and extreme positive skew of the rainfall distribution make a single-component Gaussian model fundamentally inappropriate.

---

## Model Architecture

A Zero-Inflated Gamma model is a two-component mixture. The first component, the zero-inflation submodel, is a logistic regression that estimates the probability of a structurally zero outcome (a dry day on which no precipitation occurs regardless of atmospheric conditions). The second component, the conditional intensity submodel, is a Gamma regression (with log link) that models the expected rainfall given that rain does fall. Together they answer the two questions identified in @sec-eda: "Will it rain?" and "If so, how much?"

Formally, for observation $i$:

$$P(Y_i = 0) = \pi_i + (1 - \pi_i) \cdot f_\Gamma(0)$$
$$P(Y_i = y) = (1 - \pi_i) \cdot f_\Gamma(y \mid \mu_i, \phi), \quad y > 0$$

where $\pi_i = \text{logit}^{-1}(\mathbf{z}_i^\top \boldsymbol{\gamma})$ is the zero-inflation probability and $\mu_i = \exp(\mathbf{x}_i^\top \boldsymbol{\beta})$ is the conditional mean intensity. The two linear predictors, $\mathbf{z}_i$ and $\mathbf{x}_i$, can include different sets of covariates, allowing predictors of *occurrence* to differ from predictors of *intensity*. All models were fitted using `glmmTMB`, which implements maximum likelihood estimation for this family via the Template Model Builder.

Progressive model construction serves two purposes. It provides a transparent audit trail connecting each modelling decision to its empirical motivation. It also enables incremental comparison: each model can be evaluated against its predecessor to isolate the contribution of the newly added component.

```{r}
#| label: setup-modeling
#| include: false

librarian::shelf(
  tidyverse,
  glmmTMB,
  sjPlot,
  DHARMa,
  kableExtra,
  gtsummary,
  lmtest,
  performance,
  gt,
  broom.mixed,
  parallel,
  splines,
  pROC,
  here
)


all_datasets <- readRDS(here::here("data", "all_datasets.rds"))

source(here::here("utils.R"))


models <- list(
  m0_null     = "m0_null_pooled.rds",
  m1_moisture = "m1_moisture_pooled.rds",
  m2_temporal = "m2_temporal_pooled.rds",
  m3_history  = "m3_history_pooled.rds",
  m4_energy   = "m4_energy_pooled.rds",
  m5_wind     = "m5_wind_pooled.rds",
  m6_mixed    = "m6_mixed_pooled.rds"
) %>%
  lapply(function(f) readRDS(here::here("models", f)))

list2env(models, envir = .GlobalEnv)

```

```{r}
#| label: def-fit-and-pool
#| echo: true

fit_and_pool <- function(cond_formula, zi_formula, datasets, 
                         control = glmmTMBControl(), n_cores = 2L) {
  
  fits <- parallel::mclapply(seq_along(datasets), function(i) {
    glmmTMB(
      formula   = cond_formula,
      ziformula = zi_formula,
      family    = ziGamma(link = "log"),
      control   = control,
      data      = datasets[[i]]
    )
  }, mc.cores = n_cores)
  
  # Check for errors from mclapply
  errors <- sapply(fits, inherits, "try-error")
  if (any(errors)) {
    warning(sprintf("%d model(s) failed to converge", sum(errors)))
    fits <- fits[!errors]
  }
  
  pooled <- fits %>%
    mice::as.mira() %>%
    mice::pool()
  
  fit_stats <- data.frame(
    AIC    = mean(sapply(fits, AIC)),
    BIC    = mean(sapply(fits, BIC)),
    logLik = mean(sapply(fits, function(f) as.numeric(logLik(f))))
  )
  
  list(
    pooled    = summary(pooled, conf.int = TRUE),
    fit_stats = fit_stats
  )
}
```

---

## Model 0: Null Baseline

```{r}
#| label: null-model-fit
#| echo: true
#| message: false
#| eval: false

m0_null <- fit_and_pool(
  cond_formula = rainfall ~ 1,
  zi_formula = ~1,
  datasets = all_datasets
)
```

```{r}
#| label: null-model-output

render_pooled_model_table(m0_null, "M0: Null Baseline")
```

Before introducing any covariates, we fit an intercept-only model whose sole purpose is to verify that the ZIG model structure correctly recovers the fundamental statistical properties of the dataset. A null model that fails this calibration check would undermine the validity of all subsequent extensions.

The zero-inflation intercept $\hat{\beta}_{zi} = 0.577$ (SE = 0.006, $p < 0.001$) back-transforms through the logistic function to an implied dry-day probability of:

$$\hat{P}(\text{Dry}) = \frac{e^{0.577}}{1 + e^{0.577}} \approx 64.03\%$$

This matches the empirically observed zero-inflation rate of 64.05% to within a rounding error, confirming that the hurdle mechanism is correctly calibrated to the data-generating process. The conditional intensity intercept $\hat{\beta}_{cond} = 1.883$ (SE = 0.006, $p < 0.001$) recovers a mean rainy-day intensity of $e^{1.883} \approx 6.57$ mm, consistent with the non-zero conditional mean established in @sec-eda. Both intercepts are estimated with exceptional precision, reflecting the large sample size and the fact that an intercept-only model imposes no distributional misspecification beyond the assumed family.

This model yields AIC = 461,669.7 and BIC = 461,699.3, serving as the reference against which all subsequent gains are measured.

---

## Model 1: Moisture and Pressure Dynamics

```{r}
#| label: m1-moisture-code
#| echo: true
#| eval: false

m1_moisture <- fit_and_pool(
  cond_formula = rainfall ~ 1 + humidity3pm + dewpoint_9am + dewpoint_change + pressure_change,
  zi_formula   = ~ humidity3pm + dewpoint_9am
)
```

```{r}
#| label: m1-moisture-output
#| echo: false

render_pooled_model_table(m1_moisture, "Model 1: Moisture and Pressure Dynamics")
```

The correlation analysis in @sec-eda identified afternoon relative humidity and morning dewpoint temperature as among the strongest individual predictors of rainfall occurrence. That analysis also established that both the absolute level and the diurnal rate of change of sea-level pressure carry discriminating signal. Model 1 formalises these findings by introducing the four most physically direct atmospheric moisture and pressure drivers into the conditional intensity submodel, and a subset of the moisture indicators into the zero-inflation submodel.

The AIC falls from 461,669.7 to 425,731.4, a reduction of 35,938.3 points. This is the largest single improvement across the entire model sequence, and its magnitude confirms that atmospheric moisture and pressure dynamics are not merely correlated with rainfall but constitute its fundamental predictive substrate. All four conditional predictors are highly significant ($p < 0.001$).

The positive coefficients for `humidity3pm` ($\hat{\beta} = 0.403$, $e^{0.403} \approx 1.50$) and `dewpoint_9am` ($\hat{\beta} = 0.300$, $e^{0.300} \approx 1.35$) establish that both the relative saturation of the afternoon boundary layer and the absolute moisture content of the morning atmosphere independently amplify rainfall intensity on days when precipitation occurs. These two predictors operate at different timescales: afternoon humidity reflects the near-instantaneous condition of the lower troposphere as convective processes become active, while morning dewpoint captures the ambient moisture available before any daytime heating-driven changes have taken effect.

The dewpoint change coefficient ($\hat{\beta} = -0.155$, $p < 0.001$) is negative, indicating that a diurnal drop in dewpoint from morning to afternoon (consistent with the dry air entrainment accompanying subsiding high-pressure systems) is associated with reduced rainfall intensity. Conversely, a rise in pressure over the observation window ($\hat{\beta} = 0.116$, $p = 0.007$) is positively associated with intensity, a somewhat counterintuitive result that likely reflects synoptic-scale convergence patterns preceding frontal rainfall.

The zero-inflation submodel reveals a meaningful asymmetry between the two moisture variables. The `humidity3pm` coefficient of $-1.038$ ($p < 0.001$) is strongly negative in the logistic framework: since the outcome modelled is the dry-day indicator, this implies that higher afternoon humidity substantially reduces the probability of a dry day and thereby increases the probability of rainfall. `dewpoint_9am`, by contrast, is not significant in the zero-inflation component ($\hat{\beta} = 0.002$, $p = 0.840$). This dissociation suggests that it is the relative saturation of the afternoon atmosphere that determines whether the thermodynamic threshold for precipitation is crossed, while the absolute morning moisture content shapes the intensity of rainfall once that threshold has been exceeded.

---

## Model 2: Seasonality and Day-to-Day Persistence

```{r}
#| label: m2-temporal-code
#| echo: true
#| eval: false

m2_temporal <- fit_and_pool(
  cond_formula = rainfall ~ 1 + humidity3pm + dewpoint_9am + dewpoint_change + pressure_change + day_cos + day_sin,
  zi_formula   = ~ humidity3pm + dewpoint_9am + rain_yesterday + cloud_development + pressure_change
)
```

```{r}
#| label: m2-temporal-output
#| echo: false

render_pooled_model_table(m2_temporal, "Model 2: Seasonality and Persistence Effects")
```

Having established moisture and pressure as foundational drivers, Model 2 incorporates the temporal structure identified in @sec-eda. The Markov Chain analysis in @sec-markov demonstrated that the previous day's rain state carries a moderate but practically significant effect (CramÃ©r's $V \approx 0.31$), and the seasonal decomposition confirmed that both frequency and intensity of rainfall follow a smooth annual cycle. Circular sine and cosine encodings of the day-of-year enter the conditional intensity submodel, capturing this periodicity without imposing a discontinuity at the calendar year boundary. The binary indicator `rain_yesterday`, the `cloud_development` index, and `pressure_change` are added to the zero-inflation component to account for daily persistence and synoptic-scale dynamics in the occurrence process.

The AIC falls to 412,448.4, a reduction of 13,282.6 points relative to Model 1 (BIC = 412,586.5). This improvement confirms that temporal context, specifically both where in the annual cycle a day falls and what occurred the preceding day, contributes substantial predictive information beyond the instantaneous atmospheric state.

Both seasonal harmonics are statistically significant. The cosine term ($\hat{\beta} = 0.086$, $p < 0.001$) captures the primary annual amplitude, while the sine term ($\hat{\beta} = -0.016$, $p = 0.027$) adjusts the timing of the seasonal peak. Together, they encode the well-documented shift toward wetter conditions during the austral summer across much of the continent, where enhanced monsoonal circulation and elevated sea-surface temperatures increase tropospheric moisture convergence.

The most numerically dominant result is the persistence coefficient in the zero-inflation submodel. With $\hat{\beta}_{zi}(\text{rain\_yesterday}) = -1.449$ (SE = 0.016, $p < 0.001$), it is the strongest predictor in the hurdle component across the entire model sequence. Exponentiating gives $e^{-1.449} \approx 0.235$: having rained the previous day reduces the odds of today being classified as dry by approximately 76.5%. This directly quantifies the asymmetric persistence documented in the Markov transition matrix of @sec-markov, wherein wet states are substantially more self-sustaining than dry states. Physically, this reflects the tendency for synoptic weather systems (fronts, troughs, and tropical lows) to persist over multiple days rather than generating isolated single-day precipitation events.

The `cloud_development` term in the zero-inflation submodel ($\hat{\beta} = 0.115$, $p < 0.001$) is positive, implying that greater cloud development is associated with a higher probability of a dry day. This initially counterintuitive result likely reflects the distinction between cloud cover associated with stable, non-precipitating high-pressure systems and the moisture-laden systems that drive actual precipitation. In the presence of the strong humidity predictors already in the model, incremental cloud growth may serve as a proxy for convective inhibition rather than precipitation potential.

---

## Model 3: Accumulated Weather History

```{r}
#| label: m3-history-code
#| echo: true
#| eval: false

m3_history <- fit_and_pool(
  cond_formula = rainfall ~ 1 + humidity3pm + dewpoint_9am + dewpoint_change +
                 pressure_change + day_cos + day_sin + rainfall_ma7 + 
                 days_since_rain + humidity_ma7 + rain_yesterday,
  zi_formula   = ~ humidity3pm + dewpoint_9am + rain_yesterday + 
                 cloud_development + pressure_change
)
```

```{r}
#| label: m3-history-output
#| echo: false

render_pooled_model_table(m3_history, "Model 3: Accumulated Weather History")
```

While Model 2 captured the binary rain state of the previous day, it does not represent the *accumulated* atmospheric condition over a longer antecedent window. The dry spell analysis in @sec-dry-spell demonstrated that rainfall probability decays as dry spells lengthen, and the moving average analysis showed that 7-day smoothed signals substantially reduce the stochastic variance of both the rainfall and humidity series. Model 3 introduces these medium-horizon history features (`rainfall_ma7`, `humidity_ma7`, `days_since_rain`, and the binary `rain_yesterday`) into the conditional intensity submodel.

The AIC falls to 411,060.3, a reduction of 1,388.1 points relative to Model 2 (BIC = 411,277.3). This gain is smaller than the earlier improvements, reflecting the natural diminishing returns of adding temporally redundant information once the most immediate prior state has already been captured. The reduction is nonetheless genuine and statistically consistent across imputed datasets.

The coefficients reveal an interpretable partition between immediate and accumulated antecedent conditions. The `rain_yesterday` coefficient in the conditional intensity component ($\hat{\beta} = 0.322$, $e^{0.322} \approx 1.38$, $p < 0.001$) indicates that rainfall on the preceding day is associated with approximately 38% greater intensity on rainy days, consistent with the physical scenario of a persisting frontal or trough system delivering consecutive rainfall events of comparable character. The `rainfall_ma7` coefficient ($\hat{\beta} = 0.127$, $p < 0.001$) extends this logic to the weekly horizon: a wetter preceding week is associated with heavier current rainfall, suggesting that prolonged wet spells reflect deeper or more extensive atmospheric systems rather than sequences of meteorologically independent events.

The negative coefficient for `humidity_ma7` ($\hat{\beta} = -0.078$, $p < 0.001$) warrants careful interpretation. Conditional on the full predictor set, a persistently humid preceding week is associated with slightly lower rainfall intensity. This likely reflects a distinction between two meteorological regimes: stratiform cloud systems, which sustain elevated background humidity across extended periods without generating intense precipitation, and convective systems, which produce intense episodic rainfall under conditions of rapid moisture change rather than sustained elevated humidity. Once the model incorporates both instantaneous humidity and its 7-day mean, the latter carries the residual signal of these differing system types.

Finally, `days_since_rain` is not significant in the conditional intensity component ($\hat{\beta} = 0.003$, $p = 0.694$). The duration of an antecedent dry spell predicts whether rain will occur, but once the model conditions on rainfall occurring, the length of the preceding drought provides no additional information about the volume of that rainfall. This result reinforces the conceptual separation between the occurrence and intensity sub-processes that motivates the ZIG framework, and foreshadows the use of a flexible spline for this term in the zero-inflation component of Model 6 (@sec-model6).

Imputation provenance flags for the four ghost-sensor variables (`sunshine`, `evaporation`, `cloud_3pm`, and `cloud_9am`) were tested in the zero-inflation component across all model specifications from Model 3 onward. None achieved statistical significance (all $p > 0.05$), confirming that the predictive mean matching imputation did not introduce systematic bias at stations lacking direct instrumentation for these variables. The flags were subsequently excluded from all further model specifications.

---

## Model 4: Thermodynamic Energy and the Rain Corner Interaction

```{r}
#| label: m4-energy-code
#| echo: true
#| eval: false

m4_energy <- fit_and_pool(
  cond_formula = rainfall ~ 1 + humidity3pm + dewpoint_9am + dewpoint_change +
                 pressure_change + day_cos + day_sin + rainfall_ma7 + 
                 days_since_rain + humidity_ma7 + rain_yesterday +
                 sunshine + evaporation + instability_index + 
                 sun_humid_interaction + cloud_development,
  zi_formula   = ~ humidity3pm + dewpoint_9am + rain_yesterday + 
                 cloud_development + pressure_change
)
```

```{r}
#| label: m4-energy-output
#| echo: false

render_pooled_model_table(m4_energy, "Model 4: Thermodynamic Energy and Interactions")
```

The bivariate density analysis in @sec-bivariate-density identified a structural non-linearity in the joint distribution of afternoon humidity and sunshine hours: intense rainfall occurs almost exclusively in the region of the bivariate distribution where humidity is high and sunshine is simultaneously low. An additive model is structurally incapable of representing this conditional geometry. Model 4 introduces the multiplicative `sun_humid_interaction` term alongside a broader set of thermodynamic energy predictors (`sunshine`, `evaporation`, `instability_index`, and `cloud_development`) to formalise the physical hypothesis that convective rainfall arises from the conjunction of available moisture and atmospheric instability rather than from either factor in isolation.

The AIC falls to 409,801.6, a reduction of 1,258.7 points relative to Model 3 (BIC = 410,028.4). This gain is modest in absolute terms but carries a disproportionate interpretive weight, because the new terms do not merely add marginal predictive power; they restructure the representation of the moisture signal already present in the model.

The `sun_humid_interaction` coefficient of $\hat{\beta} = -0.076$ (SE = 0.016, $p < 0.001$) is highly significant and physically coherent. After mean-centring both component variables, the product term takes large negative values precisely when humidity is above average and sunshine hours are below average. The negative coefficient therefore assigns greater expected rainfall intensity to this region of the covariate space, directly encoding the Rain Corner identified in @sec-bivariate-density: an overcast, moisture-saturated atmosphere in which solar insolation is suppressed by deep cloud cover, creating the thermodynamic conditions most conducive to sustained or intense precipitation.

The `instability_index` ($\hat{\beta} = 0.145$, $p < 0.001$) operates on related physical grounds: higher atmospheric instability, typically associated with steep lapse rates and strong surface heating, promotes convective development and augments rainfall intensity given that rainfall is occurring. The `evaporation` coefficient ($\hat{\beta} = 0.154$, $p < 0.001$) is positive, suggesting that on rainy days higher potential evaporation (a proxy for energy availability) is associated with greater intensity, consistent with convectively driven systems drawing on sensible and latent heat fluxes.

The entry of the interaction term and the thermodynamic covariates produces a marked reduction in the `humidity3pm` coefficient, from $0.422$ in Model 3 to $0.223$ in Model 4. This is not indicative of instability or suppression of the humidity signal. It reflects a correct partitioning of explained variance: the portion of humidity's predictive contribution that operates through its interaction with sunshine, and through the atmospheric instability it enables, is now attributed to those specific mechanistic pathways rather than being absorbed into the humidity main effect alone. The model has advanced from recognising that moisture matters to representing the specific conjunction of conditions under which it matters most.

---

## Model 5: Wind Vector Dynamics

```{r}
#| label: m5-wind-code
#| echo: true
#| eval: false

m5_wind <- fit_and_pool(
  cond_formula = rainfall ~ 1 + humidity3pm + dewpoint_9am + dewpoint_change +
                 pressure_change + day_cos + day_sin + rainfall_ma7 + 
                 days_since_rain + humidity_ma7 + rain_yesterday +
                 sunshine + evaporation + instability_index + 
                 sun_humid_interaction + cloud_development +
                 gust_U_EW + gust_V_NS + wind9am_V_NS + wind9am_U_EW,
  zi_formula   = ~ humidity3pm + dewpoint_9am + rain_yesterday + 
                 cloud_development + pressure_change
)
```

```{r}
#| label: m5-wind-output
#| echo: false

render_pooled_model_table(m5_wind, "Model 5: Wind Vector Dynamics")
```

Model 5 tests whether the directional provenance of air masses provides additional information about rainfall intensity beyond the instantaneous thermodynamic state of the atmosphere. As developed in @sec-feature-eng, wind direction is encoded as orthogonal zonal (U, east-west) and meridional (V, north-south) vector components, preserving the circular geometry of directional data and avoiding the discontinuity that would arise from treating compass bearing as a linear predictor. Both peak gust components and the 9:00 AM surface wind vectors are included, allowing the model to distinguish between the background synoptic circulation at day onset and the turbulent dynamics associated with active rainfall systems.

The AIC falls to 409,149.2, a reduction of 652.4 points relative to Model 4 (BIC = 409,415.5). This is the smallest stepwise improvement in the sequence. The BIC penalty for the four additional parameters is relatively restrictive, indicating that the marginal gain should be interpreted in the context of the physical interpretability of the effects rather than purely through information criteria.

The most informative wind coefficients are those for the morning surface vectors. `wind9am_U_EW` ($\hat{\beta} = -0.116$, SE = 0.008, $p < 0.001$) is negative for the zonal component: since the U convention assigns positive values to eastward flow, a negative coefficient indicates that westerly airflow at 9:00 AM increases expected rainfall intensity. This is physically consistent with the Roaring Forties, the band of persistent westerly circulation in the mid-latitudes that advects maritime air masses from the Indian Ocean onto the southern and southwestern regions of the continent. `wind9am_V_NS` is not significant at conventional levels ($\hat{\beta} = -0.008$, $p = 0.145$) when the full covariate set is included, though the direction is consistent with southerly incursion enhancing rainfall on the eastern seaboard.

For the peak gust vectors, `gust_U_EW` is significant ($\hat{\beta} = -0.056$, $p < 0.001$), while `gust_V_NS` is not ($\hat{\beta} = -0.008$, $p = 0.261$). The morning wind component has a coefficient approximately twice the magnitude of the corresponding gust component. This contrast supports the interpretation that the prevailing direction of the synoptic-scale air mass at day onset (reflecting the large-scale circulation pattern within which a rainfall event is embedded) is more informative about event intensity than the turbulent, locally generated gusts that accompany active storm activity. The provenance of an air mass carries more predictive information about the moisture it transports than does the mechanical turbulence it generates near the surface.

Coefficients for the moisture, thermodynamic, and interaction terms established in prior models remain stable in direction and magnitude across this extension, confirming that the wind predictors explain variance not already accounted for by thermodynamic state, rather than displacing existing effects through collinearity with humidity or pressure.

---

## Model 6: Spatial Heterogeneity via Mixed Effects {#sec-model6}

```{r}
#| label: m6-mixed-code
#| echo: true
#| eval: false

m6_mixed <- fit_and_pool(
  cond_formula = rainfall ~
    humidity3pm + dewpoint_9am + dewpoint_change +
    pressure_change + day_cos + day_sin +
    rainfall_ma7 + days_since_rain + humidity_ma7 +
    rain_yesterday + sunshine + evaporation +
    instability_index + sun_humid_interaction +
    cloud_development + gust_U_EW + gust_V_NS +
    wind9am_V_NS + wind9am_U_EW +
    diag(1 + humidity3pm + rain_yesterday + dewpoint_change | location),
  zi_formula = ~ humidity3pm + dewpoint_9am + rain_yesterday +
    cloud_development + pressure_change + sunshine +
    evaporation + ns(days_since_rain, df = 4) +
    (1 | location) + humidity_ma7 + day_cos + day_sin,
  datasets = all_datasets,
  control  = glmmTMBControl(
    optimizer = nlminb,
    optCtrl   = list(iter.max = 500, eval.max = 1000)
  ),
  n_cores = 3L
)
```

```{r}
#| label: m6-mixed-output
#| echo: false

render_pooled_model_table(m6_mixed, "M6: Fixed Effects Model")
```

All five preceding models implicitly assume that the relationship between each atmospheric predictor and rainfall is spatially uniform, as though the sensitivity of rainfall intensity to afternoon humidity were identical in coastal Sydney, the tropical far north, and the arid interior. For a continent as climatologically heterogeneous as Australia, spanning tropical monsoon, subtropical semi-arid, temperate oceanic, and Mediterranean regimes, this homogeneity assumption is difficult to defend. The EDA in @sec-eda confirmed that both mean rainfall levels and seasonal patterns vary substantially across the station network.

Model 6 relaxes the spatial homogeneity assumption through a mixed-effects structure. Location-specific random effects allow the intercept and three scientifically motivated slopes (for `humidity3pm`, `rain_yesterday`, and `dewpoint_change`) to vary freely across weather stations. An uncorrelated (diagonal) random effects covariance structure is specified via `diag()` rather than an unstructured matrix, avoiding the overparameterisation that would accompany a freely estimated $4 \times 4$ random covariance across the number of stations in the dataset. Two further modifications accompany the move to mixed effects. The zero-inflation submodel is expanded with `sunshine`, `evaporation`, and the day-of-year harmonic terms, reflecting the hypothesis that occurrence probability is governed by the same broad range of atmospheric drivers as intensity. Additionally, `days_since_rain` in the zero-inflation submodel is replaced by a four-degree-of-freedom natural spline, directly implementing the non-linear, rapid-then-gradual decay in rainfall probability identified in @sec-dry-spell. The spline permits the marginal probability of precipitation to decline steeply within the first ten days of a dry spell and then stabilise, rather than imposing the constant log-odds decrement implied by a linear term.

The AIC falls to 400,997.9, a reduction of 8,151.3 points relative to Model 5 (BIC = 401,402.2; log-likelihood = $-200,457.9$). This is the third-largest single improvement in the entire model sequence, exceeded only by the initial introduction of moisture and pressure in Model 1 and the addition of seasonality and persistence in Model 2. The magnitude of the gain establishes that spatial heterogeneity is not a minor correction to an otherwise well-specified model; it is a structurally important dimension of the rainfall generation process that fixed-effects models cannot represent by design.

The fixed-effect estimates for the global-mean relationships remain directionally and numerically consistent with those from Model 5, which provides reassurance that the random effects are absorbing genuine between-location variation rather than confounding the population-average coefficients. Several predictors warrant specific attention in the context of the expanded zero-inflation submodel. `dewpoint_9am` is now significant in the occurrence model ($\hat{\beta}_{zi} = -0.519$, $p < 0.001$), in contrast to its non-significance in all prior specifications. This reversal reflects the expanded zero-inflation predictor set: once sunshine, evaporation, and seasonal harmonics are included in the occurrence model, the morning dewpoint carries a distinct contribution to precipitation probability that was previously absorbed by correlated terms. The `humidity_ma7` coefficient in the zero-inflation submodel ($\hat{\beta}_{zi} = -0.254$, $p < 0.001$) is also negative and substantial, indicating that a persistently humid antecedent week substantially reduces the probability of a dry day, consistent with the view that extended moisture advection creates a background state favourable to continued precipitation.

The natural spline terms for `days_since_rain` in the zero-inflation submodel are collectively non-significant at conventional thresholds, with the second basis function marginally approaching significance ($\hat{\beta} = 0.115$, $p = 0.075$). This suggests that the dry spell decay function, while visually non-linear in the analysis of @sec-dry-spell, does not depart substantially from linearity once the full complement of humidity, seasonal, and persistence predictors is included. The spline is retained for its robustness to potential non-linearity, but the practical difference from a linear specification appears limited given the current covariate set.

---

## Progressive Model Comparison

The AIC trajectory across the model sequence (summarised in @tbl-model-comparison) reveals a pattern of steeply front-loaded improvement followed by diminishing but genuine increments, with a notable secondary gain at the step to mixed effects.

```{r}
#| label: tbl-model-comparison
#| echo: false
#| warning: false
#| message: false

library(tidyverse)
library(kableExtra)

model_summary <- tibble(
  Model = c("M0", "M1", "M2", "M3", "M4", "M5", "M6"),
  Description = c(
    "Null (intercept only)",
    "Moisture and pressure",
    "Seasonality and persistence",
    "Accumulated history",
    "Thermodynamics and interactions",
    "Wind vectors",
    "Spatial mixed effects (final)"
  ),
  AIC = c(
    461669.7,
    425731.4,
    412448.4,
    411060.3,
    409801.6,
    409149.2,
    400997.9
  )
) %>%
  mutate(
    `Delta AIC` = max(AIC) - AIC,
    `% of Total Gain` = `Delta AIC` / max(`Delta AIC`),
    AIC = scales::comma(AIC, accuracy = 0.1),
    `Delta AIC` = ifelse(
      Model == "M0", "-",
      scales::comma(`Delta AIC`, accuracy = 0.1)
    ),
    `% of Total Gain` = ifelse(
      Model == "M0", "-",
      scales::percent(`% of Total Gain`, accuracy = 0.1)
    )
  )

model_summary %>%
  kable(
    col.names = c("Model", "Description", "AIC", "Change in AIC vs Null", "% of Total Gain"),
    align = "llrrr",
    caption = "Progressive Model Comparison: AIC Trajectory"
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = FALSE,
    position = "center"
  ) %>%
  row_spec(7, bold = TRUE, background = "#e6f3ff", color = "#212529") %>%
  add_footnote(
    c(
      "AIC: Akaike Information Criterion (Lower is better)",
      "Total Gain is calculated relative to the maximum improvement achieved by Model 6."
    ),
    notation = "none"
  )
```
Moisture and pressure dynamics alone account for 55.3% of the total AIC improvement, confirming that atmospheric water content is the primary physical driver of both rainfall occurrence and intensity in the Australian context. The addition of seasonal cycles and day-to-day persistence in Model 2 raises the cumulative share to 75.7%, establishing that temporal structure (the annual insolation cycle and the short-range memory of the atmosphere) constitutes the second-order source of predictive information. The thermodynamic and wind components (Models 4 and 5) each contribute positively but with diminishing returns, reflecting the fact that the mechanistic pathways they represent are partially encoded in earlier proxies.

The step to mixed effects (Model 6) recovers 19.3 percentage points of additional gain, the largest single improvement after the initial moisture signal. This disproportionate improvement, despite the fact that the fixed-effect predictor set changes relatively little between Models 5 and 6, makes explicit a conclusion that is implicit in the geography of the station network: the parameters governing the moisture-intensity relationship, rainfall persistence, and dewpoint sensitivity are not continental constants but regional properties that vary systematically with climate zone. Treating them as such is not a statistical convenience but a physical necessity.